{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"Getting started","text":"<p>This is the documentation for version 4 of the project, the current version. Documentation for the previous version of the project, version 3, can be found here.</p> <p>The wp-browser library provides a set of Codeception modules and middleware to enable the testing of WordPress sites, plugins and themes.</p>"},{"location":"#requirements","title":"Requirements","text":"<p>Depending on the nature of your project, there are different requirements it will need to satisfy before getting started. </p>"},{"location":"#site","title":"Site","text":"<ul> <li>Ensure you're running the <code>vendor/bin/codecept init wpbrowser</code> command from the root directory of your WordPress site.</li> <li>Ensure the directory contains the WordPress installation files. In a standard scenario you should have extracted WordPress files in this directory.</li> <li>Ensure your installation is configured: it should contain a <code>wp-config.php</code> file.</li> </ul>"},{"location":"#plugin","title":"Plugin","text":"<ul> <li>Ensure you're running the <code>vendor/bin/codecept init wpbrowser</code> command from the root directory of your plugin; this should be the directory that contains the PHP file defining the plugin header.</li> </ul>"},{"location":"#theme","title":"Theme","text":"<ul> <li>Ensure you're running the <code>vendor/bin/codecept init wpbrowser</code> command from the root directory of your theme; this should be the directory that contains the <code>style.css</code> file defining the theme header.</li> </ul> <p>If you decide to use the quick installation, then your PHP version should have the <code>sqlite3</code> extensions installed and activated. You can check this using the <code>php -m</code> command and verifying the <code>sqlite3</code> extension is among the active extensions.</p>"},{"location":"#installation","title":"Installation","text":"<p>Add wp-browser to your project as a development dependency using Composer</p> <pre><code>cd my-wordrpess-project\ncomposer require --dev lucatume/wp-browser\n</code></pre> <p>Initialize wp-browser to quickly configured to suite your project and setup:</p> <pre><code>vendor/bin/codecept init wpbrowser\n</code></pre> <p>The command will set up your project to run integration and end-to-end tests using:</p> <ul> <li>SQLite as the database engine, leveraging the SQLite Database Integration plugin</li> <li>PHP built-in web server to serve the WordPress site on localhost (e.g. <code>http://localhost:8080</code>)</li> <li>Chromedriver to drive the local version of Chrome installed on your machine</li> </ul> <p>If you're working on a plugin or theme project, the default configuration will add some extra steps:</p> <ul> <li>install the latest version of WordPress in the <code>tests/_wordpress</code> directory</li> <li>create a <code>tests/_plugins</code> directory: any file or directory in this directory will be symlinked into the WordPress   installation in <code>tests/_wordpress/wp-content/plugins</code></li> <li>create a <code>tests/_themes</code> directory: any file or directory in this directory will be symlinked into the WordPress   installation in <code>tests/_wordpress/wp-content/themes</code></li> </ul> <p>For most projects this configuration will be enough to get started with testing.</p> <p>You can run your tests immediately using the <code>vendor/bin/codecept run</code> command.</p> <p>Read more about the commands provided by the library here.</p>"},{"location":"#using-a-custom-configuration","title":"Using a custom configuration","text":"<p>If you decide to skip the default configuration, you will be able to set up <code>wp-browser</code> to suit your needs and local setup by editing the <code>tests/.env</code> file. The inline documentation in the file will guide you through the configuration process.</p> <p>Read more about using a custom configuration here.</p>"},{"location":"#getting-support-for-wp-browser-configuration-and-usage","title":"Getting support for wp-browser configuration and usage","text":"<p>The best place to get support for wp-browser is the project documentation. Since this project builds on top of PHPUnit and Codeception, you can also refer to their documentation.</p> <p>If you can't find the answer to your question here you can ask on the \"Issues\" section of the wp-browser repository taking care to provide as much information as possible.</p> <p>Finally, you can contact me directly to set up a call to discuss your project needs and how wp-browser can help you.</p>"},{"location":"DispatcherAPI/","title":"Dispatcher API","text":"<p>An API to dispatch and subscribe to events fired during tests execution.</p>"},{"location":"DispatcherAPI/#events-dispatched-by-codeception","title":"Events dispatched by Codeception","text":"<p>You can subscribe to the following events dispatched by Codeception in either the global bootstrap file (usually <code>tests/_bootstrap.php</code>), or in a suite bootstrap file (usually <code>tests/&lt;suite&gt;/_bootstrap.php</code>) using the Event Dispatcher Bridge extension:</p> <ul> <li><code>Codeception\\Events::SUITE_BEFORE</code></li> <li><code>Codeception\\Events::SUITE_AFTER</code></li> <li><code>CodeceptionventsEvents::TEST_START</code></li> <li><code>CodeceptionventsEvents::TEST_BEFORE</code></li> <li><code>CodeceptionventsEvents::STEP_BEFORE</code></li> <li><code>CodeceptionventsEvents::STEP_AFTER</code></li> <li><code>CodeceptionventsEvents::TEST_FAIL</code></li> <li><code>CodeceptionventsEvents::TEST_ERROR</code></li> <li><code>CodeceptionventsEvents::TEST_PARSED</code></li> <li><code>CodeceptionventsEvents::TEST_INCOMPLETE</code></li> <li><code>CodeceptionventsEvents::TEST_SKIPPED</code></li> <li><code>CodeceptionventsEvents::TEST_WARNING</code></li> <li><code>CodeceptionventsEvents::TEST_USELESS</code></li> <li><code>CodeceptionventsEvents::TEST_SUCCESS</code></li> <li><code>CodeceptionventsEvents::TEST_AFTER</code></li> <li><code>CodeceptionventsEvents::TEST_END</code></li> <li><code>CodeceptionventsEvents::TEST_FAIL_PRINT</code></li> <li><code>CodeceptionventsEvents::RESULT_PRINT_AFTER</code></li> </ul> <p>In the global bootstrap file (usually <code>tests/_bootstrap.php</code>), or the suite bootstrap file (usually <code>tests/&lt;suite&gt;/_bootstrap.php</code>), subscribe to the Codeception events by providing a callback function that will accept different parameters depending on the event being dispatched:</p> <pre><code>&lt;?php\n\nuse Codeception\\Events;\nuse Codeception\\Event\\SuiteEvent\nuse Codeception\\Event\\TestEvent;\nuse Codeception\\Event\\StepEvent;\nuse Codeception\\Event\\PrintResultEvent;\nuse lucatume\\WPBrowser\\Events\\Dispatcher;\n\nDispatcher::addListener(Events::SUITE_BEFORE, function (SuiteEvent $suiteEvent) {\n    codecept_debug('Running on SUITE BEFORE');\n});\n\nDispatcher::addListener(Events::SUITE_AFTER, function (SuiteEvent $suiteEvent) {\n    codecept_debug('Running on SUITE AFTER');\n});\n\nDispatcher::addListener(Events::TEST_START, function (TestEvent $testEvent) {\n    codecept_debug('Running on TEST START');\n});\n\nDispatcher::addListener(Events::TEST_BEFORE, function (TestEvent $testEvent) {\n    codecept_debug('Running on TEST BEFORE');\n});\n\nDispatcher::addListener(Events::STEP_BEFORE, function (StepEvent $stepEvent) {\n    codecept_debug('Running on STEP BEFORE');\n});\n\nDispatcher::addListener(Events::STEP_AFTER, function (StepEvent $stepEvent) {\n    codecept_debug('Running on STEP AFTER');\n});\n\nDispatcher::addListener(Events::TEST_FAIL, function (TestEvent $testEvent) {\n    codecept_debug('Running on TEST FAIL');\n});\n\nDispatcher::addListener(Events::TEST_ERROR, function (TestEvent $testEvent) {\n    codecept_debug('Running on TEST ERROR');\n});\n\nDispatcher::addListener(Events::TEST_PARSED, function (TestEvent $testEvent) {\n    codecept_debug('Running on TEST PARSED');\n});\n\nDispatcher::addListener(Events::TEST_INCOMPLETE, function (TestEvent $testEvent) {\n    codecept_debug('Running on TEST INCOMPLETE');\n});\n\nDispatcher::addListener(Events::TEST_SKIPPED, function (TestEvent $testEvent) {\n    codecept_debug('Running on TEST SKIPPED');\n});\n\nDispatcher::addListener(Events::TEST_WARNING, function (TestEvent $testEvent) {\n    codecept_debug('Running on TEST WARNING');\n});\n\nDispatcher::addListener(Events::TEST_USELESS, function (TestEvent $testEvent) {\n    codecept_debug('Running on TEST USELESS');\n});\n\nDispatcher::addListener(Events::TEST_SUCCESS, function (TestEvent $testEvent) {\n    codecept_debug('Running on TEST SUCCESS');\n});\n\nDispatcher::addListener(Events::TEST_AFTER, function (TestEvent $testEvent) {\n    codecept_debug('Running on TEST AFTER');\n});\n\nDispatcher::addListener(Events::TEST_END, function (TestEvent $testEvent) {\n    codecept_debug('Running on TEST END');\n});\n\nDispatcher::addListener(Events::TEST_FAIL_PRINT, function (PrintResultEvent $printResultEvent) {\n    codecept_debug('Running on TEST FAIL PRINT');\n});\n\nDispatcher::addListener(Events::RESULT_PRINT_AFTER, function (PrintResultEvent $printResultEvent) {\n    codecept_debug('Running on RESULT PRINT AFTER');\n});\n</code></pre>"},{"location":"DispatcherAPI/#events-dispatched-by-wp-browser","title":"Events dispatched by wp-browser","text":"<p>The project dispatches its own events, allowing you to subscribe to them to control the test state and execution. To subscribe to the events dispatched by wp-browser, you do not need to use the Event Dispatcher Bridge extension.</p>"},{"location":"DispatcherAPI/#wploader-module-events","title":"WPLoader Module Events","text":"<p>The <code>WPLoader</code> module will dispatch events during its initialization.  </p>"},{"location":"DispatcherAPI/#event_before_loadonly","title":"EVENT_BEFORE_LOADONLY","text":"<p>This event fires before WordPress is loaded by the <code>WPLoader</code> module when <code>loadOnly</code> is set to <code>true</code>.</p> <p>Due to order-of-operations, you can hook on this event only in the global bootstrap file (usually <code>tests/_bootstrap.php</code>).</p> <p>WordPress is not loaded yet, so you cannot use functions or classes defined by WordPress, themes or plugins here. You can interact with the WordPress installation and use the <code>lucatume\\WPBrowser\\WordPress\\PreloadFilters</code> class to hook on actions and filters that will be fired by WordPress once loaded.</p> <pre><code>&lt;?php\n\nuse lucatume\\WPBrowser\\Events\\Dispatcher;\nuse lucatume\\WPBrowser\\Module\\WPLoader;\nuse lucatume\\WPBrowser\\Events\\Event;\n\nDispatcher::addListener(WPLoader::EVENT_BEFORE_LOADONLY, function (Event $event) {\n    /** @var WPLoader $wpLoader */\n    $wpLoader = $event-&gt;getOrigin();\n\n    codecept_debug('Running on EVENT_BEFORE_LOADONLY');\n\n    // Interact with the WordPress installation, its filesystem and database.\n    $installation = $wpLoader-&gt;getInstallation();\n    $pluginsDir = $installation-&gt;getPluginsDir();\n    $db = $installation-&gt;getDb();\n    $db-&gt;import(codecept_data_dir('some-dump.sql'));\n\n    // Use the PreloadFilters class to hook on WordPress actions and filters.\n    PreloadFilters::addFilter('init', fn() =&gt; update_option('some_option', 'some_value'));\n    PreloadFilters::addFilter('pre_option_some_option', fn() =&gt; 'some_value');\n});\n</code></pre>"},{"location":"DispatcherAPI/#event_after_loadonly","title":"EVENT_AFTER_LOADONLY","text":"<p>This event fires after WordPress is loaded by the <code>WPLoader</code> module when <code>loadOnly</code> is set to <code>true</code>.</p> <p>Due to order-of-operations, you can hook on this event only in the global bootstrap file (usually <code>tests/_bootstrap.php</code>).</p> <p>At this point, WordPress has been loaded. You can interact with the WordPress installation using functions and classes defined by WordPress, themes or plugins.</p> <pre><code>&lt;?php\n\nuse lucatume\\WPBrowser\\Events\\Dispatcher;\nuse lucatume\\WPBrowser\\Module\\WPLoader;\nuse lucatume\\WPBrowser\\Events\\Event;\n\nDispatcher::addListener(WPLoader::EVENT_AFTER_LOADONLY, function (Event $event) {\n    /** @var WPLoader $wpLoader */\n    $wpLoader = $event-&gt;getOrigin();\n\n    codecept_debug('Running on EVENT_AFTER_LOADONLY');\n\n    // Interact with the WordPress installation, its filesystem and database.    \n    $installation = $wpLoader-&gt;getInstallation();\n    $pluginsDir = $installation-&gt;getPluginsDir();\n    $db = $installation-&gt;getDb();\n    $db-&gt;import(codecept_data_dir('some-dump.sql'));\n\n    // Use WordPress functions and classes.\n    update_option('some_option', 'some_value');\n});\n</code></pre>"},{"location":"DispatcherAPI/#event_before_install","title":"EVENT_BEFORE_INSTALL","text":"<p>This event fires before WordPress is installed by the <code>WPLoader</code> module when <code>loadOnly</code> is set to <code>false</code>.</p> <p>Due to order-of-operations, you can hook on this event only in the global bootstrap file (usually <code>tests/_bootstrap.php</code>).</p> <p>WordPress is not loaded yet, so you cannot use functions or classes defined by WordPress, themes or plugins here. You can interact with the WordPress installation and use the <code>lucatume\\WPBrowser\\WordPress\\PreloadFilters</code> class to hook on actions and filters that will be fired by WordPress once loaded.</p> <pre><code>&lt;?php\n\nuse lucatume\\WPBrowser\\Events\\Dispatcher;\nuse lucatume\\WPBrowser\\Module\\WPLoader;\nuse lucatume\\WPBrowser\\Events\\Event;\n\nDispatcher::addListener(WPLoader::EVENT_BEFORE_INSTALL, function (Event $event) {\n    /** @var WPLoader $wpLoader */\n    $wpLoader = $event-&gt;getOrigin();\n\n    codecept_debug('Running on EVENT_BEFORE_INSTALL');\n\n    // Interact with the WordPress installation, its filesystem and database.\n    $installation = $wpLoader-&gt;getInstallation();\n    $pluginsDir = $installation-&gt;getPluginsDir();\n    $db = $installation-&gt;getDb();\n    $db-&gt;import(codecept_data_dir('some-dump.sql'));\n\n    // Use the PreloadFilters class to hook on WordPress actions and filters.\n    PreloadFilters::addFilter('init', fn() =&gt; update_option('some_option', 'some_value'));\n    PreloadFilters::addFilter('pre_option_some_option', fn() =&gt; 'some_value');\n});\n</code></pre>"},{"location":"DispatcherAPI/#event_after_install","title":"EVENT_AFTER_INSTALL","text":"<p>This event fires after WordPress is installed by the <code>WPLoader</code> module when <code>loadOnly</code> is set to <code>false</code>.</p> <p>Due to order-of-operations, you can hook on this event only in the global bootstrap file (usually <code>tests/_bootstrap.php</code>).</p> <p>At this point, WordPress has been installed and loaded. You can interact with the WordPress installation using functions and classes defined by WordPress, themes or plugins. This event fires before dump files specified in the <code>dump</code> configuration parameter of the <code>WPLoader</code> module are imported.</p> <pre><code>&lt;?php\n\nuse lucatume\\WPBrowser\\Events\\Dispatcher;\nuse lucatume\\WPBrowser\\Module\\WPLoader;\nuse lucatume\\WPBrowser\\Events\\Event;\n\nDispatcher::addListener(WPLoader::EVENT_AFTER_INSTALL, function (Event $event) {\n    /** @var WPLoader $wpLoader */\n    $wpLoader = $event-&gt;getOrigin();\n\n    codecept_debug('Running on EVENT_AFTER_INSTALL');\n\n    // Interact with the WordPress installation, its filesystem and database.    \n    $installation = $wpLoader-&gt;getInstallation();\n    $pluginsDir = $installation-&gt;getPluginsDir();\n    $db = $installation-&gt;getDb();\n    $db-&gt;import(codecept_data_dir('some-dump.sql'));\n\n    // Use WordPress functions and classes.    \n    update_option('some_option', 'some_value');\n});\n</code></pre>"},{"location":"DispatcherAPI/#event_after_install_1","title":"EVENT_AFTER_INSTALL","text":"<p>This event fires after WordPress is installed by the <code>WPLoader</code> module when <code>loadOnly</code> is set to <code>false</code>. </p> <p>Due to order-of-operations, you can hook on this event only in the global bootstrap file (usually <code>tests/_bootstrap.php</code>).</p> <p>At this point, WordPress has been installed and loaded. You can interact with the WordPress installation using functions and classes defined by WordPress, themes or plugins.</p> <pre><code>&lt;?php\n\nuse lucatume\\WPBrowser\\Events\\Dispatcher;\nuse lucatume\\WPBrowser\\Module\\WPLoader;\nuse lucatume\\WPBrowser\\Events\\Event;\n\nDispatcher::addListener(WPLoader::EVENT_AFTER_INSTALL, function (Event $event) {\n    /** @var WPLoader $wpLoader */\n    $wpLoader = $event-&gt;getOrigin();\n\n    codecept_debug('Running on EVENT_AFTER_INSTALL');\n\n    // Interact with the WordPress installation, its filesystem and database.    \n    $installation = $wpLoader-&gt;getInstallation();\n    $pluginsDir = $installation-&gt;getPluginsDir();\n    $db = $installation-&gt;getDb();\n    $db-&gt;import(codecept_data_dir('some-dump.sql'));\n\n    // Use WordPress functions and classes.\n    update_option('some_option', 'some_value');\n});\n</code></pre>"},{"location":"DispatcherAPI/#event_after_bootstrap","title":"EVENT_AFTER_BOOTSTRAP","text":"<p>This event fires after the <code>WPLoader</code> module has finished bootstrapping the WordPress installation and dump files specified in the <code>dump</code> configuration parameter of the <code>WPLoader</code> module are imported.</p> <p>Due to order-of-operations, you can hook on this event only in the global bootstrap file (usually <code>tests/_bootstrap.php</code>).</p> <p>You can interact with the WordPress installation using functions and classes defined by WordPress, themes or plugins.</p> <pre><code>&lt;?php\n\nuse lucatume\\WPBrowser\\Events\\Dispatcher;\nuse lucatume\\WPBrowser\\Module\\WPLoader;\nuse lucatume\\WPBrowser\\Events\\Event;\n\nDispatcher::addListener(WPLoader::EVENT_AFTER_BOOTSTRAP, function (Event $event) {\n    /** @var WPLoader $wpLoader */\n    $wpLoader = $event-&gt;getOrigin();\n\n    codecept_debug('Running on EVENT_AFTER_BOOTSTRAP');\n\n    // Interact with the WordPress installation, its filesystem and database.    \n    $installation = $wpLoader-&gt;getInstallation();\n    $pluginsDir = $installation-&gt;getPluginsDir();\n    $db = $installation-&gt;getDb();\n    $db-&gt;import(codecept_data_dir('some-dump.sql'));\n\n    // Use WordPress functions and classes.\n    update_option('some_option', 'some_value');\n});\n</code></pre>"},{"location":"DispatcherAPI/#wpdb-module-events","title":"WPDb Module Events","text":""},{"location":"DispatcherAPI/#event_before_suite","title":"EVENT_BEFORE_SUITE","text":"<p>This event fires after the <code>WPDb</code> module has run its <code>_beforeSuite</code> method.  </p> <p>Due to order-of-operations, you can hook on this event only in the global bootstrap file (usually <code>tests/_bootstrap.php</code>).</p> <p>At this point the module has connected to the database, cleaned up and populated the database with the dump files.</p> <pre><code>&lt;?php\n\nuse lucatume\\WPBrowser\\Events\\Dispatcher;\nuse lucatume\\WPBrowser\\Module\\WPDb;\nuse lucatume\\WPBrowser\\Events\\Event;\n\nDispatcher::addListener(WPDb::EVENT_BEFORE_SUITE, function (Event $event) {\n    /** @var WPDb $wpDb */\n    $wpDb = $event-&gt;getOrigin();    \n\n    codecept_debug('Running on EVENT_BEFORE_SUIT\n    E');\n});\n</code></pre>"},{"location":"DispatcherAPI/#event_before_initialize","title":"EVENT_BEFORE_INITIALIZE","text":"<p>This event fires before the <code>WPDb</code> module initializes.</p> <p>Due to order-of-operations, you can hook on this event only in the global bootstrap file (usually <code>tests/_bootstrap.php</code>).</p> <pre><code>&lt;?php\n\nuse lucatume\\WPBrowser\\Events\\Dispatcher;\nuse lucatume\\WPBrowser\\Module\\WPDb;\nuse lucatume\\WPBrowser\\Events\\Event;\n\nDispatcher::addListener(WPDb::EVENT_BEFORE_INITIALIZE, function (Event $event) {\n    /** @var WPDb $wpDb */\n    $wpDb = $event-&gt;getOrigin();    \n\n    codecept_debug('Running on EVENT_BEFORE_INITIALIZE');\n});\n</code></pre>"},{"location":"DispatcherAPI/#event_after_initialize","title":"EVENT_AFTER_INITIALIZE","text":"<p>This event fires after the <code>WPDb</code> module has initialized.</p> <p>Due to order-of-operations, you can hook on this event only in the global bootstrap file (usually <code>tests/_bootstrap.php</code>).</p> <pre><code>&lt;?php\n\nuse lucatume\\WPBrowser\\Events\\Dispatcher;  \nuse lucatume\\WPBrowser\\Module\\WPDb;  \nuse lucatume\\WPBrowser\\Events\\Event;  \n\nDispatcher::addListener(WPDb::EVENT_AFTER_INITIALIZE, function (Event $event) {\n    /** @var WPDb $wpDb */\n    $wpDb = $event-&gt;getOrigin();    \n\n    codecept_debug('Running on EVENT_AFTER_INITIALIZE');\n});\n</code></pre>"},{"location":"DispatcherAPI/#event_after_db_prepare","title":"EVENT_AFTER_DB_PREPARE","text":"<p>This event fires after the <code>WPDb</code> module has prepared the database setting up some default values for quality-of-life improvements.</p> <p>Due to order-of-operations, you can hook on this event only in the global bootstrap file (usually <code>tests/_bootstrap.php</code>).</p> <pre><code>&lt;?php\n\nuse lucatume\\WPBrowser\\Events\\Dispatcher;  \nuse lucatume\\WPBrowser\\Module\\WPDb;  \nuse lucatume\\WPBrowser\\Events\\Event;  \n\nDispatcher::addListener(WPDb::EVENT_AFTER_DB_PREPARE, function (Event $event) {\n    /** @var WPDb $wpDb */\n    $wpDb = $event-&gt;getOrigin();    \n\n    codecept_debug('Running on EVENT_AFTER_DB_PREPARE');\n});\n</code></pre>"},{"location":"DispatcherAPI/#dispatching-custom-events","title":"Dispatching custom events","text":"<p>You can use the <code>Dispatcher::dispatch</code> method to dispatch and subscribe to custom events:</p> <pre><code>&lt;?php\n\nuse lucatume\\WPBrowser\\Events\\Dispatcher;\nuse lucatume\\WPBrowser\\Events\\Event;  \n\nDispatcher::dispatch('my-event', 'my-origin', ['foo' =&gt; 'bar']);\n\n// Some other code...\nDispatcher::addListener('my-event', function (Event $event) {\n    $origin = $event-&gt;getOrigin();\n    $foo = $event-&gt;get('foo');\n    codecept_debug('Running on my custom event');\n});\n</code></pre>"},{"location":"commands/","title":"Commands","text":""},{"location":"commands/#codeception-commands-provided-by-the-library","title":"Codeception commands provided by the library","text":"<p>The library provides some custom commands that can be added to the project Codeception configuration file ( either <code>codeception.yml</code> or <code>codeception.dist.yml</code>).</p>"},{"location":"commands/#run-and-codeceptionrun","title":"<code>run</code> and <code>codeception:run</code>","text":"<p>Enable the commands with:</p> <pre><code>extensions:\n  commands:\n    - \"lucatume\\\\WPBrowser\\\\Command\\\\RunOriginal\"\n    - \"lucatume\\\\WPBrowser\\\\Command\\\\RunAll\"\n</code></pre> <p>WordPress extensive use of global variables, constants and side effectes makes it difficult to run multiple test suites in the same process without running into conflicts due to leaking state and side effects. For this reason the project replaces Codeception <code>run</code> command with one that will run each suite in a separate process. You can invoke the original Codeception command using the <code>codeception:run</code> command. Just like the original, the <code>run</code> command accepts all the arguments and options of the original Codeception command.</p> <p>Run all the suites, each one in a separate process:</p> <pre><code>vendor/bin/codecept run\n</code></pre> <p>Run only the <code>Integration</code> suite:</p> <pre><code>vendor/bin/codecept run Integration\n</code></pre> <p>Run a specific test file:</p> <pre><code>vendor/bin/codecept run Integration tests/Integration/MyTest.php\n</code></pre> <p>Run a specific test method:</p> <pre><code>vendor/bin/codecept run Integration tests/Integration/MyTest.php:testMyMethod\n</code></pre> <p>Read the Codeception documentation for more information about the <code>run</code> command.</p>"},{"location":"commands/#devstart","title":"<code>dev:start</code>","text":"<p>Enable the command with:</p> <pre><code>extensions:\n  commands:\n    - \"lucatume\\\\WPBrowser\\\\Command\\\\DevStart\"\n</code></pre> <p>If not already running, start the services required to run the tests. The started services are read from the Codeception configuration file (either <code>codeception.yml</code> or <code>codeception.dist.yml</code>), from the <code>extensions</code> section, under the <code>config</code> key.</p> <p>Given the following configuration:</p> <pre><code>extensions:\n  enabled:\n    - lucatume\\WPBrowser\\Extension\\ChromeDriverController\n    - lucatume\\WPBrowser\\Extension\\BuiltInServerController\n    - lucatume\\WPBrowser\\Extension\\DockerComposeController\n  config:\n    \"lucatume\\\\WPBrowser\\\\Extension\\\\ChromeDriverController\":\n      port: '%CHROMEDRIVER_PORT%'\n    \"lucatume\\\\WPBrowser\\\\Extension\\\\BuiltInServerController\":\n      docroot: '%WORDPRESS_ROOT_DIR%'\n      workers: 5\n      port: '%BUILT_IN_SERVER_PORT%'\n    \"lucatume\\\\WPBrowser\\\\Extension\\\\DockerComposeController\":\n      compose-file: 'tests/docker-compose.yml'\n      env-file: 'tests/.env'\n</code></pre> <p>Running the command will start ChromeDriver, the built-in PHP server and Docker Compose.</p>"},{"location":"commands/#devstop","title":"<code>dev:stop</code>","text":"<p>Enable the command with:</p> <pre><code>extensions:\n  commands:\n    - \"lucatume\\\\WPBrowser\\\\Command\\\\DevStop\"\n</code></pre> <p>If running, stop the services required to run the tests. The stopped services are read from the Codeception configuration file (either <code>codeception.yml</code> or <code>codeception.dist.yml</code>), from the <code>extensions</code> section, under the <code>config</code> key.</p> <p>Given the following configuration:</p> <pre><code>extensions:\n  enabled:\n    - \"lucatume\\\\WPBrowser\\\\Extension\\\\ChromeDriverController\"\n    - \"lucatume\\\\WPBrowser\\\\Extension\\\\BuiltInServerController\"\n    - \"lucatume\\\\WPBrowser\\\\Extension\\\\DockerComposeController\"\n  config:\n    \"lucatume\\\\WPBrowser\\\\Extension\\\\ChromeDriverController\":\n      port: '%CHROMEDRIVER_PORT%'\n    \"lucatume\\\\WPBrowser\\\\Extension\\\\BuiltInServerController\":\n      docroot: '%WORDPRESS_ROOT_DIR%'\n      workers: 5\n      port: '%BUILT_IN_SERVER_PORT%'\n    \"lucatume\\\\WPBrowser\\\\Extension\\\\DockerComposeController\":\n      compose-file: 'tests/docker-compose.yml'\n      env-file: 'tests/.env'\n</code></pre> <p>Running the command will stop ChromeDriver, the built-in PHP server and Docker Compose.</p>"},{"location":"commands/#devrestart","title":"<code>dev:restart</code>","text":"<p>Enable the command with:</p> <pre><code>extensions:\n  commands:\n    - \"lucatume\\\\WPBrowser\\\\Command\\\\DevRestart\"\n</code></pre> <p>This command is just a shortcut to run <code>dev:stop</code> and <code>dev:start</code> in sequence.</p>"},{"location":"commands/#devinfo","title":"<code>dev:info</code>","text":"<p>Enable the command with:</p> <pre><code>extensions:\n  commands:\n    - \"lucatume\\\\WPBrowser\\\\Command\\\\DevInfo\"\n</code></pre> <p>Provides information about the local testing stack managed by the DockerComposeController, BuiltInServerController and ChromeDriverController extensions.</p>"},{"location":"commands/#wpdbimport","title":"<code>wp:db:import</code>","text":"<p>Enable the command with:</p> <pre><code>extensions:\n  commands:\n    - \"lucatume\\\\WPBrowser\\\\Command\\\\DbImport\"\n</code></pre> <p>You can use WP CLI to interact with your WordPress installation, but WP CLI does not support SQLite databases in the context of the <code>wp db import</code> command. This command fills that gap by providing a database dump file import command that will support MySQL and SQLite databases.</p>"},{"location":"commands/#wpdbexport","title":"<code>wp:db:export</code>","text":"<p>Enable the command with:</p> <pre><code>extensions:\n  commands:\n    - \"lucatume\\\\WPBrowser\\\\Command\\\\DbExport\"\n</code></pre> <p>You can use WP CLI to interact with your WordPress installation, but WP CLI does not support SQLite databases in the context of the <code>wp db export</code> command. This command fills that gap by providing a database dump file export command that will support MySQL and SQLite databases.</p>"},{"location":"commands/#chromedriverupdate","title":"<code>chromedriver:update</code>","text":"<p>Enable the command with:</p> <pre><code>extensions:\n  commands:\n    - \"lucatume\\\\WPBrowser\\\\Command\\\\ChromedriverUpdate\"\n</code></pre> <p>If you're using Chromedriver as a binary installed in the Composer vendor directory (<code>vendor/bin</code> by default), you can use this command to update it. This command will download the latest version of Chromedriver compatible with the Chrome version installed on your machine in the Composer vendor directory.</p> <p>Note: if the download fails, it might be a certificate issue.</p>"},{"location":"commands/#generatewpunit","title":"<code>generate:wpunit</code>","text":"<p>Enable the command with:</p> <pre><code>extensions:\n  commands:\n    - \"lucatume\\\\WPBrowser\\\\Command\\\\GenerateWPUnit\"\n</code></pre> <p>Generate a test case extending the <code>lucatume\\WPBrowser\\TestCase\\WPTestCase</code> class. The class incorporates the WordPress test case from the <code>wordpress-develop</code> repository and adds some utility methods to make testing easier in the context of Codeception.</p> <p>The <code>lucatume\\WPBrowser\\TestCase\\WPTestCase</code> class is the one that should be used when writing tests for WordPress code when using the <code>WPLoader</code> module.</p> <p>Together with the <code>WPLoader</code> module, the <code>WPTestCase</code> class provides a number of functionalities to clean up the database after each test method and to reset the global state of WordPress.</p>"},{"location":"commands/#every-test-method-runs-in-a-transaction","title":"Every test method runs in a transaction","text":"<p>Database queries running in the context of test methods of a test case extending the <code>WPTestCase</code> class will run in a transaction that is rolled back after the test method is run. This means that any database change happening in the context of a test method will not appear in the database while the test is running and after the test is run.</p>"},{"location":"commands/#generatewpajax","title":"<code>generate:wpajax</code>","text":"<p>Enable the command with:</p> <pre><code>extensions:\n  commands:\n    - \"lucatume\\\\WPBrowser\\\\Command\\\\GenerateWPAjax\"\n</code></pre> <p>Generate a test case extending the <code>lucatume\\WPBrowser\\TestCase\\WPAjaxTestCase</code> class. This class is a version of the <code>WPTestCase</code> designed to test AJAX requests.</p>"},{"location":"commands/#generatewpcanonical","title":"<code>generate:wpcanonical</code>","text":"<p>Enable the command with:</p> <pre><code>extensions:\n  commands:\n    - \"lucatume\\\\WPBrowser\\\\Command\\\\GenerateWPCanonical\"\n</code></pre> <p>Generate a test case extending the <code>lucatume\\WPBrowser\\TestCase\\WPCanonicalTestCase</code> class. This class is a version of the <code>WPTestCase</code> designed to test canonical redirects.</p>"},{"location":"commands/#generatewprestapi","title":"<code>generate:wprestapi</code>","text":"<p>Enable the command with:</p> <pre><code>extensions:\n  commands:\n    - \"lucatume\\\\WPBrowser\\\\Command\\\\GenerateWPRestApi\"\n</code></pre> <p>Generate a test case extending the <code>lucatume\\WPBrowser\\TestCase\\WPRestApiTestCase</code> class. This class is a version of the <code>WPTestCase</code> designed to test the handling of REST API requests.</p>"},{"location":"commands/#generatewprestcontroller","title":"<code>generate:wprestcontroller</code>","text":"<p>Enable the command with:</p> <pre><code>extensions:\n  commands:\n    - \"lucatume\\\\WPBrowser\\\\Command\\\\GenerateWPRestController\"\n</code></pre> <p>Generate a test case extending the <code>lucatume\\WPBrowser\\TestCase\\WPRestControllerTestCase</code> class. This class is a version of the <code>WPTestCase</code> designed to unit-test REST API controllers.</p>"},{"location":"commands/#generatewprestposttypecontroller","title":"<code>generate:wprestposttypecontroller</code>","text":"<p>Enable the command with:</p> <pre><code>extensions:\n  commands:\n    - \"lucatume\\\\WPBrowser\\\\Command\\\\GenerateWPRestPostTypeController\"\n</code></pre> <p>Generate a test case extending the <code>lucatume\\WPBrowser\\TestCase\\WPRestPostTypeControllerTestCase</code> class. This class is a version of the <code>WPTestCase</code> designed to unit-test REST API controllers for post types.</p>"},{"location":"commands/#generatewpxml","title":"<code>generate:wpxml</code>","text":"<p>Enable the command with:</p> <pre><code>extensions:\n  commands:\n    - \"lucatume\\\\WPBrowser\\\\Command\\\\GenerateWPXML\"\n</code></pre> <p>Generate a test case extending the <code>lucatume\\WPBrowser\\TestCase\\WPXMLTestCase</code> class. This class is a version of the <code>WPTestCase</code> designed to test the production of XML data.</p>"},{"location":"commands/#generatewpxmlrpc","title":"<code>generate:wpxmlrpc</code>","text":"<p>Enable the command with:</p> <pre><code>extensions:\n  commands:\n    - \"lucatume\\\\WPBrowser\\\\Command\\\\GenerateWPXMLRPC\"\n</code></pre> <p>Generate a test case extending the <code>lucatume\\WPBrowser\\TestCase\\WPXMLRPCTestCase</code> class. This class is a version of the <code>WPTestCase</code> designed to test the XML-RPC API.</p>"},{"location":"commands/#monkeycachepath","title":"<code>monkey:cache:path</code>","text":"<p>Enable the command with:</p> <pre><code>extensions:\n  commands:\n    - \"lucatume\\\\WPBrowser\\\\Command\\\\MonkeyCachePath\"\n</code></pre> <p>Get the path to the monkey-patching cache directory.</p> <p>Use the <code>--porcelain</code> or <code>-p</code> option to get the path without any additional output.</p>"},{"location":"commands/#monkeycacheclear","title":"<code>monkey:cache:clear</code>","text":"<p>Enable the command with:</p> <pre><code>extensions:\n  commands:\n    - \"lucatume\\\\WPBrowser\\\\Command\\\\MonkeyCacheClear\"\n</code></pre> <p>Clear the monkey-patching cache.</p> <p>Use the <code>--porcelain</code> or <code>-p</code> option to suppress any confirmation output.</p>"},{"location":"custom-configuration/","title":"Custom configuration","text":""},{"location":"custom-configuration/#custom-testing-configuration","title":"Custom testing configuration","text":"<p>Any non default configuration is considered a custom configuration. If your project requires a tailored set up, this is the configuration for you.</p>"},{"location":"custom-configuration/#using-a-custom-configuration-to-run-tests","title":"Using a custom configuration to run tests","text":"<p>If you decide to skip the default configuration, or are working on a project that cannot use the default configuration you will be able to set up <code>wp-browser</code> to suit your needs using a custom configuration.</p> <p>Choose \"no\", to not use the default configuration, when running the <code>vendor/bin/codecept init wpbrowser</code> command.</p> <p>The command will set up the file structure to be able to run integration and end-to-end tests and will leverage Codeception dynamic configuration using parameters to control the testing stack using the <code>tests/.env</code> file.</p>"},{"location":"custom-configuration/#walkthrough-of-the-testsenv-file","title":"Walkthrough of the <code>tests/.env</code> file","text":"<ul> <li><code>WORDPRESS_ROOT_DIR</code> - the path to the root WordPress installation directory. This is the directory that contains   WordPress files, like <code>wp-load.php</code>. This path can be absolute or relative to the root project directory;   e.g. <code>vendor/wordpress</code> (relative) or <code>/var/www/wordpress</code> (absolute) will work.</li> <li><code>WORDPRESS_URL</code> - the URL of the WordPress installation. This is the URL that will be used by the browser to access   the WordPress   installation in the context of end-to-end tests; e.g. <code>http://localhost:8080</code> or <code>https://wordpress.local</code>.</li> <li><code>WORDPRESS_DOMAIN</code> - the domain of the WordPress installation; this value should follow the <code>WORDPRESS_URL</code> value.   E.g. if <code>WORDPRESS_URL</code> is <code>http://localhost:8080</code> the <code>WORDPRESS_DOMAIN</code> value should be <code>localhost:8080</code>;   if <code>WORDPRESS_URL</code> is <code>https://wordpress.local</code> the <code>WORDPRESS_DOMAIN</code> value should be <code>wordpress.local</code>.</li> <li><code>WORDPRESS_DB_URL</code> - the user, password, host, and name of the database used by the tests. If the database is a MySQL   database, the value should be in the form <code>mysql://user:password@host:port/database_name</code>.   If the database is a SQLite database, the value should be in the form <code>sqlite://path/to/database/file</code>.</li> <li><code>WORDPRESS_TABLE_PREFIX</code> - the database table prefix used by the WordPress installation, the one served   at <code>WORDPRESS_URL</code>.   This value is usually <code>wp_</code> but can be different if the WordPress installation has been configured to use a different   prefix.</li> <li><code>TEST_TABLE_PREFIX</code> - the database table prefix used by the WPLoader module to   install WordPress and run the tests. This value is usually <code>test_</code> and should be different from   the <code>WORDPRESS_TABLE_PREFIX</code> value.</li> <li><code>WORDPRESS_ADMIN_USER</code> - the username of the WordPress administrator user. E.g. <code>admin</code>.</li> <li><code>WORDPRESS_ADMIN_PASSWORD</code> - the password of the WordPress administrator user. E.g. <code>secret!password</code>.</li> <li><code>CHROMEDRIVER_HOST</code> - the host of the Chromedriver server. This value is usually <code>localhost</code> if you're running   Chromedriver on the same machine as the tests. If you're running your tests using a container stack, it will be the   name of the container running Chromedriver, e.g. <code>chromedriver</code>.</li> <li><code>CHROMEDRIVER_PORT</code> - the port of the Chromedriver server. This value is usually <code>9515</code> if you're running Chromedriver   on the same machine as the tests. If you're running your tests using a container stack, it will be the port exposed by   the container running Chromedriver, e.g. <code>4444</code>. Note the default configuration will set   this value to a random port during set up to avoid conflicts with other services running on the same machine.</li> </ul>"},{"location":"custom-configuration/#handling-custom-file-structures","title":"Handling custom file structures","text":"<p>If your site uses a customized file structure to manage WordPress, you will need to further configure the WPLoader module to correctly look for the site content. Read more about setting up WPLoader to correctly load plugins and themes from custom locations here.</p>"},{"location":"default-configuration/","title":"Default configuration","text":""},{"location":"default-configuration/#default-testing-configuration","title":"Default testing configuration","text":"<p>The recommended configuration for most projects. It allows you to get into WordPress integration and end-to-end testing quickly and easily.</p>"},{"location":"default-configuration/#requirements","title":"Requirements","text":"<p>The default configuration will set up Codeception and wp-browser to use SQLite as the database engine, PHP built-in server to serve the test site on localhost and your local version of Chrome, driven by Chromedriver, to run end-to-end tests.</p> <p>As such, the default configuration has the following requirements:</p> <ul> <li>the <code>sqlite3</code> PHP extension; you can check if if's installed by running <code>php -m | grep sqlite3</code> in your terminal</li> <li>the <code>pdo_sqlite</code> PHP extension; you can check if if's installed by running <code>php -m | grep pdo_sqlite</code> in your terminal</li> <li>PHP built-in server can work with only one thread, but it will be faster using multiple threads; multiple threads are   not supported on Windows, but they are supported on WSL.</li> <li>the Chrome browser installed on your machine</li> </ul>"},{"location":"default-configuration/#overview-plugin-and-theme-project","title":"Overview - plugin and theme project","text":"<p>If you're configuring wp-browser for a plugin or theme project, the default configuration will install WordPress in the <code>tests/_wordpress</code> directory and configure the installation to run using SQLite as a database engine. The SQLite Database Integration plugin) will be placed in the installation must-use plugins directory.</p> <p>If your plugin or theme project requires additional plugins or theme to work, you can place them in the <code>tests/_worpdress/wp-content/plugins</code> and <code>tests/_wordpress/wp-content/themes</code> directories respectively.</p> <p>When adding, or removing, plugin and themes, remember to update the WPLoader module configuration to load the correct plugins and themes in your integration tests.</p> <p>On the same note, update the database dump used by the WPDb module to reflect the changes in the dump loaded in the end-to-end tests. The easiest way to update the database fixture is to load the current database dump using the <code>wp:db:import</code> command, manually setting up the site interacting with it and then exporting the database dump using the <code>wp:db:export</code> command.</p> <p>You can find out about the URL of the site served by the PHP built-in web server by running the <code>dev:info</code> command.</p>"},{"location":"default-configuration/#overview-site-project","title":"Overview - site project","text":"<p>If you're configuring wp-browser for a site project, the default configuration will use a combination of PHP built-in web server and the SQLite Database Integration plugin to run the tests and serve your site.</p> <p>The router file used by the PHP built-in web server will force the site, when served on localhost, to use SQLite as database engine leaving your existing local MySQL database untouched.</p> <p>Your existing WordPress installation will be picked up as it is, with all the plugins and themes found in the contents directory.</p> <p>Existing plugins and themes are not added to WPLoader module configuration by wp-browser, you have to do that manually.</p> <p>Similarly, the database dump used by the WPDb module is, by default, an empty WordPress installation where no plugins and themes are active. You have to update the database dump used by the module to reflect the state of your site. You can do that by loading the current database dump using the <code>wp:db:import</code> command, manually setting up the site interacting with it and then exporting the database dump using the <code>wp:db:export</code> command.</p> <p>You can find out about the URL of the site served by the PHP built-in web server by running the <code>dev:info</code> command.</p>"},{"location":"default-configuration/#when-not-to-use-the-default-configuration","title":"When not to use the default configuration","text":"<p>The default configuration is the recommended one for most projects, but some projects might require you to use a custom configuration to make the most out of wp-browser.</p>"},{"location":"default-configuration/#database-drop-in","title":"Database drop-in","text":"<p>The default configuration will use the SQLite Database Integration plugin to use SQLite as the database engine. This requires placing a <code>db.php</code> drop-in file in the WordPress content directory.</p> <p>If your project already requires a <code>db.php</code> drop-in file, you will have to use a custom configuration.</p>"},{"location":"default-configuration/#multisite-with-sub-domains","title":"Multisite with sub-domains","text":"<p>While Chrome will handle sub-domains correctly, even on <code>localhost</code>, WordPress will not. If you're testing a multisite installation with sub-domains, you will have to use a custom configuration.</p>"},{"location":"default-configuration/#custom-site-structure","title":"Custom site structure","text":"<p>If your site uses a customized file structure to manage WordPress, you will need to configure wp-browser using a custom configuration. This is usually true for some site projects, and will most likely not be an issue for plugin and theme projects.</p> <p>Using a custom configuration is not that difficult though: read more about using a custom configuration here.</p>"},{"location":"extensions/","title":"Extensions","text":"<p>The library provides custom Codeception extensions that can be added to the project configuration file, <code>codeception.yml</code> or <code>codeception.dist.yml</code> by default, in the <code>extensions</code> section.</p> <ul> <li>BuiltInServerController</li> <li>ChromeDriverController</li> <li>DockerComposeController</li> <li>IsolationSupport</li> <li>Symlinker</li> <li>EventDispatcherBridge</li> <li>MySqlServerController</li> </ul>"},{"location":"migration/","title":"Migrating to newer versions","text":"<p>Depending on your project PHP compatibility, you have three options to choose from:</p> <ul> <li>Your project supports PHP <code>7.1</code> to <code>7.4</code>: migrate to wp-browser version <code>3.5</code></li> <li>Your project supports PHP <code>8.0</code> or above: migrate to wp-browser version <code>4.0</code></li> <li>You cannot, or do not want, to migrate from version <code>3</code> of wp-browser to a new   version: see how you can lock your reuirements to avoid the upgrade</li> </ul>"},{"location":"migration/#version-35-and-40","title":"Version 3.5 and 4.0","text":"<p>Version <code>3.5</code> and <code>4.0</code> are the latest versions of wp-browser. Version <code>3.5</code> is a transpile of version <code>4</code> to be compatible with PHP <code>7.1</code> to <code>7.4</code> that contains, for all intents and purposes, the same facilities and systems contained in version <code>4</code> of wp-browser adapter to work on lower PHP versions and version <code>4</code> of Codeception.</p> <p>Future development of wp-browser will happen on version <code>4</code> and will be transpiled to version <code>3.5</code> for back-compatibility purposes.</p>"},{"location":"migration/#migrate-from-version-3-to-35","title":"Migrate from version 3 to 3.5","text":"<ol> <li>Update the required version of <code>wp-browser</code> in your <code>composer.json</code> file to <code>3.5</code>:    <pre><code>{\n  \"require-dev\": {\n    \"lucatume/wp-browser\": \"^3.5\"\n  }\n}\n</code></pre></li> <li>See the changes common to version 3.5 and 4.0</li> </ol>"},{"location":"migration/#migrate-from-version-3-to-4","title":"Migrate from version 3 to 4","text":"<ol> <li>Update the required version of <code>wp-browser</code> in your <code>composer.json</code> file to <code>4.0</code>:     <pre><code>{\n  \"require-dev\": {\n    \"lucatume/wp-browser\": \"^4.0\"\n  }\n}\n</code></pre></li> <li>See the changes common to version 3.5 and 4.0</li> </ol>"},{"location":"migration/#changes-common-to-version-35-and-40","title":"Changes common to version 3.5 and 4.0","text":"<ol> <li>Update your main Codeception configuration file (e.g. <code>codeception.yml</code>) to enable the new commands:</li> </ol> <p><pre><code>extensions:\n  commands:\n    - \"lucatume\\\\WPBrowser\\\\Command\\\\RunOriginal\"\n    - \"lucatume\\\\WPBrowser\\\\Command\\\\RunAll\"\n    - \"lucatume\\\\WPBrowser\\\\Command\\\\DbExport\"\n    - \"lucatume\\\\WPBrowser\\\\Command\\\\DbImport\"\n    - \"lucatume\\\\WPBrowser\\\\Command\\\\MonkeyCachePath\"\n    - \"lucatume\\\\WPBrowser\\\\Command\\\\MonkeyCacheClear\"\n</code></pre> 2. Along with the new commands, update the existing commands to use the <code>lucatume\\WPBrowser\\Command\\</code> namespace:</p> <p><pre><code>extensions:\n  commands:\n-    - \"Codeception\\\\Command\\\\GenerateWPUnit\"\n-    - \"Codeception\\\\Command\\\\GenerateWPRestApi\"\n-    - \"Codeception\\\\Command\\\\GenerateWPRestController\"\n-    - \"Codeception\\\\Command\\\\GenerateWPRestPostTypeController\"\n-    - \"Codeception\\\\Command\\\\GenerateWPAjax\"\n-    - \"Codeception\\\\Command\\\\GenerateWPCanonical\"\n-    - \"Codeception\\\\Command\\\\GenerateWPXMLRPC\"\n+    - \"lucatume\\\\WPBrowser\\\\Command\\\\GenerateWPUnit\"\n+    - \"lucatume\\\\WPBrowser\\\\Command\\\\GenerateWPRestApi\"\n+    - \"lucatume\\\\WPBrowser\\\\Command\\\\GenerateWPRestController\"\n+    - \"lucatume\\\\WPBrowser\\\\Command\\\\GenerateWPRestPostTypeController\"\n+    - \"lucatume\\\\WPBrowser\\\\Command\\\\GenerateWPAjax\"\n+    - \"lucatume\\\\WPBrowser\\\\Command\\\\GenerateWPCanonical\"\n+    - \"lucatume\\\\WPBrowser\\\\Command\\\\GenerateWPXMLRPC\"\n</code></pre> 3. If your test code is loading deprecated functions, arguments, classes, files, or hooks, you need to update your test    code to let the test case know using the <code>setExpectedDeprecated</code> method:     <pre><code>&lt;?php\n\nuse lucatume\\WPBrowser\\TestCase\\WPTestCase;\n\nclass MyTestUsingDeprecatedCode extends WPTestCase {\n    public function test_deprecated_function() {\n        // add_filter( 'deprecated_function_trigger_error', '__return_false' );\n        $this-&gt;setExpectedDeprecated( 'my_deprecated_function' );\n        my_deprecated_function();\n    }\n\n    public function test_deprecated_class(){\n        // add_filter( 'deprecated_class_trigger_error', '__return_false' );\n        $this-&gt;setExpectedDeprecated( 'MyDeprecatedClass' );\n        new MyDeprecatedClass();\n    }\n\n    public function test_deprecated_file(){\n        // add_filter( 'deprecated_file_trigger_error', '__return_false' );\n        $this-&gt;setExpectedDeprecated( '/path/to/my_deprecated_file.php' );\n        require_once 'my_deprecated_file.php';\n    }\n\n    public function test_deprecated_hook(){\n        // add_filter( 'deprecated_hook_trigger_error', '__return_false' );\n        $this-&gt;setExpectedDeprecated( 'my_deprecated_hook' );\n        do_action( 'my_deprecated_hook' );\n    }\n}\n</code></pre>    Previously, your code could just filter    the <code>deprecated_function_trigger_error</code>, <code>deprecated_argument_trigger_error</code>, <code>deprecated_class_trigger_error</code>, <code>deprecated_file_trigger_error</code>, and <code>deprecated_hook_trigger_error</code>, hooks to return <code>false</code> to tolerate the deprecation notices in tests. 4. If your test code is directly modifying properties like <code>$expected_deprecated</code> or <code>$expected_doing_it_wrong</code> directly, you need to update your test code to use the <code>setExpectedDeprecated</code> and <code>setExpectedIncorrectUsage</code> methods:     <pre><code>&lt;?php\n\nuse lucatume\\WPBrowser\\TestCase\\WPTestCase;\nclass MyTestUsingDeprecatedCode extends WPTestCase {\n    public function test_deprecated_function() {\n        // $this-&gt;expected_deprecated[] = 'my_deprecated_function';\n        $this-&gt;setExpectedDeprecated( 'my_deprecated_function' );\n        my_deprecated_function();\n    }\n\n    public function test_doing_it_wrong(){\n        // $this-&gt;expected_doing_it_wrong[] = 'my_doing_it_wrong';\n        $this-&gt;setExpectedIncorrectUsage( 'my_doing_it_wrong' );\n        my_doing_it_wrong();\n    }\n}\n</code></pre> 5. If your test code is knowingly triggering doing-it-wrong notices, you need to update your test code to let the test    case know using the <code>setExpectedIncorrectUsage</code> method:     <pre><code>&lt;?php\n\nuse lucatume\\WPBrowser\\TestCase\\WPTestCase;\nclass MyTestUsingDoingItWrongTest extends WPTestCase {\n    public function test_it_can_use_doing_it_wrong() {\n        $this-&gt;setExpectedIncorrectUsage( 'my_doing_it_wrong' );\n        my_doing_it_wrong();\n    }\n}\n</code></pre>    Previously, your code could just filter the <code>doing_it_wrong_trigger_error</code> hook to return <code>false</code> to tolerate the    doing-it-wrong notices in tests. 6. Some assertion methods have, in more recent versions of the PHPUnit core suite, adopted stricter type checks when it comes to comparison. E.g., the <code>assertEqualFields</code> will now check the object to check the fields on is actually an object. Depending on how loose your use of assertions was before, you might have to update your work to make it pass the stricter checks:    <pre><code>&lt;?php\n\nuse lucatume\\WPBrowser\\TestCase\\WPTestCase;\n\n class MyTestUsingAssertEqualFields extends WPTestCase {\n      public function test_it_can_use_assert_equal_fields() {\n         // Cast the array to an object explicitly.\n         $this-&gt;assertEqualFields( (object) [ 'a' =&gt; 1 ], [ 'a' =&gt; 1 ] );\n      }\n }\n</code></pre> 7. Other updates to the Core PHPUnit test case will report use of deprecated functions more promptly; if your code is using deprecated functions that might have escaped previous versions of wp-browser, you will need to update them. 8. If you're using the <code>@runInSeparateProcess</code> annotation for tests in your suite, you will need to enable the <code>IsolationSupport</code> extension in your suite configuration file:</p> <pre><code>actor: MySuiteTester\nbootstrap: _bootstrap.php\nextensions:\nenabled:\n   - \"lucatume\\\\WPBrowser\\\\Extension\\\\IsolationSupport\"\nmodules: # The rest of the module configuration ...\n</code></pre> <p>Alternatively, you can enable the extension in the Codeception main configuration file (e.g. <code>codeception.yml</code>).</p> <p>Read more about the extension in the Isolation Support extension documentation. 9. Global space cleanup between test is more thorough in more recent versions of the Core PHPUnit test suite. Due to this you might see failures in tests that were passing in previous versions due to a \"leaking\" global state. Examples of this might be nonces being set by previous tests and not being reset. Update your tests to explicitly set all the global stat variables you require for the test to run.</p>"},{"location":"migration/#staying-on-version-3-lower-than-35","title":"Staying on version 3, lower than 3.5","text":"<p>Update your <code>composer.json</code> file to lock the required version of <code>wp-browser</code> to a version less than <code>3.5</code>:</p> <pre><code>{\n  \"require-dev\": {\n    \"lucatume/wp-browser\": \"&lt;3.5\"\n  }\n}\n</code></pre>"},{"location":"troubleshooting/","title":"Troubleshooting","text":""},{"location":"troubleshooting/#troubleshooting-common-issues","title":"Troubleshooting common issues","text":""},{"location":"troubleshooting/#downloads-fail-in-windows","title":"Downloads fail in Windows","text":"<p>If you're using code or commands, e.g. the <code>chromedriver:update</code> one, that download files and those keep failing with a message like the following:</p> <pre><code>File ... download failed: SSL certificate problem: unable to get local issuer certificate\n</code></pre> <p>It's likely the issue originates from PHP not having access to the system certificate store.</p> <p>You can fix this by downloading the certificates file and setting the <code>curl.cainfo</code> and <code>openssl.cafile</code> PHP configuration options to point to it:</p> <pre><code>curl.cainfo = \"C:\\path\\to\\cacert.pem\"\nopenssl.cafile = \"C:\\path\\to\\cacert.pem\"\n</code></pre>"},{"location":"extensions/BuiltInServerController/","title":"PHP Built-in Server Controller","text":"<p>This extension will start and stop the PHP built-in web server before and after the tests run.</p>"},{"location":"extensions/BuiltInServerController/#configuration","title":"Configuration","text":"<p>The extension can be configured with the following parameters:</p> <ul> <li>required<ul> <li><code>docroot</code> - the document root to use for the PHP Built-in server; it can be either an absolute path or a path   relative to the Codeception root directory. Note the lowercase <code>r</code> in the parameter name.</li> </ul> </li> <li>optional<ul> <li><code>suites</code> - an array of Codeception suites to run the server for; if not set the server will be started for all the   suites.</li> <li><code>port</code> - the port to use for the PHP Built-in server, if not set the server will use port <code>2389</code>.</li> <li><code>workers</code> - the number of workers to use for the PHP Built-in server, if not set the server will use <code>5</code> workers.   This is the equivalent of the <code>PHP_CLI_SERVER_WORKERS</code> environment variable.</li> </ul> </li> </ul> <p>Note: if you run PHP built-in server on Windows, the <code>workers</code> parameter will be ignored and the server will always run with a single worker. This limit is not present in WSL.</p>"},{"location":"extensions/BuiltInServerController/#configuration-examples","title":"Configuration Examples","text":"<p>Example configuration starting the server for all suites:</p> <pre><code>extensions:\n  enabled:\n    - \"lucatume\\\\WPBrowser\\\\Extension\\\\BuiltInServerController\"\n  config:\n    \"lucatume\\\\WPBrowser\\\\Extension\\\\BuiltInServerController\":\n      docroot: /var/www/html\n      workers: 5\n</code></pre> <p>The extension can access environment variables defined in the tests configuration file:</p> <pre><code>extensions:\n  enabled:\n    - \"lucatume\\\\WPBrowser\\\\Extension\\\\BuiltInServerController\"\n  config:\n    \"lucatume\\\\WPBrowser\\\\Extension\\\\BuiltInServerController\":\n      suites:\n        - EndToEnd\n        - WebApp\n      docroot: '%WORDPRESS_ROOT_DIR%'\n      port: '%BUILT_IN_SERVER_PORT%'\n      workers: '%BUILT_IN_SERVER_WORKERS%'\n</code></pre>"},{"location":"extensions/BuiltInServerController/#this-is-a-service-extension","title":"This is a service extension","text":"<p>This is a service extension that will be started and stopped by the <code>dev:start</code> and <code>dev:stop</code> commands.</p>"},{"location":"extensions/ChromeDriverController/","title":"ChromeDriver Controller","text":"<p>This extension will start and stop the ChromeDriver before and after the tests are run.</p>"},{"location":"extensions/ChromeDriverController/#configuration","title":"Configuration","text":"<p>The extension can be configured with the following parameters:</p> <ul> <li>optional<ul> <li><code>suites</code> - an array of Codeception suites to run the server for; if not set the server will be started for all the   suites.</li> <li><code>port</code> - the port to use for the ChromeDriver, if not set the server will use port <code>9515</code>.</li> <li><code>binary</code> - the path to the ChromeDriver binary, if not set the server will use the <code>chromedriver</code> binary in the   Composer <code>bin</code> directory.</li> </ul> </li> </ul>"},{"location":"extensions/ChromeDriverController/#configuration-examples","title":"Configuration Examples","text":"<p>Example configuration starting the server for all suites:</p> <pre><code>extensions:\n  enabled:\n    - \"lucatume\\\\WPBrowser\\\\Extension\\\\ChromeDriverController\"\n  config:\n    \"lucatume\\\\WPBrowser\\\\Extension\\\\ChromeDriverController\":\n      port: 4444\n      binary: /usr/local/bin/chromedriver\n</code></pre> <p>The extension can access environment variables defined in the tests configuration file:</p> <pre><code>extensions:\n  enabled:\n    - \"lucatume\\\\WPBrowser\\\\Extension\\\\ChromeDriverController\"\n  config:\n    suites:\n      - EndToEnd\n      - WebApp\n    \"lucatume\\\\WPBrowser\\\\Extension\\\\ChromeDriverController\":\n      port: '%CHROMEDRIVER_PORT%'\n      binary: '%CHROMEDRIVER_BINARY%'\n</code></pre> <p>You can use the <code>chromedriver:update</code> command to download the latest version of ChromeDriver compatible with your Chrome browser version and place it in the Composer <code>bin</code> directory.</p>"},{"location":"extensions/ChromeDriverController/#this-is-a-service-extension","title":"This is a service extension","text":"<p>This is a service extension that will be started and stopped by the <code>dev:start</code> and <code>dev:stop</code> commands.</p>"},{"location":"extensions/DockerComposeController/","title":"Docker Compose Controller","text":"<p>This extension will start and stop a <code>docker compose</code> stack before and after the tests are run.</p>"},{"location":"extensions/DockerComposeController/#configuration","title":"Configuration","text":"<p>The extension can be configured with the following parameters:</p> <ul> <li>required<ul> <li><code>compose-file</code> - the path to the <code>docker compose</code> file to use; it can be either an absolute path or a path   relative to the Codeception root directory.</li> </ul> </li> <li>optional<ul> <li><code>env-file</code>- the path to the environment file to use; it can be either an absolute path or a path.</li> </ul> </li> </ul>"},{"location":"extensions/DockerComposeController/#configuration-examples","title":"Configuration Examples","text":"<p>Example configuration starting the server for all suites:</p> <pre><code>extensions:\n  enabled:\n    - \"lucatume\\\\WPBrowser\\\\Extension\\\\DockerComposeController\"\n  config:\n    \"lucatume\\\\WPBrowser\\\\Extension\\\\DockerComposeController\":\n      compose-file: /var/www/html/docker-compose.yml\n      env-file: /var/www/html/.env\n</code></pre> <p>The extension can access environment variables defined in the tests configuration file:</p> <pre><code>extensions:\n  enabled:\n    - \"lucatume\\\\WPBrowser\\\\Extension\\\\DockerComposeController\"\n  config:\n    \"lucatume\\\\WPBrowser\\\\Extension\\\\DockerComposeController\":\n      compose-file: '%DOCKER_COMPOSE_FILE%'\n      env-file: '%DOCKER_COMPOSE_ENV_FILE%'\n</code></pre>"},{"location":"extensions/DockerComposeController/#this-is-a-service-extension","title":"This is a service extension","text":"<p>This is a service extension that will be started and stopped by the <code>dev:start</code> and <code>wp:dev-stop</code> commands.</p>"},{"location":"extensions/EventDispatcherBridge/","title":"Event Dispatcher Bridge","text":"<p>This extension connects the event dispatcher system provided by Codeception, and normally available only through the use of custom extensions, to make it available through calls to the <code>lucatume\\WPBrowser\\Events\\Dispatcher</code> class  API.</p> <p>If not using this extension, then the only way to subscribe to events dispatched by Codeception is to use custom extensions.</p>"},{"location":"extensions/EventDispatcherBridge/#configuration","title":"Configuration","text":"<p>The extension does not require configuration, it just needs to be enabled in the Codeception configuration file:</p> <pre><code>extensions:\n  enabled:\n    - \"lucatume\\\\WPBrowser\\\\Extension\\\\EventDispatcherBridge\"\n</code></pre>"},{"location":"extensions/EventDispatcherBridge/#usage","title":"Usage","text":"<p>The extension will automatically hook into the event dispatcher system provided by Codeception, normally available only through the use of custom extensions, and inject user-defined event listeners in it.</p> <p>Once the extension is enabled, you can use the <code>lucatume\\WPBrowser\\Events\\Dispatcher</code> class to subscribe to Codeception  events. This is typically be done in either the global bootstrap file, or in a suite bootstrap file.  </p> <p>You can subscribe to the following events dispatched by Codeception in either the global bootstrap file  (usually <code>tests/_bootstrap.php</code>), or in a suite bootstrap file (usually <code>tests/&lt;suite&gt;/_bootstrap.php</code>):</p> <ul> <li><code>Codeception\\Events::SUITE_BEFORE</code></li> <li><code>Codeception\\Events::SUITE_AFTER</code></li> <li><code>CodeceptionventsEvents::TEST_START</code></li> <li><code>CodeceptionventsEvents::TEST_BEFORE</code></li> <li><code>CodeceptionventsEvents::STEP_BEFORE</code></li> <li><code>CodeceptionventsEvents::STEP_AFTER</code></li> <li><code>CodeceptionventsEvents::TEST_FAIL</code></li> <li><code>CodeceptionventsEvents::TEST_ERROR</code></li> <li><code>CodeceptionventsEvents::TEST_PARSED</code></li> <li><code>CodeceptionventsEvents::TEST_INCOMPLETE</code></li> <li><code>CodeceptionventsEvents::TEST_SKIPPED</code></li> <li><code>CodeceptionventsEvents::TEST_WARNING</code></li> <li><code>CodeceptionventsEvents::TEST_USELESS</code></li> <li><code>CodeceptionventsEvents::TEST_SUCCESS</code></li> <li><code>CodeceptionventsEvents::TEST_AFTER</code></li> <li><code>CodeceptionventsEvents::TEST_END</code></li> <li><code>CodeceptionventsEvents::TEST_FAIL_PRINT</code></li> <li><code>CodeceptionventsEvents::RESULT_PRINT_AFTER</code></li> </ul> <p>Due to order-of-operations, the earliest Codeception dispatched Event you can subscribe to is the <code>SUITE_BEFORE</code> one. To subscribe to the following earlier events, you must implement an extension following the custom extension approach:</p> <ul> <li><code>Codeception\\Events::MODULE_INIT</code></li> <li><code>Codeception\\Events::SUITE_INIT</code></li> </ul> <p>The Dispatcher API documentation provides more details about the events dispatched by Codeception and wp-browser and examples on how to subscribe to them.</p>"},{"location":"extensions/EventDispatcherBridge/#usage-examples","title":"Usage Examples","text":"<p>In the global bootstrap file (usually <code>tests/_bootstrap.php</code>), or the suite bootstrap file (usually  <code>tests/&lt;suite&gt;/_bootstrap.php</code>), subscribe to the Codeception events by providing a callback function that will accept different parameters depending on the event being dispatched:</p> <pre><code>&lt;?php\n\nuse Codeception\\Events;\nuse Codeception\\Event\\SuiteEvent\nuse Codeception\\Event\\TestEvent;\nuse Codeception\\Event\\StepEvent;\nuse Codeception\\Event\\PrintResultEvent;\nuse lucatume\\WPBrowser\\Events\\Dispatcher;\n\nDispatcher::addListener(Events::SUITE_BEFORE, function (SuiteEvent $suiteEvent) {\n    codecept_debug('Running on SUITE BEFORE');\n});\n\nDispatcher::addListener(Events::SUITE_AFTER, function (SuiteEvent $suiteEvent) {\n    codecept_debug('Running on SUITE AFTER');\n});\n\nDispatcher::addListener(Events::TEST_START, function (TestEvent $testEvent) {\n    codecept_debug('Running on TEST START');\n});\n\nDispatcher::addListener(Events::TEST_BEFORE, function (TestEvent $testEvent) {\n    codecept_debug('Running on TEST BEFORE');\n});\n\nDispatcher::addListener(Events::STEP_BEFORE, function (StepEvent $stepEvent) {\n    codecept_debug('Running on STEP BEFORE');\n});\n\nDispatcher::addListener(Events::STEP_AFTER, function (StepEvent $stepEvent) {\n    codecept_debug('Running on STEP AFTER');\n});\n\nDispatcher::addListener(Events::TEST_FAIL, function (TestEvent $testEvent) {\n    codecept_debug('Running on TEST FAIL');\n});\n\nDispatcher::addListener(Events::TEST_ERROR, function (TestEvent $testEvent) {\n    codecept_debug('Running on TEST ERROR');\n});\n\nDispatcher::addListener(Events::TEST_PARSED, function (TestEvent $testEvent) {\n    codecept_debug('Running on TEST PARSED');\n});\n\nDispatcher::addListener(Events::TEST_INCOMPLETE, function (TestEvent $testEvent) {\n    codecept_debug('Running on TEST INCOMPLETE');\n});\n\nDispatcher::addListener(Events::TEST_SKIPPED, function (TestEvent $testEvent) {\n    codecept_debug('Running on TEST SKIPPED');\n});\n\nDispatcher::addListener(Events::TEST_WARNING, function (TestEvent $testEvent) {\n    codecept_debug('Running on TEST WARNING');\n});\n\nDispatcher::addListener(Events::TEST_USELESS, function (TestEvent $testEvent) {\n    codecept_debug('Running on TEST USELESS');\n});\n\nDispatcher::addListener(Events::TEST_SUCCESS, function (TestEvent $testEvent) {\n    codecept_debug('Running on TEST SUCCESS');\n});\n\nDispatcher::addListener(Events::TEST_AFTER, function (TestEvent $testEvent) {\n    codecept_debug('Running on TEST AFTER');\n});\n\nDispatcher::addListener(Events::TEST_END, function (TestEvent $testEvent) {\n    codecept_debug('Running on TEST END');\n});\n\nDispatcher::addListener(Events::TEST_FAIL_PRINT, function (PrintResultEvent $printResultEvent) {\n    codecept_debug('Running on TEST FAIL PRINT');\n});\n\nDispatcher::addListener(Events::RESULT_PRINT_AFTER, function (PrintResultEvent $printResultEvent) {\n    codecept_debug('Running on RESULT PRINT AFTER');\n});\n</code></pre> <p>Read more about the Dispatcher API here.</p>"},{"location":"extensions/IsolationSupport/","title":"Isolation Support","text":"<p>This extension provides support for the PHPUnit annotations <code>@runInSeparateProcess</code> and <code>@runTestsInSeparateProcesses</code>, and the PHPUnit attributes (PHPUnit 10+) <code>#[RunInSeparateProcess]</code> and <code>#[RunTestsInSeparateProcesses]</code>. You can read more about these annotations and attributes in the PHPUnit documentation about test isolation.</p> <p>Codeception does not natively support these annotations and attributes, this extension provides support for them.</p>"},{"location":"extensions/IsolationSupport/#configuration","title":"Configuration","text":"<p>You can enable the extension in the Codeception configuration file:</p> <pre><code>extensions:\n  enabled:\n    - \"lucatume\\\\WPBrowser\\\\Extension\\\\IsolationSupport\"\n</code></pre> <p>In your tests, you can use the annotations or attributes as you would in a PHPUnit test:</p> <pre><code>&lt;?php\n\nuse lucatume\\WPBrowser\\TestCase\\WPTestCase;\n\nclass IsolationExampleTest extends WPTestCase {\n    /**\n     * @runInSeparateProcess\n     */\n    public function test_in_admin_context() {\n        define('WP_ADMIN', true);\n\n        $this-&gt;assertTrue(is_admin());\n    }\n\n    #[RunTestsInSeparateProcesses]\n    public function test_in_admin_context_with_attribute() {\n        define('WP_ADMIN', true);\n\n        $this-&gt;assertTrue(is_admin());\n    }\n\n    public function test_constant_is_not_set() {\n        $this-&gt;assertFalse(defined('WP_ADMIN'));\n    }\n}\n\n#[RunTestsInSeparateProcesses]\nclass RunAllTestsInSeparateProcesses extends WPTestCase {\n    public function test_one() {\n        definen('TEST_CONST', 'one');\n\n        $this-&gt;assertEquals('one', TEST_CONST);\n    }\n\n    public function test_two() {\n        definen('TEST_CONST', 'two');\n\n        $this-&gt;assertEquals('two', TEST_CONST);\n    }\n}\n</code></pre> <p>Previous versions of the test isolation support required the <code>@backupGlobals disabled</code> annotation to be used when running tests in isolation. This is no longer required.</p> <p>Isolation support is based around monkey-patching the file at runtime. Look into the <code>monkey:cache:clear</code> and <code>monkey:cache:path</code> commands to manage the monkey-patching cache.</p>"},{"location":"extensions/MySqlServerController/","title":"MySqlServer Controller","text":"<p>This extension will start and stop the MySQL server before and after the tests run. The extension will take care of downloading the MySQL Community Server archive from the MySQL Community Server site, place it in the <code>_mysql-server</code> directory under the codeception output directory and initialize the server in the same directory.</p> <p>The aim of this extension is to allow running integration tests against a real MySQL server, without having to install and configure a MySQL server on the machine.</p> <p>Warning</p> <p>Currently the MySQL Community Server version installed by this extension (8.4.2 LTS) is not available for Windows on ARM. </p> <p>If you are running Windows on ARM, you can either: - Use a custom binary, see the configuration examples below - Use the Docker controller extension to run the database from a Docker container.</p>"},{"location":"extensions/MySqlServerController/#configuration","title":"Configuration","text":"<p>The extension can be configured with the following parameters:</p> <ul> <li>required<ul> <li><code>port</code> - the localhost port to use for the MySQL server, defaults to <code>8906</code>.</li> <li><code>database</code> - the database that will be created when starting the server, defaults to <code>wordpress</code>.</li> <li><code>user</code> - the user that will be created when starting the server, defaults to <code>wordpress</code>. The user will be granted   all privileges on the database specified by the <code>database</code> parameter. If the user is <code>root</code>, no further user will   be created.</li> <li><code>password</code> - the password to use for the user specified by the <code>user</code> parameter, defaults to <code>wordpress</code>. If the   user is <code>root</code>, the root user will be set to the password specified by this parameter.</li> </ul> </li> <li>optional<ul> <li><code>suites</code> - an array of Codeception suites to run the server for; if not set the server will be started for all the   suites.</li> <li><code>binary</code> - the path to the MySQL server binary to use, defaults to <code>mysqld</code>, defaults to <code>null</code> to download and   initialize the correct version of MySQL server for the current platform and architecture.</li> <li><code>shareDir</code> - the path to the directory to use for the MySQL server share, defaults to <code>null</code>. This is required   when providing a custom binary.</li> </ul> </li> </ul>"},{"location":"extensions/MySqlServerController/#configuration-examples","title":"Configuration Examples","text":"<p>Example configuration starting the server for all suites:</p> <pre><code>extensions:\n  enabled:\n    - \"lucatume\\WPBrowser\\Extension\\MySqlServerController\":\n      port: 8906\n      database: wordpress\n      user: wordpress\n      password: wordpress\n</code></pre> <p>The extension can access environment variables defined in the tests configuration file:</p> <pre><code>extensions:\n  enabled:\n    - \"lucatume\\WPBrowser\\Extension\\MySqlServerController\":\n      port: '%MYSQL_SERVER_PORT%'\n      database: '%MYSQL_SERVER_DATABASE%'\n      user: '%MYSQL_SERVER_USER%'\n      password: '%MYSQL_SERVER_PASSWORD%'\n</code></pre> <p>Example configuration using the <code>root</code> user:</p> <pre><code>extensions:\n  enabled:\n    - \"lucatume\\WPBrowser\\Extension\\MySqlServerController\":\n      port: 33446\n      database: wordpress\n      user: root\n      password: secret\n</code></pre>"},{"location":"extensions/MySqlServerController/#using-a-custom-mysql-server-binary","title":"Using a custom MySQL server binary","text":"<p>The extension can be configured to use a custom MySQL server binary by setting the <code>binary</code> configuration parameter to the absolute path to the binary:</p> <pre><code>extensions:\n  enabled:\n    - \"lucatume\\WPBrowser\\Extension\\MySqlServerController\":\n      port: 33446\n      database: wordpress\n      user: root\n      password: secret\n      binary: /usr/local/mysql/bin/mysqld\n</code></pre>"},{"location":"extensions/MySqlServerController/#this-is-a-service-extension","title":"This is a service extension","text":"<p>This is a service extension that will be started and stopped by the <code>dev:start</code> and <code>dev:stop</code> commands.</p>"},{"location":"extensions/Symlinker/","title":"Symlinker","text":"<p>This extension will symlink the plugins and themes specified in the <code>plugins</code> and <code>themes</code> configuration parameters to the WordPress installation plugins and themes directories, respectively.</p> <p>The plugins and themes will be symlinked before each suite, and removed after each suite.</p>"},{"location":"extensions/Symlinker/#configuration","title":"Configuration","text":"<p>The extension can be configured with the following parameters:</p> <ul> <li>required<ul> <li><code>wpRootFolder</code> - the relative (to the current working directory) or absolute path to the WordPress installation   root folder, the directory that contains the <code>wp-load.php</code> file.</li> </ul> </li> <li>optional<ul> <li><code>cleanupAfterSuite</code> - default <code>false</code>, a boolean value to indicate if the symlinks created by the extension   sshould be removed after the suite ran.</li> <li><code>plugins</code>- a list of plugin directories to symlink to the WordPress installation plugins directory, if not set   the plugin symlinking will be skipped.</li> <li><code>themes</code>- a list of theme directories to symlink to the WordPress installation themes directory, if not set   the theme symlinking will be skipped.</li> </ul> </li> </ul>"},{"location":"extensions/Symlinker/#configuration-examples","title":"Configuration Examples","text":"<p>Example configuration symbolically linking the plugins and themes to the WordPress installation plugins and themes directories:</p> <pre><code>extensions:\n  enabled:\n    - \"lucatume\\\\WPBrowser\\\\Extension\\\\Symlinker\"\n  config:\n    \"lucatume\\\\WPBrowser\\\\Extension\\\\Symlinker\":\n      wpRootFolder: /var/www/html\n      plugins:\n        - '.' # Relative path, the current working directory.\n        - /home/plugins/plugin-1 # Absolute path to a plugin directory.\n        - vendor/acme/plugin-2 # Relative path to a plugin directory.\n      themes:\n        - /home/theme-1 # Absolute path to a theme directory.\n        - vendor/acme/theme-2 # Relative path to a theme directory.\n</code></pre> <p>The extension can access environment variables defined in the tests configuration file:</p> <pre><code>extensions:\n  enabled:\n    - \"lucatume\\\\WPBrowser\\\\Extension\\\\Symlinker\"\n  config:\n    \"lucatume\\\\WPBrowser\\\\Extension\\\\Symlinker\":\n      wpRootFolder: '%WP_ROOT_FOLDER%'\n      plugins:\n        - '%PLUGIN_STORAGE%/plugin-1'\n        - '%PLUGIN_STORAGE%/plugin-2'\n      themes:\n        - '%THEME_STORAGE%/theme-1'\n        - '%THEME_STORAGE%/theme-2'\n</code></pre>"},{"location":"modules/AirplaneMode/","title":"Airplane Mode","text":""},{"location":"modules/AirplaneMode/#airplanemode-module","title":"AirplaneMode module","text":"<p>This module allows you to easily put the website under test in \"airplane mode\", preventing it from making any network requests.  </p> <p>The module uses the <code>norcross/airplane-mode</code> plugin to add or remove it from the website must-use plugins directory when activated.</p> <p>This module should be used together with the <code>WPWebDriver</code> or <code>WPBrowser</code> modules.  </p>"},{"location":"modules/AirplaneMode/#configuration","title":"Configuration","text":"<ul> <li><code>muPluginsDir</code> - required; the path to the WordPress must-use plugins directory.</li> <li><code>symlink</code> - whether to symlink the plugin or copy it. By default, the plugin is copied in the must-use plugins directory and <code>symlink</code> is set to <code>false</code>. If you're not using containers, that will ignore symlinked plugins, you can set <code>symlink</code> to <code>true</code> to symlink the plugin in the must-use plugins directory. Symbolic linking is faster and uses less disk space than copying the plugin.</li> </ul> <p>Example configuration to symlink the plugin in the <code>muPluginsDir</code> directory before the tests:</p> <pre><code>modules:\n  enabled:\n    lucatume\\WPBrowser\\Module\\AirplaneMode:\n      muPluginsDir: 'var/wordpress/wp-content/mu-plugins'\n      symlink: true\n</code></pre> <p>Example configuration to copy the plugin in the <code>muPluginsDir</code> directory before the tests:</p> <pre><code>modules:\n  enabled:\n    lucatume\\WPBrowser\\Module\\AirplaneMode:\n      muPluginsDir: 'var/wordpress/wp-content/mu-plugins'\n      symlink: false\n</code></pre> <p>The module will either symlink or copy the plugin in the <code>muPluginsDir</code> directory, depending on the <code>symlink</code> configuration parameter before the test suite runs, and will remove it after the test suite has run.</p>"},{"location":"modules/WPBrowser/","title":"WPBrowser","text":""},{"location":"modules/WPBrowser/#wpbrowser-module","title":"WPBrowser module","text":"<p>Browse and test the site HTML with a fast browser without Javascript support.</p> <p>This module trades the WPWebDriver module Javascript support for speed and stability. It is a good choice for testing sites that don't use Javascript or to make assertions that do not require Javascript support like:</p> <ul> <li>testing HTTP return codes</li> <li>testing HTML structure</li> <li>testing JSON and XML responses from APIs</li> </ul> <p>This module is used together with the WPDb module and the WPFilesystem module to control the site state, the database, and the site file structure.</p> <p>This module is an extension of the Codeception PHPBrowser module, you can reference to the Codeception module documentation for more information on the module configuration and usage.</p> <p>This module should be with Cest and Cept test cases.</p>"},{"location":"modules/WPBrowser/#configuration","title":"Configuration","text":"<ul> <li><code>url</code> - required; the start URL of your WordPress project.</li> <li><code>adminUsername</code> - required; the site administrator username to use in actions like <code>loginAsAdmin</code>.</li> <li><code>adminPassword</code> - required; the site administrator password to use in actions like <code>loginAsAdmin</code>.</li> <li><code>adminPath</code> - the path to the WordPress admin directory; defaults to <code>/wp-admin</code>.</li> </ul> <p>More Guzzle request options are available like:</p> <p><code>headers</code> - default headers are set before each test. <code>cookies</code> - default cookies are set before each test. <code>auth</code> - default authentication to be set before each test.</p> <p>... and more.</p> <p>The following is an example of the module configuration to run tests on the<code>http://localhost:8080</code> site:</p> <pre><code>modules:\n  enabled:\n    lucatume\\WPBrowser\\Module\\WPBrowser:\n      url: 'http://localhost:8080'\n      adminUsername: 'admin'\n      adminPassword: 'password'\n      adminPath: '/wp-admin'\n      headers:\n        X_WPBROWSER_REQUEST: 1\n        X_TEST_REQUEST: 1\n        X_APM_REQUEST: 1\n</code></pre> <p>The following configuration uses dynamic configuration parameters to set the module configuration:</p> <pre><code>modules:\n  enabled:\n    lucatume\\WPBrowser\\Module\\WPBrowser:\n      url: '%WORDPRESS_URL%'\n      adminUsername: '%WORDPRESS_ADMIN_USER%'\n      adminPassword: '%WORDPRESS_ADMIN_PASSWORD%'\n      adminPath: '/wp-admin'\n      headers:\n        X_WPBROWSER_REQUEST: 1\n        X_TEST_REQUEST: 1\n        X_APM_REQUEST: 1\n</code></pre>"},{"location":"modules/WPBrowser/#methods","title":"Methods","text":"<p>The module provides the following methods:</p>"},{"location":"modules/WPBrowser/#activateplugin","title":"activatePlugin","text":"<p>Signature: <code>activatePlugin(array|string $pluginSlug)</code> : <code>void</code> </p> <p>In the plugin administration screen activates a plugin clicking the \"Activate\" link.</p> <p>The method will not handle authentication to the admin area.</p> <pre><code>&lt;?php\n// Activate a plugin.\n$I-&gt;loginAsAdmin();\n$I-&gt;amOnPluginsPage();\n$I-&gt;activatePlugin('hello-dolly');\n// Activate a list of plugins.\n$I-&gt;loginAsAdmin();\n$I-&gt;amOnPluginsPage();\n$I-&gt;activatePlugin(['hello-dolly','another-plugin']);\n</code></pre>"},{"location":"modules/WPBrowser/#activatetheme","title":"activateTheme","text":"<p>Signature: <code>activateTheme(string $slug)</code> : <code>void</code> </p> <p>Activates a theme.</p> <p>The method will not handle authentication and navigation to the themes administration page.</p>"},{"location":"modules/WPBrowser/#ameditingpostwithid","title":"amEditingPostWithId","text":"<p>Signature: <code>amEditingPostWithId(int $id)</code> : <code>void</code> </p> <p>Go to the admin page to edit the post with the specified ID.</p> <p>The method will not handle authentication the admin area.</p> <pre><code>&lt;?php\n$I-&gt;loginAsAdmin();\n$postId = $I-&gt;havePostInDatabase();\n$I-&gt;amEditingPostWithId($postId);\n$I-&gt;fillField('post_title', 'Post title');\n</code></pre>"},{"location":"modules/WPBrowser/#ameditinguserwithid","title":"amEditingUserWithId","text":"<p>Signature: <code>amEditingUserWithId(int $id)</code> : <code>void</code> </p> <p>Go to the admin page to edit the user with the specified ID.</p> <p>The method will not handle authentication the admin area.</p> <pre><code>&lt;?php\n$I-&gt;loginAsAdmin();\n$userId = $I-&gt;haveUserInDatabase('luca', 'editor');\n$I-&gt;amEditingUserWithId($userId);\n$I-&gt;fillField('email', 'new@example.net');\n</code></pre>"},{"location":"modules/WPBrowser/#amhttpauthenticated","title":"amHttpAuthenticated","text":"<p>Signature: <code>amHttpAuthenticated($username, $password)</code> : <code>void</code> </p>"},{"location":"modules/WPBrowser/#amonadminajaxpage","title":"amOnAdminAjaxPage","text":"<p>Signature: <code>amOnAdminAjaxPage([array|string|null $queryVars])</code> : <code>void</code> </p> <p>Go to the <code>admin-ajax.php</code> page to start a synchronous, and blocking, <code>GET</code> AJAX request.</p> <p>The method will not handle authentication, nonces or authorization.</p> <pre><code>&lt;?php\n$I-&gt;amOnAdminAjaxPage(['action' =&gt; 'my-action', 'data' =&gt; ['id' =&gt; 23], 'nonce' =&gt; $nonce]);\n</code></pre>"},{"location":"modules/WPBrowser/#amonadminpage","title":"amOnAdminPage","text":"<p>Signature: <code>amOnAdminPage(string $page)</code> : <code>void</code> </p> <p>Go to a page in the admininstration area of the site.</p> <p>This method will not handle authentication to the administration area.</p> <pre><code>&lt;?php\n$I-&gt;loginAs('user', 'password');\n// Go to the plugins management screen.\n$I-&gt;amOnAdminPage('/plugins.php');\n</code></pre>"},{"location":"modules/WPBrowser/#amoncronpage","title":"amOnCronPage","text":"<p>Signature: <code>amOnCronPage([array|string|null $queryVars])</code> : <code>void</code> </p> <p>Go to the cron page to start a synchronous, and blocking, <code>GET</code> request to the cron script.</p> <pre><code>&lt;?php\n// Triggers the cron job with an optional query argument.\n$I-&gt;amOnCronPage('/?some-query-var=some-value');\n</code></pre>"},{"location":"modules/WPBrowser/#amonpage","title":"amOnPage","text":"<p>Signature: <code>amOnPage(string $page)</code> : <code>void</code> </p>"},{"location":"modules/WPBrowser/#amonpagespage","title":"amOnPagesPage","text":"<p>Signature: <code>amOnPagesPage()</code> : <code>void</code> </p> <p>Go the \"Pages\" administration screen.</p> <p>The method will not handle authentication.</p> <pre><code>&lt;?php\n$I-&gt;loginAsAdmin();\n$I-&gt;amOnPagesPage();\n$I-&gt;see('Add New');\n</code></pre>"},{"location":"modules/WPBrowser/#amonpluginspage","title":"amOnPluginsPage","text":"<p>Signature: <code>amOnPluginsPage()</code> : <code>void</code> </p> <p>Go to the plugins administration screen.</p> <p>The method will not handle authentication.</p> <pre><code>&lt;?php\n$I-&gt;loginAsAdmin();\n$I-&gt;amOnPluginsPage();\n$I-&gt;activatePlugin('hello-dolly');\n</code></pre>"},{"location":"modules/WPBrowser/#amonsubdomain","title":"amOnSubdomain","text":"<p>Signature: <code>amOnSubdomain($subdomain)</code> : <code>void</code> </p>"},{"location":"modules/WPBrowser/#amonthemespage","title":"amOnThemesPage","text":"<p>Signature: <code>amOnThemesPage()</code> : <code>void</code> </p> <p>Moves to the themes administration page.</p>"},{"location":"modules/WPBrowser/#amonurl","title":"amOnUrl","text":"<p>Signature: <code>amOnUrl($url)</code> : <code>void</code> </p>"},{"location":"modules/WPBrowser/#attachfile","title":"attachFile","text":"<p>Signature: <code>attachFile($field, string $filename)</code> : <code>void</code> </p>"},{"location":"modules/WPBrowser/#checkoption","title":"checkOption","text":"<p>Signature: <code>checkOption($option)</code> : <code>void</code> </p>"},{"location":"modules/WPBrowser/#click","title":"click","text":"<p>Signature: <code>click($link, [$context])</code> : <code>void</code> </p>"},{"location":"modules/WPBrowser/#deactivateplugin","title":"deactivatePlugin","text":"<p>Signature: <code>deactivatePlugin(array|string $pluginSlug)</code> : <code>void</code> </p> <p>In the plugin administration screen deactivate a plugin clicking the \"Deactivate\" link.</p> <p>The method will not handle authentication and navigation to the plugins administration page.</p> <pre><code>&lt;?php\n// Deactivate one plugin.\n$I-&gt;loginAsAdmin();\n$I-&gt;amOnPluginsPage();\n$I-&gt;deactivatePlugin('hello-dolly');\n// Deactivate a list of plugins.\n$I-&gt;loginAsAdmin();\n$I-&gt;amOnPluginsPage();\n$I-&gt;deactivatePlugin(['hello-dolly', 'my-plugin']);\n</code></pre>"},{"location":"modules/WPBrowser/#deleteheader","title":"deleteHeader","text":"<p>Signature: <code>deleteHeader(string $name)</code> : <code>void</code> </p> <p>Deletes the header with the passed name.  Subsequent requests will not have the deleted header in its request.</p> <p>Example: <pre><code>&lt;?php\n$I-&gt;haveHttpHeader('X-Requested-With', 'Codeception');\n$I-&gt;amOnPage('test-headers.php');\n// ...\n$I-&gt;deleteHeader('X-Requested-With');\n$I-&gt;amOnPage('some-other-page.php');\n</code></pre></p>"},{"location":"modules/WPBrowser/#dontsee","title":"dontSee","text":"<p>Signature: <code>dontSee(string $text, [$selector])</code> : <code>void</code> </p>"},{"location":"modules/WPBrowser/#dontseecheckboxischecked","title":"dontSeeCheckboxIsChecked","text":"<p>Signature: <code>dontSeeCheckboxIsChecked($checkbox)</code> : <code>void</code> </p>"},{"location":"modules/WPBrowser/#dontseecookie","title":"dontSeeCookie","text":"<p>Signature: <code>dontSeeCookie($cookie, [$params])</code> : <code>void</code> </p>"},{"location":"modules/WPBrowser/#dontseecurrenturlequals","title":"dontSeeCurrentUrlEquals","text":"<p>Signature: <code>dontSeeCurrentUrlEquals(string $uri)</code> : <code>void</code> </p>"},{"location":"modules/WPBrowser/#dontseecurrenturlmatches","title":"dontSeeCurrentUrlMatches","text":"<p>Signature: <code>dontSeeCurrentUrlMatches(string $uri)</code> : <code>void</code> </p>"},{"location":"modules/WPBrowser/#dontseeelement","title":"dontSeeElement","text":"<p>Signature: <code>dontSeeElement($selector, [array $attributes])</code> : <code>void</code> </p>"},{"location":"modules/WPBrowser/#dontseeincurrenturl","title":"dontSeeInCurrentUrl","text":"<p>Signature: <code>dontSeeInCurrentUrl(string $uri)</code> : <code>void</code> </p>"},{"location":"modules/WPBrowser/#dontseeinfield","title":"dontSeeInField","text":"<p>Signature: <code>dontSeeInField($field, $value)</code> : <code>void</code> </p>"},{"location":"modules/WPBrowser/#dontseeinformfields","title":"dontSeeInFormFields","text":"<p>Signature: <code>dontSeeInFormFields($formSelector, array $params)</code> : <code>void</code> </p>"},{"location":"modules/WPBrowser/#dontseeinsource","title":"dontSeeInSource","text":"<p>Signature: <code>dontSeeInSource(string $raw)</code> : <code>void</code> </p>"},{"location":"modules/WPBrowser/#dontseeintitle","title":"dontSeeInTitle","text":"<p>Signature: <code>dontSeeInTitle($title)</code> : <code>void</code> </p>"},{"location":"modules/WPBrowser/#dontseelink","title":"dontSeeLink","text":"<p>Signature: <code>dontSeeLink(string $text, [string $url])</code> : <code>void</code> </p>"},{"location":"modules/WPBrowser/#dontseeoptionisselected","title":"dontSeeOptionIsSelected","text":"<p>Signature: <code>dontSeeOptionIsSelected($selector, $optionText)</code> : <code>void</code> </p>"},{"location":"modules/WPBrowser/#dontseeplugininstalled","title":"dontSeePluginInstalled","text":"<p>Signature: <code>dontSeePluginInstalled(string $pluginSlug)</code> : <code>void</code> </p> <p>Assert a plugin is not installed in the plugins administration screen.</p> <p>The method will not handle authentication and navigation to the plugin administration screen.</p> <pre><code>&lt;?php\n$I-&gt;loginAsAdmin();\n$I-&gt;amOnPluginsPage();\n$I-&gt;dontSeePluginInstalled('my-plugin');\n</code></pre>"},{"location":"modules/WPBrowser/#dontseeresponsecodeis","title":"dontSeeResponseCodeIs","text":"<p>Signature: <code>dontSeeResponseCodeIs(int $code)</code> : <code>void</code> </p> <p>Checks that response code is equal to value provided.</p> <pre><code>&lt;?php\n$I-&gt;dontSeeResponseCodeIs(200);\n\n// recommended \\Codeception\\Util\\HttpCode\n$I-&gt;dontSeeResponseCodeIs(\\Codeception\\Util\\HttpCode::OK);\n</code></pre>"},{"location":"modules/WPBrowser/#executeinguzzle","title":"executeInGuzzle","text":"<p>Signature: <code>executeInGuzzle(Closure $function)</code> : <code>void</code> </p> <p>Low-level API method. If Codeception commands are not enough, use Guzzle HTTP Client methods directly</p> <p>Example:</p> <pre><code>&lt;?php\n$I-&gt;executeInGuzzle(function (\\GuzzleHttp\\Client $client) {\n     $client-&gt;get('/get', ['query' =&gt; ['foo' =&gt; 'bar']]);\n});\n</code></pre> <p>It is not recommended to use this command on a regular basis. If Codeception lacks important Guzzle Client methods, implement them and submit patches.</p>"},{"location":"modules/WPBrowser/#fillfield","title":"fillField","text":"<p>Signature: <code>fillField($field, $value)</code> : <code>void</code> </p>"},{"location":"modules/WPBrowser/#followredirect","title":"followRedirect","text":"<p>Signature: <code>followRedirect()</code> : <code>void</code> </p> <p>Follow pending redirect if there is one.</p> <pre><code>&lt;?php\n$I-&gt;followRedirect();\n</code></pre>"},{"location":"modules/WPBrowser/#grabactivetheme","title":"grabActiveTheme","text":"<p>Signature: <code>grabActiveTheme()</code> : <code>?string</code> </p> <p>Returns the slug of the currently active themes.</p> <p>The method will not handle authentication and navigation to the themes administration page.</p>"},{"location":"modules/WPBrowser/#grabattributefrom","title":"grabAttributeFrom","text":"<p>Signature: <code>grabAttributeFrom($cssOrXpath, string $attribute)</code> : <code>mixed</code> </p>"},{"location":"modules/WPBrowser/#grabavailablethemes","title":"grabAvailableThemes","text":"<p>Signature: <code>grabAvailableThemes([string $classes])</code> : <code>array</code> </p> <p>Returns the list of available themes.</p> <p>The method will not handle authentication and navigation to the themes administration page.</p>"},{"location":"modules/WPBrowser/#grabcookie","title":"grabCookie","text":"<p>Signature: <code>grabCookie(string $cookie, [array $params])</code> : <code>mixed</code> </p>"},{"location":"modules/WPBrowser/#grabcookieswithpattern","title":"grabCookiesWithPattern","text":"<p>Signature: <code>grabCookiesWithPattern(string $cookiePattern)</code> : <code>?array</code> </p> <p>Returns all the cookies whose name matches a regex pattern.</p> <pre><code>&lt;?php\n$I-&gt;loginAs('customer','password');\n$I-&gt;amOnPage('/shop');\n$cartCookies = $I-&gt;grabCookiesWithPattern(\"#^shop_cart\\\\.*#\");\n</code></pre>"},{"location":"modules/WPBrowser/#grabfromcurrenturl","title":"grabFromCurrentUrl","text":"<p>Signature: <code>grabFromCurrentUrl([?string $uri])</code> : <code>mixed</code> </p>"},{"location":"modules/WPBrowser/#grabmultiple","title":"grabMultiple","text":"<p>Signature: <code>grabMultiple($cssOrXpath, [?string $attribute])</code> : <code>array</code> </p>"},{"location":"modules/WPBrowser/#grabpagesource","title":"grabPageSource","text":"<p>Signature: <code>grabPageSource()</code> : <code>string</code> </p> <p>Grabs current page source code.</p>"},{"location":"modules/WPBrowser/#grabtextfrom","title":"grabTextFrom","text":"<p>Signature: <code>grabTextFrom($cssOrXPathOrRegex)</code> : <code>mixed</code> </p>"},{"location":"modules/WPBrowser/#grabvaluefrom","title":"grabValueFrom","text":"<p>Signature: <code>grabValueFrom($field)</code> : <code>mixed</code> </p>"},{"location":"modules/WPBrowser/#grabwordpresstestcookie","title":"grabWordPressTestCookie","text":"<p>Signature: <code>grabWordPressTestCookie([?string $name])</code> : <code>?Symfony\\Component\\BrowserKit\\Cookie</code> </p> <p>Returns WordPress default test cookie object if present.</p> <pre><code>&lt;?php\n// Grab the default WordPress test cookie.\n$wpTestCookie = $I-&gt;grabWordPressTestCookie();\n// Grab a customized version of the test cookie.\n$myTestCookie = $I-&gt;grabWordPressTestCookie('my_test_cookie');\n</code></pre>"},{"location":"modules/WPBrowser/#havehttpheader","title":"haveHttpHeader","text":"<p>Signature: <code>haveHttpHeader(string $name, string $value)</code> : <code>void</code> </p> <p>Sets the HTTP header to the passed value - which is used on subsequent HTTP requests through PhpBrowser.</p> <p>Example: <pre><code>&lt;?php\n$I-&gt;haveHttpHeader('X-Requested-With', 'Codeception');\n$I-&gt;amOnPage('test-headers.php');\n</code></pre></p> <p>To use special chars in Header Key use HTML Character Entities: Example: Header with underscore - 'Client_Id' should be represented as - 'Client_Id' or 'Client_Id'</p> <pre><code>&lt;?php\n$I-&gt;haveHttpHeader('Client&amp;#95;Id', 'Codeception');\n</code></pre>"},{"location":"modules/WPBrowser/#haveserverparameter","title":"haveServerParameter","text":"<p>Signature: <code>haveServerParameter(string $name, string $value)</code> : <code>void</code> </p> <p>Sets SERVER parameter valid for all next requests.</p> <pre><code>&lt;?php\n$I-&gt;haveServerParameter('name', 'value');\n</code></pre>"},{"location":"modules/WPBrowser/#logout","title":"logOut","text":"<p>Signature: <code>logOut([string|bool $redirectTo])</code> : <code>void</code> </p> <p>Navigate to the default WordPress logout page and click the logout link.</p> <pre><code>&lt;?php\n// Log out using the `wp-login.php` form and return to the current page.\n$I-&gt;logOut(true);\n// Log out using the `wp-login.php` form and remain there.\n$I-&gt;logOut(false);\n// Log out using the `wp-login.php` form and move to another page.\n$I-&gt;logOut('/some-other-page');\n</code></pre>"},{"location":"modules/WPBrowser/#loginas","title":"loginAs","text":"<p>Signature: <code>loginAs(string $username, string $password)</code> : <code>void</code> </p> <p>Login as the specified user.</p> <p>The method will not follow redirection, after the login, to any page.</p> <pre><code>&lt;?php\n$I-&gt;loginAs('user', 'password');\n$I-&gt;amOnAdminPage('/');\n$I-&gt;see('Dashboard');\n</code></pre>"},{"location":"modules/WPBrowser/#loginasadmin","title":"loginAsAdmin","text":"<p>Signature: <code>loginAsAdmin()</code> : <code>void</code> </p> <p>Login as the administrator user using the credentials specified in the module configuration.</p> <p>The method will not follow redirection, after the login, to any page.</p> <pre><code>&lt;?php\n$I-&gt;loginAsAdmin();\n$I-&gt;amOnAdminPage('/');\n$I-&gt;see('Dashboard');\n</code></pre>"},{"location":"modules/WPBrowser/#makehtmlsnapshot","title":"makeHtmlSnapshot","text":"<p>Signature: <code>makeHtmlSnapshot([?string $name])</code> : <code>void</code> </p>"},{"location":"modules/WPBrowser/#moveback","title":"moveBack","text":"<p>Signature: <code>moveBack([int $numberOfSteps])</code> : <code>void</code> </p> <p>Moves back in history.</p>"},{"location":"modules/WPBrowser/#resetcookie","title":"resetCookie","text":"<p>Signature: <code>resetCookie($cookie, [$params])</code> : <code>void</code> </p>"},{"location":"modules/WPBrowser/#see","title":"see","text":"<p>Signature: <code>see(string $text, [$selector])</code> : <code>void</code> </p>"},{"location":"modules/WPBrowser/#seecheckboxischecked","title":"seeCheckboxIsChecked","text":"<p>Signature: <code>seeCheckboxIsChecked($checkbox)</code> : <code>void</code> </p>"},{"location":"modules/WPBrowser/#seecookie","title":"seeCookie","text":"<p>Signature: <code>seeCookie($cookie, [$params])</code> : <code>void</code> </p>"},{"location":"modules/WPBrowser/#seecurrenturlequals","title":"seeCurrentUrlEquals","text":"<p>Signature: <code>seeCurrentUrlEquals(string $uri)</code> : <code>void</code> </p>"},{"location":"modules/WPBrowser/#seecurrenturlmatches","title":"seeCurrentUrlMatches","text":"<p>Signature: <code>seeCurrentUrlMatches(string $uri)</code> : <code>void</code> </p>"},{"location":"modules/WPBrowser/#seeelement","title":"seeElement","text":"<p>Signature: <code>seeElement($selector, [array $attributes])</code> : <code>void</code> </p>"},{"location":"modules/WPBrowser/#seeerrormessage","title":"seeErrorMessage","text":"<p>Signature: <code>seeErrorMessage([array|string $classes])</code> : <code>void</code> </p> <p>In an administration screen look for an error admin notice.</p> <p>The check is class-based to decouple from internationalization. The method will not handle authentication and navigation the administration area.</p> <pre><code>&lt;?php\n$I-&gt;loginAsAdmin()\n$I-&gt;amOnAdminPage('/');\n$I-&gt;seeErrorMessage('.my-plugin');\n</code></pre>"},{"location":"modules/WPBrowser/#seeincurrenturl","title":"seeInCurrentUrl","text":"<p>Signature: <code>seeInCurrentUrl(string $uri)</code> : <code>void</code> </p>"},{"location":"modules/WPBrowser/#seeinfield","title":"seeInField","text":"<p>Signature: <code>seeInField($field, $value)</code> : <code>void</code> </p>"},{"location":"modules/WPBrowser/#seeinformfields","title":"seeInFormFields","text":"<p>Signature: <code>seeInFormFields($formSelector, array $params)</code> : <code>void</code> </p>"},{"location":"modules/WPBrowser/#seeinsource","title":"seeInSource","text":"<p>Signature: <code>seeInSource(string $raw)</code> : <code>void</code> </p>"},{"location":"modules/WPBrowser/#seeintitle","title":"seeInTitle","text":"<p>Signature: <code>seeInTitle($title)</code> : <code>void</code> </p>"},{"location":"modules/WPBrowser/#seelink","title":"seeLink","text":"<p>Signature: <code>seeLink(string $text, [?string $url])</code> : <code>void</code> </p>"},{"location":"modules/WPBrowser/#seemessage","title":"seeMessage","text":"<p>Signature: <code>seeMessage([array|string $classes])</code> : <code>void</code> </p> <p>In an administration screen look for an admin notice.</p> <p>The check is class-based to decouple from internationalization. The method will not handle authentication and navigation the administration area.</p> <pre><code>&lt;?php\n$I-&gt;loginAsAdmin()\n$I-&gt;amOnAdminPage('/');\n$I-&gt;seeMessage('.missing-api-token.my-plugin');\n</code></pre>"},{"location":"modules/WPBrowser/#seenumberofelements","title":"seeNumberOfElements","text":"<p>Signature: <code>seeNumberOfElements($selector, $expected)</code> : <code>void</code> </p>"},{"location":"modules/WPBrowser/#seeoptionisselected","title":"seeOptionIsSelected","text":"<p>Signature: <code>seeOptionIsSelected($selector, $optionText)</code> : <code>void</code> </p>"},{"location":"modules/WPBrowser/#seepagenotfound","title":"seePageNotFound","text":"<p>Signature: <code>seePageNotFound()</code> : <code>void</code> </p> <p>Asserts that current page has 404 response status code.</p>"},{"location":"modules/WPBrowser/#seepluginactivated","title":"seePluginActivated","text":"<p>Signature: <code>seePluginActivated(string $pluginSlug)</code> : <code>void</code> </p> <p>Assert a plugin is activated in the plugin administration screen.</p> <p>The method will not handle authentication and navigation to the plugin administration screen.</p> <pre><code>&lt;?php\n$I-&gt;loginAsAdmin();\n$I-&gt;amOnPluginsPage();\n$I-&gt;seePluginActivated('my-plugin');\n</code></pre>"},{"location":"modules/WPBrowser/#seeplugindeactivated","title":"seePluginDeactivated","text":"<p>Signature: <code>seePluginDeactivated(string $pluginSlug)</code> : <code>void</code> </p> <p>Assert a plugin is not activated in the plugins administration screen.</p> <p>The method will not handle authentication and navigation to the plugin administration screen.</p> <pre><code>&lt;?php\n$I-&gt;loginAsAdmin();\n$I-&gt;amOnPluginsPage();\n$I-&gt;seePluginDeactivated('my-plugin');\n</code></pre>"},{"location":"modules/WPBrowser/#seeplugininstalled","title":"seePluginInstalled","text":"<p>Signature: <code>seePluginInstalled(string $pluginSlug)</code> : <code>void</code> </p> <p>Assert a plugin is installed, no matter its activation status, in the plugin administration screen.</p> <p>The method will not handle authentication and navigation to the plugin administration screen.</p> <pre><code>&lt;?php\n$I-&gt;loginAsAdmin();\n$I-&gt;amOnPluginsPage();\n$I-&gt;seePluginInstalled('my-plugin');\n</code></pre>"},{"location":"modules/WPBrowser/#seeresponsecodeis","title":"seeResponseCodeIs","text":"<p>Signature: <code>seeResponseCodeIs(int $code)</code> : <code>void</code> </p> <p>Checks that response code is equal to value provided.</p> <pre><code>&lt;?php\n$I-&gt;seeResponseCodeIs(200);\n\n// recommended \\Codeception\\Util\\HttpCode\n$I-&gt;seeResponseCodeIs(\\Codeception\\Util\\HttpCode::OK);\n</code></pre>"},{"location":"modules/WPBrowser/#seeresponsecodeisbetween","title":"seeResponseCodeIsBetween","text":"<p>Signature: <code>seeResponseCodeIsBetween(int $from, int $to)</code> : <code>void</code> </p> <p>Checks that response code is between a certain range. Between actually means [from &lt;= CODE &lt;= to]</p>"},{"location":"modules/WPBrowser/#seeresponsecodeisclienterror","title":"seeResponseCodeIsClientError","text":"<p>Signature: <code>seeResponseCodeIsClientError()</code> : <code>void</code> </p> <p>Checks that the response code is 4xx</p>"},{"location":"modules/WPBrowser/#seeresponsecodeisredirection","title":"seeResponseCodeIsRedirection","text":"<p>Signature: <code>seeResponseCodeIsRedirection()</code> : <code>void</code> </p> <p>Checks that the response code 3xx</p>"},{"location":"modules/WPBrowser/#seeresponsecodeisservererror","title":"seeResponseCodeIsServerError","text":"<p>Signature: <code>seeResponseCodeIsServerError()</code> : <code>void</code> </p> <p>Checks that the response code is 5xx</p>"},{"location":"modules/WPBrowser/#seeresponsecodeissuccessful","title":"seeResponseCodeIsSuccessful","text":"<p>Signature: <code>seeResponseCodeIsSuccessful()</code> : <code>void</code> </p> <p>Checks that the response code 2xx</p>"},{"location":"modules/WPBrowser/#seethemeactivated","title":"seeThemeActivated","text":"<p>Signature: <code>seeThemeActivated(string $slug)</code> : <code>void</code> </p> <p>Verifies that a theme is active.</p> <p>The method will not handle authentication and navigation to the themes administration page.</p>"},{"location":"modules/WPBrowser/#seewpdiepage","title":"seeWpDiePage","text":"<p>Signature: <code>seeWpDiePage()</code> : <code>void</code> </p> <p>Checks that the current page is one generated by the <code>wp_die</code> function.</p> <p>The method will try to identify the page based on the default WordPress die page HTML attributes.</p> <pre><code>&lt;?php\n$I-&gt;loginAs('user', 'password');\n$I-&gt;amOnAdminPage('/forbidden');\n$I-&gt;seeWpDiePage();\n</code></pre>"},{"location":"modules/WPBrowser/#selectoption","title":"selectOption","text":"<p>Signature: <code>selectOption($select, $option)</code> : <code>void</code> </p>"},{"location":"modules/WPBrowser/#sendajaxgetrequest","title":"sendAjaxGetRequest","text":"<p>Signature: <code>sendAjaxGetRequest(string $uri, [array $params])</code> : <code>void</code> </p> <p>Sends an ajax GET request with the passed parameters. See <code>sendAjaxPostRequest()</code></p>"},{"location":"modules/WPBrowser/#sendajaxpostrequest","title":"sendAjaxPostRequest","text":"<p>Signature: <code>sendAjaxPostRequest(string $uri, [array $params])</code> : <code>void</code> </p> <p>Sends an ajax POST request with the passed parameters. The appropriate HTTP header is added automatically: <code>X-Requested-With: XMLHttpRequest</code> Example: <pre><code>&lt;?php\n$I-&gt;sendAjaxPostRequest('/add-task', ['task' =&gt; 'lorem ipsum']);\n</code></pre> Some frameworks (e.g. Symfony) create field names in the form of an \"array\": <code>&lt;input type=\"text\" name=\"form[task]\"&gt;</code> In this case you need to pass the fields like this: <pre><code>&lt;?php\n$I-&gt;sendAjaxPostRequest('/add-task', ['form' =&gt; [\n    'task' =&gt; 'lorem ipsum',\n    'category' =&gt; 'miscellaneous',\n]]);\n</code></pre></p>"},{"location":"modules/WPBrowser/#sendajaxrequest","title":"sendAjaxRequest","text":"<p>Signature: <code>sendAjaxRequest(string $method, string $uri, [array $params])</code> : <code>void</code> </p> <p>Sends an ajax request, using the passed HTTP method. See <code>sendAjaxPostRequest()</code> Example: <pre><code>&lt;?php\n$I-&gt;sendAjaxRequest('PUT', '/posts/7', ['title' =&gt; 'new title']);\n</code></pre></p>"},{"location":"modules/WPBrowser/#setcookie","title":"setCookie","text":"<p>Signature: <code>setCookie($name, $val, [$params])</code> : <code>void</code> </p>"},{"location":"modules/WPBrowser/#setheader","title":"setHeader","text":"<p>Signature: <code>setHeader(string $name, string $value)</code> : <code>void</code> </p> <p>Alias to <code>haveHttpHeader</code></p>"},{"location":"modules/WPBrowser/#setmaxredirects","title":"setMaxRedirects","text":"<p>Signature: <code>setMaxRedirects(int $maxRedirects)</code> : <code>void</code> </p> <p>Sets the maximum number of redirects that the Client can follow.</p> <pre><code>&lt;?php\n$I-&gt;setMaxRedirects(2);\n</code></pre>"},{"location":"modules/WPBrowser/#setserverparameters","title":"setServerParameters","text":"<p>Signature: <code>setServerParameters(array $params)</code> : <code>void</code> </p> <p>Sets SERVER parameters valid for all next requests. this will remove old ones.</p> <pre><code>&lt;?php\n$I-&gt;setServerParameters([]);\n</code></pre>"},{"location":"modules/WPBrowser/#startfollowingredirects","title":"startFollowingRedirects","text":"<p>Signature: <code>startFollowingRedirects()</code> : <code>void</code> </p> <p>Enables automatic redirects to be followed by the client.</p> <pre><code>&lt;?php\n$I-&gt;startFollowingRedirects();\n</code></pre>"},{"location":"modules/WPBrowser/#stopfollowingredirects","title":"stopFollowingRedirects","text":"<p>Signature: <code>stopFollowingRedirects()</code> : <code>void</code> </p> <p>Prevents automatic redirects to be followed by the client.</p> <pre><code>&lt;?php\n$I-&gt;stopFollowingRedirects();\n</code></pre>"},{"location":"modules/WPBrowser/#submitform","title":"submitForm","text":"<p>Signature: <code>submitForm($selector, array $params, [?string $button])</code> : <code>void</code> </p>"},{"location":"modules/WPBrowser/#switchtoiframe","title":"switchToIframe","text":"<p>Signature: <code>switchToIframe(string $name)</code> : <code>void</code> </p> <p>Switch to iframe or frame on the page.</p> <p>Example: <pre><code>&lt;iframe name=\"another_frame\" src=\"http://example.com\"&gt;\n</code></pre></p> <pre><code>&lt;?php\n# switch to iframe\n$I-&gt;switchToIframe(\"another_frame\");\n</code></pre>"},{"location":"modules/WPBrowser/#uncheckoption","title":"uncheckOption","text":"<p>Signature: <code>uncheckOption($option)</code> : <code>void</code> </p> <p>Read more in Codeception documentation.</p>"},{"location":"modules/WPCLI/","title":"WPCLI","text":""},{"location":"modules/WPCLI/#wpcli-module","title":"WPCLI module","text":"<p>Use WP-CLI to interact with the WordPress installation under test and issue commands.</p> <p>This module is used in the context of end-to-end testing, together with, or as a replacement for the WPDb module to manipulate the database and the WPFilesystem module to manipulate the site file structure.</p> <p>This module should be with Cest and Cept test cases.</p>"},{"location":"modules/WPCLI/#configuration","title":"Configuration","text":"<ul> <li><code>path</code> - required; the path to the WordPress installation under test. This can be a relative path to the   codeception root directory, or an absolute path to the WordPress installation directory. The WordPress installation   directory is the directory that contains the <code>wp-load.php</code> file.</li> <li><code>url</code> - the URL of the WordPress installation under test. Equivalent to the <code>--url</code> option of the <code>wp</code> command.</li> <li><code>user</code> - the user to use to run the <code>wp</code> command. Equivalent to the <code>--user</code> option of the <code>wp</code> command.</li> <li><code>skip-plugins</code> - a boolean value to indicate if the <code>wp</code> command should skip loading plugins. Equivalent to the   <code>--skip-plugins</code> option of the <code>wp</code> command.</li> <li><code>skip-themes</code> - a boolean value to indicate if the <code>wp</code> command should skip loading themes. Equivalent to the   <code>--skip-themes</code> option of the <code>wp</code> command.</li> <li><code>skip-packages</code> - a boolean value to indicate if the <code>wp</code> command should skip loading packages. Equivalent to the   <code>--skip-packages</code> option of the <code>wp</code> command.</li> <li><code>require</code> - a list of PHP files to require before running the <code>wp</code> command. Equivalent to the <code>--require</code> option of   the <code>wp</code> command.</li> <li><code>exec</code> - PHP code to execute before running the <code>wp</code> command. Equivalent to the <code>--exec</code> option of the <code>wp</code> command.</li> <li><code>context</code> - the context to use when running the <code>wp</code> command. Equivalent to the <code>--context</code> option of the <code>wp</code>   command.</li> <li><code>color</code> - a boolean value to indicate if the <code>wp</code> command should output in color. Equivalent to the <code>--color</code> option   of the <code>wp</code> command.</li> <li><code>no-color</code> - a boolean value to indicate if the <code>wp</code> command should not output in color. Equivalent to the   <code>--no-color</code> option of the <code>wp</code> command.</li> <li><code>debug</code> - a boolean value to indicate if the <code>wp</code> command should output debug information. Equivalent to the   <code>--debug</code> option of the <code>wp</code> command.</li> <li><code>quiet</code> - a boolean value to indicate if the <code>wp</code> command should suppress informational messages. Equivalent to the   <code>--quiet</code> option of the <code>wp</code> command.</li> <li><code>throw</code> - a boolean value to indicate if the <code>wp</code> command should throw an exception if the command fails.</li> <li><code>timeout</code> - the timeout to use when running the <code>wp</code> command. When the timeout is reached the command will be   terminated as a failure.</li> <li><code>cache-dir</code> - the directory to use to cache the files WPCLI might downloads. Equivalent to setting   the <code>WP_CLI_CACHE_DIR</code>   environment variable.</li> <li><code>config-path</code> - the path to the <code>wp-cli.yml</code> file to use. Equivalent to setting the <code>WP_CLI_CONFIG_PATH</code>   environment variable.</li> <li><code>custom-shell</code> - the shell to use to run the <code>wp</code> command. Equivalent to setting the <code>WP_CLI_SHELL</code> environment   variable.</li> <li><code>packages-dir</code> - the directory to use to store the packages downloaded by the <code>wp package</code> command. Equivalent to   setting the <code>WP_CLI_PACKAGES_DIR</code> environment variable.</li> <li><code>bin</code> - the path to a custom WP-CLI binary.</li> <li><code>allow-root</code> - a boolean value to indicate if the <code>wp</code> command should be run with the <code>--allow-root</code> flag. Equivalent to the <code>--allow-root</code> option of the <code>wp</code> command. This is useful when running wp-cli commands as the root user.</li> </ul> <p>The following is an example of the module configuration to run WPCLI commands on the <code>/var/wordpress</code> directory:</p> <pre><code>modules:\n  enabled:\n    lucatume\\WPBrowser\\Module\\WPCLI:\n      path: /var/wordpress\n      throw: true\n</code></pre> <p>The following configuration uses dynamic configuration parameters to set the module configuration:</p> <pre><code>modules:\n  enabled:\n    lucatume\\WPBrowser\\Module\\WPCLI:\n      path: '%WP_ROOT_DIR%'\n      throw: true\n</code></pre> <p>The following configuration uses a custom WP-CLI binary:</p> <pre><code>modules:\n  enabled:\n    lucatume\\WPBrowser\\Module\\WPCLI:\n      path: /var/wordpress\n      bin: /usr/local/bin/wp\n</code></pre>"},{"location":"modules/WPCLI/#methods","title":"Methods","text":"<p>The module provides the following methods:</p>"},{"location":"modules/WPCLI/#changewpclipath","title":"changeWpcliPath","text":"<p>Signature: <code>changeWpcliPath(string $path)</code> : <code>void</code> </p> <p>Changes the path to the WordPress installation that WPCLI should use.</p> <p>This is the equivalent of the <code>--path</code> option.</p> <pre><code>&lt;?php\n// Operate on the installation specified in the `path` config parameter.\n$I-&gt;cli(['core','version']);\n// Change to another installation and run a command there.\n$I-&gt;changeWpcliPath('var/wordpress-installation-two');\n$I-&gt;cli(['core','version']);\n</code></pre>"},{"location":"modules/WPCLI/#cli","title":"cli","text":"<p>Signature: <code>cli([array|string $command], [?array $env], [mixed $input])</code> : <code>int</code> </p> <p>Executes a wp-cli command targeting the test WordPress installation.</p> <pre><code>&lt;?php\n// Activate a plugin via wp-cli in the test WordPress site.\n$I-&gt;cli(['plugin', 'activate', 'my-plugin']);\n// Change a user password.\n$I-&gt;cli(['user', 'update', 'luca', '--user_pass=newpassword']);\n</code></pre>"},{"location":"modules/WPCLI/#clitoarray","title":"cliToArray","text":"<p>Signature: <code>cliToArray(array $command, [?callable $splitCallback], [?array $env], [mixed $input])</code> : <code>array</code> </p> <p>Returns the output of a wp-cli command as an array optionally allowing a callback to process the output.</p> <pre><code>&lt;?php\n// Return a list of inactive themes, like ['twentyfourteen', 'twentyfifteen'].\n$inactiveThemes = $I-&gt;cliToArray(['theme', 'list', '--status=inactive', '--field=name']);\n// Get the list of installed plugins and only keep the ones starting with \"foo\".\n$fooPlugins = $I-&gt;cliToArray(['plugin', 'list', '--field=name'], function($output){\n     return array_filter(explode(PHP_EOL, $output), function($name){\n             return strpos(trim($name), 'foo') === 0;\n     });\n});\n</code></pre>"},{"location":"modules/WPCLI/#clitostring","title":"cliToString","text":"<p>Signature: <code>cliToString(array $command, [?array $env], [mixed $input])</code> : <code>string</code> </p> <p>Returns the output of a wp-cli command as a string.</p> <pre><code>&lt;?php\n// Return the current site administrator email, using string command format.\n$adminEmail = $I-&gt;cliToString('option get admin_email');\n// Get the list of active plugins in JSON format, two ways.\n$activePlugins = $I-&gt;cliToString(['plugin', 'list','--status=active', '--format=json']);\n$activePlugins = $I-&gt;cliToString(['option', 'get', 'active_plugins' ,'--format=json']);\n</code></pre>"},{"location":"modules/WPCLI/#dontseeinshelloutput","title":"dontSeeInShellOutput","text":"<p>Signature: <code>dontSeeInShellOutput(string $text)</code> : <code>void</code> </p> <p>Checks that output from last command doesn't contain text.</p> <pre><code>&lt;?php\n// Return the current site administrator email, using string command format.\n$I-&gt;cli('plugin list --status=active');\n$I-&gt;dontSeeInShellOutput('my-inactive/plugin.php');\n</code></pre>"},{"location":"modules/WPCLI/#dontseeshelloutputmatches","title":"dontSeeShellOutputMatches","text":"<p>Signature: <code>dontSeeShellOutputMatches(string $regex)</code> : <code>void</code> </p> <p>Checks that output from the last command doesn't match a given regular expression.</p> <pre><code>&lt;?php\n// Return the current site administrator email, using string command format.\n$I-&gt;cli('option get siteurl');\n$I-&gt;dontSeeShellOutputMatches('/^http/');\n</code></pre>"},{"location":"modules/WPCLI/#grablastcliprocess","title":"grabLastCliProcess","text":"<p>Signature: <code>grabLastCliProcess()</code> : <code>lucatume\\WPBrowser\\WordPress\\CliProcess</code></p>"},{"location":"modules/WPCLI/#grablastshellerroroutput","title":"grabLastShellErrorOutput","text":"<p>Signature: <code>grabLastShellErrorOutput()</code> : <code>string</code> </p> <p>Returns the shell error output of the last command.</p>"},{"location":"modules/WPCLI/#grablastshelloutput","title":"grabLastShellOutput","text":"<p>Signature: <code>grabLastShellOutput()</code> : <code>string</code> </p> <p>Returns the shell output of the last command.</p>"},{"location":"modules/WPCLI/#seeinshelloutput","title":"seeInShellOutput","text":"<p>Signature: <code>seeInShellOutput(string $text)</code> : <code>void</code> </p> <p>Checks that output from last command contains text.</p> <pre><code>&lt;?php\n// Return the current site administrator email, using string command format.\n$I-&gt;cli('option get admin_email');\n$I-&gt;seeInShellOutput('admin@example.org');\n</code></pre>"},{"location":"modules/WPCLI/#seeresultcodeis","title":"seeResultCodeIs","text":"<p>Signature: <code>seeResultCodeIs(int $code)</code> : <code>void</code> </p> <p>Checks the result code from the last command.</p> <pre><code>&lt;?php\n// Return the current site administrator email, using string command format.\n$I-&gt;cli('option get admin_email');\n$I-&gt;seeResultCodeIs(0);\n</code></pre>"},{"location":"modules/WPCLI/#seeresultcodeisnot","title":"seeResultCodeIsNot","text":"<p>Signature: <code>seeResultCodeIsNot(int $code)</code> : <code>void</code> </p> <p>Checks the result code from the last command.</p> <pre><code>&lt;?php\n// Return the current site administrator email, using string command format.\n$I-&gt;cli('invalid command');\n$I-&gt;seeResultCodeIsNot(0);\n</code></pre>"},{"location":"modules/WPCLI/#seeshelloutputmatches","title":"seeShellOutputMatches","text":"<p>Signature: <code>seeShellOutputMatches(string $regex)</code> : <code>void</code> </p> <p>Checks that output from the last command matches a given regular expression.</p> <pre><code>&lt;?php\n// Return the current site administrator email, using string command format.\n$I-&gt;cli('option get admin_email');\n$I-&gt;seeShellOutputMatches('/^\\S+@\\S+$/');\n</code></pre> <p>Explore the WP-CLI documentation for more information on the available commands.</p>"},{"location":"modules/WPDb/","title":"WPDb","text":""},{"location":"modules/WPDb/#wpdb-module","title":"WPDb module","text":"<p>This module allows to manipulate the database of the WordPress installation under test directly, without using the WordPress API.</p> <p>The module is used together with the WPBrowser module, WPWebDriver and WPFilesystem modules to control the site state, the database, and the site file structure.</p> <p>Note about interaction with the WPLoader module: both this module and the WPLoader one can be used to control the state of the database before tests and set up fixtures: use either this or WPLoader, do not use both. This module should be used in end-to-end testing, the WPLoader module should be used in integration testing. If you're using this module to load a database dump before integration tests, use the WPLoader module <code>dump</code> configuration parameter instead.</p> <p>This module should be with Cest and Cept test cases.</p>"},{"location":"modules/WPDb/#configuration","title":"Configuration","text":"<p>This module extends the Codeception Db module adding some configuration options and functions that are specific to WordPress.</p> <ul> <li><code>dbUrl</code> - required; the URL to use to connect to the database. The URL must be in the form   <code>mysql://user:password@host:port/database</code> if you're using a MySQL database for your tests, or in the form   <code>sqlite://path/to/database/file</code> if you're using a SQLite database for your tests (   like the default configuration does)</li> <li><code>dsn</code> - required; the DSN to use to connect to the database; required if not using the <code>dbUrl</code> parameter.</li> <li><code>user</code> - required; the user to use to connect to the database; required if not using the <code>dbUrl</code> parameter.</li> <li><code>password</code> - required; the password to use to connect to the database; required if not using the <code>dbUrl</code>   parameter.</li> <li><code>url</code> - required;the URL of the WordPress installation under test. E.g. <code>http://localhost:8080</code>   or <code>https://wordpress.test</code>.</li> <li><code>tablePrefix</code> - the table prefix to use when interacting with the database; defaults to <code>wp_</code>.</li> <li><code>dump</code> - the path to a database dump file, or a set of database files, to load before running tests. The path can be   relative to the project root directory, e.g. <code>tests/_data/dump.sql</code>, or absolute.</li> <li><code>populate</code> - a boolean value to indicate if the database should be populated importing the dump file(s) at the start   of the suite.</li> <li><code>cleanup</code> - a boolean value to indicate if the database should be populated importing the dump file(s) before each   test.</li> <li><code>reconnect</code> - a boolean value to indicate if the database connection should be re-established before each test.</li> <li><code>populator</code> - a command to use to populate the database instead of using   PHP; read more on the Codeception documentation.</li> <li><code>urlReplacement</code> - a boolean value to indicate if the database dump file(s) should be searched for the <code>siteurl</code>   and <code>home</code> options and replaced with the <code>url</code> parameter value. This is required since WordPress hard-codes URLs in   the database, the original URL is inferred, if the <code>originalUrl</code> parameter is not provided.</li> <li><code>originalUrl</code> - if provided together with the <code>urlReplacement</code> parameter, the module will not try to infer the   original URL from the database dump file(s) but use the provided value instead.</li> <li><code>waitlock</code> - the number of seconds to wait for a database lock to be released before failing the test. Defaults to   <code>10</code> meaning that the test will fail if the database lock is not released after 10 seconds.</li> <li><code>createIfNotExists</code> - a boolean value to indicate if the database should be created if it does not exist. Defaults to   <code>false</code>.</li> </ul> <p>The following is an example of the module configuration to run tests on the<code>http://localhost:8080</code> site:</p> <pre><code>modules:\n  enabled:\n    - lucatume\\WPBrowser\\Module\\WPDb:\n        dbUrl: 'mysql://root:password@localhost:3306/wordpress'\n        url: 'http://localhost:8080'\n        tablePrefix: 'wp_'\n        dump: 'tests/_data/dump.sql'\n        populate: true\n        cleanup: true\n        reconnect: false\n        urlReplacement: true\n        originalUrl: http://wordpress.test\n        waitlock: 10\n        createIfNotExists: true\n</code></pre> <p>The following configuration uses dynamic configuration parameters to set the module configuration:</p> <pre><code>modules:\n  enabled:\n    - lucatume\\WPBrowser\\Module\\WPDb:\n        dbUrl: '%DB_URL%'\n        url: '%WORDPRESS_URL%'\n        tablePrefix: '%WORDPRESS_TABLE_PREFIX%'\n        dump: '%DB_DUMP%'\n        populate: true\n        cleanup: true\n        reconnect: false\n        urlReplacement: true\n        originalUrl: '%WORDPRESS_ORIGINAL_URL%'\n        waitlock: 10\n        createIfNotExists: true\n</code></pre> <p>The following configuration uses a SQLite database:</p> <pre><code>modules:\n  enabled:\n    - lucatume\\WPBrowser\\Module\\WPDb:\n        dbUrl: 'sqlite://tests/database.sqlite'\n        url: 'http://localhost:8080'\n        tablePrefix: 'wp_'\n        dump: 'tests/_data/dump.sql'\n        populate: true\n        cleanup: true\n        reconnect: false\n        urlReplacement: true\n        originalUrl: http://wordpress.test\n        waitlock: 10\n        createIfNotExists: true\n</code></pre>"},{"location":"modules/WPDb/#methods","title":"Methods","text":""},{"location":"modules/WPDb/#amconnectedtodatabase","title":"amConnectedToDatabase","text":"<p>Signature: <code>amConnectedToDatabase(string $databaseKey)</code> : <code>void</code> </p> <p>Make sure you are connected to the right database.</p> <pre><code>&lt;?php\n$I-&gt;seeNumRecords(2, 'users');   //executed on default database\n$I-&gt;amConnectedToDatabase('db_books');\n$I-&gt;seeNumRecords(30, 'books');  //executed on db_books database\n//All the next queries will be on db_books\n</code></pre>"},{"location":"modules/WPDb/#countrowsindatabase","title":"countRowsInDatabase","text":"<p>Signature: <code>countRowsInDatabase(string $table, [array $criteria])</code> : <code>int</code> </p> <p>Returns the number of table rows matching a criteria.</p> <pre><code>&lt;?php\n$I-&gt;haveManyPostsInDatabase(3, ['post_status' =&gt; 'draft' ]);\n$I-&gt;haveManyPostsInDatabase(3, ['post_status' =&gt; 'private' ]);\n// Make sure there are now the expected number of draft posts.\n$postsTable = $I-&gt;grabPostsTableName();\n$draftsCount = $I-&gt;countRowsInDatabase($postsTable, ['post_status' =&gt; 'draft']);\n</code></pre>"},{"location":"modules/WPDb/#donthaveattachmentfilesindatabase","title":"dontHaveAttachmentFilesInDatabase","text":"<p>Signature: <code>dontHaveAttachmentFilesInDatabase(array|int $attachmentIds)</code> : <code>void</code> </p> <p>Removes all the files attached with an attachment post, it will not remove the database entries. Requires the <code>WPFilesystem</code> module to be loaded in the suite.</p> <pre><code>&lt;?php\n$posts = $I-&gt;grabPostsTableName();\n$attachmentIds = $I-&gt;grabColumnFromDatabase($posts, 'ID', ['post_type' =&gt; 'attachment']);\n// This will only remove the files, not the database entries.\n$I-&gt;dontHaveAttachmentFilesInDatabase($attachmentIds);\n</code></pre>"},{"location":"modules/WPDb/#donthaveattachmentindatabase","title":"dontHaveAttachmentInDatabase","text":"<p>Signature: <code>dontHaveAttachmentInDatabase(array $criteria, [bool $purgeMeta], [bool $removeFiles])</code> : <code>void</code> </p> <p>Removes an attachment from the posts table.</p> <pre><code>$postmeta = $I-&gt;grabpostmetatablename();\n$thumbnailId = $I-&gt;grabFromDatabase($postmeta, 'meta_value', [\n     'post_id' =&gt; $id,\n     'meta_key'=&gt;'thumbnail_id'\n]);\n// Remove only the database entry (including postmeta) but not the files.\n$I-&gt;dontHaveAttachmentInDatabase($thumbnailId);\n// Remove the database entry (including postmeta) and the files.\n$I-&gt;dontHaveAttachmentInDatabase($thumbnailId, true, true);\n</code></pre>"},{"location":"modules/WPDb/#donthaveblogindatabase","title":"dontHaveBlogInDatabase","text":"<p>Signature: <code>dontHaveBlogInDatabase(array $criteria, [bool $removeTables], [bool $removeUploads])</code> : <code>void</code> </p> <p>Removes one ore more blogs from the database.</p> <pre><code>&lt;?php\n// Remove the blog, all its tables and files.\n$I-&gt;dontHaveBlogInDatabase(['path' =&gt; 'test/one']);\n// Remove the blog entry, not the tables though.\n$I-&gt;dontHaveBlogInDatabase(['blog_id' =&gt; $blogId]);\n// Remove multiple blogs.\n$I-&gt;dontHaveBlogInDatabase(['domain' =&gt; 'test']);\n</code></pre>"},{"location":"modules/WPDb/#donthavecommentindatabase","title":"dontHaveCommentInDatabase","text":"<p>Signature: <code>dontHaveCommentInDatabase(array $criteria, [bool $purgeMeta])</code> : <code>void</code> </p> <p>Removes an entry from the comments table.</p> <pre><code>&lt;?php\n$I-&gt;dontHaveCommentInDatabase(['comment_post_ID' =&gt; 23, 'comment_url' =&gt; 'http://example.copm']);\n</code></pre>"},{"location":"modules/WPDb/#donthavecommentmetaindatabase","title":"dontHaveCommentMetaInDatabase","text":"<p>Signature: <code>dontHaveCommentMetaInDatabase(array $criteria)</code> : <code>void</code> </p> <p>Removes a post comment meta from the database</p> <pre><code>&lt;?php\n// Remove all meta for the comment with an ID of 23.\n$I-&gt;dontHaveCommentMetaInDatabase(['comment_id' =&gt; 23]);\n// Remove the `count` comment meta for the comment with an ID of 23.\n$I-&gt;dontHaveCommentMetaInDatabase(['comment_id' =&gt; 23, 'meta_key' =&gt; 'count']);\n</code></pre>"},{"location":"modules/WPDb/#donthaveindatabase","title":"dontHaveInDatabase","text":"<p>Signature: <code>dontHaveInDatabase(string $table, array $criteria)</code> : <code>void</code> </p> <p>Deletes a database entry.</p> <pre><code>&lt;?php\n$I-&gt;dontHaveInDatabase('custom_table', ['book_ID' =&gt; 23, 'book_genre' =&gt; 'fiction']);\n</code></pre>"},{"location":"modules/WPDb/#donthavelinkindatabase","title":"dontHaveLinkInDatabase","text":"<p>Signature: <code>dontHaveLinkInDatabase(array $criteria)</code> : <code>void</code> </p> <p>Removes a link from the database.</p> <pre><code>&lt;?php\n$I-&gt;dontHaveLinkInDatabase(['link_url' =&gt; 'http://example.com']);\n</code></pre>"},{"location":"modules/WPDb/#donthaveoptionindatabase","title":"dontHaveOptionInDatabase","text":"<p>Signature: <code>dontHaveOptionInDatabase(string $key, [mixed $value])</code> : <code>void</code> </p> <p>Removes an entry from the options table.</p> <pre><code>&lt;?php\n// Remove the `foo` option.\n$I-&gt;dontHaveOptionInDatabase('foo');\n// Remove the 'bar' option only if it has the `baz` value.\n$I-&gt;dontHaveOptionInDatabase('bar', 'baz');\n</code></pre>"},{"location":"modules/WPDb/#donthavepostindatabase","title":"dontHavePostInDatabase","text":"<p>Signature: <code>dontHavePostInDatabase(array $criteria, [bool $purgeMeta])</code> : <code>void</code> </p> <p>Removes an entry from the posts table.</p> <pre><code>&lt;?php\n$posts = $I-&gt;haveManyPostsInDatabase(3, ['post_title' =&gt; 'Test {{n}}']);\n$I-&gt;dontHavePostInDatabase(['post_title' =&gt; 'Test 2']);\n</code></pre>"},{"location":"modules/WPDb/#donthavepostmetaindatabase","title":"dontHavePostMetaInDatabase","text":"<p>Signature: <code>dontHavePostMetaInDatabase(array $criteria)</code> : <code>void</code> </p> <p>Removes an entry from the postmeta table.</p> <pre><code>&lt;?php\n$postId = $I-&gt;havePostInDatabase(['meta_input' =&gt; ['rating' =&gt; 23]]);\n$I-&gt;dontHavePostMetaInDatabase(['post_id' =&gt; $postId, 'meta_key' =&gt; 'rating']);\n</code></pre>"},{"location":"modules/WPDb/#donthavepostthumbnailindatabase","title":"dontHavePostThumbnailInDatabase","text":"<p>Signature: <code>dontHavePostThumbnailInDatabase(int $postId)</code> : <code>void</code> </p> <p>Remove the thumbnail (featured image) from a post, if any.</p> <p>Please note: the method will NOT remove the attachment post, post meta and file.</p> <pre><code>&lt;?php\n$attachmentId = $I-&gt;haveAttachmentInDatabase(codecept_data_dir('some-image.png'));\n$postId = $I-&gt;havePostInDatabase();\n// Attach the thumbnail to the post.\n$I-&gt;havePostThumbnailInDatabase($postId, $attachmentId);\n// Remove the thumbnail from the post.\n$I-&gt;dontHavePostThumbnailInDatabase($postId);\n</code></pre>"},{"location":"modules/WPDb/#donthavesiteoptionindatabase","title":"dontHaveSiteOptionInDatabase","text":"<p>Signature: <code>dontHaveSiteOptionInDatabase(string $key, [mixed $value])</code> : <code>void</code> </p> <p>Removes a site option from the database.</p> <pre><code>&lt;?php\n// Remove the `foo_count` option.\n$I-&gt;dontHaveSiteOptionInDatabase('foo_count');\n// Remove the `foo_count` option only if its value is `23`.\n$I-&gt;dontHaveSiteOptionInDatabase('foo_count', 23);\n</code></pre>"},{"location":"modules/WPDb/#donthavesitetransientindatabase","title":"dontHaveSiteTransientInDatabase","text":"<p>Signature: <code>dontHaveSiteTransientInDatabase(string $key)</code> : <code>void</code> </p> <p>Removes a site transient from the database.</p> <pre><code>&lt;?php\n$I-&gt;dontHaveSiteTransientInDatabase(['my_plugin_site_buffer']);\n</code></pre>"},{"location":"modules/WPDb/#donthavetableindatabase","title":"dontHaveTableInDatabase","text":"<p>Signature: <code>dontHaveTableInDatabase(string $fullTableName)</code> : <code>void</code> </p> <p>Removes a table from the database. The case where a table does not exist is handled without raising an error.</p> <pre><code>&lt;?php\n$ordersTable = $I-&gt;grabPrefixedTableNameFor('orders');\n$I-&gt;dontHaveTableInDatabase($ordersTable);\n</code></pre>"},{"location":"modules/WPDb/#donthavetermindatabase","title":"dontHaveTermInDatabase","text":"<p>Signature: <code>dontHaveTermInDatabase(array $criteria, [bool $purgeMeta])</code> : <code>void</code> </p> <p>Removes a term from the database.</p> <pre><code>&lt;?php\n$I-&gt;dontHaveTermInDatabase(['name' =&gt; 'romance']);\n$I-&gt;dontHaveTermInDatabase(['slug' =&gt; 'genre--romance']);\n</code></pre>"},{"location":"modules/WPDb/#donthavetermmetaindatabase","title":"dontHaveTermMetaInDatabase","text":"<p>Signature: <code>dontHaveTermMetaInDatabase(array $criteria)</code> : <code>void</code> </p> <p>Removes a term meta from the database.</p> <pre><code>&lt;?php\n// Remove the \"karma\" key.\n$I-&gt;dontHaveTermMetaInDatabase(['term_id' =&gt; $termId, 'meta_key' =&gt; 'karma']);\n// Remove all meta for the term.\n$I-&gt;dontHaveTermMetaInDatabase(['term_id' =&gt; $termId]);\n</code></pre>"},{"location":"modules/WPDb/#donthavetermrelationshipindatabase","title":"dontHaveTermRelationshipInDatabase","text":"<p>Signature: <code>dontHaveTermRelationshipInDatabase(array $criteria)</code> : <code>void</code> </p> <p>Removes an entry from the term_relationships table.</p> <pre><code>&lt;?php\n// Remove the relation between a post and a category.\n$I-&gt;dontHaveTermRelationshipInDatabase(['object_id' =&gt; $postId, 'term_taxonomy_id' =&gt; $ttaxId]);\n// Remove all terms for a post.\n$I-&gt;dontHaveTermMetaInDatabase(['object_id' =&gt; $postId]);\n</code></pre>"},{"location":"modules/WPDb/#donthavetermtaxonomyindatabase","title":"dontHaveTermTaxonomyInDatabase","text":"<p>Signature: <code>dontHaveTermTaxonomyInDatabase(array $criteria)</code> : <code>void</code> </p> <p>Removes an entry from the <code>term_taxonomy</code> table.</p> <pre><code>&lt;?php\n// Remove a specific term from the genre taxonomy.\n$I-&gt;dontHaveTermTaxonomyInDatabase(['term_id' =&gt; $postId, 'taxonomy' =&gt; 'genre']);\n// Remove all terms for a taxonomy.\n$I-&gt;dontHaveTermTaxonomyInDatabase(['taxonomy' =&gt; 'genre']);\n</code></pre>"},{"location":"modules/WPDb/#donthavetransientindatabase","title":"dontHaveTransientInDatabase","text":"<p>Signature: <code>dontHaveTransientInDatabase(string $transient)</code> : <code>void</code> </p> <p>Removes a transient from the database.</p> <pre><code>&lt;?php\n// Removes the `tweets` transient from the database, if set.\n$I-&gt;dontHaveTransientInDatabase('tweets');\n</code></pre>"},{"location":"modules/WPDb/#donthaveuserindatabase","title":"dontHaveUserInDatabase","text":"<p>Signature: <code>dontHaveUserInDatabase(string|int $userIdOrLogin, [bool $purgeMeta])</code> : <code>void</code> </p> <p>Removes a user from the database.</p> <pre><code>&lt;?php\n$bob = $I-&gt;haveUserInDatabase('bob');\n$alice = $I-&gt;haveUserInDatabase('alice');\n// Remove Bob's user and meta.\n$I-&gt;dontHaveUserInDatabase('bob');\n// Remove Alice's user but not meta.\n$I-&gt;dontHaveUserInDatabase($alice);\n</code></pre>"},{"location":"modules/WPDb/#donthaveuserindatabasewithemail","title":"dontHaveUserInDatabaseWithEmail","text":"<p>Signature: <code>dontHaveUserInDatabaseWithEmail(string $userEmail, [bool $purgeMeta])</code> : <code>array</code> </p> <p>Removes a user(s) from the database using the user email address.</p> <pre><code>&lt;?php\n$luca = $I-&gt;haveUserInDatabase('luca', 'editor', ['user_email' =&gt; 'luca@example.org']);\n$I-&gt;dontHaveUserInDatabaseWithEmail('luca@exampl.org');\n</code></pre>"},{"location":"modules/WPDb/#donthaveusermetaindatabase","title":"dontHaveUserMetaInDatabase","text":"<p>Signature: <code>dontHaveUserMetaInDatabase(array $criteria)</code> : <code>void</code> </p> <p>Removes an entry from the usermeta table.</p> <pre><code>&lt;?php\n// Remove the `karma` user meta for a user.\n$I-&gt;dontHaveUserMetaInDatabase(['user_id' =&gt; 23, 'meta_key' =&gt; 'karma']);\n// Remove all the user meta for a user.\n$I-&gt;dontHaveUserMetaInDatabase(['user_id' =&gt; 23]);\n</code></pre>"},{"location":"modules/WPDb/#dontseeattachmentindatabase","title":"dontSeeAttachmentInDatabase","text":"<p>Signature: <code>dontSeeAttachmentInDatabase(array $criteria)</code> : <code>void</code> </p> <p>Checks that an attachment is not in the database.</p> <pre><code>&lt;?php\n$url = 'https://example.org/images/foo.png';\n$I-&gt;dontSeeAttachmentInDatabase(['guid' =&gt; $url]);\n</code></pre>"},{"location":"modules/WPDb/#dontseeblogindatabase","title":"dontSeeBlogInDatabase","text":"<p>Signature: <code>dontSeeBlogInDatabase(array $criteria)</code> : <code>void</code> </p> <p>Checks that a row is not present in the <code>blogs</code> table.</p> <pre><code>&lt;?php\n$I-&gt;haveManyBlogsInDatabase(2, ['path' =&gt; 'test-{{n}}'], false)\n$I-&gt;dontSeeBlogInDatabase(['path' =&gt; '/test-3/'])\n</code></pre>"},{"location":"modules/WPDb/#dontseecommentindatabase","title":"dontSeeCommentInDatabase","text":"<p>Signature: <code>dontSeeCommentInDatabase(array $criteria)</code> : <code>void</code> </p> <p>Checks that a comment is not in the database.</p> <p>Will look up the \"comments\" table.</p> <pre><code>&lt;?php\n// Checks for one comment.\n$I-&gt;dontSeeCommentInDatabase(['comment_ID' =&gt; 23]);\n// Checks for comments from a user.\n$I-&gt;dontSeeCommentInDatabase(['user_id' =&gt; 89]);\n</code></pre>"},{"location":"modules/WPDb/#dontseecommentmetaindatabase","title":"dontSeeCommentMetaInDatabase","text":"<p>Signature: <code>dontSeeCommentMetaInDatabase(array $criteria)</code> : <code>void</code> </p> <p>Checks that a comment meta value is not in the database.</p> <p>Will look up the \"commentmeta\" table.</p> <pre><code>&lt;?php\n// Delete a comment `karma` meta.\n$I-&gt;dontSeeCommentMetaInDatabase(['comment_id' =&gt; 23, 'meta_key' =&gt; 'karma']);\n// Delete all meta for a comment.\n$I-&gt;dontSeeCommentMetaInDatabase(['comment_id' =&gt; 23]);\n</code></pre>"},{"location":"modules/WPDb/#dontseeindatabase","title":"dontSeeInDatabase","text":"<p>Signature: <code>dontSeeInDatabase(string $table, [array $criteria])</code> : <code>void</code> </p>"},{"location":"modules/WPDb/#dontseelinkindatabase","title":"dontSeeLinkInDatabase","text":"<p>Signature: <code>dontSeeLinkInDatabase(array $criteria)</code> : <code>void</code> </p> <p>Checks that a link is not in the <code>links</code> database table.</p> <pre><code>&lt;?php\n$I-&gt;dontSeeLinkInDatabase(['link_url' =&gt; 'http://example.com']);\n$I-&gt;dontSeeLinkInDatabase(['link_url' =&gt; 'http://example.com', 'link_name' =&gt; 'example']);\n</code></pre>"},{"location":"modules/WPDb/#dontseeoptionindatabase","title":"dontSeeOptionInDatabase","text":"<p>Signature: <code>dontSeeOptionInDatabase(array|string $criteriaOrName, [mixed $value])</code> : <code>void</code> </p> <p>Checks that an option is not in the database for the current blog.</p> <p>If the value is an object or an array then the serialized option will be checked.</p> <pre><code>&lt;?php\n$I-&gt;dontHaveOptionInDatabase('posts_per_page');\n$I-&gt;dontSeeOptionInDatabase('posts_per_page');\n$I-&gt;dontSeeOptionInDatabase('posts_per_page', 23);\n$I-&gt;dontSeeOptionInDatabase(['option_name' =&gt; 'posts_per_page']);\n$I-&gt;dontSeeOptionInDatabase(['option_name' =&gt; 'posts_per_page', 'option_value' =&gt; 23]);\n</code></pre>"},{"location":"modules/WPDb/#dontseepageindatabase","title":"dontSeePageInDatabase","text":"<p>Signature: <code>dontSeePageInDatabase(array $criteria)</code> : <code>void</code> </p> <p>Checks that a page is not in the database.</p> <pre><code>&lt;?php\n// Assert a page with an ID does not exist.\n$I-&gt;dontSeePageInDatabase(['ID' =&gt; 23]);\n// Assert a page with a slug and ID.\n$I-&gt;dontSeePageInDatabase(['post_name' =&gt; 'test', 'ID' =&gt; 23]);\n</code></pre>"},{"location":"modules/WPDb/#dontseepostindatabase","title":"dontSeePostInDatabase","text":"<p>Signature: <code>dontSeePostInDatabase(array $criteria)</code> : <code>void</code> </p> <p>Checks that a post is not in the database.</p> <pre><code>&lt;?php\n// Asserts a post with title 'Test' is not in the database.\n$I-&gt;dontSeePostInDatabase(['post_title' =&gt; 'Test']);\n// Asserts a post with title 'Test' and content 'Test content' is not in the database.\n$I-&gt;dontSeePostInDatabase(['post_title' =&gt; 'Test', 'post_content' =&gt; 'Test content']);\n</code></pre>"},{"location":"modules/WPDb/#dontseepostmetaindatabase","title":"dontSeePostMetaInDatabase","text":"<p>Signature: <code>dontSeePostMetaInDatabase(array $criteria)</code> : <code>void</code> </p> <p>Checks that a post meta value does not exist.</p> <p>If the meta value is an object or an array then the check will be made on its serialized version.</p> <pre><code>&lt;?php\n$postId = $I-&gt;havePostInDatabase(['meta_input' =&gt; ['foo' =&gt; 'bar']]);\n$I-&gt;dontSeePostMetaInDatabase(['post_id' =&gt; $postId, 'meta_key' =&gt; 'woot']);\n</code></pre>"},{"location":"modules/WPDb/#dontseepostwithtermindatabase","title":"dontSeePostWithTermInDatabase","text":"<p>Signature: <code>dontSeePostWithTermInDatabase(int $post_id, int $term_taxonomy_id, [?int $term_order], [?string $taxonomy])</code> : <code>void</code> </p> <p>Checks that a post to term relation does not exist in the database.</p> <p>The method will check the \"term_relationships\" table.</p> <pre><code>&lt;?php\n$fiction = $I-&gt;haveTermInDatabase('fiction', 'genre');\n$nonFiction = $I-&gt;haveTermInDatabase('non-fiction', 'genre');\n$postId = $I-&gt;havePostInDatabase(['tax_input' =&gt; ['genre' =&gt; ['fiction']]]);\n$I-&gt;dontSeePostWithTermInDatabase($postId, $nonFiction['term_taxonomy_id], );\n</code></pre>"},{"location":"modules/WPDb/#dontseesiteoptionindatabase","title":"dontSeeSiteOptionInDatabase","text":"<p>Signature: <code>dontSeeSiteOptionInDatabase(array|string $criteriaOrName, [mixed $value])</code> : <code>void</code> </p> <p>Checks that a site option is not in the database.</p> <pre><code>&lt;?php\n// Check that the option is not set in the database.\n$I-&gt;dontSeeSiteOptionInDatabase('foo_count');\n// Check that the option is not set with a specific value.\n$I-&gt;dontSeeSiteOptionInDatabase('foo_count', 23);\n$I-&gt;dontSeeSiteOptionInDatabase(['option_name =&gt; 'foo_count', 'option_value' =&gt; 23]);\n</code></pre>"},{"location":"modules/WPDb/#dontseesitetransientindatabase","title":"dontSeeSiteTransientInDatabase","text":"<p>Signature: <code>dontSeeSiteTransientInDatabase(string $transient, [mixed $value])</code> : <code>void</code> </p> <p>Checks that a site transient is not in the database.</p> <pre><code>&lt;?php\n$I-&gt;dontSeeSiteTransientInDatabase('foo');\n$I-&gt;dontSeeSiteTransientInDatabase('foo', 23);\n</code></pre>"},{"location":"modules/WPDb/#dontseetableindatabase","title":"dontSeeTableInDatabase","text":"<p>Signature: <code>dontSeeTableInDatabase(string $table)</code> : <code>void</code> </p> <p>Checks that a table is not in the database.</p> <pre><code>&lt;?php\n$options = $I-&gt;grabPrefixedTableNameFor('options');\n$I-&gt;dontHaveTableInDatabase($options)\n$I-&gt;dontSeeTableInDatabase($options);\n</code></pre>"},{"location":"modules/WPDb/#dontseetermindatabase","title":"dontSeeTermInDatabase","text":"<p>Signature: <code>dontSeeTermInDatabase(array $criteria)</code> : <code>void</code> </p> <p>Makes sure a term is not in the database.</p> <p>Looks up both the <code>terms</code> table and the <code>term_taxonomy</code> tables.</p> <pre><code>&lt;?php\n// Asserts a 'fiction' term is not in the database.\n$I-&gt;dontSeeTermInDatabase(['name' =&gt; 'fiction']);\n// Asserts a 'fiction' term with slug 'genre--fiction' is not in the database.\n$I-&gt;dontSeeTermInDatabase(['name' =&gt; 'fiction', 'slug' =&gt; 'genre--fiction']);\n</code></pre>"},{"location":"modules/WPDb/#dontseetermmetaindatabase","title":"dontSeeTermMetaInDatabase","text":"<p>Signature: <code>dontSeeTermMetaInDatabase(array $criteria)</code> : <code>void</code> </p> <p>Checks that a term meta is not in the database.</p> <pre><code>&lt;?php\nlist($termId, $termTaxonomyId) = $I-&gt;haveTermInDatabase('fiction', 'genre');\n$I-&gt;haveTermMetaInDatabase($termId, 'rating', 4);\n$I-&gt;dontSeeTermMetaInDatabase(['term_id' =&gt; $termId,'meta_key' =&gt; 'average_review']);\n</code></pre>"},{"location":"modules/WPDb/#dontseetermtaxonomyindatabase","title":"dontSeeTermTaxonomyInDatabase","text":"<p>Signature: <code>dontSeeTermTaxonomyInDatabase(array $criteria)</code> : <code>void</code> </p> <p>Checks that a term taxonomy is not in the database.</p> <pre><code>&lt;?php\nlist($termId, $termTaxonomyId) = $I-&gt;haveTermInDatabase('fiction', 'genre');\n$I-&gt;dontSeeTermTaxonomyInDatabase(['term_id' =&gt; $termId, 'taxonomy' =&gt; 'country']);\n</code></pre>"},{"location":"modules/WPDb/#dontseetransientindatabase","title":"dontSeeTransientInDatabase","text":"<p>Signature: <code>dontSeeTransientInDatabase(string $transient, [mixed $value])</code> : <code>void</code> </p> <p>Checks that a transient is not in the database.</p> <pre><code>&lt;?php\n$I-&gt;dontSeeTransientInDatabase('foo');\n$I-&gt;dontSeeTransientInDatabase('foo', 23);\n</code></pre>"},{"location":"modules/WPDb/#dontseeuserindatabase","title":"dontSeeUserInDatabase","text":"<p>Signature: <code>dontSeeUserInDatabase(array $criteria)</code> : <code>void</code> </p> <p>Checks that a user is not in the database.</p> <pre><code>&lt;?php\n// Asserts a user does not exist in the database.\n$I-&gt;dontSeeUserInDatabase(['user_login' =&gt; 'luca']);\n// Asserts a user with email and login is not in the database.\n$I-&gt;dontSeeUserInDatabase(['user_login' =&gt; 'luca', 'user_email' =&gt; 'luca@theaveragedev.com']);\n</code></pre>"},{"location":"modules/WPDb/#dontseeusermetaindatabase","title":"dontSeeUserMetaInDatabase","text":"<p>Signature: <code>dontSeeUserMetaInDatabase(array $criteria)</code> : <code>void</code> </p> <p>Check that a user meta value is not in the database.</p> <pre><code>&lt;?php\n// Asserts a user does not have a 'karma' meta assigned.\n$I-&gt;dontSeeUserMetaInDatabase(['user_id' =&gt; 23, 'meta_key' =&gt; 'karma']);\n// Asserts no user has any 'karma' meta assigned.\n$I-&gt;dontSeeUserMetaInDatabase(['meta_key' =&gt; 'karma']);\n</code></pre>"},{"location":"modules/WPDb/#getsitedomain","title":"getSiteDomain","text":"<p>Signature: <code>getSiteDomain()</code> : <code>string</code> </p> <p>Returns the site domain inferred from the <code>url</code> set in the config.</p> <pre><code>&lt;?php\n$domain = $I-&gt;getSiteDomain();\n// We should be redirected to the HTTPS version when visiting the HTTP version.\n$I-&gt;amOnPage('http://' . $domain);\n$I-&gt;seeCurrentUrlEquals('https://' . $domain);\n</code></pre>"},{"location":"modules/WPDb/#getuserstablename","title":"getUsersTableName","text":"<p>Signature: <code>getUsersTableName()</code> : <code>string</code> </p> <p>Returns the prefixed users table name.</p> <pre><code>&lt;?php\n// Given a `wp_` table prefix returns `wp_users`.\n$usersTable = $I-&gt;getUsersTableName();\n// Given a `wp_` table prefix returns `wp_users`.\n$I-&gt;useBlog(23);\n$usersTable = $I-&gt;getUsersTableName();\n</code></pre>"},{"location":"modules/WPDb/#graballfromdatabase","title":"grabAllFromDatabase","text":"<p>Signature: <code>grabAllFromDatabase(string $table, string $column, array $criteria)</code> : <code>array</code> </p> <p>Returns all entries matching a criteria from the database.</p> <pre><code>&lt;?php\n$books = $I-&gt;grabPrefixedTableNameFor('books');\n$I-&gt;grabAllFromDatabase($books, 'title', ['genre' =&gt; 'fiction']);\n</code></pre>"},{"location":"modules/WPDb/#grabattachmentattachedfile","title":"grabAttachmentAttachedFile","text":"<p>Signature: <code>grabAttachmentAttachedFile(int $attachmentPostId)</code> : <code>string</code> </p> <p>Returns the path, as stored in the database, of an attachment <code>_wp_attached_file</code> meta. The attached file is, usually, an attachment origal file.</p> <pre><code>&lt;?php\n$file = $I-&gt;grabAttachmentAttachedFile($attachmentId);\n$fileInfo = new SplFileInfo($file);\n$I-&gt;assertEquals('jpg', $fileInfo-&gt;getExtension());\n</code></pre>"},{"location":"modules/WPDb/#grabattachmentmetadata","title":"grabAttachmentMetadata","text":"<p>Signature: <code>grabAttachmentMetadata(int $attachmentPostId)</code> : <code>array</code> </p> <p>Returns the metadata array for an attachment post. This is the value of the <code>_wp_attachment_metadata</code> meta.</p> <pre><code>&lt;?php\n$metadata = $I-&gt;grabAttachmentMetadata($attachmentId);\n$I-&gt;assertEquals(['thumbnail', 'medium', 'medium_large'], array_keys($metadata['sizes']);\n</code></pre>"},{"location":"modules/WPDb/#grabblogdomain","title":"grabBlogDomain","text":"<p>Signature: <code>grabBlogDomain(int $blogId)</code> : <code>string</code> </p> <p>Returns a blog domain given its ID.</p> <pre><code>&lt;?php\n$blogIds = $I-&gt;haveManyBlogsInDatabase(3);\n$domains = array_map(function($blogId){\n     return $I-&gt;grabBlogDomain($blogId);\n}, $blogIds);\n</code></pre>"},{"location":"modules/WPDb/#grabblogpath","title":"grabBlogPath","text":"<p>Signature: <code>grabBlogPath(int $blogId)</code> : <code>string</code> </p> <p>Grabs a blog domain from the blogs table.</p> <pre><code>&lt;?php\n$blogId = $I-&gt;haveBlogInDatabase('test');\n$path = $I-&gt;grabBlogDomain($blogId);\n$I-&gt;amOnSubdomain($path);\n$I-&gt;amOnPage('/');\n</code></pre>"},{"location":"modules/WPDb/#grabblogtablename","title":"grabBlogTableName","text":"<p>Signature: <code>grabBlogTableName(int $blogId, string $table)</code> : <code>string</code> </p> <p>Returns the full name of a table for a blog from a multisite installation database.</p> <pre><code>&lt;?php\n$blogOptionTable = $I-&gt;grabBlogTableName($blogId, 'option');\n</code></pre>"},{"location":"modules/WPDb/#grabblogtablenames","title":"grabBlogTableNames","text":"<p>Signature: <code>grabBlogTableNames(int $blogId)</code> : <code>array</code> </p> <p>Returns a list of tables for a blog ID.</p> <pre><code>&lt;?php\n     $blogId = $I-&gt;haveBlogInDatabase('test');\n     $tables = $I-&gt;grabBlogTableNames($blogId);\n     $options = array_filter($tables, function($tableName){\n     return str_pos($tableName, 'options') !== false;\n});\n</code></pre>"},{"location":"modules/WPDb/#grabblogtableprefix","title":"grabBlogTablePrefix","text":"<p>Signature: <code>grabBlogTablePrefix(int $blogId)</code> : <code>string</code> </p> <p>Returns the table prefix for a blog.</p> <pre><code>&lt;?php\n$blogId = $I-&gt;haveBlogInDatabase('test');\n$blogTablePrefix = $I-&gt;getBlogTablePrefix($blogId);\n$blogOrders = $I-&gt;blogTablePrefix . 'orders';\n</code></pre>"},{"location":"modules/WPDb/#grabblogurl","title":"grabBlogUrl","text":"<p>Signature: <code>grabBlogUrl([int $blogId])</code> : <code>string</code> </p> <p>Gets the blog URL from the Blog ID.</p>"},{"location":"modules/WPDb/#grabblogversionstablename","title":"grabBlogVersionsTableName","text":"<p>Signature: <code>grabBlogVersionsTableName()</code> : <code>string</code> </p> <p>Gets the prefixed <code>blog_versions</code> table name.</p> <pre><code>&lt;?php\n// Assuming a `wp_` table prefix it will return `wp_blog_versions`.\n$blogVersionsTable = $I-&gt;grabBlogVersionsTableName();\n$I-&gt;useBlog(23);\n// Assuming a `wp_` table prefix it will return `wp_blog_versions`.\n$blogVersionsTable = $I-&gt;grabBlogVersionsTableName();\n</code></pre>"},{"location":"modules/WPDb/#grabblogstablename","title":"grabBlogsTableName","text":"<p>Signature: <code>grabBlogsTableName()</code> : <code>string</code> </p> <p>Gets the prefixed <code>blogs</code> table name.</p> <pre><code>&lt;?php\n// Assuming a `wp_` table prefix it will return `wp_blogs`.\n$blogVersionsTable = $I-&gt;grabBlogsTableName();\n$I-&gt;useBlog(23);\n// Assuming a `wp_` table prefix it will return `wp_blogs`.\n$blogVersionsTable = $I-&gt;grabBlogsTableName();\n</code></pre>"},{"location":"modules/WPDb/#grabcolumnfromdatabase","title":"grabColumnFromDatabase","text":"<p>Signature: <code>grabColumnFromDatabase(string $table, string $column, [array $criteria])</code> : <code>array</code> </p> <p>Fetches all values from the column in database. Provide table name, desired column and criteria.</p> <pre><code>&lt;?php\n$mails = $I-&gt;grabColumnFromDatabase('users', 'email', array('name' =&gt; 'RebOOter'));\n</code></pre>"},{"location":"modules/WPDb/#grabcommentmetatablename","title":"grabCommentmetaTableName","text":"<p>Signature: <code>grabCommentmetaTableName()</code> : <code>string</code> </p> <p>Returns the prefixed comment meta table name.</p> <pre><code>&lt;?php\n// Get all the values of 'karma' for all comments.\n$commentMeta = $I-&gt;grabCommentmetaTableName();\n$I-&gt;grabAllFromDatabase($commentMeta, 'meta_value', ['meta_key' =&gt; 'karma']);\n</code></pre>"},{"location":"modules/WPDb/#grabcommentstablename","title":"grabCommentsTableName","text":"<p>Signature: <code>grabCommentsTableName()</code> : <code>string</code> </p> <p>Gets the comments table name.</p> <pre><code>&lt;?php\n// Will be `wp_comments`.\n$comments = $I-&gt;grabCommentsTableName();\n// Will be `wp_23_comments`.\n$I-&gt;useBlog(23);\n$comments = $I-&gt;grabCommentsTableName();\n</code></pre>"},{"location":"modules/WPDb/#grabentriesfromdatabase","title":"grabEntriesFromDatabase","text":"<p>Signature: <code>grabEntriesFromDatabase(string $table, [array $criteria])</code> : <code>array</code> </p> <p>Fetches a set of entries from a database. Provide table name and criteria.</p> <p><pre><code>&lt;?php\n$mail = $I-&gt;grabEntriesFromDatabase('users', array('name' =&gt; 'Davert'));\n</code></pre> Comparison expressions can be used as well:</p> <pre><code>&lt;?php\n$post = $I-&gt;grabEntriesFromDatabase('posts', ['num_comments &gt;=' =&gt; 100]);\n$user = $I-&gt;grabEntriesFromDatabase('users', ['email like' =&gt; 'miles%']);\n</code></pre> <p>Supported operators: <code>&lt;</code>, <code>&gt;</code>, <code>&gt;=</code>, <code>&lt;=</code>, <code>!=</code>, <code>like</code>.</p>"},{"location":"modules/WPDb/#grabentryfromdatabase","title":"grabEntryFromDatabase","text":"<p>Signature: <code>grabEntryFromDatabase(string $table, [array $criteria])</code> : <code>array</code> </p> <p>Fetches a whole entry from a database. Make the test fail if the entry is not found. Provide table name, desired column and criteria.</p> <p><pre><code>&lt;?php\n$mail = $I-&gt;grabEntryFromDatabase('users', array('name' =&gt; 'Davert'));\n</code></pre> Comparison expressions can be used as well:</p> <pre><code>&lt;?php\n$post = $I-&gt;grabEntryFromDatabase('posts', ['num_comments &gt;=' =&gt; 100]);\n$user = $I-&gt;grabEntryFromDatabase('users', ['email like' =&gt; 'miles%']);\n</code></pre> <p>Supported operators: <code>&lt;</code>, <code>&gt;</code>, <code>&gt;=</code>, <code>&lt;=</code>, <code>!=</code>, <code>like</code>.</p>"},{"location":"modules/WPDb/#grabfromdatabase","title":"grabFromDatabase","text":"<p>Signature: <code>grabFromDatabase(string $table, string $column, [array $criteria])</code> : <code>void</code> </p> <p>Fetches a single column value from a database. Provide table name, desired column and criteria.</p> <p><pre><code>&lt;?php\n$mail = $I-&gt;grabFromDatabase('users', 'email', array('name' =&gt; 'Davert'));\n</code></pre> Comparison expressions can be used as well:</p> <pre><code>&lt;?php\n$postNum = $I-&gt;grabFromDatabase('posts', 'num_comments', ['num_comments &gt;=' =&gt; 100]);\n$mail = $I-&gt;grabFromDatabase('users', 'email', ['email like' =&gt; 'miles%']);\n</code></pre> <p>Supported operators: <code>&lt;</code>, <code>&gt;</code>, <code>&gt;=</code>, <code>&lt;=</code>, <code>!=</code>, <code>like</code>.</p>"},{"location":"modules/WPDb/#grablatestentrybyfromdatabase","title":"grabLatestEntryByFromDatabase","text":"<p>Signature: <code>grabLatestEntryByFromDatabase(string $tableName, [string $idColumn])</code> : <code>int</code> </p> <p>Returns the id value of the last table entry.</p> <pre><code>&lt;?php\n$I-&gt;haveManyPostsInDatabase();\n$postsTable = $I-&gt;grabPostsTableName();\n$last = $I-&gt;grabLatestEntryByFromDatabase($postsTable, 'ID');\n</code></pre>"},{"location":"modules/WPDb/#grablinkstablename","title":"grabLinksTableName","text":"<p>Signature: <code>grabLinksTableName()</code> : <code>string</code> </p> <p>Returns the prefixed links table name.</p> <pre><code>&lt;?php\n// Given a `wp_` table prefix returns `wp_links`.\n$linksTable = $I-&gt;grabLinksTableName();\n// Given a `wp_` table prefix returns `wp_23_links`.\n$I-&gt;useBlog(23);\n$linksTable = $I-&gt;grabLinksTableName();\n</code></pre>"},{"location":"modules/WPDb/#grabnumrecords","title":"grabNumRecords","text":"<p>Signature: <code>grabNumRecords(string $table, [array $criteria])</code> : <code>int</code> </p> <p>Returns the number of rows in a database</p>"},{"location":"modules/WPDb/#graboptionfromdatabase","title":"grabOptionFromDatabase","text":"<p>Signature: <code>grabOptionFromDatabase(string $option_name)</code> : <code>mixed</code> </p> <p>Gets an option value from the database.</p> <pre><code>&lt;?php\n$count = $I-&gt;grabOptionFromDatabase('foo_count');\n</code></pre>"},{"location":"modules/WPDb/#grabpostfieldfromdatabase","title":"grabPostFieldFromDatabase","text":"<p>Signature: <code>grabPostFieldFromDatabase(int $postId, string $field)</code> : <code>mixed</code> </p> <p>Returns the value of a post field for a post, from the <code>posts</code>  table.</p> <pre><code>&lt;?php\n$title = $I-&gt;grabPostFieldFromDatabase(1, 'post_title');\n$type = $I-&gt;grabPostFieldFromDatabase(1, 'post_type');\n</code></pre>"},{"location":"modules/WPDb/#grabpostmetafromdatabase","title":"grabPostMetaFromDatabase","text":"<p>Signature: <code>grabPostMetaFromDatabase(int $postId, string $metaKey, [bool $single])</code> : <code>mixed</code> </p> <p>Gets the value of one or more post meta values from the database.</p> <pre><code>&lt;?php\n$thumbnail_id = $I-&gt;grabPostMetaFromDatabase($postId, '_thumbnail_id', true);\n</code></pre>"},{"location":"modules/WPDb/#grabpostmetatablename","title":"grabPostmetaTableName","text":"<p>Signature: <code>grabPostmetaTableName()</code> : <code>string</code> </p> <p>Returns the prefixed post meta table name.</p> <pre><code>&lt;?php\n// Returns 'wp_postmeta'.\n$I-&gt;grabPostmetaTableName();\n// Returns 'wp_23_postmeta'.\n$I-&gt;useBlog(23);\n$I-&gt;grabPostmetaTableName();\n</code></pre>"},{"location":"modules/WPDb/#grabpoststablename","title":"grabPostsTableName","text":"<p>Signature: <code>grabPostsTableName()</code> : <code>string</code> </p> <p>Gets the posts prefixed table name.</p> <pre><code>&lt;?php\n// Given a `wp_` table prefix returns `wp_posts`.\n$postsTable = $I-&gt;grabPostsTableName();\n// Given a `wp_` table prefix returns `wp_23_posts`.\n$I-&gt;useBlog(23);\n$postsTable = $I-&gt;grabPostsTableName();\n</code></pre>"},{"location":"modules/WPDb/#grabprefixedtablenamefor","title":"grabPrefixedTableNameFor","text":"<p>Signature: <code>grabPrefixedTableNameFor([string $tableName])</code> : <code>string</code> </p> <p>Returns a prefixed table name for the current blog.</p> <p>If the table is not one to be prefixed (e.g. <code>users</code>) then the proper table name will be returned.</p> <pre><code>&lt;?php\n// Will return wp_users.\n$usersTable = $I-&gt;grabPrefixedTableNameFor('users');\n// Will return wp_options.\n$optionsTable = $I-&gt;grabPrefixedTableNameFor('options');\n// Use a different blog and get its options table.\n$I-&gt;useBlog(2);\n$blogOptionsTable = $I-&gt;grabPrefixedTableNameFor('options');\n</code></pre>"},{"location":"modules/WPDb/#grabregistrationlogtablename","title":"grabRegistrationLogTableName","text":"<p>Signature: <code>grabRegistrationLogTableName()</code> : <code>string</code> </p> <p>Gets the prefixed <code>registration_log</code> table name.</p> <pre><code>&lt;?php\n// Assuming a `wp_` table prefix it will return `wp_registration_log`.\n$blogVersionsTable = $I-&gt;grabRegistrationLogTableName();\n$I-&gt;useBlog(23);\n// Assuming a `wp_` table prefix it will return `wp_registration_log`.\n$blogVersionsTable = $I-&gt;grabRegistrationLogTableName();\n</code></pre>"},{"location":"modules/WPDb/#grabsignupstablename","title":"grabSignupsTableName","text":"<p>Signature: <code>grabSignupsTableName()</code> : <code>string</code> </p> <p>Gets the prefixed <code>signups</code> table name.</p> <pre><code>&lt;?php\n// Assuming a `wp_` table prefix it will return `wp_signups`.\n$blogVersionsTable = $I-&gt;grabSignupsTableName();\n$I-&gt;useBlog(23);\n// Assuming a `wp_` table prefix it will return `wp_signups`.\n$blogVersionsTable = $I-&gt;grabSignupsTableName();\n</code></pre>"},{"location":"modules/WPDb/#grabsitemetafromdatabase","title":"grabSiteMetaFromDatabase","text":"<p>Signature: <code>grabSiteMetaFromDatabase(int $blogId, string $key, bool $single)</code> : <code>mixed</code> </p> <p>Returns a single or all meta values for a site meta key.</p> <pre><code>&lt;?php\n$I-&gt;haveSiteMetaInDatabase(1, 'foo', 'bar');\n$value = $I-&gt;grabSiteMetaFromDatabase(1, 'foo', true);\n$values = $I-&gt;grabSiteMetaFromDatabase(1, 'foo', false);\n</code></pre>"},{"location":"modules/WPDb/#grabsitemetatablename","title":"grabSiteMetaTableName","text":"<p>Signature: <code>grabSiteMetaTableName()</code> : <code>string</code> </p> <p>Gets the prefixed <code>sitemeta</code> table name.</p> <pre><code>&lt;?php\n// Assuming a `wp_` table prefix it will return `wp_sitemeta`.\n$blogVersionsTable = $I-&gt;grabSiteMetaTableName();\n$I-&gt;useBlog(23);\n// Assuming a `wp_` table prefix it will return `wp_sitemeta`.\n$blogVersionsTable = $I-&gt;grabSiteMetaTableName();\n</code></pre>"},{"location":"modules/WPDb/#grabsiteoptionfromdatabase","title":"grabSiteOptionFromDatabase","text":"<p>Signature: <code>grabSiteOptionFromDatabase(string $key)</code> : <code>mixed</code> </p> <p>Gets a site option from the database.</p> <pre><code>&lt;?php\n$fooCountOptionId = $I-&gt;haveSiteOptionInDatabase('foo_count','23');\n</code></pre>"},{"location":"modules/WPDb/#grabsitetablename","title":"grabSiteTableName","text":"<p>Signature: <code>grabSiteTableName()</code> : <code>string</code> </p> <p>Gets the prefixed <code>site</code> table name.</p> <pre><code>&lt;?php\n// Assuming a `wp_` table prefix it will return `wp_site`.\n$blogVersionsTable = $I-&gt;grabSiteTableName();\n$I-&gt;useBlog(23);\n// Assuming a `wp_` table prefix it will return `wp_site`.\n$blogVersionsTable = $I-&gt;grabSiteTableName();\n</code></pre>"},{"location":"modules/WPDb/#grabsitetransientfromdatabase","title":"grabSiteTransientFromDatabase","text":"<p>Signature: <code>grabSiteTransientFromDatabase(string $key)</code> : <code>mixed</code> </p> <p>Gets a site transient from the database.</p> <pre><code>&lt;?php\n$I-&gt;grabSiteTransientFromDatabase('total_comments');\n$I-&gt;grabSiteTransientFromDatabase('api_data');\n</code></pre>"},{"location":"modules/WPDb/#grabsiteurl","title":"grabSiteUrl","text":"<p>Signature: <code>grabSiteUrl([?string $path])</code> : <code>string</code> </p> <p>Returns the current site URL as specified in the module configuration.</p> <pre><code>&lt;?php\n$shopPath = $I-&gt;grabSiteUrl('/shop');\n</code></pre>"},{"location":"modules/WPDb/#grabtableprefix","title":"grabTablePrefix","text":"<p>Signature: <code>grabTablePrefix()</code> : <code>string</code> </p> <p>Returns the table prefix, namespaced for secondary blogs if selected.</p> <pre><code>&lt;?php\n// Assuming a table prefix of `wp_` it will return `wp_`;\n$tablePrefix = $I-&gt;grabTablePrefix();\n$I-&gt;useBlog(23);\n// Assuming a table prefix of `wp_` it will return `wp_23_`;\n$tablePrefix = $I-&gt;grabTablePrefix();\n</code></pre>"},{"location":"modules/WPDb/#grabtermidfromdatabase","title":"grabTermIdFromDatabase","text":"<p>Signature: <code>grabTermIdFromDatabase(array $criteria)</code> : <code>int|false</code> </p> <p>Gets a term ID from the database. Looks up the prefixed <code>terms</code> table, e.g. <code>wp_terms</code>.</p> <pre><code>&lt;?php\n// Return the 'fiction' term 'term_id'.\n$termId = $I-&gt;grabTermIdFromDatabase(['name' =&gt; 'fiction']);\n// Get a term ID by more stringent criteria.\n$termId = $I-&gt;grabTermIdFromDatabase(['name' =&gt; 'fiction', 'slug' =&gt; 'genre--fiction']);\n// Return the 'term_id' of the first term for a group.\n$termId = $I-&gt;grabTermIdFromDatabase(['term_group' =&gt; 23]);\n</code></pre>"},{"location":"modules/WPDb/#grabtermmetatablename","title":"grabTermMetaTableName","text":"<p>Signature: <code>grabTermMetaTableName()</code> : <code>string</code> </p> <p>Gets the terms meta table prefixed name.</p> <pre><code>&lt;?php\n// Returns 'wp_termmeta'.\n$I-&gt;grabTermMetaTableName();\n// Returns 'wp_23_termmeta'.\n$I-&gt;useBlog(23);\n$I-&gt;grabTermMetaTableName();\n</code></pre>"},{"location":"modules/WPDb/#grabtermrelationshipstablename","title":"grabTermRelationshipsTableName","text":"<p>Signature: <code>grabTermRelationshipsTableName()</code> : <code>string</code> </p> <p>Gets the prefixed term relationships table name, e.g. <code>wp_term_relationships</code>.</p> <pre><code>&lt;?php\n$I-&gt;grabTermRelationshipsTableName();\n</code></pre>"},{"location":"modules/WPDb/#grabtermtaxonomyidfromdatabase","title":"grabTermTaxonomyIdFromDatabase","text":"<p>Signature: <code>grabTermTaxonomyIdFromDatabase(array $criteria)</code> : <code>int|false</code> </p> <p>Gets a <code>term_taxonomy_id</code> from the database.</p> <p>Looks up the prefixed <code>terms_relationships</code> table, e.g. <code>wp_term_relationships</code>.</p> <pre><code>&lt;?php\n// Get the `term_taxonomy_id` for a term and a taxonomy.\n$I-&gt;grabTermTaxonomyIdFromDatabase(['term_id' =&gt; $fictionId, 'taxonomy' =&gt; 'genre']);\n// Get the `term_taxonomy_id` for the first term with a count of 23.\n$I-&gt;grabTermTaxonomyIdFromDatabase(['count' =&gt; 23]);\n</code></pre>"},{"location":"modules/WPDb/#grabtermtaxonomytablename","title":"grabTermTaxonomyTableName","text":"<p>Signature: <code>grabTermTaxonomyTableName()</code> : <code>string</code> </p> <p>Gets the prefixed term and taxonomy table name, e.g. <code>wp_term_taxonomy</code>.</p> <pre><code>&lt;?php\n// Returns 'wp_term_taxonomy'.\n$I-&gt;grabTermTaxonomyTableName();\n// Returns 'wp_23_term_taxonomy'.\n$I-&gt;useBlog(23);\n$I-&gt;grabTermTaxonomyTableName();\n</code></pre>"},{"location":"modules/WPDb/#grabtermstablename","title":"grabTermsTableName","text":"<p>Signature: <code>grabTermsTableName()</code> : <code>string</code> </p> <p>Gets the prefixed terms table name, e.g. <code>wp_terms</code>.</p> <pre><code>&lt;?php\n// Returns 'wp_terms'.\n$I-&gt;grabTermsTableName();\n// Returns 'wp_23_terms'.\n$I-&gt;useBlog(23);\n$I-&gt;grabTermsTableName();\n</code></pre>"},{"location":"modules/WPDb/#grabtransientfromdatabase","title":"grabTransientFromDatabase","text":"<p>Signature: <code>grabTransientFromDatabase(string $transient)</code> : <code>mixed</code> </p> <p>Fetches the value of a transient from the database.</p> <pre><code>&lt;?php\n$I-&gt;haveTransientInDatabase('foo', 23);\n$transientValue = $I-&gt;grabTransientFromDatabase('foo');\n$I-&gt;assertEquals(23, $transientValue);\n</code></pre>"},{"location":"modules/WPDb/#grabuseridfromdatabase","title":"grabUserIdFromDatabase","text":"<p>Signature: <code>grabUserIdFromDatabase(string $userLogin)</code> : <code>int|false</code> </p> <p>Gets the a user ID from the database using the user login.</p> <pre><code>&lt;?php\n$userId = $I-&gt;grabUserIdFromDatabase('luca');\n</code></pre>"},{"location":"modules/WPDb/#grabusermetafromdatabase","title":"grabUserMetaFromDatabase","text":"<p>Signature: <code>grabUserMetaFromDatabase(int $userId, string $meta_key, [bool $single])</code> : <code>mixed</code> </p> <p>Gets a user meta from the database.</p> <pre><code>&lt;?php\n// Returns a user 'karma' value.\n$I-&gt;grabUserMetaFromDatabase($userId, 'karma');\n// Returns an array, the unserialized version of the value stored in the database.\n$I-&gt;grabUserMetaFromDatabase($userId, 'api_data');\n</code></pre>"},{"location":"modules/WPDb/#grabusermetatablename","title":"grabUsermetaTableName","text":"<p>Signature: <code>grabUsermetaTableName()</code> : <code>string</code> </p> <p>Returns the prefixed users meta table name.</p> <pre><code>&lt;?php\n// Given a `wp_` table prefix returns `wp_usermeta`.\n$usermetaTable = $I-&gt;grabUsermetaTableName();\n// Given a `wp_` table prefix returns `wp_usermeta`.\n$I-&gt;useBlog(23);\n$usermetaTable = $I-&gt;grabUsermetaTableName();\n</code></pre>"},{"location":"modules/WPDb/#grabuserstablename","title":"grabUsersTableName","text":"<p>Signature: <code>grabUsersTableName()</code> : <code>string</code> </p> <p>Returns the prefixed users table name.</p> <pre><code>&lt;?php\n// Given a `wp_` table prefix returns `wp_users`.\n$usersTable = $I-&gt;grabUsersTableName();\n// Given a `wp_` table prefix returns `wp_users`.\n$I-&gt;useBlog(23);\n$usersTable = $I-&gt;grabUsersTableName();\n</code></pre>"},{"location":"modules/WPDb/#haveattachmentindatabase","title":"haveAttachmentInDatabase","text":"<p>Signature: <code>haveAttachmentInDatabase(string $file, [string|int $date], [array $overrides], [?array $imageSizes])</code> : <code>int</code> </p> <p>Creates the database entries representing an attachment and moves the attachment file to the right location.</p> <pre><code>&lt;?php\n$file = codecept_data_dir('images/test.png');\n$attachmentId = $I-&gt;haveAttachmentInDatabase($file);\n$image = codecept_data_dir('images/test-2.png');\n$lastWeekAttachment = $I-&gt;haveAttachmentInDatabase($image, '-1 week');\n</code></pre> <p>Requires the WPFilesystem module.</p>"},{"location":"modules/WPDb/#haveblogindatabase","title":"haveBlogInDatabase","text":"<p>Signature: <code>haveBlogInDatabase(string $domainOrPath, [array $overrides], [bool $subdomain])</code> : <code>int</code> </p> <p>Inserts a blog in the <code>blogs</code> table.</p> <pre><code>&lt;?php\n// Create the `test` subdomain blog.\n$blogId = $I-&gt;haveBlogInDatabase('test', ['administrator' =&gt; $userId]);\n// Create the `/test` subfolder blog.\n$blogId = $I-&gt;haveBlogInDatabase('test', ['administrator' =&gt; $userId], false);\n</code></pre>"},{"location":"modules/WPDb/#havecommentindatabase","title":"haveCommentInDatabase","text":"<p>Signature: <code>haveCommentInDatabase(int $comment_post_ID, [array $data])</code> : <code>int</code> </p> <p>Inserts a comment in the database.</p> <pre><code>&lt;?php\n$I-&gt;haveCommentInDatabase($postId, ['comment_content' =&gt; 'Test Comment', 'comment_karma' =&gt; 23]);\n</code></pre>"},{"location":"modules/WPDb/#havecommentmetaindatabase","title":"haveCommentMetaInDatabase","text":"<p>Signature: <code>haveCommentMetaInDatabase(int $comment_id, string $meta_key, mixed $meta_value)</code> : <code>int</code> </p> <p>Inserts a comment meta field in the database. Array and object meta values will be serialized.</p> <pre><code>&lt;?php\n$I-&gt;haveCommentMetaInDatabase($commentId, 'api_ID', 23);\n// The value will be serialized.\n$apiData = ['ID' =&gt; 23, 'user' =&gt; 89, 'origin' =&gt; 'twitter'];\n$I-&gt;haveCommentMetaInDatabase($commentId, 'api_data', $apiData);\n</code></pre>"},{"location":"modules/WPDb/#haveindatabase","title":"haveInDatabase","text":"<p>Signature: <code>haveInDatabase(string $table, array $data)</code> : <code>int</code> </p> <p>Inserts an SQL record into a database. This record will be erased after the test, unless you've configured \"skip_cleanup_if_failed\", and the test fails.</p> <pre><code>&lt;?php\n$I-&gt;haveInDatabase('users', array('name' =&gt; 'miles', 'email' =&gt; 'miles@davis.com'));\n</code></pre>"},{"location":"modules/WPDb/#havelinkindatabase","title":"haveLinkInDatabase","text":"<p>Signature: <code>haveLinkInDatabase([array $overrides])</code> : <code>int</code> </p> <p>Inserts a link in the database.</p> <pre><code>&lt;?php\n$linkId = $I-&gt;haveLinkInDatabase(['link_url' =&gt; 'http://example.org']);\n</code></pre>"},{"location":"modules/WPDb/#havemanyblogsindatabase","title":"haveManyBlogsInDatabase","text":"<p>Signature: <code>haveManyBlogsInDatabase(int $count, [array $overrides], [bool $subdomain])</code> : <code>array</code> </p> <p>Inserts many blogs in the database.</p> <pre><code>&lt;?php\n     $blogIds = $I-&gt;haveManyBlogsInDatabase(3, ['domain' =&gt;'test-{{n}}']);\n     foreach($blogIds as $blogId){\n     $I-&gt;useBlog($blogId);\n     $I-&gt;haveManuPostsInDatabase(3);\n}\n</code></pre>"},{"location":"modules/WPDb/#havemanycommentsindatabase","title":"haveManyCommentsInDatabase","text":"<p>Signature: <code>haveManyCommentsInDatabase(int $count, int $comment_post_ID, [array $overrides])</code> : <code>array</code> </p> <p>Inserts many comments in the database.</p> <pre><code>&lt;?php\n// Insert 3 random comments for a post.\n$I-&gt;haveManyCommentsInDatabase(3, $postId);\n// Insert 3 random comments for a post.\n$I-&gt;haveManyCommentsInDatabase(3, $postId, ['comment_content' =&gt; 'Comment {{n}}']);\n</code></pre>"},{"location":"modules/WPDb/#havemanylinksindatabase","title":"haveManyLinksInDatabase","text":"<p>Signature: <code>haveManyLinksInDatabase(int $count, [array $overrides])</code> : <code>array</code> </p> <p>Inserts many links in the database <code>links</code> table.</p> <pre><code>&lt;?php\n// Insert 3 randomly generated links in the database.\n$linkIds = $I-&gt;haveManyLinksInDatabase(3);\n// Inserts links in the database replacing the `n` placeholder.\n$linkIds = $I-&gt;haveManyLinksInDatabase(3, ['link_url' =&gt; 'http://example.org/test-{{n}}']);\n</code></pre>"},{"location":"modules/WPDb/#havemanypostsindatabase","title":"haveManyPostsInDatabase","text":"<p>Signature: <code>haveManyPostsInDatabase(int $count, [array $overrides])</code> : <code>array</code> </p> <p>Inserts many posts in the database returning their IDs.</p> <pre><code>&lt;?php\n// Insert 3 random posts.\n$I-&gt;haveManyPostsInDatabase(3);\n// Insert 3 posts with generated titles.\n$I-&gt;haveManyPostsInDatabase(3, ['post_title' =&gt; 'Test post {{n}}']);\n</code></pre>"},{"location":"modules/WPDb/#havemanytermsindatabase","title":"haveManyTermsInDatabase","text":"<p>Signature: <code>haveManyTermsInDatabase(int $count, string $name, string $taxonomy, [array $overrides])</code> : <code>array</code> </p> <p>Inserts many terms in the database.</p> <pre><code>&lt;?php\n$terms = $I-&gt;haveManyTermsInDatabase(3, 'genre-{{n}}', 'genre');\n$termIds = array_column($terms, 0);\n$termTaxonomyIds = array_column($terms, 1);\n</code></pre>"},{"location":"modules/WPDb/#havemanyusersindatabase","title":"haveManyUsersInDatabase","text":"<p>Signature: <code>haveManyUsersInDatabase(int $count, string $user_login, [string $role], [array $overrides])</code> : <code>array</code> </p> <p>Inserts many users in the database.</p> <pre><code>&lt;?php\n$subscribers = $I-&gt;haveManyUsersInDatabase(5, 'user-{{n}}');\n$editors = $I-&gt;haveManyUsersInDatabase(\n     5,\n     'user-{{n}}',\n     'editor',\n     ['user_email' =&gt; 'user-{{n}}@example.org']\n);\n</code></pre>"},{"location":"modules/WPDb/#havemenuindatabase","title":"haveMenuInDatabase","text":"<p>Signature: <code>haveMenuInDatabase(string $slug, string $location, [array $overrides])</code> : <code>array</code> </p> <p>Creates and adds a menu to a theme location in the database.</p> <pre><code>&lt;?php\nlist($termId, $termTaxId) = $I-&gt;haveMenuInDatabase('test', 'sidebar');\n</code></pre>"},{"location":"modules/WPDb/#havemenuitemindatabase","title":"haveMenuItemInDatabase","text":"<p>Signature: <code>haveMenuItemInDatabase(string $menuSlug, string $title, [?int $menuOrder], [array $meta])</code> : <code>int</code> </p> <p>Adds a menu element to a menu for the current theme.</p> <pre><code>&lt;?php\n$I-&gt;haveMenuInDatabase('test', 'sidebar');\n$I-&gt;haveMenuItemInDatabase('test', 'Test one', 0);\n$I-&gt;haveMenuItemInDatabase('test', 'Test two', 1);\n</code></pre>"},{"location":"modules/WPDb/#haveoptionindatabase","title":"haveOptionInDatabase","text":"<p>Signature: <code>haveOptionInDatabase(string $option_name, mixed $option_value, [string $autoload])</code> : <code>int</code> </p> <p>Inserts an option in the database.</p> <pre><code>&lt;?php\n$I-&gt;haveOptionInDatabase('posts_per_page', 23);\n$I-&gt;haveOptionInDatabase('my_plugin_options', ['key_one' =&gt; 'value_one', 'key_two' =&gt; 89]);\n</code></pre> <p>If the option value is an object or an array then the value will be serialized.</p>"},{"location":"modules/WPDb/#havepageindatabase","title":"havePageInDatabase","text":"<p>Signature: <code>havePageInDatabase([array $overrides])</code> : <code>int</code> </p> <p>Inserts a page in the database.</p> <pre><code>&lt;?php\n// Creates a test page in the database with random values.\n$randomPageId = $I-&gt;havePageInDatabase();\n// Creates a test page in the database defining its title.\n$testPageId = $I-&gt;havePageInDatabase(['post_title' =&gt; 'Test page']);\n</code></pre>"},{"location":"modules/WPDb/#havepostindatabase","title":"havePostInDatabase","text":"<p>Signature: <code>havePostInDatabase([array $data])</code> : <code>int</code> </p> <p>Inserts a post in the database.</p> <pre><code>&lt;?php\n// Insert a post with random values in the database.\n$randomPostId = $I-&gt;havePostInDatabase();\n// Insert a post with specific values in the database.\n$I-&gt;havePostInDatabase([\n'post_type' =&gt; 'book',\n'post_title' =&gt; 'Alice in Wonderland',\n'meta_input' =&gt; [\n'readers_count' =&gt; 23\n],\n'tax_input' =&gt; [\n['genre' =&gt; 'fiction']\n]\n]);\n</code></pre>"},{"location":"modules/WPDb/#havepostthumbnailindatabase","title":"havePostThumbnailInDatabase","text":"<p>Signature: <code>havePostThumbnailInDatabase(int $postId, int $thumbnailId)</code> : <code>int</code> </p> <p>Assigns the specified attachment ID as thumbnail (featured image) to a post.</p> <pre><code>&lt;?php\n$attachmentId = $I-&gt;haveAttachmentInDatabase(codecept_data_dir('some-image.png'));\n$postId = $I-&gt;havePostInDatabase();\n$I-&gt;havePostThumbnailInDatabase($postId, $attachmentId);\n</code></pre>"},{"location":"modules/WPDb/#havepostmetaindatabase","title":"havePostmetaInDatabase","text":"<p>Signature: <code>havePostmetaInDatabase(int $postId, string $meta_key, mixed $meta_value)</code> : <code>int</code> </p> <p>Adds one or more meta key and value couples in the database for a post.</p> <pre><code>&lt;?php\n// Set the post-meta for a post.\n$I-&gt;havePostmetaInDatabase($postId, 'karma', 23);\n// Set an array post-meta for a post, it will be serialized in the db.\n$I-&gt;havePostmetaInDatabase($postId, 'data', ['one', 'two']);\n// Use a loop to insert one meta per row.\nforeach( ['one', 'two'] as $value){\n     $I-&gt;havePostmetaInDatabase($postId, 'data', $value);\n}\n</code></pre>"},{"location":"modules/WPDb/#havesitemetaindatabase","title":"haveSiteMetaInDatabase","text":"<p>Signature: <code>haveSiteMetaInDatabase(int $blogId, string $string, mixed $value)</code> : <code>int</code> </p> <p>Adds a meta key and value for a site in the database.</p> <pre><code>&lt;?php\n$I-&gt;haveSiteMetaInDatabase(1, 'foo', 'bar');\n$insertedId = $I-&gt;haveSiteMetaInDatabase(2, 'foo', ['bar' =&gt; 'baz']);\n</code></pre>"},{"location":"modules/WPDb/#havesiteoptionindatabase","title":"haveSiteOptionInDatabase","text":"<p>Signature: <code>haveSiteOptionInDatabase(string $key, mixed $value)</code> : <code>int</code> </p> <p>Inserts a site option in the database.</p> <p>If the value is an array or an object then the value will be serialized.</p> <pre><code>&lt;?php\n$fooCountOptionId = $I-&gt;haveSiteOptionInDatabase('foo_count','23');\n</code></pre>"},{"location":"modules/WPDb/#havesitetransientindatabase","title":"haveSiteTransientInDatabase","text":"<p>Signature: <code>haveSiteTransientInDatabase(string $key, mixed $value)</code> : <code>int</code> </p> <p>Inserts a site transient in the database. If the value is an array or an object then the value will be serialized.</p> <pre><code>&lt;?php\n$I-&gt;haveSiteTransientInDatabase('total_comments_count', 23);\n// This value will be serialized.\n$I-&gt;haveSiteTransientInDatabase('api_data', ['user' =&gt; 'luca', 'token' =&gt; '11ae3ijns-j83']);\n</code></pre>"},{"location":"modules/WPDb/#havetermindatabase","title":"haveTermInDatabase","text":"<p>Signature: <code>haveTermInDatabase(string $name, string $taxonomy, [array $overrides])</code> : <code>array</code> </p> <p>Inserts a term in the database.</p> <pre><code>&lt;?php\n// Insert a random 'genre' term in the database.\n$I-&gt;haveTermInDatabase('non-fiction', 'genre');\n// Insert a term in the database with term meta.\n$I-&gt;haveTermInDatabase('fiction', 'genre', [\n     'slug' =&gt; 'genre--fiction',\n     'meta' =&gt; [\n        'readers_count' =&gt; 23\n     ]\n]);\n</code></pre>"},{"location":"modules/WPDb/#havetermmetaindatabase","title":"haveTermMetaInDatabase","text":"<p>Signature: <code>haveTermMetaInDatabase(int $term_id, string $meta_key, mixed $meta_value)</code> : <code>int</code> </p> <p>Inserts a term meta row in the database. Objects and array meta values will be serialized.</p> <pre><code>&lt;?php\n$I-&gt;haveTermMetaInDatabase($fictionId, 'readers_count', 23);\n// Insert some meta that will be serialized.\n$I-&gt;haveTermMetaInDatabase($fictionId, 'flags', [3, 4, 89]);\n// Use a loop to insert one meta per row.\nforeach([3, 4, 89] as $value) {\n     $I-&gt;haveTermMetaInDatabase($fictionId, 'flag', $value);\n}\n</code></pre>"},{"location":"modules/WPDb/#havetermrelationshipindatabase","title":"haveTermRelationshipInDatabase","text":"<p>Signature: <code>haveTermRelationshipInDatabase(int $object_id, int $term_taxonomy_id, [int $term_order])</code> : <code>void</code> </p> <p>Creates a term relationship in the database.</p> <p>No check about the consistency of the insertion is made. E.g. a post could be assigned a term from a taxonomy that's not registered for that post type.</p> <pre><code>&lt;?php\n// Assign the `fiction` term to a book.\n$I-&gt;haveTermRelationshipInDatabase($bookId, $fictionId);\n</code></pre>"},{"location":"modules/WPDb/#havetransientindatabase","title":"haveTransientInDatabase","text":"<p>Signature: <code>haveTransientInDatabase(string $transient, mixed $value)</code> : <code>int</code> </p> <p>Inserts a transient in the database.</p> <p>If the value is an array or an object then the value will be serialized. Since the transients are set in the context of tests it's not possible to set an expiration directly.</p> <pre><code>&lt;?php\n// Store an array in the `tweets` transient.\n$I-&gt;haveTransientInDatabase('tweets', $tweets);\n</code></pre>"},{"location":"modules/WPDb/#haveusercapabilitiesindatabase","title":"haveUserCapabilitiesInDatabase","text":"<p>Signature: <code>haveUserCapabilitiesInDatabase(int $userId, array|string $role)</code> : <code>array</code> </p> <p>Sets a user capabilities in the database.</p> <pre><code>&lt;?php\n// Assign one user a role in a blog.\n$blogId = $I-&gt;haveBlogInDatabase('test');\n$editor = $I-&gt;haveUserInDatabase('luca', 'editor');\n$capsIds = $I-&gt;haveUserCapabilitiesInDatabase($editor, [$blogId =&gt; 'editor']);\n\n// Assign a user two roles in blog 1.\n$capsIds = $I-&gt;haveUserCapabilitiesInDatabase($userId, ['editor', 'subscriber']);\n\n// Assign one user different roles in different blogs.\n$capsIds = $I-&gt;haveUserCapabilitiesInDatabase($userId, [$blogId1 =&gt; 'editor', $blogId2 =&gt; 'author']);\n\n// Assign a user a role and an additional capability in blog 1.\n$I-&gt;haveUserCapabilitiesInDatabase($userId, ['editor' =&gt; true, 'edit_themes' =&gt; true]);\n\n// Assign a user a mix of roles and capabilities in different blogs.\n$capsIds = $I-&gt;haveUserCapabilitiesInDatabase(\n     $userId,\n     [\n         $blogId1 =&gt; ['editor' =&gt; true, 'edit_themes' =&gt; true],\n         $blogId2 =&gt; ['administrator' =&gt; true, 'edit_themes' =&gt; false]\n     ]\n);\n</code></pre>"},{"location":"modules/WPDb/#haveuserindatabase","title":"haveUserInDatabase","text":"<p>Signature: <code>haveUserInDatabase(string $user_login, [array|string $role], [array $overrides])</code> : <code>int</code> </p> <p>Inserts a user and its meta in the database.</p> <pre><code>&lt;?php\n// Create an editor user in blog 1 w/ specific email.\n$userId = $I-&gt;haveUserInDatabase('luca', 'editor', ['user_email' =&gt; 'luca@example.org']);\n\n// Create a subscriber user in blog 1.\n$subscriberId = $I-&gt;haveUserInDatabase('subscriber');\n\n// Create a user editor in blog 1, author in blog 2, administrator in blog 3.\n$userWithMeta = $I-&gt;haveUserInDatabase('luca',\n     [\n         1 =&gt; 'editor',\n         2 =&gt; 'author',\n         3 =&gt; 'administrator'\n     ], [\n         'user_email' =&gt; 'luca@example.org'\n         'meta' =&gt; ['a meta_key' =&gt; 'a_meta_value']\n     ]\n);\n\n// Create editor in blog 1 w/ `edit_themes` cap, author in blog 2, admin in blog 3 w/o `manage_options` cap.\n$userWithMeta = $I-&gt;haveUserInDatabase('luca',\n     [\n         1 =&gt; ['editor', 'edit_themes'],\n         2 =&gt; 'author',\n         3 =&gt; ['administrator' =&gt; true, 'manage_options' =&gt; false]\n     ]\n);\n\n// Create a user w/o role.\n$userId = $I-&gt;haveUserInDatabase('luca', '');\n</code></pre>"},{"location":"modules/WPDb/#haveuserlevelsindatabase","title":"haveUserLevelsInDatabase","text":"<p>Signature: <code>haveUserLevelsInDatabase(int $userId, array|string $role)</code> : <code>array</code> </p> <p>Sets the user access level meta in the database for a user.</p> <pre><code>&lt;?php\n$userId = $I-&gt;haveUserInDatabase('luca', 'editor');\n$moreThanAnEditorLessThanAnAdmin = 8;\n$I-&gt;haveUserLevelsInDatabase($userId, $moreThanAnEditorLessThanAnAdmin);\n</code></pre>"},{"location":"modules/WPDb/#haveusermetaindatabase","title":"haveUserMetaInDatabase","text":"<p>Signature: <code>haveUserMetaInDatabase(int $userId, string $meta_key, mixed $meta_value)</code> : <code>array</code> </p> <p>Sets a user meta in the database.</p> <pre><code>&lt;?php\n$userId = $I-&gt;haveUserInDatabase('luca', 'editor');\n$I-&gt;haveUserMetaInDatabase($userId, 'karma', 23);\n</code></pre>"},{"location":"modules/WPDb/#importsql","title":"importSql","text":"<p>Signature: <code>importSql(array $sql)</code> : <code>void</code> </p> <p>Loads a set SQL code lines in the current database.</p> <pre><code>&lt;?php\n// Import a SQL string.\n$I-&gt;importSql([$sqlString]);\n// Import a set of SQL strings.\n$I-&gt;importSql($sqlStrings);\n// Import a prepared set of SQL strings.\n$preparedSqlStrings = array_map(function($line){\n    return str_replace('{{date}}', date('Y-m-d H:i:s'), $line);\n}, $sqlTemplate);\n$I-&gt;importSql($preparedSqlStrings);\n</code></pre>"},{"location":"modules/WPDb/#importsqldumpfile","title":"importSqlDumpFile","text":"<p>Signature: <code>importSqlDumpFile([?string $dumpFile])</code> : <code>void</code> </p> <p>Import the SQL dump file if populate is enabled.</p> <pre><code>&lt;?php\n// Import a dump file passing the absolute path.\n$I-&gt;importSqlDumpFile(codecept_data_dir('dumps/start.sql'));\n</code></pre> <p>Specifying a dump file that file will be imported.</p>"},{"location":"modules/WPDb/#performindatabase","title":"performInDatabase","text":"<p>Signature: <code>performInDatabase($databaseKey, $actions)</code> : <code>void</code> </p> <p>Can be used with a callback if you don't want to change the current database in your test.</p> <p><pre><code>&lt;?php\n$I-&gt;seeNumRecords(2, 'users');   //executed on default database\n$I-&gt;performInDatabase('db_books', function($I) {\n    $I-&gt;seeNumRecords(30, 'books');  //executed on db_books database\n});\n$I-&gt;seeNumRecords(2, 'users');  //executed on default database\n</code></pre> List of actions can be pragmatically built using <code>Codeception\\Util\\ActionSequence</code>:</p> <p><pre><code>&lt;?php\n$I-&gt;performInDatabase('db_books', ActionSequence::build()\n    -&gt;seeNumRecords(30, 'books')\n);\n</code></pre> Alternatively an array can be used:</p> <pre><code>&lt;?php\n$I-&gt;performInDatabase('db_books', ['seeNumRecords' =&gt; [30, 'books']]);\n</code></pre> <p>Choose the syntax you like the most and use it,</p> <p>Actions executed from array or ActionSequence will print debug output for actions, and adds an action name to exception on failure.</p>"},{"location":"modules/WPDb/#seeattachmentindatabase","title":"seeAttachmentInDatabase","text":"<p>Signature: <code>seeAttachmentInDatabase(array $criteria)</code> : <code>void</code> </p> <p>Checks for an attachment in the database.</p> <pre><code>&lt;?php\n$url = 'https://example.org/images/foo.png';\n$I-&gt;seeAttachmentInDatabase(['guid' =&gt; $url]);\n</code></pre>"},{"location":"modules/WPDb/#seeblogindatabase","title":"seeBlogInDatabase","text":"<p>Signature: <code>seeBlogInDatabase(array $criteria)</code> : <code>void</code> </p> <p>Checks for a blog in the <code>blogs</code> table.</p> <pre><code>&lt;?php\n// Search for a blog by `blog_id`.\n$I-&gt;seeBlogInDatabase(['blog_id' =&gt; 23]);\n// Search for all blogs on a path.\n$I-&gt;seeBlogInDatabase(['path' =&gt; '/sub-path/']);\n</code></pre>"},{"location":"modules/WPDb/#seecommentindatabase","title":"seeCommentInDatabase","text":"<p>Signature: <code>seeCommentInDatabase(array $criteria)</code> : <code>void</code> </p> <p>Checks for a comment in the database.</p> <p>Will look up the \"comments\" table.</p> <pre><code>&lt;?php\n$I-&gt;seeCommentInDatabase(['comment_ID' =&gt; 23]);\n</code></pre>"},{"location":"modules/WPDb/#seecommentmetaindatabase","title":"seeCommentMetaInDatabase","text":"<p>Signature: <code>seeCommentMetaInDatabase(array $criteria)</code> : <code>void</code> </p> <p>Checks that a comment meta value is in the database. Will look up the \"commentmeta\" table.</p> <pre><code>&lt;?php\n// Assert a specified meta for a comment exists.\n$I-&gt;seeCommentMetaInDatabase(['comment_ID' =&gt; $commentId, 'meta_key' =&gt; 'karma', 'meta_value' =&gt; 23]);\n// Assert the comment has at least one meta set.\n$I-&gt;seeCommentMetaInDatabase(['comment_ID' =&gt; $commentId]);\n</code></pre>"},{"location":"modules/WPDb/#seeindatabase","title":"seeInDatabase","text":"<p>Signature: <code>seeInDatabase(string $table, [array $criteria])</code> : <code>void</code> </p>"},{"location":"modules/WPDb/#seelinkindatabase","title":"seeLinkInDatabase","text":"<p>Signature: <code>seeLinkInDatabase(array $criteria)</code> : <code>void</code> </p> <p>Checks for a link in the <code>links</code> table of the database.</p> <pre><code>&lt;?php\n// Asserts a link exists by name.\n$I-&gt;seeLinkInDatabase(['link_name' =&gt; 'my-link']);\n// Asserts at least one link exists for the user.\n$I-&gt;seeLinkInDatabase(['link_owner' =&gt; $userId]);\n</code></pre>"},{"location":"modules/WPDb/#seenumrecords","title":"seeNumRecords","text":"<p>Signature: <code>seeNumRecords(int $expectedNumber, string $table, [array $criteria])</code> : <code>void</code> </p> <p>Asserts that the given number of records were found in the database.</p> <pre><code>&lt;?php\n$I-&gt;seeNumRecords(1, 'users', ['name' =&gt; 'davert'])\n</code></pre>"},{"location":"modules/WPDb/#seeoptionindatabase","title":"seeOptionInDatabase","text":"<p>Signature: <code>seeOptionInDatabase(array|string $criteriaOrName, [mixed $value])</code> : <code>void</code> </p> <p>Checks if an option is in the database for the current blog, either by criteria or by name and value.</p> <p>If checking for an array or an object then the serialized version will be checked for.</p> <pre><code>&lt;?php\n// Checks an option is in the database.\n$I-&gt;seeOptionInDatabase('tables_version');\n// Checks an option is in the database and has a specific value.\n$I-&gt;seeOptionInDatabase('tables_version', '1.0');\n$I-&gt;seeOptionInDatabase(['option_name' =&gt; 'tables_version', 'option_value' =&gt; 1.0']);\n</code></pre>"},{"location":"modules/WPDb/#seepageindatabase","title":"seePageInDatabase","text":"<p>Signature: <code>seePageInDatabase(array $criteria)</code> : <code>void</code> </p> <p>Checks for a page in the database.</p> <pre><code>&lt;?php\n// Asserts a page with an exists in the database.\n$I-&gt;seePageInDatabase(['ID' =&gt; 23]);\n// Asserts a page with a slug and ID exists in the database.\n$I-&gt;seePageInDatabase(['post_title' =&gt; 'Test Page', 'ID' =&gt; 23]);\n</code></pre>"},{"location":"modules/WPDb/#seepostindatabase","title":"seePostInDatabase","text":"<p>Signature: <code>seePostInDatabase(array $criteria)</code> : <code>void</code> </p> <p>Checks for a post in the database.</p> <pre><code>&lt;?php\n// Assert a post exists in the database.\n$I-&gt;seePostInDatabase(['ID' =&gt; 23]);\n// Assert a post with a slug and ID exists in the database.\n$I-&gt;seePostInDatabase(['post_content' =&gt; 'test content', 'ID' =&gt; 23]);\n</code></pre>"},{"location":"modules/WPDb/#seepostmetaindatabase","title":"seePostMetaInDatabase","text":"<p>Signature: <code>seePostMetaInDatabase(array $criteria)</code> : <code>void</code> </p> <p>Checks for a post meta value in the database for the current blog.</p> <p>If the <code>meta_value</code> is an object or an array then the check will be made for serialized values.</p> <pre><code>&lt;?php\n$postId = $I-&gt;havePostInDatabase(['meta_input' =&gt; ['foo' =&gt; 'bar']];\n$I-&gt;seePostMetaInDatabase(['post_id' =&gt; '$postId', 'meta_key' =&gt; 'foo']);\n</code></pre>"},{"location":"modules/WPDb/#seepostwithtermindatabase","title":"seePostWithTermInDatabase","text":"<p>Signature: <code>seePostWithTermInDatabase(int $post_id, int $term_taxonomy_id, [?int $term_order], [?string $taxonomy])</code> : <code>void</code> </p> <p>Checks that a post to term relation exists in the database.</p> <p>The method will check the \"term_relationships\" table.</p> <pre><code>&lt;?php\n$fiction = $I-&gt;haveTermInDatabase('fiction', 'genre');\n$postId = $I-&gt;havePostInDatabase(['tax_input' =&gt; ['genre' =&gt; ['fiction']]]);\n$I-&gt;seePostWithTermInDatabase($postId, $fiction['term_taxonomy_id']);\n</code></pre>"},{"location":"modules/WPDb/#seesiteoptionindatabase","title":"seeSiteOptionInDatabase","text":"<p>Signature: <code>seeSiteOptionInDatabase(array|string $criteriaOrName, [mixed $value])</code> : <code>void</code> </p> <p>Checks that a site option is in the database.</p> <pre><code>&lt;?php\n// Check that the option is set in the database.\n$I-&gt;seeSiteOptionInDatabase('foo_count');\n// Check that the option is set and has a specific value.\n$I-&gt;seeSiteOptionInDatabase('foo_count', 23);\n</code></pre>"},{"location":"modules/WPDb/#seesitesitetransientindatabase","title":"seeSiteSiteTransientInDatabase","text":"<p>Signature: <code>seeSiteSiteTransientInDatabase(string $key, [mixed $value])</code> : <code>void</code> </p> <p>Checks that a site option is in the database.</p> <pre><code>&lt;?php\n// Check a transient exists.\n$I-&gt;seeSiteSiteTransientInDatabase('total_counts');\n// Check a transient exists and has a specific value.\n$I-&gt;seeSiteSiteTransientInDatabase('total_counts', 23);\n</code></pre>"},{"location":"modules/WPDb/#seesitetransientindatabase","title":"seeSiteTransientInDatabase","text":"<p>Signature: <code>seeSiteTransientInDatabase(string $transient, [mixed $value])</code> : <code>void</code> </p> <p>Checks that a site transient is in the database.</p> <pre><code>&lt;?php\n$I-&gt;haveSiteTransientInDatabase('foo', 23);\n$I-&gt;seeSiteTransientInDatabase('foo');\n$I-&gt;seeSiteTransientInDatabase('foo', 23);\n</code></pre>"},{"location":"modules/WPDb/#seetableindatabase","title":"seeTableInDatabase","text":"<p>Signature: <code>seeTableInDatabase(string $table)</code> : <code>void</code> </p> <p>Checks that a table is in the database.</p> <pre><code>&lt;?php\n$options = $I-&gt;grabPrefixedTableNameFor('options');\n$I-&gt;seeTableInDatabase($options);\n</code></pre>"},{"location":"modules/WPDb/#seetermindatabase","title":"seeTermInDatabase","text":"<p>Signature: <code>seeTermInDatabase(array $criteria)</code> : <code>void</code> </p> <p>Checks for a term in the database. Looks up the <code>terms</code> and <code>term_taxonomy</code> prefixed tables.</p> <pre><code>&lt;?php\n$I-&gt;seeTermInDatabase(['slug' =&gt; 'genre--fiction']);\n$I-&gt;seeTermInDatabase(['name' =&gt; 'Fiction', 'slug' =&gt; 'genre--fiction']);\n</code></pre>"},{"location":"modules/WPDb/#seetermmetaindatabase","title":"seeTermMetaInDatabase","text":"<p>Signature: <code>seeTermMetaInDatabase(array $criteria)</code> : <code>void</code> </p> <p>Checks for a term meta in the database.</p> <pre><code>&lt;?php\nlist($termId, $termTaxonomyId) = $I-&gt;haveTermInDatabase('fiction', 'genre');\n$I-&gt;haveTermMetaInDatabase($termId, 'rating', 4);\n$I-&gt;seeTermMetaInDatabase(['term_id' =&gt; $termId,'meta_key' =&gt; 'rating', 'meta_value' =&gt; 4]);\n</code></pre>"},{"location":"modules/WPDb/#seetermrelationshipindatabase","title":"seeTermRelationshipInDatabase","text":"<p>Signature: <code>seeTermRelationshipInDatabase(array $criteria)</code> : <code>void</code> </p> <p>Checks for a term relationship in the database.</p> <pre><code>&lt;?php\n$postId = $I-&gt;havePostInDatabase(['tax_input' =&gt; ['category' =&gt; 'one']]);\n$I-&gt;seeTermRelationshipInDatabase(['object_id' =&gt; $postId, 'term_taxonomy_id' =&gt; $oneTermTaxId]);\n</code></pre>"},{"location":"modules/WPDb/#seetermtaxonomyindatabase","title":"seeTermTaxonomyInDatabase","text":"<p>Signature: <code>seeTermTaxonomyInDatabase(array $criteria)</code> : <code>void</code> </p> <p>Checks for a taxonomy taxonomy in the database.</p> <pre><code>&lt;?php\nlist($termId, $termTaxonomyId) = $I-&gt;haveTermInDatabase('fiction', 'genre');\n$I-&gt;seeTermTaxonomyInDatabase(['term_id' =&gt; $termId, 'taxonomy' =&gt; 'genre']);\n</code></pre>"},{"location":"modules/WPDb/#seetransientindatabase","title":"seeTransientInDatabase","text":"<p>Signature: <code>seeTransientInDatabase(string $name, [mixed $value])</code> : <code>void</code> </p> <p>Checks that a transient is in the database.</p> <pre><code>&lt;?php\n$I-&gt;haveTransientInDatabase('foo', 23);\n$I-&gt;seeTransientInDatabase('foo');\n$I-&gt;seeTransientInDatabase('foo', 23);\n</code></pre>"},{"location":"modules/WPDb/#seeuserindatabase","title":"seeUserInDatabase","text":"<p>Signature: <code>seeUserInDatabase(array $criteria)</code> : <code>void</code> </p> <p>Checks that a user is in the database.</p> <p>The method will check the \"users\" table.</p> <pre><code>&lt;?php\n$I-&gt;seeUserInDatabase([\n    \"user_email\" =&gt; \"test@example.org\",\n    \"user_login\" =&gt; \"login name\"\n])\n</code></pre>"},{"location":"modules/WPDb/#seeusermetaindatabase","title":"seeUserMetaInDatabase","text":"<p>Signature: <code>seeUserMetaInDatabase(array $criteria)</code> : <code>void</code> </p> <p>Checks for a user meta value in the database.</p> <pre><code>&lt;?php\n$I-&gt;seeUserMetaInDatabase(['user_id' =&gt; 23, 'meta_key' =&gt; 'karma']);\n</code></pre>"},{"location":"modules/WPDb/#updateindatabase","title":"updateInDatabase","text":"<p>Signature: <code>updateInDatabase(string $table, array $data, [array $criteria])</code> : <code>void</code> </p> <p>Update an SQL record into a database.</p> <pre><code>&lt;?php\n$I-&gt;updateInDatabase('users', array('isAdmin' =&gt; true), array('email' =&gt; 'miles@davis.com'));\n</code></pre>"},{"location":"modules/WPDb/#useblog","title":"useBlog","text":"<p>Signature: <code>useBlog([int $blogId])</code> : <code>void</code> </p> <p>Sets the blog to be used.</p> <p>This has nothing to do with WordPress <code>switch_to_blog</code> function, this code will affect the table prefixes used.</p>"},{"location":"modules/WPDb/#usemainblog","title":"useMainBlog","text":"<p>Signature: <code>useMainBlog()</code> : <code>void</code> </p> <p>Sets the current blog to the main one (<code>blog_id</code> 1).</p> <pre><code>&lt;?php\n// Switch to the blog with ID 23.\n$I-&gt;useBlog(23);\n// Switch back to the main blog.\n$I-&gt;useMainBlog();\n</code></pre>"},{"location":"modules/WPDb/#usetheme","title":"useTheme","text":"<p>Signature: <code>useTheme(string $stylesheet, [?string $template], [?string $themeName])</code> : <code>void</code> </p> <p>Sets the current theme options.</p> <pre><code>&lt;?php\n$I-&gt;useTheme('twentyseventeen');\n$I-&gt;useTheme('child-of-twentyseventeen', 'twentyseventeen');\n$I-&gt;useTheme('acme', 'acme', 'Acme Theme');\n</code></pre> <p>Read more in Codeception documentation for the Db module.</p>"},{"location":"modules/WPFilesystem/","title":"WPFilesystem","text":""},{"location":"modules/WPFilesystem/#wpfilesystem-module","title":"WPFilesystem module","text":"<p>Interact and make assertions on the WordPress file structure.</p> <p>This module is used together with the WPDb module to manage the state of the WordPress installation in the context of end-to-end tests.</p> <p>This module extends the Filesystem module from Codeception, you can reference to the Codeception documentation to find out more about the module configuration and usage.</p> <p>This module should be with Cest and Cept test cases.</p>"},{"location":"modules/WPFilesystem/#configuration","title":"Configuration","text":"<p><code>wpRootFolder</code> - required; the path to the WordPress installation root folder. This can be a relative path to the codeception root directory, or an absolute path to the WordPress installation directory. The WordPress installation directory is the directory that contains the <code>wp-load.php</code> file. <code>themes</code> - the path, relative to the path specified in the <code>wpRootFolder</code> parameter, to the themes directory. By default, it's <code>/wp-content/themes</code>. <code>plugins</code> - the path, relative to the path specified in the <code>wpRootFolder</code> parameter, to the plugins directory. By default, it's <code>/wp-content/plugins</code>. <code>mu-plugins</code> - the path, relative to the path specified in the <code>wpRootFolder</code> parameter, to the must-use plugins. By default, it's <code>/wp-content/mu-plugins</code>. directory. <code>uploads</code> - the path, relative to the path specified in the <code>wpRootFolder</code> parameter, to the uploads directory. By default, it's <code>/wp-content/uploads</code>.</p> <p>The following is an example of the module configuration to run tests on the <code>/var/wordpress</code> site:</p> <pre><code>modules:\n  enabled:\n    lucatume\\WPBrowser\\Module\\WPFilesystem:\n      wpRootFolder: /var/wordpress\n      themes: wp-content/themes\n      plugins: wp-content/plugins\n      mu-plugins: wp-content/mu-plugins\n      uploads: wp-content/uploads\n</code></pre> <p>The following configuration uses dynamic configuration parameters to set the module configuration:</p> <pre><code>modules:\n  enabled:\n    lucatume\\WPBrowser\\Module\\WPFilesystem:\n      wpRootFolder: '%WP_ROOT_FOLDER%'\n</code></pre>"},{"location":"modules/WPFilesystem/#methods","title":"Methods","text":"<p>The module provides the following methods:</p>"},{"location":"modules/WPFilesystem/#aminmupluginpath","title":"amInMuPluginPath","text":"<p>Signature: <code>amInMuPluginPath(string $path)</code> : <code>void</code> </p> <p>Sets the current working folder to a folder in a mu-plugin.</p> <pre><code>$I-&gt;amInMuPluginPath('mu-plugin');\n</code></pre>"},{"location":"modules/WPFilesystem/#aminpath","title":"amInPath","text":"<p>Signature: <code>amInPath(string $path)</code> : <code>void</code> </p> <p>Enters a directory In local filesystem. Project root directory is used by default</p>"},{"location":"modules/WPFilesystem/#aminpluginpath","title":"amInPluginPath","text":"<p>Signature: <code>amInPluginPath(string $path)</code> : <code>void</code> </p> <p>Sets the current working folder to a folder in a plugin.</p> <pre><code>$I-&gt;amInPluginPath('my-plugin');\n</code></pre>"},{"location":"modules/WPFilesystem/#aminthemepath","title":"amInThemePath","text":"<p>Signature: <code>amInThemePath(string $path)</code> : <code>void</code> </p> <p>Sets the current working folder to a folder in a theme.</p> <pre><code>$I-&gt;amInThemePath('my-theme');\n</code></pre>"},{"location":"modules/WPFilesystem/#aminuploadspath","title":"amInUploadsPath","text":"<p>Signature: <code>amInUploadsPath([?string $path])</code> : <code>void</code> </p> <p>Enters, changing directory, to the uploads folder in the local filesystem.</p> <pre><code>&lt;?php\n$I-&gt;amInUploadsPath('/logs');\n$I-&gt;seeFileFound('shop.log');\n</code></pre>"},{"location":"modules/WPFilesystem/#assertdirectoryexists","title":"assertDirectoryExists","text":"<p>Signature: <code>assertDirectoryExists(string $directory, [string $message])</code> : <code>void</code></p>"},{"location":"modules/WPFilesystem/#cleandir","title":"cleanDir","text":"<p>Signature: <code>cleanDir(string $dirname)</code> : <code>void</code> </p> <p>Erases directory contents</p> <pre><code>&lt;?php\n$I-&gt;cleanDir('logs');\n</code></pre>"},{"location":"modules/WPFilesystem/#cleanmuplugindir","title":"cleanMuPluginDir","text":"<p>Signature: <code>cleanMuPluginDir(string $dir)</code> : <code>void</code> </p> <p>Cleans, emptying it, a folder in a mu-plugin folder.</p> <pre><code>$I-&gt;cleanMuPluginDir('mu-plugin1/foo');\n</code></pre>"},{"location":"modules/WPFilesystem/#cleanplugindir","title":"cleanPluginDir","text":"<p>Signature: <code>cleanPluginDir(string $dir)</code> : <code>void</code> </p> <p>Cleans, emptying it, a folder in a plugin folder.</p> <pre><code>$I-&gt;cleanPluginDir('my-plugin/foo');\n</code></pre>"},{"location":"modules/WPFilesystem/#cleanthemedir","title":"cleanThemeDir","text":"<p>Signature: <code>cleanThemeDir(string $dir)</code> : <code>void</code> </p> <p>Clears, emptying it, a folder in a theme folder.</p> <pre><code>$I-&gt;cleanThemeDir('my-theme/foo');\n</code></pre>"},{"location":"modules/WPFilesystem/#cleanuploadsdir","title":"cleanUploadsDir","text":"<p>Signature: <code>cleanUploadsDir([?string $dir], [DateTime|string|int|null $date])</code> : <code>void</code> </p> <p>Clears a folder in the uploads folder.</p> <p>The date argument can be a string compatible with <code>strtotime</code> or a Unix timestamp that will be used to build the <code>Y/m</code> uploads subfolder path.</p> <pre><code>$I-&gt;cleanUploadsDir('some/folder');\n$I-&gt;cleanUploadsDir('some/folder', 'today');\n</code></pre>"},{"location":"modules/WPFilesystem/#copydir","title":"copyDir","text":"<p>Signature: <code>copyDir(string $src, string $dst)</code> : <code>void</code> </p> <p>Copies directory with all contents</p> <pre><code>&lt;?php\n$I-&gt;copyDir('vendor','old_vendor');\n</code></pre>"},{"location":"modules/WPFilesystem/#copydirtomuplugin","title":"copyDirToMuPlugin","text":"<p>Signature: <code>copyDirToMuPlugin(string $src, string $pluginDst)</code> : <code>void</code> </p> <p>Copies a folder to a folder in a mu-plugin.</p> <pre><code>$I-&gt;copyDirToMuPlugin(codecept_data_dir('foo'), 'mu-plugin/foo');\n</code></pre>"},{"location":"modules/WPFilesystem/#copydirtoplugin","title":"copyDirToPlugin","text":"<p>Signature: <code>copyDirToPlugin(string $src, string $pluginDst)</code> : <code>void</code> </p> <p>Copies a folder to a folder in a plugin.</p> <pre><code>// Copy the 'foo' folder to the 'foo' folder in the plugin.\n$I-&gt;copyDirToPlugin(codecept_data_dir('foo'), 'my-plugin/foo');\n</code></pre>"},{"location":"modules/WPFilesystem/#copydirtotheme","title":"copyDirToTheme","text":"<p>Signature: <code>copyDirToTheme(string $src, string $themeDst)</code> : <code>void</code> </p> <p>Copies a folder in a theme folder.</p> <pre><code>$I-&gt;copyDirToTheme(codecept_data_dir('foo'), 'my-theme');\n</code></pre>"},{"location":"modules/WPFilesystem/#copydirtouploads","title":"copyDirToUploads","text":"<p>Signature: <code>copyDirToUploads(string $src, string $dst, [DateTime|string|int|null $date])</code> : <code>void</code> </p> <p>Copies a folder to the uploads folder.</p> <p>The date argument can be a string compatible with <code>strtotime</code> or a Unix timestamp that will be used to build the <code>Y/m</code> uploads subfolder path.</p> <pre><code>$I-&gt;copyDirToUploads(codecept_data_dir('foo'), 'uploadsFoo');\n$I-&gt;copyDirToUploads(codecept_data_dir('foo'), 'uploadsFoo', 'today');\n</code></pre>"},{"location":"modules/WPFilesystem/#deletedir","title":"deleteDir","text":"<p>Signature: <code>deleteDir(string $dirname)</code> : <code>void</code> </p> <p>Deletes directory with all subdirectories</p> <pre><code>&lt;?php\n$I-&gt;deleteDir('vendor');\n</code></pre>"},{"location":"modules/WPFilesystem/#deletefile","title":"deleteFile","text":"<p>Signature: <code>deleteFile(string $filename)</code> : <code>void</code> </p> <p>Deletes a file</p> <pre><code>&lt;?php\n$I-&gt;deleteFile('composer.lock');\n</code></pre>"},{"location":"modules/WPFilesystem/#deletemupluginfile","title":"deleteMuPluginFile","text":"<p>Signature: <code>deleteMuPluginFile(string $file)</code> : <code>void</code> </p> <p>Deletes a file in a mu-plugin folder.</p> <pre><code>$I-&gt;deleteMuPluginFile('mu-plugin1/some-file.txt');\n</code></pre>"},{"location":"modules/WPFilesystem/#deletepluginfile","title":"deletePluginFile","text":"<p>Signature: <code>deletePluginFile(string $file)</code> : <code>void</code> </p> <p>Deletes a file in a plugin folder.</p> <pre><code>$I-&gt;deletePluginFile('my-plugin/some-file.txt');\n</code></pre>"},{"location":"modules/WPFilesystem/#deletethemefile","title":"deleteThemeFile","text":"<p>Signature: <code>deleteThemeFile(string $file)</code> : <code>void</code> </p> <p>Deletes a file in a theme folder.</p> <pre><code>$I-&gt;deleteThemeFile('my-theme/some-file.txt');\n</code></pre>"},{"location":"modules/WPFilesystem/#deletethisfile","title":"deleteThisFile","text":"<p>Signature: <code>deleteThisFile()</code> : <code>void</code> </p> <p>Deletes a file</p>"},{"location":"modules/WPFilesystem/#deleteuploadeddir","title":"deleteUploadedDir","text":"<p>Signature: <code>deleteUploadedDir(string $dir, [DateTime|string|int|null $date])</code> : <code>void</code> </p> <p>Deletes a dir in the uploads folder.</p> <p>The date argument can be a string compatible with <code>strtotime</code> or a Unix timestamp that will be used to build the <code>Y/m</code> uploads subfolder path.</p> <pre><code>$I-&gt;deleteUploadedDir('folder');\n$I-&gt;deleteUploadedDir('folder', 'today');\n</code></pre>"},{"location":"modules/WPFilesystem/#deleteuploadedfile","title":"deleteUploadedFile","text":"<p>Signature: <code>deleteUploadedFile(string $file, [string|int|null $date])</code> : <code>void</code> </p> <p>Deletes a file in the uploads folder.</p> <p>The date argument can be a string compatible with <code>strtotime</code> or a Unix timestamp that will be used to build the <code>Y/m</code> uploads subfolder path.</p> <pre><code>$I-&gt;deleteUploadedFile('some-file.txt');\n$I-&gt;deleteUploadedFile('some-file.txt', 'today');\n</code></pre>"},{"location":"modules/WPFilesystem/#dontseefilefound","title":"dontSeeFileFound","text":"<p>Signature: <code>dontSeeFileFound(string $filename, [string $path])</code> : <code>void</code> </p> <p>Checks if file does not exist in path</p>"},{"location":"modules/WPFilesystem/#dontseeinmupluginfile","title":"dontSeeInMuPluginFile","text":"<p>Signature: <code>dontSeeInMuPluginFile(string $file, string $contents)</code> : <code>void</code> </p> <p>Checks that a file in a mu-plugin folder does not contain a string.</p> <pre><code>$I-&gt;dontSeeInMuPluginFile('mu-plugin1/some-file.txt', 'foo');\n</code></pre>"},{"location":"modules/WPFilesystem/#dontseeinpluginfile","title":"dontSeeInPluginFile","text":"<p>Signature: <code>dontSeeInPluginFile(string $file, string $contents)</code> : <code>void</code> </p> <p>Checks that a file in a plugin folder does not contain a string.</p> <pre><code>$I-&gt;dontSeeInPluginFile('my-plugin/some-file.txt', 'foo');\n</code></pre>"},{"location":"modules/WPFilesystem/#dontseeinthemefile","title":"dontSeeInThemeFile","text":"<p>Signature: <code>dontSeeInThemeFile(string $file, string $contents)</code> : <code>void</code> </p> <p>Checks that a file in a theme folder does not contain a string.</p> <pre><code>$I-&gt;dontSeeInThemeFile('my-theme/some-file.txt', 'foo');\n</code></pre>"},{"location":"modules/WPFilesystem/#dontseeinthisfile","title":"dontSeeInThisFile","text":"<p>Signature: <code>dontSeeInThisFile(string $text)</code> : <code>void</code> </p> <p>Checks If opened file doesn't contain <code>text</code> in it</p> <pre><code>&lt;?php\n$I-&gt;openFile('composer.json');\n$I-&gt;dontSeeInThisFile('codeception/codeception');\n</code></pre>"},{"location":"modules/WPFilesystem/#dontseeinuploadedfile","title":"dontSeeInUploadedFile","text":"<p>Signature: <code>dontSeeInUploadedFile(string $file, string $contents, [string|int|null $date])</code> : <code>void</code> </p> <p>Checks that a file in the uploads folder does contain a string.</p> <p>The date argument can be a string compatible with <code>strtotime</code> or a Unix timestamp that will be used to build the <code>Y/m</code> uploads subfolder path.</p> <pre><code>&lt;?php\n$I-&gt;dontSeeInUploadedFile('some-file.txt', 'foo');\n$I-&gt;dontSeeInUploadedFile('some-file.txt','foo', 'today');\n</code></pre>"},{"location":"modules/WPFilesystem/#dontseemupluginfilefound","title":"dontSeeMuPluginFileFound","text":"<p>Signature: <code>dontSeeMuPluginFileFound(string $file)</code> : <code>void</code> </p> <p>Checks that a file is not found in a mu-plugin folder.</p> <pre><code>$I-&gt;dontSeeMuPluginFileFound('mu-plugin1/some-file.txt');\n</code></pre>"},{"location":"modules/WPFilesystem/#dontseepluginfilefound","title":"dontSeePluginFileFound","text":"<p>Signature: <code>dontSeePluginFileFound(string $file)</code> : <code>void</code> </p> <p>Checks that a file is not found in a plugin folder.</p> <pre><code>$I-&gt;dontSeePluginFileFound('my-plugin/some-file.txt');\n</code></pre>"},{"location":"modules/WPFilesystem/#dontseethemefilefound","title":"dontSeeThemeFileFound","text":"<p>Signature: <code>dontSeeThemeFileFound(string $file)</code> : <code>void</code> </p> <p>Checks that a file is not found in a theme folder.</p> <pre><code>$I-&gt;dontSeeThemeFileFound('my-theme/some-file.txt');\n</code></pre>"},{"location":"modules/WPFilesystem/#dontseeuploadedfilefound","title":"dontSeeUploadedFileFound","text":"<p>Signature: <code>dontSeeUploadedFileFound(string $file, [string|int|null $date])</code> : <code>void</code> </p> <p>Checks thata a file does not exist in the uploads folder.</p> <p>The date argument can be a string compatible with <code>strtotime</code> or a Unix timestamp that will be used to build the <code>Y/m</code> uploads subfolder path.</p> <pre><code>$I-&gt;dontSeeUploadedFileFound('some-file.txt');\n$I-&gt;dontSeeUploadedFileFound('some-file.txt','today');\n</code></pre>"},{"location":"modules/WPFilesystem/#getbloguploadspath","title":"getBlogUploadsPath","text":"<p>Signature: <code>getBlogUploadsPath(int $blogId, [string $file], [DateTimeImmutable|DateTime|string|null $date])</code> : <code>string</code> </p> <p>Returns the absolute path to a blog uploads folder or file.</p> <pre><code>&lt;?php\n$blogId = $I-&gt;haveBlogInDatabase('test');\n$testTodayUploads = $I-&gt;getBlogUploadsPath($blogId);\n$testLastMonthLogs = $I-&gt;getBlogUploadsPath($blogId, '/logs', '-1 month');\n</code></pre>"},{"location":"modules/WPFilesystem/#getuploadspath","title":"getUploadsPath","text":"<p>Signature: <code>getUploadsPath([string $file], [mixed $date])</code> : <code>string</code> </p> <p>Returns the path to the specified uploads file of folder.</p> <p>Not providing a value for <code>$file</code> and <code>$date</code> will return the uploads folder path.</p> <pre><code>&lt;?php\n$todaysPath = $I-&gt;getUploadsPath();\n$lastWeek = $I-&gt;getUploadsPath('', '-1 week');\n</code></pre>"},{"location":"modules/WPFilesystem/#getwprootfolder","title":"getWpRootFolder","text":"<p>Signature: <code>getWpRootFolder()</code> : <code>string</code> </p> <p>Returns the absolute path to WordPress root folder without trailing slash.</p> <pre><code>&lt;?php\n$rootFolder = $I-&gt;getWpRootFolder();\n$I-&gt;assertFileExists($rootFolder . 'wp-load.php');\n</code></pre>"},{"location":"modules/WPFilesystem/#havemuplugin","title":"haveMuPlugin","text":"<p>Signature: <code>haveMuPlugin(string $filename, string $code)</code> : <code>void</code> </p> <p>Creates a mu-plugin file, including plugin header, in the mu-plugins folder.</p> <p>The code can not contain the opening '&lt;?php' tag.</p> <pre><code>$code = 'echo \"Hello world!\"';\n$I-&gt;haveMuPlugin('foo-mu-plugin.php', $code);\n// Load the code from a file.\n$code = file_get_contents(codecept_data_dir('code/mu-plugin.php'));\n$I-&gt;haveMuPlugin('foo-mu-plugin.php', $code);\n</code></pre>"},{"location":"modules/WPFilesystem/#haveplugin","title":"havePlugin","text":"<p>Signature: <code>havePlugin(string $path, string $code)</code> : <code>void</code> </p> <p>Creates a plugin file, including plugin header, in the plugins folder.</p> <p>The plugin is just created and not activated; the code can not contain the opening '&lt;?php' tag.</p> <pre><code>$code = 'echo \"Hello world!\"';\n$I-&gt;havePlugin('foo/plugin.php', $code);\n// Load the code from a file.\n$code = file_get_contents(codecept_data_dir('code/plugin.php'));\n$I-&gt;havePlugin('foo/plugin.php', $code);\n</code></pre>"},{"location":"modules/WPFilesystem/#havetheme","title":"haveTheme","text":"<p>Signature: <code>haveTheme(string $folder, string $indexFileCode, [string $functionsFileCode])</code> : <code>void</code> </p> <p>Creates a theme file structure, including theme style file and index, in the themes folder.</p> <p>The theme is just created and not activated; the code can not contain the opening '&lt;?php' tag.</p> <pre><code>$code = 'sayHi();';\n$functionsCode  = 'function sayHi(){echo \"Hello world\";};';\n$I-&gt;haveTheme('foo', $indexCode, $functionsCode);\n// Load the code from a file.\n$indexCode = file_get_contents(codecept_data_dir('code/index.php'));\n$functionsCode = file_get_contents(codecept_data_dir('code/functions.php'));\n$I-&gt;haveTheme('foo', $indexCode, $functionsCode);\n</code></pre>"},{"location":"modules/WPFilesystem/#makeuploadsdir","title":"makeUploadsDir","text":"<p>Signature: <code>makeUploadsDir(string $path)</code> : <code>string</code> </p> <p>Creates an empty folder in the WordPress installation uploads folder.</p> <pre><code>&lt;?php\n$logsDir = $I-&gt;makeUploadsDir('logs/acme');\n</code></pre>"},{"location":"modules/WPFilesystem/#openfile","title":"openFile","text":"<p>Signature: <code>openFile(string $filename)</code> : <code>void</code> </p> <p>Opens a file and stores it's content.</p> <p>Usage:</p> <pre><code>&lt;?php\n$I-&gt;openFile('composer.json');\n$I-&gt;seeInThisFile('codeception/codeception');\n</code></pre>"},{"location":"modules/WPFilesystem/#openuploadedfile","title":"openUploadedFile","text":"<p>Signature: <code>openUploadedFile(string $filename, [DateTime|string|int|null $date])</code> : <code>void</code> </p> <p>Opens a file in the the uploads folder.</p> <p>The date argument can be a string compatible with <code>strtotime</code> or a Unix timestamp that will be used to build the <code>Y/m</code> uploads subfolder path.</p> <pre><code>$I-&gt;openUploadedFile('some-file.txt');\n$I-&gt;openUploadedFile('some-file.txt', 'time');\n</code></pre>"},{"location":"modules/WPFilesystem/#seefilecontentsequal","title":"seeFileContentsEqual","text":"<p>Signature: <code>seeFileContentsEqual(string $text)</code> : <code>void</code> </p> <p>Checks the strict matching of file contents. Unlike <code>seeInThisFile</code> will fail if file has something more than expected lines. Better to use with HEREDOC strings. Matching is done after removing \"\\r\" chars from file content.</p> <pre><code>&lt;?php\n$I-&gt;openFile('process.pid');\n$I-&gt;seeFileContentsEqual('3192');\n</code></pre>"},{"location":"modules/WPFilesystem/#seefilefound","title":"seeFileFound","text":"<p>Signature: <code>seeFileFound(string $filename, [string $path])</code> : <code>void</code> </p> <p>Checks if file exists in path. Opens a file when it's exists</p> <pre><code>&lt;?php\n$I-&gt;seeFileFound('UserModel.php','app/models');\n</code></pre>"},{"location":"modules/WPFilesystem/#seeinmupluginfile","title":"seeInMuPluginFile","text":"<p>Signature: <code>seeInMuPluginFile(string $file, string $contents)</code> : <code>void</code> </p> <p>Checks that a file in a mu-plugin folder contains a string.</p> <pre><code>$I-&gt;seeInMuPluginFile('mu-plugin1/some-file.txt', 'foo');\n</code></pre>"},{"location":"modules/WPFilesystem/#seeinpluginfile","title":"seeInPluginFile","text":"<p>Signature: <code>seeInPluginFile(string $file, string $contents)</code> : <code>void</code> </p> <p>Checks that a file in a plugin folder contains a string.</p> <pre><code>$I-&gt;seeInPluginFile('my-plugin/some-file.txt', 'foo');\n</code></pre>"},{"location":"modules/WPFilesystem/#seeinthemefile","title":"seeInThemeFile","text":"<p>Signature: <code>seeInThemeFile(string $file, string $contents)</code> : <code>void</code> </p> <p>Checks that a file in a theme folder contains a string.</p> <pre><code>&lt;?php\n$I-&gt;seeInThemeFile('my-theme/some-file.txt', 'foo');\n?&gt;\n</code></pre>"},{"location":"modules/WPFilesystem/#seeinthisfile","title":"seeInThisFile","text":"<p>Signature: <code>seeInThisFile(string $text)</code> : <code>void</code> </p> <p>Checks If opened file has <code>text</code> in it.</p> <p>Usage:</p> <pre><code>&lt;?php\n$I-&gt;openFile('composer.json');\n$I-&gt;seeInThisFile('codeception/codeception');\n</code></pre>"},{"location":"modules/WPFilesystem/#seeinuploadedfile","title":"seeInUploadedFile","text":"<p>Signature: <code>seeInUploadedFile(string $file, string $contents, [string|int|null $date])</code> : <code>void</code> </p> <p>Checks that a file in the uploads folder contains a string.</p> <p>The date argument can be a string compatible with <code>strtotime</code> or a Unix timestamp that will be used to build the <code>Y/m</code> uploads subfolder path.</p> <pre><code>&lt;?php\n$I-&gt;seeInUploadedFile('some-file.txt', 'foo');\n$I-&gt;seeInUploadedFile('some-file.txt','foo', 'today');\n</code></pre>"},{"location":"modules/WPFilesystem/#seemupluginfilefound","title":"seeMuPluginFileFound","text":"<p>Signature: <code>seeMuPluginFileFound(string $file)</code> : <code>void</code> </p> <p>Checks that a file is found in a mu-plugin folder.</p> <pre><code>$I-&gt;seeMuPluginFileFound('mu-plugin1/some-file.txt');\n</code></pre>"},{"location":"modules/WPFilesystem/#seenumbernewlines","title":"seeNumberNewLines","text":"<p>Signature: <code>seeNumberNewLines(int $number)</code> : <code>void</code> </p> <p>Checks If opened file has the <code>number</code> of new lines.</p> <p>Usage:</p> <pre><code>&lt;?php\n$I-&gt;openFile('composer.json');\n$I-&gt;seeNumberNewLines(5);\n</code></pre>"},{"location":"modules/WPFilesystem/#seepluginfilefound","title":"seePluginFileFound","text":"<p>Signature: <code>seePluginFileFound(string $file)</code> : <code>void</code> </p> <p>Checks that a file is found in a plugin folder.</p> <pre><code>$I-&gt;seePluginFileFound('my-plugin/some-file.txt');\n</code></pre>"},{"location":"modules/WPFilesystem/#seethemefilefound","title":"seeThemeFileFound","text":"<p>Signature: <code>seeThemeFileFound(string $file)</code> : <code>void</code> </p> <p>Checks that a file is found in a theme folder.</p> <pre><code>$I-&gt;seeThemeFileFound('my-theme/some-file.txt');\n</code></pre>"},{"location":"modules/WPFilesystem/#seethisfilematches","title":"seeThisFileMatches","text":"<p>Signature: <code>seeThisFileMatches(string $regex)</code> : <code>void</code> </p> <p>Checks that contents of currently opened file matches $regex</p>"},{"location":"modules/WPFilesystem/#seeuploadedfilefound","title":"seeUploadedFileFound","text":"<p>Signature: <code>seeUploadedFileFound(string $filename, [string|int|null $date])</code> : <code>void</code> </p> <p>Checks if file exists in the uploads folder.</p> <p>The date argument can be a string compatible with <code>strtotime</code> or a Unix timestamp that will be used to build the <code>Y/m</code> uploads subfolder path.</p> <pre><code>&lt;?php\n$I-&gt;seeUploadedFileFound('some-file.txt');\n$I-&gt;seeUploadedFileFound('some-file.txt','today');\n?&gt;\n</code></pre>"},{"location":"modules/WPFilesystem/#writetofile","title":"writeToFile","text":"<p>Signature: <code>writeToFile(string $filename, string $contents)</code> : <code>void</code> </p> <p>Saves contents to file</p>"},{"location":"modules/WPFilesystem/#writetomupluginfile","title":"writeToMuPluginFile","text":"<p>Signature: <code>writeToMuPluginFile(string $file, string $data)</code> : <code>void</code> </p> <p>Writes a file in a mu-plugin folder.</p> <pre><code>$I-&gt;writeToMuPluginFile('mu-plugin1/some-file.txt', 'foo');\n</code></pre>"},{"location":"modules/WPFilesystem/#writetopluginfile","title":"writeToPluginFile","text":"<p>Signature: <code>writeToPluginFile(string $file, string $data)</code> : <code>void</code> </p> <p>Writes a file in a plugin folder.</p> <pre><code>$I-&gt;writeToPluginFile('my-plugin/some-file.txt', 'foo');\n</code></pre>"},{"location":"modules/WPFilesystem/#writetothemefile","title":"writeToThemeFile","text":"<p>Signature: <code>writeToThemeFile(string $file, string $data)</code> : <code>void</code> </p> <p>Writes a string to a file in a theme folder.</p> <pre><code>$I-&gt;writeToThemeFile('my-theme/some-file.txt', 'foo');\n</code></pre>"},{"location":"modules/WPFilesystem/#writetouploadedfile","title":"writeToUploadedFile","text":"<p>Signature: <code>writeToUploadedFile(string $filename, string $data, [DateTime|string|int|null $date])</code> : <code>string</code> </p> <p>Writes a string to a file in the the uploads folder.</p> <p>The date argument can be a string compatible with <code>strtotime</code> or a Unix timestamp that will be used to build the <code>Y/m</code> uploads subfolder path.</p> <pre><code>$I-&gt;writeToUploadedFile('some-file.txt', 'foo bar');\n$I-&gt;writeToUploadedFile('some-file.txt', 'foo bar', 'today');\n</code></pre> <p>Read more in Codeception documentation.</p>"},{"location":"modules/WPLoader/","title":"WPLoader","text":""},{"location":"modules/WPLoader/#wploader-module","title":"WPLoader module","text":"<p>A module to load WordPress and make its code available in tests.</p> <p>Depending on the value of the <code>loadOnly</code> configuration parameter, the module will behave differently:</p> <ul> <li><code>loadOnly: false</code> - The module will load WordPress like the Core PHPUnit suite does to run integration tests in a   controlled environment. Use the module in this mode with test cases generated   using the <code>generate:wpunit</code> command.</li> <li><code>loadOnly: true</code> - The module will load WordPress to make it available in the context of tests. Use the module in this   mode in Cest, Cept and Codeception unit test cases.</li> </ul>"},{"location":"modules/WPLoader/#configuration-with-loadonly-false","title":"Configuration with loadOnly: false","text":"<p>The module will load WordPress like the Core PHPUnit suite does to run integration tests in a controlled environment. Together with the test case generated by the <code>generate:wpunit</code> command the module will:</p> <ul> <li>take care of running any test method in a database transaction rolled back after each test</li> <li>manage and clean up the global environment and context between tests</li> </ul> <p>Note</p> <p>The module will set the environment variable <code>WPBROWSER_LOAD_ONLY=0</code> when running in this mode. This environment variable can be used to detect whether WordPress is being loaded by WPBrowser and in which mode.</p> <p>When used in this mode, the module supports the following configuration parameters:</p> <ul> <li><code>loadOnly</code> - <code>false</code> to load WordPress and run tests in a controlled environment.</li> <li><code>wpRootFolder</code> - required; the path to the WordPress installation root folder. This can be a relative path to the   codeception root directory, or an absolute path to the WordPress installation directory. The WordPress installation   directory is the directory that contains the <code>wp-load.php</code> file.</li> <li><code>dbUrl</code> - required; the URL to the database to use to run tests. The URL must be in the form   <code>mysql://username:password@host:port/database</code> to use a MySQL database, or in the form <code>sqlite://path/to/database</code> to   use a SQLite database. Alternatively, you can use the <code>dbName</code>, <code>dbUser</code>, <code>dbPassword</code>, <code>dbHost</code> configuration   parameters to specify the database connection details.</li> <li><code>dump</code> - the path to a database dump, or a set of database dumps, to load before running tests. The dump will be   loaded only once, after the tests run.</li> <li><code>tablePrefix</code> - the database table prefix to use when loading WordPress, defaults to <code>wp_</code>.</li> <li><code>multisite</code> - a boolean value to indicate if WordPress should be loaded and initialized in multisite mode.</li> <li><code>dbCharset</code> - the database charset to use when loading WordPress.</li> <li><code>dbCollate</code> - the database collate to use when loading WordPress.</li> <li><code>domain</code> - the domain to use when loading WordPress. Equivalent to defining the <code>WP_TESTS_DOMAIN</code> constant.</li> <li><code>adminEmail</code> - the administrator email to use when loading WordPress. Equivalent to defining the <code>WP_TESTS_EMAIL</code>   constant.</li> <li><code>title</code> - the site title to use when loading WordPress. Equivalent to defining the <code>WP_TESTS_TITLE</code> constant.</li> <li><code>phpBinary</code> - the path to the PHP binary to use to run tests. Defaults to the <code>WP_PHP_BINARY</code> constant.</li> <li><code>language</code> - the language to use when loading WordPress. Equivalent to defining the <code>WPLANG</code> constant.</li> <li><code>configFile</code> - a configuration file, or a set of configuration files, to load before the tests to further customize   and control the WordPress testing environment. This file(s) will be loaded before the WordPress installation is loaded.</li> <li><code>pluginsFolder</code> - the path to the plugins folder to use when loading WordPress. Equivalent to defining the   <code>WP_PLUGIN_DIR</code> constant. If both this parameter and the <code>WP_PLUGIN_DIR</code> parameter are set, the <code>WP_PLUGIN_DIR</code>   parameter will override the value of this one.</li> <li><code>WP_CONTENT_DIR</code> - the path to the content folder to use when loading WordPress in the context of tests. If the   installation used by the <code>WPLoader</code> module defines a <code>WP_CONTENT_DIR</code> constant in its <code>wp-config.php</code> file, the module   will throw an exception if this parameter is set. Setting this parameter will affect the <code>WP_PLUGIN_DIR</code> and the <code>WPMU_PLUGIN_DIR</code>   parameters.</li> <li><code>WP_PLUGIN_DIR</code> - the path to the plugins folder to use when loading WordPress in the context of tests. If the   installation used by the <code>WPLoader</code> module defines a <code>WP_PLUGIN_DIR</code> constant in its <code>wp-config.php</code> file, the module   will throw an exception if this parameter is set.</li> <li><code>WPMU_PLUGIN_DIR</code> - the path to the mu-plugins folder to use when loading WordPress in the context of tests. If the   installation used by the <code>WPLoader</code> module defines a <code>WPMU_PLUGIN_DIR</code> constant in its <code>wp-config.php</code> file, the module   will throw an exception if this parameter is set.</li> <li><code>plugins</code> - a list of plugins to activate and load in the WordPress installation. If the plugin is located in the   WordPress installation plugins directory, then the plugin name can be specified using the <code>directory/file.php</code> format.   If the plugin is located in an arbitrary path inside or outiside of the WordPress installation or project, then the   plugin name must be specified either as an absolute path or as a relative path to the project root folder.</li> <li><code>silentlyActivatePlugins</code> - a list of plugins to activate silently, without firing their activation hooks.   Depending on the plugin, a silent activation might cause the plugin to not work correctly. The list must be in the   same format as the <code>plugins</code> parameter and plugin should be activated silently only if they are not working correctly   during normal activation and are known to work correctly when activated silently. Plugin paths can be specified   following the same format of the <code>plugins</code> parameter.</li> <li><code>bootstrapActions</code> - a list of actions or callables to call after WordPress is loaded and before the tests run.</li> <li><code>theme</code> - the theme to activate and load in the WordPress installation. The theme can be specified in slug format,   e.g., <code>twentytwentythree</code>, to load it from the WordPress installation themes directory. Alternatively, the theme can   be specified as an absolute or relative path to a theme folder, e.g., <code>/home/themes/my-theme</code>   or <code>vendor/acme/vendor-theme</code>. To use both a parent and ha child theme from arbitrary absolute or relative paths,   define the <code>theme</code> parameter as an array of theme paths, e.g., <code>['/home/themes/parent-theme', '.']</code>.</li> <li><code>AUTH_KEY</code> - the <code>AUTH_KEY</code> constant value to use when loading WordPress. If the <code>wpRootFolder</code> path points at a   configured installation, containing the <code>wp-config.php</code> file, then the value of the constant in the configuration file   will be used, else it will be randomly generated.</li> <li><code>SECURE_AUTH_KEY</code> - the <code>SECURE_AUTH_KEY</code> constant value to use when loading WordPress. If the <code>wpRootFolder</code> path   points at a configured installation, containing the <code>wp-config.php</code> file, then the value of the constant in the   configuration file will be used, else it will be randomly generated.</li> <li><code>LOGGED_IN_KEY</code> - the <code>LOGGED_IN_KEY</code> constant value to use when loading WordPress. If the <code>wpRootFolder</code> path points   at a configured installation, containing the <code>wp-config.php</code> file, then the value of the constant in the configuration   file will be used, else it will be randomly generated.</li> <li><code>NONCE_KEY</code> - the <code>NONCE_KEY</code> constant value to use when loading WordPress. If the <code>wpRootFolder</code> path points at a   configured installation, containing the <code>wp-config.php</code> file, then the value of the constant in the configuration file   will be used, else it will be randomly generated.</li> <li><code>AUTH_SALT</code> - the <code>AUTH_SALT</code> constant value to use when loading WordPress. If the <code>wpRootFolder</code> path points at a   configured installation, containing the <code>wp-config.php</code> file, then the value of the constant in the configuration file   will be used, else it will be randomly generated.</li> <li><code>SECURE_AUTH_SALT</code> - the <code>SECURE_AUTH_SALT</code> constant value to use when loading WordPress. If the <code>wpRootFolder</code> path   points at a configured installation, containing the <code>wp-config.php</code> file, then the value of the constant in the   configuration file will be used, else it will be randomly generated.</li> <li><code>LOGGED_IN_SALT</code> - the <code>LOGGED_IN_SALT</code> constant value to use when loading WordPress. If the <code>wpRootFolder</code> path   points at a configured installation, containing the <code>wp-config.php</code> file, then the value of the constant in the   configuration file will be used, else it will be randomly generated.</li> <li><code>NONCE_SALT</code> - the <code>NONCE_SALT</code> constant value to use when loading WordPress. If the <code>wpRootFolder</code> path points at a   configured installation, containing the <code>wp-config.php</code> file, then the value of the constant in the configuration file   will be used, else it will be randomly generated.</li> <li><code>AUTOMATIC_UPDATER_DISABLED</code> - the <code>AUTOMATIC_UPDATER_DISABLED</code> constant value to use when loading WordPress. If   the <code>wpRootFolder</code> path points at a configured installation, containing the <code>wp-config.php</code> file, then the value of   the constant in the configuration file will be used, else it will be randomly generated.</li> <li><code>WP_HTTP_BLOCK_EXTERNAL</code> - the <code>WP_HTTP_BLOCK_EXTERNAL</code> constant value to use when loading WordPress. If   the <code>wpRootFolder</code> path points at a configured installation, containing the <code>wp-config.php</code> file, then the value of   the constant in the configuration file will be used, else it will be randomly generated.</li> <li><code>backupGlobals</code> - a boolean value to indicate if the global environment should be backed up before each test. Defaults   to <code>true</code>. The globals' backup involves serialization of the global state, plugins or themes that define classes   developed to prevent serialization of the global state will cause the tests to fail. Set this parameter to <code>false</code> to   disable the global environment backup, or use a more refined approach setting the <code>backupGlobalsExcludeList</code> parameter   below. Note that a test case that is explicitly setting the <code>backupGlobals</code> property will override this configuration   parameter.</li> <li><code>backupGlobalsExcludeList</code> - a list of global variables to exclude from the global environment backup. The list must   be in the form of array, and it will be merged to the list of globals excluded by default.</li> <li><code>backupStaticAttributes</code> - a boolean value to indicate if static attributes of classes should be backed up before each   test. Defaults to <code>true</code>. The static attributes' backup involves serialization of the global state, plugins or themes   that define classes developed to prevent serialization of the global state will cause the tests to fail. Set this   parameter to <code>false</code> to disable the static attributes backup, or use a more refined approanch setting   the <code>backupStaticAttributesExcludeList</code> parameter below. Note that a test case that is explicitly setting   the <code>backupStaticAttributes</code> property will override this configuration parameter.</li> <li><code>backupStaticAttributesExcludeList</code> - a list of classes to exclude from the static attributes backup. The list must be   in the form of map from class names to the array of method names to exclude from the backup. See an example below.</li> <li><code>skipInstall</code> - a boolean value to indicate if the WordPress installation should be skipped between runs, when already   installed. Defaults to <code>false</code>. During boot, the <code>WPLoader</code> module will re-install WordPress and activate, on top of   the fresh installation, any plugin and theme specified in the <code>plugins</code> and <code>theme</code> configuration parameters: this can   be a time-consuming operation. Set this parameter to <code>true</code> to run the WordPress installation once and just load it on   the following runs. To force the installation to run again, rerun the suite using the WPLoader module using   the <code>--debug</code> flag or delete the <code>_wploader-state.sql</code> file in the suite directory. This configuration parameter is   ignored when the <code>loadOnly</code> parameter is set to <code>true</code>.</li> <li><code>beStrictAboutWpdbConnectionId</code> - a boolean value to indicate if the <code>WPTestCase</code> class should throw an exception if   the database connection is closed during any <code>setUpBeforeClass</code> method; default is <code>true</code>.</li> </ul> <p>This is an example of an integration suite configured to use the module:</p> <pre><code>actor: IntegrationTester\nbootstrap: _bootstrap.php\nmodules:\n  enabled:\n    - \\Helper\\Integration\n    - lucatume\\WPBrowser\\Module\\WPLoader:\n        wpRootFolder: /var/wordpress\n        dbUrl: mysql://root:root@mysql:3306/wordpress\n        tablePrefix: test_\n        domain: wordpress.test\n        adminEmail: admin@wordpress.test\n        title: 'Integration Tests'\n        plugins:\n          # This plugin will be loaded from the WordPress installation plugins directory.\n          - hello.php\n          # This plugin will be loaded from an arbitrary absolute path.\n          - /home/plugins/woocommerce/woocommerce.php\n          # This plugin will be loaded from an arbitrary relative path inside the project root folder.\n          - vendor/acme/project/plugin.php\n          # This plugin will be loaded from the project root folder.\n          - my-plugin.php\n        theme: twentytwentythree # Load the theme from the WordPress installation themes directory.\n</code></pre> <p>The following configuration uses dynamic configuration parameters to set the module configuration:</p> <pre><code>actor: IntegrationTester\nbootstrap: _bootstrap.php\nmodules:\n  enabled:\n    - \\Helper\\Integration\n    - lucatume\\WPBrowser\\Module\\WPLoader:\n        wpRootFolder: '%WP_ROOT_FOLDER%'\n        dbUrl: '%WP_DB_URL%'\n        tablePrefix: '%WP_TABLE_PREFIX%'\n        domain: '%WP_DOMAIN%'\n        adminEmail: '%WP_ADMIN_EMAIL%'\n        title: '%WP_TITLE%'\n        plugins:\n          - hello.php\n          - /home/plugins/woocommerce/woocommerce.php\n          - my-plugin.php\n          - vendor/acme/project/plugin.php\n        # Parent theme from the WordPress installation themes directory, child theme from absolute path.\n        theme: [ twentytwentythree, /home/themes/my-theme ]\n</code></pre> <p>The following example configuration uses a SQLite database and loads a database fixture before the tests run:</p> <pre><code>actor: IntegrationTester\nbootstrap: _bootstrap.php\nmodules:\n  enabled:\n    - \\Helper\\Integration\n    - lucatume\\WPBrowser\\Module\\WPLoader:\n        wpRootFolder: /var/wordpress\n        dbUrl: sqlite:///var/wordpress/wp-tests.sqlite\n        dump:\n          - tests/_data/products.sql\n          - tests/_data/users.sql\n          - tests/_data/orders.sql\n        tablePrefix: test_\n        domain: wordpress.test\n        adminEmail: admin@wordpress.test\n        title: 'Integration Tests'\n        plugins:\n          - hello.php\n          - woocommerce/woocommerce.php\n          - my-plugin/my-plugin.php\n        theme:\n          # Parent theme from relative path.\n          - vendor/acme/parent-theme\n          # Child theme from the current working directory.\n          - .\n</code></pre> <p>The follow example configuration prevents the backup of globals and static attributes in all the tests of the suite that are not explicitly overriding the <code>backupGlobals</code> and <code>backupStaticAttributes</code> properties:</p> <pre><code>actor: IntegrationTester\nbootstrap: _bootstrap.php\nmodules:\n  enabled:\n    - \\Helper\\Integration\n    - lucatume\\WPBrowser\\Module\\WPLoader:\n        wpRootFolder: /var/wordpress\n        dbUrl: sqlite:///var/wordpress/wp-tests.sqlite\n        dump:\n          - tests/_data/products.sql\n          - tests/_data/users.sql\n          - tests/_data/orders.sql\n        tablePrefix: test_\n        domain: wordpress.test\n        adminEmail: admin@wordpress.test\n        title: 'Integration Tests'\n        plugins:\n          - hello.php\n          - woocommerce/woocommerce.php\n          - my-plugin/my-plugin.php\n        theme: twentytwentythree\n        backupGlobals: false\n        backupStaticAttributes: false \n</code></pre> <p>The following configuration prevents the backup of some globals and static attributes:</p> <pre><code>actor: IntegrationTester\nbootstrap: _bootstrap.php\nmodules:\n  enabled:\n    - \\Helper\\Integration\n    - lucatume\\WPBrowser\\Module\\WPLoader:\n        wpRootFolder: /var/wordpress\n        dbUrl: sqlite:///var/wordpress/wp-tests.sqlite\n        dump:\n          - tests/_data/products.sql\n          - tests/_data/users.sql\n          - tests/_data/orders.sql\n        tablePrefix: test_\n        domain: wordpress.test\n        adminEmail: admin@wordpress.test\n        title: 'Integration Tests'\n        plugins:\n          - hello.php\n          - woocommerce/woocommerce.php\n          - my-plugin/my-plugin.php\n        theme: twentytwentythree\n        backupGlobalsExcludeList:\n          - my_plugin_will_explode_on_wakeup\n          - another_problematic_global\n        backupStaticAttributesExcludeList:\n          - MyPlugin\\MyClass:\n              - instance\n              - anotherStaticAttributeThatWillExplodeOnWakeup\n          - AnotherPlugin\\AnotherClass:\n              - instance\n              - yetAnotherStaticAttributeThatWillExplodeOnWakeup\n</code></pre>"},{"location":"modules/WPLoader/#handling-a-custom-site-structure","title":"Handling a custom site structure","text":"<p>The setup process should just work for standard and non-standard WordPress installations alike.</p> <p>Even if you're working on a site project using a custom file structure, e.g. Bedrock, you will be able to set up your site to run tests using the default configuration based on PHP built-in server, Chromedriver and SQLite database.</p>"},{"location":"modules/WPLoader/#configuration-with-loadonly-true","title":"Configuration with loadOnly: true","text":"<p>The module will load WordPress from the location specified by the <code>wpRootFolder</code> parameter, relying on the WPDb module to manage the database state.</p> <p>Note</p> <p>The module will set the environment variable <code>WPBROWSER_LOAD_ONLY=1</code> when running in this mode. This environment variable can be used to detect whether WordPress is being loaded by WPBrowser and in which mode.</p> <p>When used in this mode, the module supports the following configuration parameters:</p> <ul> <li><code>loadOnly</code> - <code>true</code> to load WordPress and make it available in the context of tests.</li> <li><code>wpRootFolder</code> - required; the path to the WordPress installation root folder. This can be a relative path to the   codeception root directory, or an absolute path to the WordPress installation directory. The WordPress installation   directory is the directory that contains the <code>wp-load.php</code> file.</li> <li><code>dbUrl</code> - required; the URL to the database to use to run tests. The URL must be in the form   <code>mysql://username:password@host:port/database</code> to use a MySQL database, or in the form <code>sqlite://path/to/database</code> to   use a SQLite database. Alternatively, you can use the <code>dbName</code>, <code>dbUser</code>, <code>dbPassword</code>, <code>dbHost</code> configuration   parameters to specify the database connection details.</li> <li><code>domain</code> - the domain to use when loading WordPress. Equivalent to defining the <code>WP_TESTS_DOMAIN</code> constant.</li> <li><code>configFile</code> - a configuration file, or a set of configuration files, to load before the tests to further customize   and control the WordPress testing environment. This file(s) will be loaded before the WordPress installation is loaded.</li> </ul> <p>Note</p> <p>The order of the modules matters. In your suite configuration file place the <code>WPDb</code> module before the <code>WPLoader</code> one to make sure the <code>WPDb</code> module will correctly set up the database fixture before the <code>WPLoader</code> modules attempts to load WordPress from it.</p> <p>Warning</p> <p>The module will define the <code>DB_NAME</code>, <code>DB_USER</code>, <code>DB_PASSWORD</code> and <code>DB_HOST</code> constants in the context of loading WordPress. This is done to allow the WordPress database connection to be configured using the <code>dbUrl</code> configuration parameter. The module will silence the warnings about the redeclaration of these constants, but in some cases with stricter error checking (e.g. Bedrock) this may not be enough. In those cases, you can use the <code>WPBROWSER_LOAD_ONLY</code> environment variable to detect whether WordPress is being loaded by WPBrowser and in which mode and configured your installation accordingly.</p> <p>The following is an example of the module configuration to run end-to-end tests on the site served at <code>http://localhost:8080</code> URL and served from the  <code>/var/wordpress</code> directory:</p> <pre><code>actor: EndToEndTester\nbootstrap: _bootstrap.php\nmodules:\n  enabled:\n    - \\Helper\\Integration\n    - lucatume\\WPBrowser\\Module\\WPWebDriver:\n        url: 'http://localhost:8080'\n        adminUsername: 'admin'\n        adminPassword: 'password'\n        adminPath: '/wp-admin'\n        browser: chrome\n        host: 'localhost'\n        port: '4444'\n        path: '/'\n        window_size: false\n        capabilities:\n          \"goog:chromeOptions\":\n            args:\n              - \"--headless\"\n              - \"--disable-gpu\"\n              - \"--disable-dev-shm-usage\"\n              - \"--proxy-server='direct://'\"\n              - \"--proxy-bypass-list=*\"\n              - \"--no-sandbox\"\n    - lucatume\\WPBrowser\\Module\\WPDb: # WPDb module before the WPLoader one: position matters!\n        dbUrl: 'mysql://root:password@localhost:3306/wordpress'\n        url: 'http://localhost:8080'\n        tablePrefix: 'wp_'\n        dump: 'tests/_data/dump.sql'\n        populate: true\n        cleanup: true\n        reconnect: false\n        urlReplacement: true\n        originalUrl: http://wordpress.test\n        waitlock: 10\n        createIfNotExists: true\n    - lucatume\\WPBrowser\\Module\\WPLoader:\n        loadOnly: true\n        wpRootFolder: /var/wordpress\n        dbUrl: 'mysql://root:password@localhost:3306/wordpress'\n        domain: wordpress.test\n</code></pre>"},{"location":"modules/WPLoader/#methods","title":"Methods","text":"<p>The module provides the following methods:</p>"},{"location":"modules/WPLoader/#factory","title":"factory","text":"<p>Signature: <code>factory()</code> : <code>lucatume\\WPBrowser\\Module\\WPLoader\\FactoryStore</code></p> <p>Accessor method to get the object storing the factories for things. This method gives access to the same factories provided by the Core test suite.</p>"},{"location":"modules/WPLoader/#getcontentfolder","title":"getContentFolder","text":"<p>Signature: <code>getContentFolder([string $path])</code> : <code>string</code></p> <p>Returns the absolute path to the WordPress content directory.</p>"},{"location":"modules/WPLoader/#getinstallation","title":"getInstallation","text":"<p>Signature: <code>getInstallation()</code> : <code>lucatume\\WPBrowser\\WordPress\\Installation</code></p>"},{"location":"modules/WPLoader/#getpluginsfolder","title":"getPluginsFolder","text":"<p>Signature: <code>getPluginsFolder([string $path])</code> : <code>string</code></p> <p>Returns the absolute path to the plugins directory.</p> <p>The value will first look at the <code>WP_PLUGIN_DIR</code> constant, then the <code>pluginsFolder</code> configuration parameter and will, finally, look in the default path from the WordPress root directory.</p>"},{"location":"modules/WPLoader/#getthemesfolder","title":"getThemesFolder","text":"<p>Signature: <code>getThemesFolder([string $path])</code> : <code>string</code></p> <p>Returns the absolute path to the themes directory.</p>"},{"location":"modules/WPLoader/#getwprootfolder","title":"getWpRootFolder","text":"<p>Signature: <code>getWpRootFolder([?string $path])</code> : <code>string</code></p> <p>Returns the absolute path to the WordPress root folder or a path within it..</p>"},{"location":"modules/WPQueries/","title":"WPQueries","text":""},{"location":"modules/WPQueries/#wpqueries-module","title":"WPQueries module","text":"<p>This module provides assertions for WordPress queries.</p> <p>This module can be used in any test context where the global <code>$wpdb</code> variable is defined, this usually means in any suite where the WPLoader module is used.</p>"},{"location":"modules/WPQueries/#configuration","title":"Configuration","text":"<p>The method does not require configuration.</p>"},{"location":"modules/WPQueries/#methods","title":"Methods","text":"<p>The module provides the following methods:</p>"},{"location":"modules/WPQueries/#assertcountqueries","title":"assertCountQueries","text":"<p>Signature: <code>assertCountQueries(int $n, [string $message])</code> : <code>void</code> </p> <p>Asserts that n queries have been made.</p> <pre><code>&lt;?php\n$posts = $this-&gt;factory()-&gt;post-&gt;create_many(3);\n$cachedUsers = $this-&gt;factory()-&gt;user-&gt;create_many(2);\n$nonCachedUsers = $this-&gt;factory()-&gt;user-&gt;create_many(2);\nforeach($cachedUsers as $userId){\n     wp_cache_set('page-posts-for-user-' . $userId, $posts, 'acme');\n}\n// Run the same query as different users\nforeach(array_merge($cachedUsers, $nonCachedUsers) as $userId){\n     $pagePosts = $plugin-&gt;getPagePostsForUser($userId);\n}\n$I-&gt;assertCountQueries(2, 'A query should be made for each user missing cached posts.')\n</code></pre>"},{"location":"modules/WPQueries/#assertnotqueries","title":"assertNotQueries","text":"<p>Signature: <code>assertNotQueries([string $message])</code> : <code>void</code> </p> <p>Asserts that no queries were made.</p> <p>Queries generated by <code>setUp</code>, <code>tearDown</code> and <code>factory</code> methods are excluded by default.</p> <pre><code>&lt;?php\n$posts = $this-&gt;factory()-&gt;post-&gt;create_many(3);\nwp_cache_set('page-posts', $posts, 'acme');\n$pagePosts = $plugin-&gt;getPagePosts();\n$I-&gt;assertNotQueries('Queries should not be made if the cache is set.')\n</code></pre>"},{"location":"modules/WPQueries/#assertnotqueriesbyaction","title":"assertNotQueriesByAction","text":"<p>Signature: <code>assertNotQueriesByAction(string $action, [string $message])</code> : <code>void</code> </p> <p>Asserts that no queries were made as a consequence of the specified action.</p> <p>Queries generated by <code>setUp</code>, <code>tearDown</code> and <code>factory</code> methods are excluded by default.</p> <pre><code>&lt;?php\nadd_action( 'edit_post', function($postId){\n        $count = get_option('acme_title_updates_count');\n        update_option('acme_title_updates_count', ++$count);\n} );\nwp_delete_post($bookId);\n$this-&gt;assertNotQueriesByAction('edit_post');\n</code></pre>"},{"location":"modules/WPQueries/#assertnotqueriesbyfilter","title":"assertNotQueriesByFilter","text":"<p>Signature: <code>assertNotQueriesByFilter(string $filter, [string $message])</code> : <code>void</code> </p> <p>Asserts that no queries were made as a consequence of the specified filter.</p> <p>Queries generated by <code>setUp</code>, <code>tearDown</code> and <code>factory</code> methods are excluded by default.</p> <pre><code>&lt;?php\nadd_filter('the_title', function($title, $postId){\n     $post = get_post($postId);\n     if($post-&gt;post_type !== 'book'){\n         return $title;\n     }\n     $new = get_option('acme_new_prefix');\n     return \"{$new} - \" . $title;\n});\n$title = apply_filters('the_title', get_post($notABookId)-&gt;post_title, $notABookId);\n$this-&gt;assertNotQueriesByFilter('the_title');\n</code></pre>"},{"location":"modules/WPQueries/#assertnotqueriesbyfunction","title":"assertNotQueriesByFunction","text":"<p>Signature: <code>assertNotQueriesByFunction(string $function, [string $message])</code> : <code>void</code> </p> <p>Asserts that no queries were made by the specified function.</p> <p>Queries generated by <code>setUp</code>, <code>tearDown</code> and <code>factory</code> methods are excluded by default.</p> <pre><code>&lt;?php\n$this-&gt;assertEmpty(Acme\\get_orphaned_posts());\nAcme\\delete_orphaned_posts();\n$this-&gt;assertNotQueriesByFunction('Acme\\delete_orphaned_posts');\n</code></pre>"},{"location":"modules/WPQueries/#assertnotqueriesbymethod","title":"assertNotQueriesByMethod","text":"<p>Signature: <code>assertNotQueriesByMethod(string $class, string $method, [string $message])</code> : <code>void</code> </p> <p>Asserts that no queries have been made by the specified class method.</p> <p>Queries generated by <code>setUp</code>, <code>tearDown</code> and <code>factory</code> methods are excluded by default.</p> <pre><code>&lt;?php\n$options = new Acme\\Options();\n$options-&gt;update('adsSource', 'not-a-real-url.org');\n$I-&gt;assertNotQueriesByMethod('Acme\\Options', 'update');\n</code></pre>"},{"location":"modules/WPQueries/#assertnotqueriesbystatement","title":"assertNotQueriesByStatement","text":"<p>Signature: <code>assertNotQueriesByStatement(string $statement, [string $message])</code> : <code>void</code> </p> <p>Asserts that no queries have been made by the specified class method.</p> <p>Queries generated by <code>setUp</code>, <code>tearDown</code> and <code>factory</code> methods are excluded by default.</p> <pre><code>&lt;?php\n$bookRepository = new Acme\\BookRepository();\n$repository-&gt;where('ID', 23)-&gt;set('title', 'Peter Pan', $deferred = true);\n$this-&gt;assertNotQueriesByStatement('INSERT', 'Deferred write should happen on __destruct');\n</code></pre>"},{"location":"modules/WPQueries/#assertnotqueriesbystatementandaction","title":"assertNotQueriesByStatementAndAction","text":"<p>Signature: <code>assertNotQueriesByStatementAndAction(string $statement, string $action, [string $message])</code> : <code>void</code> </p> <p>Asserts that no queries were made as a consequence of the specified action containing the SQL query.</p> <p>Queries generated by <code>setUp</code>, <code>tearDown</code> and <code>factory</code> methods are excluded by default.</p> <pre><code>&lt;?php\nadd_action( 'edit_post', function($postId){\n        $count = get_option('acme_title_updates_count');\n        update_option('acme_title_updates_count', ++$count);\n} );\nwp_delete_post($bookId);\n$this-&gt;assertNotQueriesByStatementAndAction('DELETE', 'delete_post');\n</code></pre>"},{"location":"modules/WPQueries/#assertnotqueriesbystatementandfilter","title":"assertNotQueriesByStatementAndFilter","text":"<p>Signature: <code>assertNotQueriesByStatementAndFilter(string $statement, string $filter, [string $message])</code> : <code>void</code> </p> <p>Asserts that no queries were made as a consequence of the specified filter containing the specified SQL query.</p> <p>Queries generated by <code>setUp</code>, <code>tearDown</code> and <code>factory</code> methods are excluded by default.</p> <pre><code>&lt;?php\nadd_filter('the_title', function($title, $postId){\n     $post = get_post($postId);\n     if($post-&gt;post_type !== 'book'){\n         return $title;\n     }\n     $new = get_option('acme_new_prefix');\n     return \"{$new} - \" . $title;\n});\n$title = apply_filters('the_title', get_post($notABookId)-&gt;post_title, $notABookId);\n$this-&gt;assertNotQueriesByStatementAndFilter('SELECT', 'the_title');\n</code></pre>"},{"location":"modules/WPQueries/#assertnotqueriesbystatementandfunction","title":"assertNotQueriesByStatementAndFunction","text":"<p>Signature: <code>assertNotQueriesByStatementAndFunction(string $statement, string $function, [string $message])</code> : <code>void</code> </p> <p>Asserts that no queries were made by the specified function starting with the specified SQL statement.</p> <p>Queries generated by <code>setUp</code>, <code>tearDown</code> and <code>factory</code> methods are excluded by default.</p> <pre><code>&lt;?php\nwp_insert_post(['ID' =&gt; $bookId, 'post_title' =&gt; 'The Call of the Wild']);\n$this-&gt;assertNotQueriesByStatementAndFunction('INSERT', 'wp_insert_post');\n$this-&gt;assertQueriesByStatementAndFunction('UPDATE', 'wp_insert_post');\n</code></pre>"},{"location":"modules/WPQueries/#assertnotqueriesbystatementandmethod","title":"assertNotQueriesByStatementAndMethod","text":"<p>Signature: <code>assertNotQueriesByStatementAndMethod(string $statement, string $class, string $method, [string $message])</code> : <code>void</code> </p> <p>Asserts that no queries were made by the specified class method starting with the specified SQL statement.</p> <p>Queries generated by <code>setUp</code>, <code>tearDown</code> and <code>factory</code> methods are excluded by default.</p> <pre><code>&lt;?php\nAcme\\BookRepository::new(['title' =&gt; 'Alice in Wonderland'])-&gt;commit();\n$this-&gt;assertQueriesByStatementAndMethod('INSERT', Acme\\BookRepository::class, 'commit');\n</code></pre>"},{"location":"modules/WPQueries/#assertqueries","title":"assertQueries","text":"<p>Signature: <code>assertQueries([string $message])</code> : <code>void</code> </p> <p>Asserts that at least one query was made during the test.</p> <p>Queries generated by <code>setUp</code>, <code>tearDown</code> and <code>factory</code> methods are excluded by default.</p> <pre><code>&lt;?php\nwp_cache_delete('page-posts', 'acme');\n$pagePosts = $plugin-&gt;getPagePosts();\n$I-&gt;assertQueries('Queries should be made to set the cache.')\n</code></pre>"},{"location":"modules/WPQueries/#assertqueriesbyaction","title":"assertQueriesByAction","text":"<p>Signature: <code>assertQueriesByAction(string $action, [string $message])</code> : <code>void</code> </p> <p>Asserts that at least one query was made as a consequence of the specified action.</p> <p>Queries generated by <code>setUp</code>, <code>tearDown</code> and <code>factory</code> methods are excluded by default.</p> <pre><code>&lt;?php\nadd_action( 'edit_post', function($postId){\n        $count = get_option('acme_title_updates_count');\n        update_option('acme_title_updates_count', ++$count);\n} );\nwp_update_post(['ID' =&gt; $bookId, 'post_title' =&gt; 'New Title']);\n$this-&gt;assertQueriesByAction('edit_post');\n</code></pre>"},{"location":"modules/WPQueries/#assertqueriesbyfilter","title":"assertQueriesByFilter","text":"<p>Signature: <code>assertQueriesByFilter(string $filter, [string $message])</code> : <code>void</code> </p> <p>Asserts that at least one query was made as a consequence of the specified filter.</p> <p>Queries generated by <code>setUp</code>, <code>tearDown</code> and <code>factory</code> methods are excluded by default.</p> <pre><code>&lt;?php\nadd_filter('the_title', function($title, $postId){\n     $post = get_post($postId);\n     if($post-&gt;post_type !== 'book'){\n         return $title;\n     }\n     $new = get_option('acme_new_prefix');\n     return \"{$new} - \" . $title;\n});\n$title = apply_filters('the_title', get_post($bookId)-&gt;post_title, $bookId);\n$this-&gt;assertQueriesByFilter('the_title');\n</code></pre>"},{"location":"modules/WPQueries/#assertqueriesbyfunction","title":"assertQueriesByFunction","text":"<p>Signature: <code>assertQueriesByFunction(string $function, [string $message])</code> : <code>void</code> </p> <p>Asserts that queries were made by the specified function.</p> <p>Queries generated by <code>setUp</code>, <code>tearDown</code> and <code>factory</code> methods are excluded by default.</p> <pre><code>&lt;?php\nacme_clean_queue();\n$this-&gt;assertQueriesByFunction('acme_clean_queue');\n</code></pre>"},{"location":"modules/WPQueries/#assertqueriesbymethod","title":"assertQueriesByMethod","text":"<p>Signature: <code>assertQueriesByMethod(string $class, string $method, [string $message])</code> : <code>void</code> </p> <p>Asserts that at least one query has been made by the specified class method.</p> <p>Queries generated by <code>setUp</code>, <code>tearDown</code> and <code>factory</code> methods are excluded by default.</p> <pre><code>&lt;?php\n$options = new Acme\\Options();\n$options-&gt;update('showAds', false);\n$I-&gt;assertQueriesByMethod('Acme\\Options', 'update');\n</code></pre>"},{"location":"modules/WPQueries/#assertqueriesbystatement","title":"assertQueriesByStatement","text":"<p>Signature: <code>assertQueriesByStatement(string $statement, [string $message])</code> : <code>void</code> </p> <p>Asserts that at least a query starting with the specified statement was made.</p> <p>Queries generated by <code>setUp</code>, <code>tearDown</code> and <code>factory</code> methods are excluded by default.</p> <pre><code>&lt;?php\nwp_cache_flush();\ncached_get_posts($args);\n$I-&gt;assertQueriesByStatement('SELECT');\n</code></pre>"},{"location":"modules/WPQueries/#assertqueriesbystatementandaction","title":"assertQueriesByStatementAndAction","text":"<p>Signature: <code>assertQueriesByStatementAndAction(string $statement, string $action, [string $message])</code> : <code>void</code> </p> <p>Asserts that at least one query was made as a consequence of the specified action containing the SQL query.</p> <p>Queries generated by <code>setUp</code>, <code>tearDown</code> and <code>factory</code> methods are excluded by default.</p> <pre><code>&lt;?php\nadd_action( 'edit_post', function($postId){\n        $count = get_option('acme_title_updates_count');\n        update_option('acme_title_updates_count', ++$count);\n} );\nwp_update_post(['ID' =&gt; $bookId, 'post_title' =&gt; 'New']);\n$this-&gt;assertQueriesByStatementAndAction('UPDATE', 'edit_post');\n</code></pre>"},{"location":"modules/WPQueries/#assertqueriesbystatementandfilter","title":"assertQueriesByStatementAndFilter","text":"<p>Signature: <code>assertQueriesByStatementAndFilter(string $statement, string $filter, [string $message])</code> : <code>void</code> </p> <p>Asserts that at least one query was made as a consequence of the specified filter containing the SQL query.</p> <p>Queries generated by <code>setUp</code>, <code>tearDown</code> and <code>factory</code> methods are excluded by default.</p> <pre><code>&lt;?php\nadd_filter('the_title', function($title, $postId){\n     $post = get_post($postId);\n     if($post-&gt;post_type !== 'book'){\n         return $title;\n     }\n     $new = get_option('acme_new_prefix');\n     return \"{$new} - \" . $title;\n});\n$title = apply_filters('the_title', get_post($bookId)-&gt;post_title, $bookId);\n$this-&gt;assertQueriesByStatementAndFilter('SELECT', 'the_title');\n</code></pre>"},{"location":"modules/WPQueries/#assertqueriesbystatementandfunction","title":"assertQueriesByStatementAndFunction","text":"<p>Signature: <code>assertQueriesByStatementAndFunction(string $statement, string $function, [string $message])</code> : <code>void</code> </p> <p>Asserts that queries were made by the specified function starting with the specified SQL statement.</p> <p>Queries generated by <code>setUp</code>, <code>tearDown</code> and <code>factory</code> methods are excluded by default.</p> <pre><code>&lt;?php\nwp_insert_post(['post_type' =&gt; 'book', 'post_title' =&gt; 'Alice in Wonderland']);\n$this-&gt;assertQueriesByStatementAndFunction('INSERT', 'wp_insert_post');\n</code></pre>"},{"location":"modules/WPQueries/#assertqueriesbystatementandmethod","title":"assertQueriesByStatementAndMethod","text":"<p>Signature: <code>assertQueriesByStatementAndMethod(string $statement, string $class, string $method, [string $message])</code> : <code>void</code> </p> <p>Asserts that queries were made by the specified class method starting with the specified SQL statement.</p> <p>Queries generated by <code>setUp</code>, <code>tearDown</code> and <code>factory</code> methods are excluded by default.</p> <pre><code>&lt;?php\nAcme\\BookRepository::new(['title' =&gt; 'Alice in Wonderland'])-&gt;commit();\n$this-&gt;assertQueriesByStatementAndMethod('UPDATE', Acme\\BookRepository::class, 'commit');\n</code></pre>"},{"location":"modules/WPQueries/#assertqueriescountbyaction","title":"assertQueriesCountByAction","text":"<p>Signature: <code>assertQueriesCountByAction(int $n, string $action, [string $message])</code> : <code>void</code> </p> <p>Asserts that n queries were made as a consequence of the specified action.</p> <p>Queries generated by <code>setUp</code>, <code>tearDown</code> and <code>factory</code> methods are excluded by default.</p> <pre><code>&lt;?php\nadd_action( 'edit_post', function($postId){\n        $count = get_option('acme_title_updates_count');\n        update_option('acme_title_updates_count', ++$count);\n} );\nwp_update_post(['ID' =&gt; $bookOneId, 'post_title' =&gt; 'One']);\nwp_update_post(['ID' =&gt; $bookTwoId, 'post_title' =&gt; 'Two']);\nwp_update_post(['ID' =&gt; $bookThreeId, 'post_title' =&gt; 'Three']);\n$this-&gt;assertQueriesCountByAction(3, 'edit_post');\n</code></pre>"},{"location":"modules/WPQueries/#assertqueriescountbyfilter","title":"assertQueriesCountByFilter","text":"<p>Signature: <code>assertQueriesCountByFilter(int $n, string $filter, [string $message])</code> : <code>void</code> </p> <p>Asserts that n queries were made as a consequence of the specified filter.</p> <p>Queries generated by <code>setUp</code>, <code>tearDown</code> and <code>factory</code> methods are excluded by default.</p> <pre><code>&lt;?php\nadd_filter('the_title', function($title, $postId){\n     $post = get_post($postId);\n     if($post-&gt;post_type !== 'book'){\n         return $title;\n     }\n     $new = get_option('acme_new_prefix');\n     return \"{$new} - \" . $title;\n});\n$title = apply_filters('the_title', get_post($bookOneId)-&gt;post_title, $bookOneId);\n$title = apply_filters('the_title', get_post($notABookId)-&gt;post_title, $notABookId);\n$title = apply_filters('the_title', get_post($bookTwoId)-&gt;post_title, $bookTwoId);\n$this-&gt;assertQueriesCountByFilter(2, 'the_title');\n</code></pre>"},{"location":"modules/WPQueries/#assertqueriescountbyfunction","title":"assertQueriesCountByFunction","text":"<p>Signature: <code>assertQueriesCountByFunction(int $n, string $function, [string $message])</code> : <code>void</code> </p> <p>Asserts that n queries were made by the specified function.</p> <p>Queries generated by <code>setUp</code>, <code>tearDown</code> and <code>factory</code> methods are excluded by default.</p> <pre><code>&lt;?php\n$this-&gt;assertCount(3, Acme\\get_orphaned_posts());\nAcme\\delete_orphaned_posts();\n$this-&gt;assertQueriesCountByFunction(3, 'Acme\\delete_orphaned_posts');\n</code></pre>"},{"location":"modules/WPQueries/#assertqueriescountbymethod","title":"assertQueriesCountByMethod","text":"<p>Signature: <code>assertQueriesCountByMethod(int $n, string $class, string $method, [string $message])</code> : <code>void</code> </p> <p>Asserts that n queries have been made by the specified class method.</p> <p>Queries generated by <code>setUp</code>, <code>tearDown</code> and <code>factory</code> methods are excluded by default.</p> <pre><code>&lt;?php\n$bookRepository = new Acme\\BookRepository();\n$repository-&gt;where('ID', 23)-&gt;commit('title', 'Peter Pan');\n$repository-&gt;where('ID', 89)-&gt;commit('title', 'Moby-dick');\n$repository-&gt;where('ID', 2389)-&gt;commit('title', 'The call of the wild');\n$this-&gt;assertQueriesCountByMethod(3, 'Acme\\BookRepository', 'commit');\n</code></pre>"},{"location":"modules/WPQueries/#assertqueriescountbystatement","title":"assertQueriesCountByStatement","text":"<p>Signature: <code>assertQueriesCountByStatement(int $n, string $statement, [string $message])</code> : <code>void</code> </p> <p>Asserts that n queries starting with the specified statement were made.</p> <p>Queries generated by <code>setUp</code>, <code>tearDown</code> and <code>factory</code> methods are excluded by default.</p> <pre><code>&lt;?php\n$bookRepository = new Acme\\BookRepository();\n$repository-&gt;where('ID', 23)-&gt;set('title', 'Peter Pan', $deferred = true);\n$repository-&gt;where('ID', 89)-&gt;set('title', 'Moby-dick', $deferred = true);\n$repository-&gt;where('ID', 2389)-&gt;set('title', 'The call of the wild', $deferred = false);\n$this-&gt;assertQueriesCountByStatement(1, 'INSERT', 'Deferred write should happen on __destruct');\n</code></pre>"},{"location":"modules/WPQueries/#assertqueriescountbystatementandaction","title":"assertQueriesCountByStatementAndAction","text":"<p>Signature: <code>assertQueriesCountByStatementAndAction(int $n, string $statement, string $action, [string $message])</code> : <code>void</code> </p> <p>Asserts that n queries were made as a consequence of the specified action containing the specified SQL statement.</p> <p>Queries generated by <code>setUp</code>, <code>tearDown</code> and <code>factory</code> methods are excluded by default.</p> <pre><code>&lt;?php\nadd_action( 'edit_post', function($postId){\n        $count = get_option('acme_title_updates_count');\n        update_option('acme_title_updates_count', ++$count);\n} );\nwp_delete_post($bookOneId);\nwp_delete_post($bookTwoId);\nwp_update_post(['ID' =&gt; $bookThreeId, 'post_title' =&gt; 'New']);\n$this-&gt;assertQueriesCountByStatementAndAction(2, 'DELETE', 'delete_post');\n$this-&gt;assertQueriesCountByStatementAndAction(1, 'INSERT', 'edit_post');\n</code></pre>"},{"location":"modules/WPQueries/#assertqueriescountbystatementandfilter","title":"assertQueriesCountByStatementAndFilter","text":"<p>Signature: <code>assertQueriesCountByStatementAndFilter(int $n, string $statement, string $filter, [string $message])</code> : <code>void</code> </p> <p>Asserts that n queries were made as a consequence of the specified filter containing the specified SQL statement.</p> <p>Queries generated by <code>setUp</code>, <code>tearDown</code> and <code>factory</code> methods are excluded by default.</p> <pre><code>&lt;?php\nadd_filter('the_title', function($title, $postId){\n     $post = get_post($postId);\n     if($post-&gt;post_type !== 'book'){\n         return $title;\n     }\n     $new = get_option('acme_new_prefix');\n     return \"{$new} - \" . $title;\n});\n// Warm up the cache.\n$title = apply_filters('the_title', get_post($bookOneId)-&gt;post_title, $bookOneId);\n// Cache is warmed up now.\n$title = apply_filters('the_title', get_post($bookTwoId)-&gt;post_title, $bookTwoId);\n$title = apply_filters('the_title', get_post($bookThreeId)-&gt;post_title, $bookThreeId);\n$this-&gt;assertQueriesCountByStatementAndFilter(1, 'SELECT', 'the_title');\n</code></pre>"},{"location":"modules/WPQueries/#assertqueriescountbystatementandfunction","title":"assertQueriesCountByStatementAndFunction","text":"<p>Signature: <code>assertQueriesCountByStatementAndFunction(int $n, string $statement, string $function, [string $message])</code> : <code>void</code> </p> <p>Asserts that n queries were made by the specified function starting with the specified SQL statement.</p> <p>Queries generated by <code>setUp</code>, <code>tearDown</code> and <code>factory</code> methods are excluded by default.</p> <pre><code>&lt;?php\nwp_insert_post(['post_type' =&gt; 'book', 'post_title' =&gt; 'The Call of the Wild']);\nwp_insert_post(['post_type' =&gt; 'book', 'post_title' =&gt; 'Alice in Wonderland']);\nwp_insert_post(['post_type' =&gt; 'book', 'post_title' =&gt; 'The Chocolate Factory']);\n$this-&gt;assertQueriesCountByStatementAndFunction(3, 'INSERT', 'wp_insert_post');\n</code></pre>"},{"location":"modules/WPQueries/#assertqueriescountbystatementandmethod","title":"assertQueriesCountByStatementAndMethod","text":"<p>Signature: <code>assertQueriesCountByStatementAndMethod(int $n, string $statement, string $class, string $method, [string $message])</code> : <code>void</code> </p> <p>Asserts that n queries were made by the specified class method starting with the specified SQL statement.</p> <p>Queries generated by <code>setUp</code>, <code>tearDown</code> and <code>factory</code> methods are excluded by default.</p> <pre><code>&lt;?php\nAcme\\BookRepository::new(['title' =&gt; 'Alice in Wonderland'])-&gt;commit();\nAcme\\BookRepository::new(['title' =&gt; 'Moby-Dick'])-&gt;commit();\nAcme\\BookRepository::new(['title' =&gt; 'The Call of the Wild'])-&gt;commit();\n$this-&gt;assertQueriesCountByStatementAndMethod(3, 'INSERT', Acme\\BookRepository::class, 'commit');\n</code></pre>"},{"location":"modules/WPQueries/#countqueries","title":"countQueries","text":"<p>Signature: <code>countQueries([?wpdb $wpdb])</code> : <code>int</code> </p> <p>Returns the current number of queries. Set-up and tear-down queries performed by the test case are filtered out.</p> <pre><code>&lt;?php\n// In a WPTestCase, using the global $wpdb object.\n$queriesCount = $this-&gt;queries()-&gt;countQueries();\n// In a WPTestCase, using a custom $wpdb object.\n$queriesCount = $this-&gt;queries()-&gt;countQueries($customWdbb);\n</code></pre>"},{"location":"modules/WPQueries/#getqueries","title":"getQueries","text":"<p>Signature: <code>getQueries([?wpdb $wpdb])</code> : <code>array</code> </p> <p>Returns the queries currently performed by the global database object or the specified one. Set-up and tear-down queries performed by the test case are filtered out.</p> <pre><code>&lt;?php\n// In a WPTestCase, using the global $wpdb object.\n$queries = $this-&gt;queries()-&gt;getQueries();\n// In a WPTestCase, using a custom $wpdb object.\n$queries = $this-&gt;queries()-&gt;getQueries($customWdbb);\n</code></pre>"},{"location":"modules/WPWebDriver/","title":"WPWebDriver","text":""},{"location":"modules/WPWebDriver/#wpwebdriver-module","title":"WPWebDriver module","text":"<p>This module drives a browser using a solution like Selenium or Chromedriver to simulate user interactions with the WordPress project.</p> <p>The module has full Javascript support, differently from the WPBrowser module, and can be used to test sites that use Javascript to render the page or to make assertions that require Javascript support.</p> <p>The method extends the Codeception WebDriver module and is used in the context of Cest and Cept test cases.</p>"},{"location":"modules/WPWebDriver/#configuration","title":"Configuration","text":"<ul> <li><code>browser</code> - the browser to use; e.g. 'chrome'</li> <li><code>host</code> - the host to use; e.g. 'localhost'. This is the host of the Selenium server or the Chromedriver server.</li> <li><code>port</code> - the port to use; e.g. '4444'. This is the port of the Selenium server or the Chromedriver server.</li> <li><code>path</code> - the path to use; e.g. '/wd/hub' or '/'. Use '/' for Chrome.</li> <li><code>url</code> - required; the start URL of your WordPress project.</li> <li><code>adminUsername</code> - required; the site administrator username to use in actions like <code>loginAsAdmin</code>.</li> <li><code>adminPassword</code> - required; the site administrator password to use in actions like <code>loginAsAdmin</code>.</li> <li><code>adminPath</code> - the path to the WordPress admin directory; defaults to <code>/wp-admin</code>.</li> </ul> <p>More configuration options, and their explanation, are available in the Codeception WebDriver module documentation.</p> <p>The following is an example of the module configuration to run tests on the<code>http://localhost:8080</code> site:</p> <pre><code>modules:\n  enabled:\n    lucatume\\WPBrowser\\Module\\WPBrowser:\n      url: 'http://localhost:8080'\n      adminUsername: 'admin'\n      adminPassword: 'password'\n      adminPath: '/wp-admin'\n      browser: chrome\n      host: 'localhost'\n      port: '4444'\n      path: '/'\n      window_size: false\n      capabilities:\n        \"goog:chromeOptions\":\n          args:\n            - \"--headless\"\n            - \"--disable-gpu\"\n            - \"--disable-dev-shm-usage\"\n            - \"--proxy-server='direct://'\"\n            - \"--proxy-bypass-list=*\"\n            - \"--no-sandbox\"\n</code></pre> <p>The following configuration uses dynamic configuration parameters to set the module configuration:</p> <pre><code>modules:\n  enabled:\n    lucatume\\WPBrowser\\Module\\WPBrowser:\n      url: 'http://localhost:8080'\n      adminUsername: 'admin'\n      adminPassword: 'password'\n      adminPath: '/wp-admin'\n      browser: chrome\n      host: '%CHROME_HOST%'\n      port: '%CHROME_PORT%'\n      path: '/'\n      window_size: `1920,1080`\n      capabilities:\n        \"goog:chromeOptions\":\n          args:\n            - \"--headless\"\n            - \"--disable-gpu\"\n            - \"--disable-dev-shm-usage\"\n            - \"--proxy-server='direct://'\"\n            - \"--proxy-bypass-list=*\"\n            - \"--no-sandbox\"\n</code></pre> <p>Furthermore, the above configuration will not run Chrome in headless mode: the browser window will be visible.</p>"},{"location":"modules/WPWebDriver/#methods","title":"Methods","text":"<p>The module provides the following methods:</p>"},{"location":"modules/WPWebDriver/#acceptpopup","title":"acceptPopup","text":"<p>Signature: <code>acceptPopup()</code> : <code>void</code> </p> <p>Accepts the active JavaScript native popup window, as created by <code>window.alert</code>|<code>window.confirm</code>|<code>window.prompt</code>. Don't confuse popups with modal windows, as created by various libraries.</p>"},{"location":"modules/WPWebDriver/#activateplugin","title":"activatePlugin","text":"<p>Signature: <code>activatePlugin(array|string $pluginSlug)</code> : <code>void</code> </p> <p>In the plugin administration screen activates one or more plugins clicking the \"Activate\" link.</p> <p>The method will not handle authentication and navigation to the plugins administration page.</p> <pre><code>&lt;?php\n// Activate a plugin.\n$I-&gt;loginAsAdmin();\n$I-&gt;amOnPluginsPage();\n$I-&gt;activatePlugin('hello-dolly');\n// Activate a list of plugins.\n$I-&gt;loginAsAdmin();\n$I-&gt;amOnPluginsPage();\n$I-&gt;activatePlugin(['hello-dolly','another-plugin']);\n</code></pre>"},{"location":"modules/WPWebDriver/#activatetheme","title":"activateTheme","text":"<p>Signature: <code>activateTheme(string $slug)</code> : <code>void</code> </p> <p>Activates a theme.</p> <p>The method will not handle authentication and navigation to the themes administration page.</p>"},{"location":"modules/WPWebDriver/#ameditingpostwithid","title":"amEditingPostWithId","text":"<p>Signature: <code>amEditingPostWithId(int $id)</code> : <code>void</code> </p> <p>Go to the admin page to edit the post with the specified ID.</p> <p>The method will not handle authentication the admin area.</p> <pre><code>&lt;?php\n$I-&gt;loginAsAdmin();\n$postId = $I-&gt;havePostInDatabase();\n$I-&gt;amEditingPostWithId($postId);\n$I-&gt;fillField('post_title', 'Post title');\n</code></pre>"},{"location":"modules/WPWebDriver/#ameditinguserwithid","title":"amEditingUserWithId","text":"<p>Signature: <code>amEditingUserWithId(int $id)</code> : <code>void</code> </p> <p>Go to the admin page to edit the user with the specified ID.</p> <p>The method will not handle authentication the admin area.</p> <pre><code>&lt;?php\n$I-&gt;loginAsAdmin();\n$userId = $I-&gt;haveUserInDatabase('luca', 'editor');\n$I-&gt;amEditingUserWithId($userId);\n$I-&gt;fillField('email', 'new@example.net');\n</code></pre>"},{"location":"modules/WPWebDriver/#amonadminajaxpage","title":"amOnAdminAjaxPage","text":"<p>Signature: <code>amOnAdminAjaxPage([array|string|null $queryVars])</code> : <code>void</code> </p> <p>Go to the <code>admin-ajax.php</code> page to start a synchronous, and blocking, <code>GET</code> AJAX request.</p> <p>The method will not handle authentication, nonces or authorization.</p> <pre><code>&lt;?php\n$I-&gt;amOnAdminAjaxPage(['action' =&gt; 'my-action', 'data' =&gt; ['id' =&gt; 23], 'nonce' =&gt; $nonce]);\n</code></pre>"},{"location":"modules/WPWebDriver/#amonadminpage","title":"amOnAdminPage","text":"<p>Signature: <code>amOnAdminPage(string $page)</code> : <code>void</code> </p> <p>Go to a page in the admininstration area of the site.</p> <p>This method will not handle authentication to the administration area.</p> <pre><code>&lt;?php\n$I-&gt;loginAs('user', 'password');\n// Go to the plugins management screen.\n$I-&gt;amOnAdminPage('/plugins.php');\n</code></pre>"},{"location":"modules/WPWebDriver/#amoncronpage","title":"amOnCronPage","text":"<p>Signature: <code>amOnCronPage([array|string|null $queryVars])</code> : <code>void</code> </p> <p>Go to the cron page to start a synchronous, and blocking, <code>GET</code> request to the cron script.</p> <pre><code>&lt;?php\n// Triggers the cron job with an optional query argument.\n$I-&gt;amOnCronPage('/?some-query-var=some-value');\n</code></pre>"},{"location":"modules/WPWebDriver/#amonpage","title":"amOnPage","text":"<p>Signature: <code>amOnPage($page)</code> : <code>void</code> </p>"},{"location":"modules/WPWebDriver/#amonpagespage","title":"amOnPagesPage","text":"<p>Signature: <code>amOnPagesPage()</code> : <code>void</code> </p> <p>Go the \"Pages\" administration screen.</p> <p>The method will not handle authentication.</p> <pre><code>&lt;?php\n$I-&gt;loginAsAdmin();\n$I-&gt;amOnPagesPage();\n$I-&gt;see('Add New');\n</code></pre>"},{"location":"modules/WPWebDriver/#amonpluginspage","title":"amOnPluginsPage","text":"<p>Signature: <code>amOnPluginsPage()</code> : <code>void</code> </p> <p>Go to the plugins administration screen.</p> <p>The method will not handle authentication.</p> <pre><code>&lt;?php\n$I-&gt;loginAsAdmin();\n$I-&gt;amOnPluginsPage();\n$I-&gt;activatePlugin('hello-dolly');\n</code></pre>"},{"location":"modules/WPWebDriver/#amonsubdomain","title":"amOnSubdomain","text":"<p>Signature: <code>amOnSubdomain(string $subdomain)</code> : <code>void</code> </p>"},{"location":"modules/WPWebDriver/#amonthemespage","title":"amOnThemesPage","text":"<p>Signature: <code>amOnThemesPage()</code> : <code>void</code> </p> <p>Moves to the themes administration page.</p>"},{"location":"modules/WPWebDriver/#amonurl","title":"amOnUrl","text":"<p>Signature: <code>amOnUrl($url)</code> : <code>void</code> </p>"},{"location":"modules/WPWebDriver/#appendfield","title":"appendField","text":"<p>Signature: <code>appendField($field, string $value)</code> : <code>void</code> </p> <p>Append the given text to the given element. Can also add a selection to a select box.</p> <pre><code>&lt;?php\n$I-&gt;appendField('#mySelectbox', 'SelectValue');\n$I-&gt;appendField('#myTextField', 'appended');\n</code></pre>"},{"location":"modules/WPWebDriver/#attachfile","title":"attachFile","text":"<p>Signature: <code>attachFile($field, string $filename)</code> : <code>void</code> </p>"},{"location":"modules/WPWebDriver/#cancelpopup","title":"cancelPopup","text":"<p>Signature: <code>cancelPopup()</code> : <code>void</code> </p> <p>Dismisses the active JavaScript popup, as created by <code>window.alert</code>, <code>window.confirm</code>, or <code>window.prompt</code>.</p>"},{"location":"modules/WPWebDriver/#checkoption","title":"checkOption","text":"<p>Signature: <code>checkOption($option)</code> : <code>void</code> </p>"},{"location":"modules/WPWebDriver/#clearfield","title":"clearField","text":"<p>Signature: <code>clearField($field)</code> : <code>void</code> </p> <p>Clears given field which isn't empty.</p> <pre><code>&lt;?php\n$I-&gt;clearField('#username');\n</code></pre>"},{"location":"modules/WPWebDriver/#click","title":"click","text":"<p>Signature: <code>click($link, [$context])</code> : <code>void</code> </p>"},{"location":"modules/WPWebDriver/#clickwithleftbutton","title":"clickWithLeftButton","text":"<p>Signature: <code>clickWithLeftButton([$cssOrXPath], [?int $offsetX], [?int $offsetY])</code> : <code>void</code> </p> <p>Performs click with the left mouse button on an element. If the first parameter <code>null</code> then the offset is relative to the actual mouse position. If the second and third parameters are given, then the mouse is moved to an offset of the element's top-left corner. Otherwise, the mouse is moved to the center of the element.</p> <pre><code>&lt;?php\n$I-&gt;clickWithLeftButton(['css' =&gt; '.checkout']);\n$I-&gt;clickWithLeftButton(null, 20, 50);\n$I-&gt;clickWithLeftButton(['css' =&gt; '.checkout'], 20, 50);\n</code></pre>"},{"location":"modules/WPWebDriver/#clickwithrightbutton","title":"clickWithRightButton","text":"<p>Signature: <code>clickWithRightButton([$cssOrXPath], [?int $offsetX], [?int $offsetY])</code> : <code>void</code> </p> <p>Performs contextual click with the right mouse button on an element. If the first parameter <code>null</code> then the offset is relative to the actual mouse position. If the second and third parameters are given, then the mouse is moved to an offset of the element's top-left corner. Otherwise, the mouse is moved to the center of the element.</p> <pre><code>&lt;?php\n$I-&gt;clickWithRightButton(['css' =&gt; '.checkout']);\n$I-&gt;clickWithRightButton(null, 20, 50);\n$I-&gt;clickWithRightButton(['css' =&gt; '.checkout'], 20, 50);\n</code></pre>"},{"location":"modules/WPWebDriver/#closetab","title":"closeTab","text":"<p>Signature: <code>closeTab()</code> : <code>void</code> </p> <p>Closes current browser tab and switches to previous active tab.</p> <pre><code>&lt;?php\n$I-&gt;closeTab();\n</code></pre>"},{"location":"modules/WPWebDriver/#deactivateplugin","title":"deactivatePlugin","text":"<p>Signature: <code>deactivatePlugin(array|string $pluginSlug)</code> : <code>void</code> </p> <p>In the plugin administration screen deactivate a plugin clicking the \"Deactivate\" link.</p> <p>The method will not handle authentication and navigation to the plugins administration page.</p> <pre><code>&lt;?php\n// Deactivate one plugin.\n$I-&gt;loginAsAdmin();\n$I-&gt;amOnPluginsPage();\n$I-&gt;deactivatePlugin('hello-dolly');\n// Deactivate a list of plugins.\n$I-&gt;loginAsAdmin();\n$I-&gt;amOnPluginsPage();\n$I-&gt;deactivatePlugin(['hello-dolly', 'my-plugin']);\n</code></pre>"},{"location":"modules/WPWebDriver/#debugwebdriverlogs","title":"debugWebDriverLogs","text":"<p>Signature: <code>debugWebDriverLogs([?Codeception\\TestInterface $test])</code> : <code>void</code> </p> <p>Print out latest Selenium Logs in debug mode</p>"},{"location":"modules/WPWebDriver/#deletesessionsnapshot","title":"deleteSessionSnapshot","text":"<p>Signature: <code>deleteSessionSnapshot($name)</code> : <code>void</code> </p>"},{"location":"modules/WPWebDriver/#dontsee","title":"dontSee","text":"<p>Signature: <code>dontSee($text, [$selector])</code> : <code>void</code> </p>"},{"location":"modules/WPWebDriver/#dontseecheckboxischecked","title":"dontSeeCheckboxIsChecked","text":"<p>Signature: <code>dontSeeCheckboxIsChecked($checkbox)</code> : <code>void</code> </p>"},{"location":"modules/WPWebDriver/#dontseecookie","title":"dontSeeCookie","text":"<p>Signature: <code>dontSeeCookie($cookie, [array $params], [bool $showDebug])</code> : <code>void</code> </p>"},{"location":"modules/WPWebDriver/#dontseecurrenturlequals","title":"dontSeeCurrentUrlEquals","text":"<p>Signature: <code>dontSeeCurrentUrlEquals(string $uri)</code> : <code>void</code> </p>"},{"location":"modules/WPWebDriver/#dontseecurrenturlmatches","title":"dontSeeCurrentUrlMatches","text":"<p>Signature: <code>dontSeeCurrentUrlMatches(string $uri)</code> : <code>void</code> </p>"},{"location":"modules/WPWebDriver/#dontseeelement","title":"dontSeeElement","text":"<p>Signature: <code>dontSeeElement($selector, [array $attributes])</code> : <code>void</code> </p>"},{"location":"modules/WPWebDriver/#dontseeelementindom","title":"dontSeeElementInDOM","text":"<p>Signature: <code>dontSeeElementInDOM($selector, [array $attributes])</code> : <code>void</code> </p> <p>Opposite of <code>seeElementInDOM</code>.</p>"},{"location":"modules/WPWebDriver/#dontseeincurrenturl","title":"dontSeeInCurrentUrl","text":"<p>Signature: <code>dontSeeInCurrentUrl(string $uri)</code> : <code>void</code> </p>"},{"location":"modules/WPWebDriver/#dontseeinfield","title":"dontSeeInField","text":"<p>Signature: <code>dontSeeInField($field, $value)</code> : <code>void</code> </p>"},{"location":"modules/WPWebDriver/#dontseeinformfields","title":"dontSeeInFormFields","text":"<p>Signature: <code>dontSeeInFormFields($formSelector, array $params)</code> : <code>void</code> </p>"},{"location":"modules/WPWebDriver/#dontseeinpagesource","title":"dontSeeInPageSource","text":"<p>Signature: <code>dontSeeInPageSource(string $text)</code> : <code>void</code> </p> <p>Checks that the page source doesn't contain the given string.</p>"},{"location":"modules/WPWebDriver/#dontseeinpopup","title":"dontSeeInPopup","text":"<p>Signature: <code>dontSeeInPopup(string $text)</code> : <code>void</code> </p> <p>Checks that the active JavaScript popup, as created by <code>window.alert</code>|<code>window.confirm</code>|<code>window.prompt</code>, does NOT contain the given string.</p>"},{"location":"modules/WPWebDriver/#dontseeinsource","title":"dontSeeInSource","text":"<p>Signature: <code>dontSeeInSource($raw)</code> : <code>void</code> </p>"},{"location":"modules/WPWebDriver/#dontseeintitle","title":"dontSeeInTitle","text":"<p>Signature: <code>dontSeeInTitle($title)</code> : <code>void</code> </p>"},{"location":"modules/WPWebDriver/#dontseelink","title":"dontSeeLink","text":"<p>Signature: <code>dontSeeLink(string $text, [string $url])</code> : <code>void</code> </p>"},{"location":"modules/WPWebDriver/#dontseeoptionisselected","title":"dontSeeOptionIsSelected","text":"<p>Signature: <code>dontSeeOptionIsSelected($selector, $optionText)</code> : <code>void</code> </p>"},{"location":"modules/WPWebDriver/#dontseeplugininstalled","title":"dontSeePluginInstalled","text":"<p>Signature: <code>dontSeePluginInstalled(string $pluginSlug)</code> : <code>void</code> </p> <p>Assert a plugin is not installed in the plugins administration screen.</p> <p>The method will not handle authentication and navigation to the plugin administration screen.</p> <pre><code>&lt;?php\n$I-&gt;loginAsAdmin();\n$I-&gt;amOnPluginsPage();\n$I-&gt;dontSeePluginInstalled('my-plugin');\n</code></pre>"},{"location":"modules/WPWebDriver/#doubleclick","title":"doubleClick","text":"<p>Signature: <code>doubleClick($cssOrXPath)</code> : <code>void</code> </p> <p>Performs a double click on an element matched by CSS or XPath.</p>"},{"location":"modules/WPWebDriver/#draganddrop","title":"dragAndDrop","text":"<p>Signature: <code>dragAndDrop($source, $target)</code> : <code>void</code> </p> <p>Performs a simple mouse drag-and-drop operation.</p> <pre><code>&lt;?php\n$I-&gt;dragAndDrop('#drag', '#drop');\n</code></pre>"},{"location":"modules/WPWebDriver/#executeasyncjs","title":"executeAsyncJS","text":"<p>Signature: <code>executeAsyncJS(string $script, [array $arguments])</code> : <code>void</code> </p> <p>Executes asynchronous JavaScript. A callback should be executed by JavaScript to exit from a script. Callback is passed as a last element in <code>arguments</code> array. Additional arguments can be passed as array in second parameter.</p> <pre><code>// wait for 1200 milliseconds my running `setTimeout`\n* $I-&gt;executeAsyncJS('setTimeout(arguments[0], 1200)');\n\n$seconds = 1200; // or seconds are passed as argument\n$I-&gt;executeAsyncJS('setTimeout(arguments[1], arguments[0])', [$seconds]);\n</code></pre>"},{"location":"modules/WPWebDriver/#executeinselenium","title":"executeInSelenium","text":"<p>Signature: <code>executeInSelenium(Closure $function)</code> : <code>void</code> </p> <p>Low-level API method. If Codeception commands are not enough, this allows you to use Selenium WebDriver methods directly:</p> <pre><code>$I-&gt;executeInSelenium(function(\\Facebook\\WebDriver\\Remote\\RemoteWebDriver $webdriver) {\n  $webdriver-&gt;get('https://google.com');\n});\n</code></pre> <p>This runs in the context of the RemoteWebDriver class. Try not to use this command on a regular basis. If Codeception lacks a feature you need, please implement it and submit a patch.</p>"},{"location":"modules/WPWebDriver/#executejs","title":"executeJS","text":"<p>Signature: <code>executeJS(string $script, [array $arguments])</code> : <code>void</code> </p> <p>Executes custom JavaScript.</p> <p>This example uses jQuery to get a value and assigns that value to a PHP variable:</p> <pre><code>&lt;?php\n$myVar = $I-&gt;executeJS('return $(\"#myField\").val()');\n\n// additional arguments can be passed as array\n// Example shows `Hello World` alert:\n$I-&gt;executeJS(\"window.alert(arguments[0])\", ['Hello world']);\n</code></pre>"},{"location":"modules/WPWebDriver/#fillfield","title":"fillField","text":"<p>Signature: <code>fillField($field, $value)</code> : <code>void</code> </p>"},{"location":"modules/WPWebDriver/#grabactivetheme","title":"grabActiveTheme","text":"<p>Signature: <code>grabActiveTheme()</code> : <code>?string</code> </p> <p>Returns the slug of the currently active themes.</p> <p>The method will not handle authentication and navigation to the themes administration page.</p>"},{"location":"modules/WPWebDriver/#grabattributefrom","title":"grabAttributeFrom","text":"<p>Signature: <code>grabAttributeFrom($cssOrXpath, $attribute)</code> : <code>?string</code> </p>"},{"location":"modules/WPWebDriver/#grabavailablethemes","title":"grabAvailableThemes","text":"<p>Signature: <code>grabAvailableThemes([string $classes])</code> : <code>array</code> </p> <p>Returns the list of available themes.</p> <p>The method will not handle authentication and navigation to the themes administration page.</p>"},{"location":"modules/WPWebDriver/#grabcookie","title":"grabCookie","text":"<p>Signature: <code>grabCookie($cookie, [array $params])</code> : <code>mixed</code> </p>"},{"location":"modules/WPWebDriver/#grabcookieswithpattern","title":"grabCookiesWithPattern","text":"<p>Signature: <code>grabCookiesWithPattern(string $cookiePattern)</code> : <code>?array</code> </p> <p>Returns all the cookies whose name matches a regex pattern.</p> <pre><code>&lt;?php\n$I-&gt;loginAs('customer','password');\n$I-&gt;amOnPage('/shop');\n$cartCookies = $I-&gt;grabCookiesWithPattern(\"#^shop_cart\\\\.*#\");\n</code></pre>"},{"location":"modules/WPWebDriver/#grabfromcurrenturl","title":"grabFromCurrentUrl","text":"<p>Signature: <code>grabFromCurrentUrl([$uri])</code> : <code>mixed</code> </p>"},{"location":"modules/WPWebDriver/#grabfullurl","title":"grabFullUrl","text":"<p>Signature: <code>grabFullUrl()</code> : <code>string</code> </p> <p>Grabs the current page full URL including the query vars.</p> <pre><code>&lt;?php\n$today = date('Y-m-d');\n$I-&gt;amOnPage('/concerts?date=' . $today);\n$I-&gt;assertRegExp('#\\\\/concerts$#', $I-&gt;grabFullUrl());\n</code></pre>"},{"location":"modules/WPWebDriver/#grabmultiple","title":"grabMultiple","text":"<p>Signature: <code>grabMultiple($cssOrXpath, [$attribute])</code> : <code>array</code> </p>"},{"location":"modules/WPWebDriver/#grabpagesource","title":"grabPageSource","text":"<p>Signature: <code>grabPageSource()</code> : <code>string</code> </p> <p>Grabs current page source code.</p>"},{"location":"modules/WPWebDriver/#grabtextfrom","title":"grabTextFrom","text":"<p>Signature: <code>grabTextFrom($cssOrXPathOrRegex)</code> : <code>mixed</code> </p>"},{"location":"modules/WPWebDriver/#grabvaluefrom","title":"grabValueFrom","text":"<p>Signature: <code>grabValueFrom($field)</code> : <code>?string</code> </p>"},{"location":"modules/WPWebDriver/#grabwordpresstestcookie","title":"grabWordPressTestCookie","text":"<p>Signature: <code>grabWordPressTestCookie([?string $name])</code> : <code>?Symfony\\Component\\BrowserKit\\Cookie</code> </p> <p>Returns WordPress default test cookie object if present.</p> <pre><code>&lt;?php\n// Grab the default WordPress test cookie.\n$wpTestCookie = $I-&gt;grabWordPressTestCookie();\n// Grab a customized version of the test cookie.\n$myTestCookie = $I-&gt;grabWordPressTestCookie('my_test_cookie');\n</code></pre>"},{"location":"modules/WPWebDriver/#loadsessionsnapshot","title":"loadSessionSnapshot","text":"<p>Signature: <code>loadSessionSnapshot($name, [bool $showDebug])</code> : <code>bool</code> </p>"},{"location":"modules/WPWebDriver/#logout","title":"logOut","text":"<p>Signature: <code>logOut([string|bool $redirectTo])</code> : <code>void</code> </p> <p>Navigate to the default WordPress logout page and click the logout link.</p> <pre><code>&lt;?php\n// Log out using the `wp-login.php` form and return to the current page.\n$I-&gt;logOut(true);\n// Log out using the `wp-login.php` form and remain there.\n$I-&gt;logOut(false);\n// Log out using the `wp-login.php` form and move to another page.\n$I-&gt;logOut('/some-other-page');\n</code></pre>"},{"location":"modules/WPWebDriver/#loginas","title":"loginAs","text":"<p>Signature: <code>loginAs(string $username, string $password, [int $timeout], [int $maxAttempts])</code> : <code>void</code> </p> <p>Login as the specified user.</p> <p>The method will not follow redirection, after the login, to any page. Depending on the driven browser the login might be \"too fast\" and the server might have not replied with valid cookies yet; in that case the method will re-attempt the login to obtain the cookies.</p> <pre><code>&lt;?php\n$I-&gt;loginAs('user', 'password');\n$I-&gt;amOnAdminPage('/');\n$I-&gt;see('Dashboard');\n</code></pre>"},{"location":"modules/WPWebDriver/#loginasadmin","title":"loginAsAdmin","text":"<p>Signature: <code>loginAsAdmin([int $timeout], [int $maxAttempts])</code> : <code>void</code> </p> <p>Login as the administrator user using the credentials specified in the module configuration.</p> <p>The method will not follow redirection, after the login, to any page.</p> <pre><code>&lt;?php\n$I-&gt;loginAsAdmin();\n$I-&gt;amOnAdminPage('/');\n$I-&gt;see('Dashboard');\n</code></pre>"},{"location":"modules/WPWebDriver/#makeelementscreenshot","title":"makeElementScreenshot","text":"<p>Signature: <code>makeElementScreenshot($selector, [?string $name])</code> : <code>void</code> </p> <p>Takes a screenshot of an element of the current window and saves it to <code>tests/_output/debug</code>.</p> <pre><code>&lt;?php\n$I-&gt;amOnPage('/user/edit');\n$I-&gt;makeElementScreenshot('#dialog', 'edit_page');\n// saved to: tests/_output/debug/edit_page.png\n$I-&gt;makeElementScreenshot('#dialog');\n// saved to: tests/_output/debug/2017-05-26_14-24-11_4b3403665fea6.png\n</code></pre>"},{"location":"modules/WPWebDriver/#makehtmlsnapshot","title":"makeHtmlSnapshot","text":"<p>Signature: <code>makeHtmlSnapshot([?string $name])</code> : <code>void</code> </p>"},{"location":"modules/WPWebDriver/#makescreenshot","title":"makeScreenshot","text":"<p>Signature: <code>makeScreenshot([?string $name])</code> : <code>void</code> </p> <p>Takes a screenshot of the current window and saves it to <code>tests/_output/debug</code>.</p> <pre><code>&lt;?php\n$I-&gt;amOnPage('/user/edit');\n$I-&gt;makeScreenshot('edit_page');\n// saved to: tests/_output/debug/edit_page.png\n$I-&gt;makeScreenshot();\n// saved to: tests/_output/debug/2017-05-26_14-24-11_4b3403665fea6.png\n</code></pre>"},{"location":"modules/WPWebDriver/#maximizewindow","title":"maximizeWindow","text":"<p>Signature: <code>maximizeWindow()</code> : <code>void</code> </p> <p>Maximizes the current window.</p>"},{"location":"modules/WPWebDriver/#moveback","title":"moveBack","text":"<p>Signature: <code>moveBack()</code> : <code>void</code> </p> <p>Moves back in history.</p>"},{"location":"modules/WPWebDriver/#moveforward","title":"moveForward","text":"<p>Signature: <code>moveForward()</code> : <code>void</code> </p> <p>Moves forward in history.</p>"},{"location":"modules/WPWebDriver/#movemouseover","title":"moveMouseOver","text":"<p>Signature: <code>moveMouseOver([$cssOrXPath], [?int $offsetX], [?int $offsetY])</code> : <code>void</code> </p> <p>Move mouse over the first element matched by the given locator. If the first parameter null then the page is used. If the second and third parameters are given, then the mouse is moved to an offset of the element's top-left corner. Otherwise, the mouse is moved to the center of the element.</p> <pre><code>&lt;?php\n$I-&gt;moveMouseOver(['css' =&gt; '.checkout']);\n$I-&gt;moveMouseOver(null, 20, 50);\n$I-&gt;moveMouseOver(['css' =&gt; '.checkout'], 20, 50);\n</code></pre>"},{"location":"modules/WPWebDriver/#opennewtab","title":"openNewTab","text":"<p>Signature: <code>openNewTab()</code> : <code>void</code> </p> <p>Opens a new browser tab and switches to it.</p> <p><pre><code>&lt;?php\n$I-&gt;openNewTab();\n</code></pre> The tab is opened with JavaScript's <code>window.open()</code>, which means: * Some ad-blockers might restrict it. * The sessionStorage is copied to the new tab (contrary to a tab that was manually opened by the user)</p>"},{"location":"modules/WPWebDriver/#performon","title":"performOn","text":"<p>Signature: <code>performOn($element, $actions, [int $timeout])</code> : <code>void</code> </p> <p>Waits for element and runs a sequence of actions inside its context. Actions can be defined with array, callback, or <code>Codeception\\Util\\ActionSequence</code> instance.</p> <p>Actions as array are recommended for simple to combine \"waitForElement\" with assertions; <code>waitForElement($el)</code> and <code>see('text', $el)</code> can be simplified to:</p> <pre><code>&lt;?php\n$I-&gt;performOn($el, ['see' =&gt; 'text']);\n</code></pre> <p>List of actions can be pragmatically build using <code>Codeception\\Util\\ActionSequence</code>:</p> <pre><code>&lt;?php\n$I-&gt;performOn('.model', ActionSequence::build()\n    -&gt;see('Warning')\n    -&gt;see('Are you sure you want to delete this?')\n    -&gt;click('Yes')\n);\n</code></pre> <p>Actions executed from array or ActionSequence will print debug output for actions, and adds an action name to exception on failure.</p> <p>Whenever you need to define more actions a callback can be used. A WebDriver module is passed for argument:</p> <pre><code>&lt;?php\n$I-&gt;performOn('.rememberMe', function (WebDriver $I) {\n     $I-&gt;see('Remember me next time');\n     $I-&gt;seeElement('#LoginForm_rememberMe');\n     $I-&gt;dontSee('Login');\n});\n</code></pre> <p>In 3rd argument you can set number a seconds to wait for element to appear</p>"},{"location":"modules/WPWebDriver/#presskey","title":"pressKey","text":"<p>Signature: <code>pressKey($element, [...$chars])</code> : <code>void</code> </p> <p>Presses the given key on the given element. To specify a character and modifier (e.g. Ctrl, Alt, Shift, Meta), pass an array for <code>$char</code> with the modifier as the first element and the character as the second. For special keys, use the constants from <code>Facebook\\WebDriver\\WebDriverKeys</code>.</p> <pre><code>&lt;?php\n// &lt;input id=\"page\" value=\"old\" /&gt;\n$I-&gt;pressKey('#page','a'); // =&gt; olda\n$I-&gt;pressKey('#page',array('ctrl','a'),'new'); //=&gt; new\n$I-&gt;pressKey('#page',array('shift','111'),'1','x'); //=&gt; old!!!1x\n$I-&gt;pressKey('descendant-or-self::*[@id='page']','u'); //=&gt; oldu\n$I-&gt;pressKey('#name', array('ctrl', 'a'), \\Facebook\\WebDriver\\WebDriverKeys::DELETE); //=&gt;''\n</code></pre>"},{"location":"modules/WPWebDriver/#reloadpage","title":"reloadPage","text":"<p>Signature: <code>reloadPage()</code> : <code>void</code> </p> <p>Reloads the current page.</p>"},{"location":"modules/WPWebDriver/#resetcookie","title":"resetCookie","text":"<p>Signature: <code>resetCookie($cookie, [array $params], [bool $showDebug])</code> : <code>void</code> </p>"},{"location":"modules/WPWebDriver/#resizewindow","title":"resizeWindow","text":"<p>Signature: <code>resizeWindow(int $width, int $height)</code> : <code>void</code> </p> <p>Resize the current window.</p> <pre><code>&lt;?php\n$I-&gt;resizeWindow(800, 600);\n</code></pre>"},{"location":"modules/WPWebDriver/#savesessionsnapshot","title":"saveSessionSnapshot","text":"<p>Signature: <code>saveSessionSnapshot($name)</code> : <code>void</code> </p>"},{"location":"modules/WPWebDriver/#scrollto","title":"scrollTo","text":"<p>Signature: <code>scrollTo($selector, [?int $offsetX], [?int $offsetY])</code> : <code>void</code> </p> <p>Move to the middle of the given element matched by the given locator. Extra shift, calculated from the top-left corner of the element, can be set by passing $offsetX and $offsetY parameters.</p> <pre><code>&lt;?php\n$I-&gt;scrollTo(['css' =&gt; '.checkout'], 20, 50);\n</code></pre>"},{"location":"modules/WPWebDriver/#see","title":"see","text":"<p>Signature: <code>see($text, [$selector])</code> : <code>void</code> </p>"},{"location":"modules/WPWebDriver/#seecheckboxischecked","title":"seeCheckboxIsChecked","text":"<p>Signature: <code>seeCheckboxIsChecked($checkbox)</code> : <code>void</code> </p>"},{"location":"modules/WPWebDriver/#seecookie","title":"seeCookie","text":"<p>Signature: <code>seeCookie($cookie, [array $params], [bool $showDebug])</code> : <code>void</code> </p>"},{"location":"modules/WPWebDriver/#seecurrenturlequals","title":"seeCurrentUrlEquals","text":"<p>Signature: <code>seeCurrentUrlEquals(string $uri)</code> : <code>void</code> </p>"},{"location":"modules/WPWebDriver/#seecurrenturlmatches","title":"seeCurrentUrlMatches","text":"<p>Signature: <code>seeCurrentUrlMatches(string $uri)</code> : <code>void</code> </p>"},{"location":"modules/WPWebDriver/#seeelement","title":"seeElement","text":"<p>Signature: <code>seeElement($selector, [array $attributes])</code> : <code>void</code> </p>"},{"location":"modules/WPWebDriver/#seeelementindom","title":"seeElementInDOM","text":"<p>Signature: <code>seeElementInDOM($selector, [array $attributes])</code> : <code>void</code> </p> <p>Checks that the given element exists on the page, even it is invisible.</p> <pre><code>&lt;?php\n$I-&gt;seeElementInDOM('//form/input[type=hidden]');\n</code></pre>"},{"location":"modules/WPWebDriver/#seeerrormessage","title":"seeErrorMessage","text":"<p>Signature: <code>seeErrorMessage([array|string $classes])</code> : <code>void</code> </p> <p>In an administration screen look for an error admin notice.</p> <p>The check is class-based to decouple from internationalization. The method will not handle authentication and navigation the administration area.</p> <pre><code>&lt;?php\n$I-&gt;loginAsAdmin()\n$I-&gt;amOnAdminPage('/');\n$I-&gt;seeErrorMessage('.my-plugin');\n</code></pre>"},{"location":"modules/WPWebDriver/#seeincurrenturl","title":"seeInCurrentUrl","text":"<p>Signature: <code>seeInCurrentUrl(string $uri)</code> : <code>void</code> </p>"},{"location":"modules/WPWebDriver/#seeinfield","title":"seeInField","text":"<p>Signature: <code>seeInField($field, $value)</code> : <code>void</code> </p>"},{"location":"modules/WPWebDriver/#seeinformfields","title":"seeInFormFields","text":"<p>Signature: <code>seeInFormFields($formSelector, array $params)</code> : <code>void</code> </p>"},{"location":"modules/WPWebDriver/#seeinpagesource","title":"seeInPageSource","text":"<p>Signature: <code>seeInPageSource(string $text)</code> : <code>void</code> </p> <p>Checks that the page source contains the given string.</p> <pre><code>&lt;?php\n$I-&gt;seeInPageSource('&lt;link rel=\"apple-touch-icon\"');\n</code></pre>"},{"location":"modules/WPWebDriver/#seeinpopup","title":"seeInPopup","text":"<p>Signature: <code>seeInPopup(string $text)</code> : <code>void</code> </p> <p>Checks that the active JavaScript popup, as created by <code>window.alert</code>|<code>window.confirm</code>|<code>window.prompt</code>, contains the given string.</p>"},{"location":"modules/WPWebDriver/#seeinsource","title":"seeInSource","text":"<p>Signature: <code>seeInSource($raw)</code> : <code>void</code> </p>"},{"location":"modules/WPWebDriver/#seeintitle","title":"seeInTitle","text":"<p>Signature: <code>seeInTitle($title)</code> : <code>void</code> </p>"},{"location":"modules/WPWebDriver/#seelink","title":"seeLink","text":"<p>Signature: <code>seeLink(string $text, [?string $url])</code> : <code>void</code> </p>"},{"location":"modules/WPWebDriver/#seemessage","title":"seeMessage","text":"<p>Signature: <code>seeMessage([array|string $classes])</code> : <code>void</code> </p> <p>In an administration screen look for an admin notice.</p> <p>The check is class-based to decouple from internationalization. The method will not handle authentication and navigation the administration area.</p> <pre><code>&lt;?php\n$I-&gt;loginAsAdmin()\n$I-&gt;amOnAdminPage('/');\n$I-&gt;seeMessage('.missing-api-token.my-plugin');\n</code></pre>"},{"location":"modules/WPWebDriver/#seenumberofelements","title":"seeNumberOfElements","text":"<p>Signature: <code>seeNumberOfElements($selector, $expected)</code> : <code>void</code> </p>"},{"location":"modules/WPWebDriver/#seenumberofelementsindom","title":"seeNumberOfElementsInDOM","text":"<p>Signature: <code>seeNumberOfElementsInDOM($selector, $expected)</code> : <code>void</code></p>"},{"location":"modules/WPWebDriver/#seenumberoftabs","title":"seeNumberOfTabs","text":"<p>Signature: <code>seeNumberOfTabs(int $number)</code> : <code>void</code> </p> <p>Checks current number of opened tabs</p> <pre><code>&lt;?php\n$I-&gt;seeNumberOfTabs(2);\n</code></pre>"},{"location":"modules/WPWebDriver/#seeoptionisselected","title":"seeOptionIsSelected","text":"<p>Signature: <code>seeOptionIsSelected($selector, $optionText)</code> : <code>void</code> </p>"},{"location":"modules/WPWebDriver/#seepluginactivated","title":"seePluginActivated","text":"<p>Signature: <code>seePluginActivated(string $pluginSlug)</code> : <code>void</code> </p> <p>Assert a plugin is activated in the plugin administration screen.</p> <p>The method will not handle authentication and navigation to the plugin administration screen.</p> <pre><code>&lt;?php\n$I-&gt;loginAsAdmin();\n$I-&gt;amOnPluginsPage();\n$I-&gt;seePluginActivated('my-plugin');\n</code></pre>"},{"location":"modules/WPWebDriver/#seeplugindeactivated","title":"seePluginDeactivated","text":"<p>Signature: <code>seePluginDeactivated(string $pluginSlug)</code> : <code>void</code> </p> <p>Assert a plugin is not activated in the plugins administration screen.</p> <p>The method will not handle authentication and navigation to the plugin administration screen.</p> <pre><code>&lt;?php\n$I-&gt;loginAsAdmin();\n$I-&gt;amOnPluginsPage();\n$I-&gt;seePluginDeactivated('my-plugin');\n</code></pre>"},{"location":"modules/WPWebDriver/#seeplugininstalled","title":"seePluginInstalled","text":"<p>Signature: <code>seePluginInstalled(string $pluginSlug)</code> : <code>void</code> </p> <p>Assert a plugin is installed, no matter its activation status, in the plugin administration screen.</p> <p>The method will not handle authentication and navigation to the plugin administration screen.</p> <pre><code>&lt;?php\n$I-&gt;loginAsAdmin();\n$I-&gt;amOnPluginsPage();\n$I-&gt;seePluginInstalled('my-plugin');\n</code></pre>"},{"location":"modules/WPWebDriver/#seethemeactivated","title":"seeThemeActivated","text":"<p>Signature: <code>seeThemeActivated(string $slug)</code> : <code>void</code> </p> <p>Verifies that a theme is active.</p> <p>The method will not handle authentication and navigation to the themes administration page.</p>"},{"location":"modules/WPWebDriver/#seewpdiepage","title":"seeWpDiePage","text":"<p>Signature: <code>seeWpDiePage()</code> : <code>void</code> </p> <p>Checks that the current page is one generated by the <code>wp_die</code> function.</p> <p>The method will try to identify the page based on the default WordPress die page HTML attributes.</p> <pre><code>&lt;?php\n$I-&gt;loginAs('user', 'password');\n$I-&gt;amOnAdminPage('/forbidden');\n$I-&gt;seeWpDiePage();\n</code></pre>"},{"location":"modules/WPWebDriver/#selectoption","title":"selectOption","text":"<p>Signature: <code>selectOption($select, $option)</code> : <code>void</code> </p>"},{"location":"modules/WPWebDriver/#setcookie","title":"setCookie","text":"<p>Signature: <code>setCookie($name, $value, [array $params], [$showDebug])</code> : <code>void</code> </p>"},{"location":"modules/WPWebDriver/#submitform","title":"submitForm","text":"<p>Signature: <code>submitForm($selector, array $params, [$button])</code> : <code>void</code> </p> <p>Submits the given form on the page, optionally with the given form values.  Give the form fields values as an array. Note that hidden fields can't be accessed.</p> <p>Skipped fields will be filled by their values from the page. You don't need to click the 'Submit' button afterwards. This command itself triggers the request to form's action.</p> <p>You can optionally specify what button's value to include in the request with the last parameter as an alternative to explicitly setting its value in the second parameter, as button values are not otherwise included in the request.</p> <p>Examples:</p> <pre><code>&lt;?php\n$I-&gt;submitForm('#login', [\n    'login' =&gt; 'davert',\n    'password' =&gt; '123456'\n]);\n// or\n$I-&gt;submitForm('#login', [\n    'login' =&gt; 'davert',\n    'password' =&gt; '123456'\n], 'submitButtonName');\n</code></pre> <p>For example, given this sample \"Sign Up\" form:</p> <pre><code>&lt;form action=\"/sign_up\"&gt;\n    Login:\n    &lt;input type=\"text\" name=\"user[login]\" /&gt;&lt;br/&gt;\n    Password:\n    &lt;input type=\"password\" name=\"user[password]\" /&gt;&lt;br/&gt;\n    Do you agree to our terms?\n    &lt;input type=\"checkbox\" name=\"user[agree]\" /&gt;&lt;br/&gt;\n    Select pricing plan:\n    &lt;select name=\"plan\"&gt;\n        &lt;option value=\"1\"&gt;Free&lt;/option&gt;\n        &lt;option value=\"2\" selected=\"selected\"&gt;Paid&lt;/option&gt;\n    &lt;/select&gt;\n    &lt;input type=\"submit\" name=\"submitButton\" value=\"Submit\" /&gt;\n&lt;/form&gt;\n</code></pre> <p>You could write the following to submit it:</p> <p><pre><code>&lt;?php\n$I-&gt;submitForm(\n    '#userForm',\n    [\n        'user[login]' =&gt; 'Davert',\n        'user[password]' =&gt; '123456',\n        'user[agree]' =&gt; true\n    ],\n    'submitButton'\n);\n</code></pre> Note that \"2\" will be the submitted value for the \"plan\" field, as it is the selected option.</p> <p>Also note that this differs from PhpBrowser, in that <code>'user' =&gt; [ 'login' =&gt; 'Davert' ]</code> is not supported at the moment. Named array keys must be included in the name as above.</p> <p>Pair this with seeInFormFields for quick testing magic.</p> <pre><code>&lt;?php\n$form = [\n     'field1' =&gt; 'value',\n     'field2' =&gt; 'another value',\n     'checkbox1' =&gt; true,\n     // ...\n];\n$I-&gt;submitForm('//form[@id=my-form]', $form, 'submitButton');\n// $I-&gt;amOnPage('/path/to/form-page') may be needed\n$I-&gt;seeInFormFields('//form[@id=my-form]', $form);\n</code></pre> <p>Parameter values must be set to arrays for multiple input fields of the same name, or multi-select combo boxes.  For checkboxes, either the string value can be used, or boolean values which will be replaced by the checkbox's value in the DOM.</p> <pre><code>&lt;?php\n$I-&gt;submitForm('#my-form', [\n     'field1' =&gt; 'value',\n     'checkbox' =&gt; [\n         'value of first checkbox',\n         'value of second checkbox',\n     ],\n     'otherCheckboxes' =&gt; [\n         true,\n         false,\n         false,\n     ],\n     'multiselect' =&gt; [\n         'first option value',\n         'second option value',\n     ]\n]);\n</code></pre> <p>Mixing string and boolean values for a checkbox's value is not supported and may produce unexpected results.</p> <p>Field names ending in \"[]\" must be passed without the trailing square bracket characters, and must contain an array for its value.  This allows submitting multiple values with the same name, consider:</p> <pre><code>&lt;?php\n$I-&gt;submitForm('#my-form', [\n    'field[]' =&gt; 'value',\n    'field[]' =&gt; 'another value', // 'field[]' is already a defined key\n]);\n</code></pre> <p>The solution is to pass an array value:</p> <pre><code>&lt;?php\n// this way both values are submitted\n$I-&gt;submitForm('#my-form', [\n    'field' =&gt; [\n        'value',\n        'another value',\n    ]\n]);\n</code></pre> <p>The <code>$button</code> parameter can be either a string, an array or an instance of Facebook\\WebDriver\\WebDriverBy. When it is a string, the button will be found by its \"name\" attribute. If $button is an array then it will be treated as a strict selector and a WebDriverBy will be used verbatim.</p> <p>For example, given the following HTML:</p> <pre><code>&lt;input type=\"submit\" name=\"submitButton\" value=\"Submit\" /&gt;\n</code></pre> <p><code>$button</code> could be any one of the following:   - 'submitButton'   - ['name' =&gt; 'submitButton']   - WebDriverBy::name('submitButton')</p>"},{"location":"modules/WPWebDriver/#switchtoframe","title":"switchToFrame","text":"<p>Signature: <code>switchToFrame([?string $locator])</code> : <code>void</code> </p> <p>Switch to another frame on the page.</p> <p>Example: <pre><code>&lt;frame name=\"another_frame\" id=\"fr1\" src=\"https://example.com\"&gt;\n</code></pre></p> <pre><code>&lt;?php\n# switch to frame by name\n$I-&gt;switchToFrame(\"another_frame\");\n# switch to frame by CSS or XPath\n$I-&gt;switchToFrame(\"#fr1\");\n# switch to parent page\n$I-&gt;switchToFrame();\n</code></pre>"},{"location":"modules/WPWebDriver/#switchtoiframe","title":"switchToIFrame","text":"<p>Signature: <code>switchToIFrame([?string $locator])</code> : <code>void</code> </p> <p>Switch to another iframe on the page.</p> <p>Example: <pre><code>&lt;iframe name=\"another_frame\" id=\"fr1\" src=\"https://example.com\"&gt;\n</code></pre></p> <pre><code>&lt;?php\n# switch to iframe by name\n$I-&gt;switchToIFrame(\"another_frame\");\n# switch to iframe by CSS or XPath\n$I-&gt;switchToIFrame(\"#fr1\");\n# switch to parent page\n$I-&gt;switchToIFrame();\n</code></pre>"},{"location":"modules/WPWebDriver/#switchtonexttab","title":"switchToNextTab","text":"<p>Signature: <code>switchToNextTab([int $offset])</code> : <code>void</code> </p> <p>Switches to next browser tab. An offset can be specified.</p> <pre><code>&lt;?php\n// switch to next tab\n$I-&gt;switchToNextTab();\n// switch to 2nd next tab\n$I-&gt;switchToNextTab(2);\n</code></pre>"},{"location":"modules/WPWebDriver/#switchtoprevioustab","title":"switchToPreviousTab","text":"<p>Signature: <code>switchToPreviousTab([int $offset])</code> : <code>void</code> </p> <p>Switches to previous browser tab. An offset can be specified.</p> <pre><code>&lt;?php\n// switch to previous tab\n$I-&gt;switchToPreviousTab();\n// switch to 2nd previous tab\n$I-&gt;switchToPreviousTab(2);\n</code></pre>"},{"location":"modules/WPWebDriver/#switchtowindow","title":"switchToWindow","text":"<p>Signature: <code>switchToWindow([?string $name])</code> : <code>void</code> </p> <p>Switch to another window identified by name.</p> <p>The window can only be identified by name. If the $name parameter is blank, the parent window will be used.</p> <p>Example: <pre><code>&lt;input type=\"button\" value=\"Open window\" onclick=\"window.open('https://example.com', 'another_window')\"&gt;\n</code></pre></p> <pre><code>&lt;?php\n$I-&gt;click(\"Open window\");\n# switch to another window\n$I-&gt;switchToWindow(\"another_window\");\n# switch to parent window\n$I-&gt;switchToWindow();\n</code></pre> <p>If the window has no name, match it by switching to next active tab using <code>switchToNextTab</code> method.</p> <p>Or use native Selenium functions to get access to all opened windows:</p> <pre><code>&lt;?php\n$I-&gt;executeInSelenium(function (\\Facebook\\WebDriver\\Remote\\RemoteWebDriver $webdriver) {\n     $handles=$webdriver-&gt;getWindowHandles();\n     $last_window = end($handles);\n     $webdriver-&gt;switchTo()-&gt;window($last_window);\n});\n</code></pre>"},{"location":"modules/WPWebDriver/#type","title":"type","text":"<p>Signature: <code>type(string $text, [int $delay])</code> : <code>void</code> </p> <p>Type in characters on active element. With a second parameter you can specify delay between key presses.</p> <pre><code>&lt;?php\n// activate input element\n$I-&gt;click('#input');\n\n// type text in active element\n$I-&gt;type('Hello world');\n\n// type text with a 1sec delay between chars\n$I-&gt;type('Hello World', 1);\n</code></pre> <p>This might be useful when you an input reacts to typing and you need to slow it down to emulate human behavior. For instance, this is how Credit Card fields can be filled in.</p>"},{"location":"modules/WPWebDriver/#typeinpopup","title":"typeInPopup","text":"<p>Signature: <code>typeInPopup(string $keys)</code> : <code>void</code> </p> <p>Enters text into a native JavaScript prompt popup, as created by <code>window.prompt</code>.</p>"},{"location":"modules/WPWebDriver/#uncheckoption","title":"uncheckOption","text":"<p>Signature: <code>uncheckOption($option)</code> : <code>void</code> </p>"},{"location":"modules/WPWebDriver/#unselectoption","title":"unselectOption","text":"<p>Signature: <code>unselectOption($select, $option)</code> : <code>void</code> </p> <p>Unselect an option in the given select box.</p>"},{"location":"modules/WPWebDriver/#wait","title":"wait","text":"<p>Signature: <code>wait($timeout)</code> : <code>void</code> </p> <p>Wait for $timeout seconds.</p>"},{"location":"modules/WPWebDriver/#waitforelement","title":"waitForElement","text":"<p>Signature: <code>waitForElement($element, [int $timeout])</code> : <code>void</code> </p> <p>Waits up to $timeout seconds for an element to appear on the page. If the element doesn't appear, a timeout exception is thrown.</p> <pre><code>&lt;?php\n$I-&gt;waitForElement('#agree_button', 30); // secs\n$I-&gt;click('#agree_button');\n</code></pre>"},{"location":"modules/WPWebDriver/#waitforelementchange","title":"waitForElementChange","text":"<p>Signature: <code>waitForElementChange($element, Closure $callback, [int $timeout])</code> : <code>void</code> </p> <p>Waits up to $timeout seconds for the given element to change. Element \"change\" is determined by a callback function which is called repeatedly until the return value evaluates to true.</p> <pre><code>&lt;?php\nuse \\Facebook\\WebDriver\\WebDriverElement\n$I-&gt;waitForElementChange('#menu', function(WebDriverElement $el) {\n    return $el-&gt;isDisplayed();\n}, 100);\n</code></pre>"},{"location":"modules/WPWebDriver/#waitforelementclickable","title":"waitForElementClickable","text":"<p>Signature: <code>waitForElementClickable($element, [int $timeout])</code> : <code>void</code> </p> <p>Waits up to $timeout seconds for the given element to be clickable. If element doesn't become clickable, a timeout exception is thrown.</p> <pre><code>&lt;?php\n$I-&gt;waitForElementClickable('#agree_button', 30); // secs\n$I-&gt;click('#agree_button');\n</code></pre>"},{"location":"modules/WPWebDriver/#waitforelementnotvisible","title":"waitForElementNotVisible","text":"<p>Signature: <code>waitForElementNotVisible($element, [int $timeout])</code> : <code>void</code> </p> <p>Waits up to $timeout seconds for the given element to become invisible. If element stays visible, a timeout exception is thrown.</p> <pre><code>&lt;?php\n$I-&gt;waitForElementNotVisible('#agree_button', 30); // secs\n</code></pre>"},{"location":"modules/WPWebDriver/#waitforelementvisible","title":"waitForElementVisible","text":"<p>Signature: <code>waitForElementVisible($element, [int $timeout])</code> : <code>void</code> </p> <p>Waits up to $timeout seconds for the given element to be visible on the page. If element doesn't appear, a timeout exception is thrown.</p> <pre><code>&lt;?php\n$I-&gt;waitForElementVisible('#agree_button', 30); // secs\n$I-&gt;click('#agree_button');\n</code></pre>"},{"location":"modules/WPWebDriver/#waitforjs","title":"waitForJS","text":"<p>Signature: <code>waitForJS(string $script, [int $timeout])</code> : <code>void</code> </p> <p>Executes JavaScript and waits up to $timeout seconds for it to return true.</p> <p>In this example we will wait up to 60 seconds for all jQuery AJAX requests to finish.</p> <pre><code>&lt;?php\n$I-&gt;waitForJS(\"return $.active == 0;\", 60);\n</code></pre>"},{"location":"modules/WPWebDriver/#waitforjqueryajax","title":"waitForJqueryAjax","text":"<p>Signature: <code>waitForJqueryAjax([int $time])</code> : <code>void</code> </p> <p>Waits for any jQuery triggered AJAX request to be resolved.</p> <pre><code>&lt;?php\n$I-&gt;amOnPage('/triggering-ajax-requests');\n$I-&gt;waitForJqueryAjax();\n$I-&gt;see('From AJAX');\n</code></pre>"},{"location":"modules/WPWebDriver/#waitfortext","title":"waitForText","text":"<p>Signature: <code>waitForText(string $text, [int $timeout], [$selector])</code> : <code>void</code> </p> <p>Waits up to $timeout seconds for the given string to appear on the page.</p> <p>Can also be passed a selector to search in, be as specific as possible when using selectors. waitForText() will only watch the first instance of the matching selector / text provided. If the given text doesn't appear, a timeout exception is thrown.</p> <pre><code>&lt;?php\n$I-&gt;waitForText('foo', 30); // secs\n$I-&gt;waitForText('foo', 30, '.title'); // secs\n</code></pre> <p>Read more in Codeception documentation.</p>"},{"location":"traits/UopzFunctions/","title":"UopzFunctions trait","text":"<p>This trait provides a set of methods to manipulate functions, methods and class attributes using the uopz PHP extension.</p> <p>Warning</p> <p>This test trait requires the <code>uopz</code> PHP extension.  </p> <p>See the Installing the extension locally section of this page for more information about how to do that. If you need to install the extension in a CI environment, see the Installing the extension in CI section of this page.</p> <p>If the <code>uopz</code> extension is not installed, test methods using methods from the <code>UopzFunctions</code> trait will be marked as skipped.</p>"},{"location":"traits/UopzFunctions/#why-require-an-extension","title":"Why require an extension?","text":"<p>Why use a PHP extension instead of a user-land solution, i.e. a PHP library that does not require installing an extension?</p> <p>I've written such a solution myself, function-mocker, but have grown frustrated with its limitations, and the limitation of other similar solutions.</p> <p>All user-land, monkey-patching, pure PHP solutions rely on stream-wrapping. This is a very powerful feature that this project uses for some of its functionality, but it has a drawbacks when used extensively for monkey-patching functions and methods:</p> <ul> <li>the files patch must be included after the library loaded</li> <li>the files have to patched, or patched and cached, on each run</li> <li>there are some random and difficult to track issues introduced by how function and method patching works; e.g.   functions manipulating values by reference will not work as expected</li> <li>some constants like <code>__METHOD__</code> and <code>__FUNCTION__</code> will not work as expected in the patched files</li> <li>monkey-patching code will be \"inserted\" in the function stack, lengthening the stack trace and making it very   difficult to debug</li> <li>all this processing together with XDebug spells doom for the performance of the test suite</li> </ul> <p>The <code>uopz</code> extension is a solid and fast solution that has been created and maintained by people that know PHP internals and the PHP language very well that has none of the drawbacks of the above-mentioned solutions.</p> <p>It is just a better tool for the job.</p>"},{"location":"traits/UopzFunctions/#installing-the-extension-locally","title":"Installing the extension locally","text":"WindowsLinuxMacOS <ul> <li>Locate your <code>php.ini</code> file:     <pre><code>php --ini\n</code></pre></li> <li>Download the latest <code>DLL</code> stable version of the extension from the releases page. You'll likely need the <code>NTS x64</code> version.</li> <li>Unzip the file and copy the <code>php_uopz.dll</code> file to the <code>ext</code> folder of your PHP installation. If your <code>php.ini</code> file is located at <code>C:\\tools\\php81\\php.ini</code>, the extensions directory will be located at <code>C:\\tools\\php81\\ext</code>.</li> <li>Edit your <code>php.ini</code> file and add the following line to enable and configure the extension:     <pre><code>extension=uopz\nuopz.exit=1\n</code></pre></li> <li>Make sure the extension is correctly installed by running <code>php -m</code> and making sure the <code>uopz</code> extension appears in the list of extensions.</li> </ul> <p>You can find more information about installing PHP extensions on Windows in the PHP manual and in the <code>uopz</code> extension install guide.</p> <ul> <li>Use the <code>pecl</code> command to install the extension:     <pre><code>pecl install uopz\n</code></pre></li> <li>Configure the extension to ensure it will allow <code>exit</code> and <code>die</code> calls to terminate the script execution.   Add the following line to either the main PHP configuration file (<code>php.ini</code>), or a dedicated configuration file:     <pre><code>uopz.exit=1\n</code></pre></li> <li>Make sure the extension is correctly installed by running <code>php -m</code> and making sure the <code>uopz</code> extension appears in the list of extensions.</li> </ul> <p>Alternatively, you can build the extension from source as detailed in the <code>uopz</code> extension install guide.</p> <ul> <li>Use the <code>pecl</code> command to install the extension:     <pre><code>pecl install uopz\n</code></pre></li> <li>Configure the extension to ensure it will allow <code>exit</code> and <code>die</code> calls to terminate the script execution.   Add the following line to either the main PHP configuration file (<code>php.ini</code>), or a dedicated configuration file:     <pre><code>uopz.exit=1\n</code></pre></li> <li>Make sure the extension is correctly installed by running <code>php -m</code> and making sure the <code>uopz</code> extension appears in the list of extensions.</li> </ul> <p>Alternatively, you can build the extension from source as detailed in the <code>uopz</code> extension install guide.</p>"},{"location":"traits/UopzFunctions/#installing-the-extension-in-ci","title":"Installing the extension in CI","text":"<p>Depending on your Continuous Integration (CI) solution of choice, the configuration required to install and set up the <code>uopz</code> extensions will be different.</p> <p>As an example, here is how you can set up the <code>uopz</code> extension in a GitHub Actions job:</p> <pre><code>- name: Setup PHP 8.1 with uopz\nuses: shivammathur/setup-php@v2\nwith:\n  php-version: 8.1\n  extensions: uopz\n  ini-values: uopz.exit=1\n</code></pre> <p>This project uses the very same setup.</p> <p>Most CI systems are based on Linux OSes: if you're not using GitHub Actions, you can reference to the Linux local installation instructions to set up and install the extension for your CI solution of choice.</p>"},{"location":"traits/UopzFunctions/#usage","title":"Usage","text":"<p>Include the <code>UopzFunctions</code> trait in your test class and use the methods provided by the trait to manipulate functions, methods and class attributes.</p> <pre><code>&lt;?php\n\nuse lucatume\\WPBrowser\\WPTestCase;\nuse lucatume\\WPBrowser\\Traits\\UopzFunctions;\n\nclass MyTest extends WPTestCase\n{\n    use UopzFunctions;\n\n    public function test_can_mock_wp_create_nonce()\n    {\n        $this-&gt;setFunctionReturn('wp_create_nonce', 'super-secret-nonce');\n\n        $this-&gt;assertEquals('super-secret-nonce', wp_create_nonce('some-action'));\n    }\n}\n</code></pre> <p>The trait will take care of cleaning up all the modifications made to the functions, methods and class attributes after each test.</p> <p>You can use the <code>UopzFunctions</code> trait in test cases extending the <code>PHUnit\\Framework\\TestCase</code> class as well:</p> <pre><code>&lt;?php\n\nuse PHPUnit\\Framework\\TestCase;\nuse lucatume\\WPBrowser\\Traits\\UopzFunctions;\n\nclass MyTest extends TestCase\n{\n    use UopzFunctions;\n\n    public function test_can_mock_my_function()\n    {\n        $this-&gt;setFunctionReturn('someFunction', 'mocked-value');\n\n        $this-&gt;assertEquals('mocked-value', someFunction());\n    }\n}\n</code></pre> <p>If you need to reset a function return or mock during a test, you can use the unset Closure returned by each method setting up a mock or return value:</p> <pre><code>&lt;?php\n\nuse lucatume\\WPBrowser\\Traits\\UopzFunctions;\n\nfunction someFunction()\n{\n    return 'original-value';\n}\n\nclass MyTestWithUopzFunctions extends WPTestCase\n{\n    use UopzFunctions;\n\n    public function test_can_mock_my_function()\n    {\n        $unsetSomeFunctionReturn = $this-&gt;setFunctionReturn('someFunction', 'mocked-value');\n\n        $this-&gt;assertEquals('mocked-value', someFunction());\n\n        $unsetSomeFunctionReturn();\n\n        $this-&gt;assertEquals('original-value', someFunction());\n    }\n}\n</code></pre>"},{"location":"traits/UopzFunctions/#methods","title":"Methods","text":"<p>The <code>UopzFunctions</code> trait provides the following methods:</p>"},{"location":"traits/UopzFunctions/#setfunctionreturn","title":"setFunctionReturn","text":"<p><code>setFunctionReturn(string $function, mixed $value, bool $execute = false): Closure</code></p> <p>Set the return value for the function <code>$function</code> to <code>$value</code>. The Closure returned by this method can be used to unset the return value.</p> <p>If <code>$value</code> is a closure and <code>$execute</code> is <code>true</code>, then the return value will be the return value of the closure.</p> <pre><code>&lt;?php\n\nuse lucatume\\WPBrowser\\Traits\\UopzFunctions;\nuse lucatume\\WPBrowser\\TestCase\\WPTestCase;\n\nclass MyTest extends WPTestCase\n{\n    use UopzFunctions;\n\n    public function test_can_set_function_return()\n    {\n        $this-&gt;setFunctionReturn('wp_generate_nonce', 'super-secret-nonce');\n\n        $this-&gt;assertEquals('super-secret-nonce', wp_create_nonce('some-action'));\n    }\n}\n</code></pre> <p>If <code>$value</code> is a closure, the original function can be called within the closure to relay the original return value:</p> <pre><code>&lt;?php\n\nuse lucatume\\WPBrowser\\Traits\\UopzFunctions;\nuse lucatume\\WPBrowser\\TestCase\\WPTestCase;\n\nclass MyTest extends WPTestCase\n{\n    use UopzFunctions;\n\n    public function test_can_set_function_return_with_closure()\n    {\n        $this-&gt;setFunctionReturn(\n            'wp_generate_nonce',\n            fn(string $action) =&gt; $action === 'test' ? 'test-nonce' : wp_create_nonce($action),\n            true\n        );\n\n        $this-&gt;assertEquals('test-nonce', wp_create_nonce('test'));\n        $this-&gt;assertNotEquals('test-nonce', wp_create_nonce('some-other-action'));\n    }\n}\n</code></pre>"},{"location":"traits/UopzFunctions/#unsetfunctionreturn","title":"unsetFunctionReturn","text":"<p><code>unsetFunctionReturn(string $function): void</code></p> <p>Unset the return value for the function <code>$function</code> previously set with <code>setFunctionReturn</code>.</p> <p>You do not need to unset the return value for a function that was set with <code>setFunctionReturn</code> using <code>unsetFunctionReturn</code> explicitly: the trait will take care of cleaning up all the modifications made to the functions, methods and class attributes after each test.</p>"},{"location":"traits/UopzFunctions/#setmethodreturn","title":"setMethodReturn","text":"<p><code>setMethodReturn(string $class, string $method, mixed $value, bool $execute = false): Closure</code></p> <p>Sets the return value for the static or instance method <code>$method</code> of the class <code>$class</code> to <code>$value</code>. The Closure returned by this method can be used to unset the return value.</p> <p>If <code>$value</code> is a closure and <code>$execute</code> is <code>true</code>, then the return value will be the return value of the closure.</p> <p>Magic methods like <code>__construct</code>, <code>__destruct</code>, <code>__call</code> and so on cannot be mocked using this method. See the <code>setClassMock</code> method for more information about how to mock magic class methods.</p> <pre><code>&lt;?php\n\nuse lucatume\\WPBrowser\\Traits\\UopzFunctions;\nuse lucatume\\WPBrowser\\TestCase\\WPTestCase;\n\nclass SomeLegacyClass {\n    public static function staticMethod(){\n        return 'some-static-value';\n    }\n\n    public function instanceMethod(){\n        return 'some-instance-value';\n    }\n}\n\nclass MyTest extends WPTestCase\n{\n    use UopzFunctions;\n\n    public function test_can_set_method_return()\n    {\n        $this-&gt;setMethodReturn(SomeLegacyClass::class, 'staticMethod', 'STATIC');\n        $this-&gt;setMethodReturn(SomeLegacyClass::class, 'instanceMethod', 'TEST');\n\n        $legacyClass = new SomeLegacyClass();\n\n        $this-&gt;assertEquals('STATIC', SomeLegacyClass::staticMethod());\n        $this-&gt;assertEquals('TEST', $legacyClass-&gt;instanceMethod());\n    }\n}\n</code></pre> <p>If <code>$value</code> is a closure, the original static or instance method can be called within the closure, with correctly bound <code>self</code> and <code>$this</code> context, to relay the original return value:</p> <pre><code>&lt;?php\n\nuse lucatume\\WPBrowser\\Traits\\UopzFunctions;\nuse lucatume\\WPBrowser\\TestCase\\WPTestCase;\n\nclass SomeLegacyClass {\n    public static function raiseStaticFlag(bool $flag = false){\n        return $flag ? 'static-flag-raised' : 'static-flag-lowered';\n    }\n\n    public function raiseFlag(bool $flag = false){\n        return $flag ? 'flag-raised' : 'flag-lowered';\n    }\n}\n\nclass MyTest extends WPTestCase\n{\n    use UopzFunctions;\n\n    public function test_can_set_method_return_with_closure()\n    {\n        $this-&gt;setMethodReturn(\n            SomeLegacyClass::class,\n            'raiseStaticFlag',\n            fn(bool $flag) =&gt; $flag ? 'STATIC' : self::raiseStaticFlag($flag),\n            true\n        );\n        $this-&gt;setMethodReturn(\n            SomeLegacyClass::class,\n            'raiseFlag',\n            fn(bool $flag) =&gt; $flag ? 'TEST' : $this-&gt;raiseFlag($flag),\n            true\n        );\n\n        $legacyClass = new SomeLegacyClass();\n\n        $this-&gt;assertEquals('STATIC', SomeLegacyClass::raiseStaticFlag(true));\n        $this-&gt;assertEquals('static-flag-lowered', SomeLegacyClass::raiseStaticFlag(false));\n        $this-&gt;assertEquals('TEST', $legacyClass-&gt;raiseFlag(true));\n        $this-&gt;assertEquals('flag-lowered', $legacyClass-&gt;raiseFlag(false));\n    }\n}\n</code></pre>"},{"location":"traits/UopzFunctions/#unsetmethodreturn","title":"unsetMethodReturn","text":"<p><code>unsetmethodreturn(string $class, string $method): void</code></p> <p>Unset the return value for the static or instance method <code>$method</code> of the class <code>$class</code> previously set with <code>setMethodReturn</code>.</p> <p>You do not need to unset the return value for a method that was set with <code>setMethodReturn</code> using <code>unsetMethodReturn</code> explicitly: the trait will take care of cleaning up all the modifications made to the functions, methods and class attributes after each test.</p>"},{"location":"traits/UopzFunctions/#setfunctionhook","title":"setFunctionHook","text":"<p><code>setFunctionHook(string $function, Closure $hook): Closure</code></p> <p>Execute <code>$hook</code> when entering the function <code>$function</code>. The Closure returned by this method can be used to unset the hook.</p> <p>Hooks can be set on both internal and user-defined functions.</p> <pre><code>&lt;?php\n\nuse lucatume\\WPBrowser\\Traits\\UopzFunctions;\nuse lucatume\\WPBrowser\\TestCase\\WPTestCase;\n\nclass MyTest extends WPTestCase\n{\n    use UopzFunctions;\n\n    public function test_can_set_hook()\n    {\n        $log = [];\n        $this-&gt;setFunctionHook(\n            'header', \n            function($header, bool $replace = true, int $response_code = 0) use (&amp;$log): void {\n                $log[] = $header;\n            }\n        );\n\n        header('X-Plugin-Version: 1.0.0');\n        header('X-Plugin-REST-Enabled: 1');\n        header('X-Plugin-GraphQL-Enabled: 0');\n\n        $this-&gt;assertEquals([\n            [\n                'X-Plugin-Version' =&gt; '1.0.0',\n                'X-Plugin-REST-Enabled' =&gt; '1',\n                'X-Plugin-GraphQL-Enabled' =&gt; '0'\n        ], $log);\n    }\n}\n</code></pre>"},{"location":"traits/UopzFunctions/#unsetfunctionhook","title":"unsetFunctionHook","text":"<p><code>unsetFunctionHook(string $function): void</code></p> <p>Unset the hook for the function <code>$function</code> previously set with <code>setFunctionHook</code>.</p> <p>You do not need to unset the hook for a function that was set with <code>setFunctionHook</code> using <code>unsetFunctionHook</code> explicitly: the trait will take care of cleaning up all the modifications made to the functions, methods and class attributes after each test.</p>"},{"location":"traits/UopzFunctions/#setmethodhook","title":"setMethodHook","text":"<p><code>setMethodHook(string $class, string $method, Closure $hook): Closure</code></p> <p>Execute <code>$hook</code> when entering the static or instance method <code>$method</code> of the class <code>$class</code>. The Closure returned by this method can be used to unset the hook.</p> <p>The keywords <code>self</code> and <code>$this</code> will be correctly bound to the class and the class instance respectively.</p> <pre><code>&lt;?php\n\nuse lucatume\\WPBrowser\\Traits\\UopzFunctions;\nuse lucatume\\WPBrowser\\TestCase\\WPTestCase;\n\nclass LegacyApiController {\n    private static array $connections = [];\n    private ?array $cachedItems = null;\n\n    public static function connect(): self {\n        $connected = new self;\n        self::$connections[] = $connected;\n        return $connected;\n    }\n\n    public function getItems(int $count, int $from = 0): array {\n        if($this-&gt;cachedItems === null){\n            $this-&gt;cachedItems = wp_remote_get('https://example.com/items');\n        }\n\n        return array_slice($this-&gt;cachedItems, $from, $count);\n    }\n}\n\nclass MyTest extends WPTestCase\n{\n    use UopzFunctions;\n\n    public function test_can_set_method_hook()\n    {\n        $connections = 0;\n        $this-&gt;setMethodHook(\n            LegacyApiController::class, \n            'connect', \n            function() use (&amp;$connections): void {\n                $connections  = count(self::$connections) + 1;\n            }\n        );\n        $itemsCacheHits = 0;\n        $this-&gt;setMethodHook(\n            LegacyApiController::class, \n            'getItems', \n            function(int $count, int $from = 0) use (&amp;$itemsCacheHit): bool {\n                if($this-&gt;cachedItems !== null){\n                    $itemsCacheHits++;\n                }\n            }\n        );\n\n        $connectedController1 = LegacyApiController::connect();\n        $connectedController2 = LegacyApiController::connect();\n        $connectedController1-&gt;getItems(10, 0);\n        $connectedController1-&gt;getItems(10, 10);\n        $connectedController2-&gt;getItems(10, 0);\n        $connectedController2-&gt;getItems(10, 10);\n\n        $this-&gt;assertEquals(2, $connections);\n        $this-&gt;assertEquals(4, $itemsCacheHits);\n    }\n}\n</code></pre>"},{"location":"traits/UopzFunctions/#unsetmethodhook","title":"unsetMethodHook","text":"<p><code>unsetMethodHook(string $class, string $method): void</code></p> <p>Unset the hook for the static or instance method <code>$method</code> of the class <code>$class</code> previously set with <code>setMethodHook</code>.</p> <p>You do not need to unset the hook for a method that was set with <code>seMethodHook</code> using <code>unsetClassMethodHook</code> explicitly: the trait will take care of cleaning up all the modifications made to the functions, methods and class attributes after each test.</p>"},{"location":"traits/UopzFunctions/#setconstant","title":"setConstant","text":"<p><code>setConstant(string $constant, mixed $value): Closure</code></p> <p>Set the constant <code>$constant</code> to the value <code>$value</code>. The Closure returned by this method can be used to unset the constant or reset it to its original value.</p> <p>If the constant is not already defined, it will be defined and set to the value <code>$value</code>.</p> <pre><code>&lt;?php\n\nuse lucatume\\WPBrowser\\Traits\\UopzFunctions;\nuse lucatume\\WPBrowser\\TestCase\\WPTestCase;\n\nclass MyTest extends WPTestCase\n{\n    use UopzFunctions;\n\n    public function test_can_set_constant()\n    {\n        $this-&gt;setconstant('WP_ADMIN', true);\n        $this-&gt;setconstant('TEST_CONST', 23);\n\n        $this-&gt;assertTrue(wp_is_admin());\n        $this-&gt;assertEquals(23, TEST_CONST);\n    }\n}\n</code></pre>"},{"location":"traits/UopzFunctions/#unsetconstant","title":"unsetConstant","text":"<p><code>unsetConstant(string $constant): void</code></p> <p>Unset an existing constant or restores the original value of the constant if set with <code>setConstant</code>.</p> <pre><code>&lt;?php\n\nuse lucatume\\WPBrowser\\Traits\\UopzFunctions;\nuse lucatume\\WPBrowser\\TestCase\\WPTestCase;\n\nclass MyTest extends WPTestCase\n{\n    use UopzFunctions;\n\n    public function test_can_unset_constant()\n    {\n        // The test is starting in Admin context.\n        $this-&gt;assertTrue(is_admin());\n\n        $this-&gt;unsetConstant('WP_ADMIN');\n\n        $this-&gt;assertFalse(is_admin());\n    }\n}\n</code></pre> <p>You do not need to undefine a constant defined with <code>setConstant</code> using <code>unsetConstant</code> explicitly: the trait will take care of cleaning up all the modifications made to the functions, methods and class attributes after each test.</p>"},{"location":"traits/UopzFunctions/#setclassconstant","title":"setClassConstant","text":"<p><code>setClassConstant(string $class, string $constant, mixed $value): Closure</code></p> <p>Set the constant <code>$constant</code> of the class <code>$class</code> to the value <code>$value</code>. The Closure returned by this method can be used to unset the constant or reset it to its original value.</p> <p>If the class constant is not already defined, it will be defined and set to the value <code>$value</code>.</p> <pre><code>&lt;?php\n\nuse lucatume\\WPBrowser\\Traits\\UopzFunctions;\nuse lucatume\\WPBrowser\\TestCase\\WPTestCase;\n\nclass MyPlugin {\n    const VERSION = '89.0.0';\n}\n\nclass MyTest extends WPTestCase\n{\n    use UopzFunctions;\n\n    public function test_can_set_class_constant()\n    {\n        $this-&gt;setClassConstant(MyPlugin::class, 'VERSION', '23.89.0');\n        $this-&gt;setClassConstant(MyPlugin::class, 'NOT_EXISTING', 'TEST');\n\n        $this-&gt;assertEquals('23.89.0', MyPlugin::VERSION);\n        $this-&gt;assertEquals('TEST', MyPlugin::NOT_EXISTING);\n    }\n}\n</code></pre>"},{"location":"traits/UopzFunctions/#unsetclassconstant","title":"unsetClassConstant","text":"<p><code>unsetClassConstant(string $class, string $constant): void</code></p> <p>Restore the constant <code>$constant</code> of the class <code>$class</code> to its original value or removes it if it was not defined.</p> <p>You do not need to undefine a constant defined with <code>setClassConstant</code> using <code>undefineClassConstant</code> explicitly: the trait will take care of cleaning up all the modifications made to the functions, methods and class attributes after each test.</p>"},{"location":"traits/UopzFunctions/#setclassmock","title":"setClassMock","text":"<p><code>setClassMock(string $class, string|object $mock): Closure</code></p> <p>Use <code>$mock</code> instead of <code>$class</code> when creating new instances of the class <code>$class</code>. The Closure returned by this method can be used to unset the mock.</p> <p>This method allows you to override magic methods as well as you would do with a normal class extension.</p> <pre><code>&lt;?php\n\nuse lucatume\\WPBrowser\\Traits\\UopzFunctions;\nuse lucatume\\WPBrowser\\TestCase\\WPTestCase;\n\nclass MockPaymentApi extends PaymentApi {\n    public static function version($name, $arguments){\n        return '23.89.0';\n    }\n}\n\nclass MyTest extends WPTestCase\n{\n    use UopzFunctions;\n\n    public function test_can_set_class_mock()\n    {\n        $this-&gt;setClassMock(PaymentApi::class, MockPaymentApi::class);\n\n        $paymentApi = new PaymentApi();\n        $this-&gt;assertInstanceOf(MyPluginMock::class, $paymentApi);\n        $this-&gt;assertSame('23.89.0', $paymentApi::version());\n    }\n}\n</code></pre> <p>If you set the <code>$mock</code> to an object, then the same mock object will be used for all the new instances of the class <code>$class</code>:</p> <pre><code>&lt;?php\n\nuse lucatume\\WPBrowser\\Traits\\UopzFunctions;\nuse lucatume\\WPBrowser\\TestCase\\WPTestCase;\n\nclass MockPaymentApi extends PaymentApi {\n    public function getIds($name, $arguments){\n        return [1, 23, 89];\n    }\n}\n\nclass MyTest extends WPTestCase\n{\n    use UopzFunctions;\n\n    public function test_can_set_class_mock()\n    {\n        $mockPaymentApi = new MockPaymentApi();\n\n        $this-&gt;setClassMock(PaymentApi::class, $mockPaymentApi);\n\n        $api1 = new PaymentApi();\n        $this-&gt;assertSame($mockPaymentApi, $api1);\n        $this-&gt;assertSame([1, 23, 89], $api1-&gt;getIds());\n        $api2 = new PaymentApi();\n        $this-&gt;assertSame($mockPaymentApi, $api2);\n        $this-&gt;assertSame([1, 23, 89], $api2-&gt;getIds());\n    }\n}\n</code></pre> <p>The <code>$mock</code> class, or instance, is not required to be a subclass of the class <code>$class</code> by the trait; although it might be required from the code you're testing by means of type hinting.</p> <p>If the class or method you would like to set a mock for is <code>final</code>, then you can combine this method with the <code>unsetClassFinalAttribute</code> and <code>unsetMethodFinalAttribute</code> methods to avoid the final attribute being set on the class:</p> <pre><code>&lt;?php\n\nuse lucatume\\WPBrowser\\Traits\\UopzFunctions;\nuse lucatume\\WPBrowser\\TestCase\\WPTestCase;\n\nfinal class LegacyPaymentApi {\n    public function getIds(){\n        // ... fetch ids from a real external API ...\n    }\n}\n\nclass LegacyCacheController {\n    protected final function get(string $key){\n        // ... fetch data from a real cache ...\n    }\n}\n\nclass MyTest extends WPTestCase\n{\n    use UopzFunctions;\n\n    public function test_can_set_class_mock()\n    {\n        $this-&gt;unsetClassFinalAttribute(LegacyPaymentApi::class);\n        $mockPaymentApi = new class extends LegacyPaymentApi {\n            public function getIds(){\n                return [1, 23, 89];\n            }\n        };\n        $this-&gt;setClassMock(LegacyPaymentApi::class, $mockPaymentApi);\n        $this-&gt;unsetMethodFinalAttribute(LegacyCacheController::class, 'get');\n        $mockCacheController = new class extends LegacyCacheController {\n            public function get(string $key){\n                return 'some-value';\n            }\n        };\n\n        $paymentApi = new LegacyPaymentApi();\n\n        $this-&gt;assertSame($mockPaymentApi, $paymentApi);\n        $this-&gt;assertSame([1, 23, 89], $paymentApi-&gt;getIds());\n\n        $cacheController = new LegacyCacheController();\n\n        $this-&gt;assertSame($mockCacheController, $cacheController);\n        $this-&gt;assertSame('some-value', $cacheController-&gt;get('some-key'));\n    }\n}\n</code></pre>"},{"location":"traits/UopzFunctions/#unsetclassmock","title":"unsetClassMock","text":"<p><code>unsetClassMock(string $class): void</code></p> <p>Remove the mock for the class <code>$class</code> previously set with <code>setMock</code>.</p> <pre><code>&lt;?php\n\nuse lucatume\\WPBrowser\\Traits\\UopzFunctions;\nuse lucatume\\WPBrowser\\TestCase\\WPTestCase;\n\nclass MyTest extends WPTestCase\n{\n    use UopzFunctions;\n\n    public function test_can_unset_class_mock()\n    {\n        $this-&gt;setClassMock(MyPlugin::class, new MyPluginMock());\n\n        $this-&gt;assertInstanceOf(MyPluginMock::class, new MyPlugin());\n\n        $this-&gt;unsetClassMock(MyPlugin::class);\n\n        $this-&gt;assertInstanceOf(MyPlugin::class, new MyPlugin());\n    }\n}\n</code></pre> <p>You do not need to unset the mock for a class that was set with <code>setClassMock</code> using <code>unsetClassMock</code> explicitly: the trait will take care of cleaning up all the modifications made to the functions, methods and class attributes after each test.</p>"},{"location":"traits/UopzFunctions/#unsetclassfinalattribute","title":"unsetClassFinalAttribute","text":"<p><code>unsetClassFinalAttribute(string $class): Closure</code></p> <p>Remove the <code>final</code> attribute from the class <code>$class</code>. The Closure returned by this method can be used to reset the <code>final</code> attribute.</p> <pre><code>&lt;?php\n\nuse lucatume\\WPBrowser\\Traits\\UopzFunctions;\nuse lucatume\\WPBrowser\\TestCase\\WPTestCase;\n\nfinal class LegacyPaymentApi {}\n\nclass MyTest extends WPTestCase\n{\n    use UopzFunctions;\n\n    public function test_can_remove_class_final_attribute()\n    {\n        $post = static::factory()-&gt;post-&gt;createAndGet();\n\n        $this-&gt;unsetClassFinalAttribute(LegacyPaymentApi::class);\n\n        // The class is not final anymore; it can be extended for testing purposes.\n        $mockPaymentApi = new class extends LegacyPaymentApi {\n            public function getIds(){\n                return [1, 23, 89];\n            }\n        };\n\n        $this-&gt;assertSame([1, 23, 89], $mockPaymentApi-&gt;getIds());\n    }\n}\n</code></pre>"},{"location":"traits/UopzFunctions/#resetclassfinalattribute","title":"resetClassFinalAttribute","text":"<p><code>resetClassFinalAttribute(string $class): void</code></p> <p>Reset the <code>final</code> attribute of the class <code>$class</code> previously removed with the <code>unsetClassFinalAttribute</code> method.</p> <p>You do not need to restore the class final attribute for a class that was set with <code>unsetClassFinalAttribute</code> using <code>setClassFinalAttribute</code> explicitly: the trait will take care of cleaning up all the modifications made to the functions, methods and class attributes after each test.</p>"},{"location":"traits/UopzFunctions/#unsetmethodfinalattribute","title":"unsetMethodFinalAttribute","text":"<p><code>unsetMethodFinalAttribute(string $class, string $method): Closure</code></p> <p>Remove the <code>final</code> attribute from the static or instance method <code>$method</code> of the class <code>$class</code>. The Closure returned by this method can be used to reset the <code>final</code> attribute.</p> <pre><code>&lt;?php\n\nuse lucatume\\WPBrowser\\Traits\\UopzFunctions;\nuse lucatume\\WPBrowser\\TestCase\\WPTestCase;\n\nclass MyTest extends WPTestCase\n{\n    use UopzFunctions;\n\n    public function test_can_remove_method_final_attribute()\n    {\n        $this-&gt;unsetMethodFinalAttribute(LegacyAjaxController::class, 'printResponseAndExit');\n\n        // Build a class to avoid the `printResponseAndExit` method from exiting.\n        $testLegacyAdminController = new class extends LegacyAjaxController {\n            public string $response = '';\n\n            public function printResponseAndExit(){\n                $this-&gt;response = $this-&gt;template-&gt;render('list', return: true);\n                return;\n            }\n        };\n\n        // Set up things for the test ...\n\n        $testLegacyAjaxController-&gt;printResponseAndExit();\n\n        $this-&gt;assertEquals('&lt;ul&gt;&lt;li&gt;Item One&lt;/li&gt;&lt;li&gt;Item Two&lt;/li&gt;&lt;/ul&gt;', $testLegacyAjaxController-&gt;response);\n    }\n}\n</code></pre>"},{"location":"traits/UopzFunctions/#restoremethodfinalattribute","title":"restoreMethodFinalAttribute","text":"<p><code>restoreMethodFinalAttribute(string $class, string $method): void</code></p> <p>Restore the <code>final</code> attribute of the method static or instance <code>$method</code> of the class <code>$class</code> previously removed with the <code>unsetMethodFinalAttribute</code> method.</p> <p>You do not need to restore the method final attribute for a method that was set with <code>unsetMethodFinalAttribute</code> using <code>restoreMethodFinalAttribute</code> explicitly: the trait will take care of cleaning up all the modifications made to the functions, methods and class attributes after each test.</p>"},{"location":"traits/UopzFunctions/#addclassmethod","title":"addClassMethod","text":"<p><code>addClassMethod(string $class, string $method, Closure $closure, bool $static = false): Closure</code></p> <p>Add a <code>public</code> static (<code>$static = true</code>) or instance (<code>$static = false</code>) method to the class <code>$class</code> with the name <code>$method</code> and the code provided by the closure <code>$closure</code>. The Closure returned by this method can be used to remove the method.</p> <p>Differently from the <code>setClassMock</code> method, this method will work on already existing instances of the class <code>$class</code>, not just new instances.</p> <p>The closure <code>$this</code> will be bound to the class instance.</p> <pre><code>&lt;?php\n\nuse lucatume\\WPBrowser\\Traits\\UopzFunctions;\nuse lucatume\\WPBrowser\\TestCase\\WPTestCase;\n\nclass LegacySingletonController {\n    private static $instance;\n    private array $cache = null;\n    private int $cacheCount = 0;\n\n    public static function getInstance(){\n        if(!self::$instance){\n            self::$instance = new self();\n        }\n        return self::$instance;\n    }\n\n    public function getItems(int $count, int $from = 0){\n        if($this-&gt;cache === null){\n            $this-&gt;cache = wp_remote_get('https://example.com/items');\n            $this-&gt;cacheCount = count($cache);\n        }\n\n        return array_slice($this-&gt;cache, $from, $count);\n    }\n}\n\nclass MyTest extends WPTestCase\n{\n    use UopzFunctions;\n\n    public function test_can_add_class_method()\n    {\n        $controller = LegacySingletonController::getInstance();\n\n        $this-&gt;addClassMethod(\n            LegacySingletonController::class, \n            'setCache',\n            function(array $cache): void {\n                $this-&gt;cache = $cache;\n                $this-&gt;cacheCount = count($cache);\n            }\n        );\n\n        // Set the singletong instance cache for testing purposes.\n        $controller-&gt;setCache(range(1,100));\n\n        $this-&gt;assertEquals([1,2,3], $controller-&gt;getItems(3, 0));\n    }\n</code></pre>"},{"location":"traits/UopzFunctions/#removeclassmethod","title":"removeClassMethod","text":"<p><code>removeClassMethod(string $class, string $method): void</code></p> <p>Remove the static or instance method <code>$method</code> added with <code>addClassMethod</code> from the class <code>$class</code>.</p> <p>You do not need to remove a method added with <code>addClassMethod</code>, or <code>addClassStaticMethod</code>, using <code>removeClassMethod</code> explicitly: the trait will take care of cleaning up all the modifications made to the functions, methods and class attributes after each test.</p>"},{"location":"traits/UopzFunctions/#setobjectproperty","title":"setObjectProperty","text":"<p><code>setObjectProperty(string|object $classOrObject, string $property, mixed $value): Closure</code></p> <p>If <code>$classOrInstance</code> is a string, set the property <code>$property</code> of the class <code>$classOrObject</code> to the value <code>$value</code>. If <code>$classOrInstance</code> is an object, set the property <code>$property</code> of the object <code>$classOrObject</code> to the value <code>$value</code>. The Closure returned by this method can be used to unset the property.</p> <pre><code>&lt;?php\n\nuse lucatume\\WPBrowser\\Traits\\UopzFunctions;\nuse lucatume\\WPBrowser\\TestCase\\WPTestCase;\n\nclass Payment {\n    private string $uuid;\n    private string $from;\n    private string $to;\n\n    public function __construct(string $from, $string $to){\n        $this-&gt;uuid = UUID::generate();\n    }\n\n    public function getHash(): string {\n        return wp_hash(serialize([\n            'uuid' =&gt; $this-&gt;uuid\n            'from' =&gt; $this-&gt;from,\n            'to' =&gt; $this-&gt;to\n        ]));\n    }\n}\n\nclass MyTest extends WPTestCase\n{\n    use UopzFunctions;\n\n    public function test_can_set_object_property()\n    {\n        $payment = new Payment('Bob', 'Alice');\n\n        $this-&gt;setObjectProperty($payment, 'uuid', '550e8400-e29b-41d4-a716-446655440000');\n\n        $this-&gt;assertEquals(wp_hash(serialize([\n            'uuid' =&gt; '550e8400-e29b-41d4-a716-446655440000',\n            'from' =&gt; 'Bob',\n            'to' =&gt; 'Alice'\n        ])), $payment-&gt;getHash());\n    }\n}\n</code></pre> <p>You do not need to reset the property of an object that was set with <code>setObjectProperty</code> explicitly: the trait will take care of cleaning up all the modifications made to the functions, methods and class attributes after each test.</p>"},{"location":"traits/UopzFunctions/#getobjectproperty","title":"getObjectProperty","text":"<p><code>getObjectProperty(object $object, string $property): mixed</code></p> <p>Get the value of the static or instance property <code>$property</code> of the object <code>$object</code>.</p> <pre><code>&lt;?php\n\nuse lucatume\\WPBrowser\\Traits\\UopzFunctions;\nuse lucatume\\WPBrowser\\TestCase\\WPTestCase;\n\nclass LegacyController {\n    private Template $template;\n\n    public function __construct(){\n        $this-&gt;template = new Template();\n    }\n\n    // ...\n}\n\nclass MyTest extends WPTestCase\n{\n    use UopzFunctions;\n\n    public function test_can_get_object_property()\n    {\n        $controller = new LegacyController();\n\n        $templateEngine $this-&gt;getObjectProperty($controller, 'template'));\n\n        // ... do something with the template ...\n    }\n}\n</code></pre>"},{"location":"traits/UopzFunctions/#resetobjectproperty","title":"resetObjectProperty","text":"<p><code>resetObjectProperty(string|object $classOrObject, string $property): void</code></p> <p>Reset the property <code>$property</code> of the class <code>$class</code> or object <code>$object</code> to its original value.</p> <p>You do not need to reset the property of an object that was set with <code>setObjectProperty</code> explicitly: the trait will take care of cleaning up all the modifications made to the functions, methods and class attributes after each test.</p>"},{"location":"traits/UopzFunctions/#getmethodstaticvariables","title":"getMethodStaticVariables","text":"<p><code>getMethodStaticVariables(string $class, string $method): array</code></p> <p>Get the value of the static variables of the class <code>$class</code> and method <code>$method</code>.</p> <p>The method will work for both static and instance methods of the class <code>$class</code>.</p> <pre><code>&lt;?php\n\nuse lucatume\\WPBrowser\\Traits\\UopzFunctions;\nuse lucatume\\WPBrowser\\TestCase\\WPTestCase;\n\nclass RequestLogger {\n    public function log(int $code, string $response):void {\n        static $requestId;\n\n        if($requestId === null){\n            $requestId = md5(microtime());\n        }\n\n        printf(\"Request %s: %d %s\\n\", $requestId, $code, $response);\n    }\n}\n\nclass MyTest extends WPTestCase\n{\n    use UopzFunctions;\n\n    public function test_can_get_class_method_static_variables()\n    {\n        $requestLogger = new RequestLogger();\n\n        ob_start();\n        $requestLogger-&gt;log(200, 'OK');\n        $requestLogger-&gt;log(403, 'Forbidden');\n        $requestLogger-&gt;log(200, 'OK');\n        $buffer = ob_get_clean();\n\n        $requestId = $this-&gt;getClassMethodStaticVariables(RequestLogger::class, 'log')['requestId'];\n\n        $this-&gt;assertEquals(\"Request $requestId: 200 OK\\nRequest $requestId: 403 Forbidden\\nRequest $requestId: 200 OK\\n\", $buffer);\n}\n</code></pre>"},{"location":"traits/UopzFunctions/#setmethodstaticvariables","title":"setMethodStaticVariables","text":"<p><code>setMethodStaticVariables(string $class, string $method, array $values): Closure</code></p> <p>Set the static variablesof the class <code>$class</code> and method <code>$method</code> to the values <code>$values</code>. The Closure returned by this method can be used to unset the static variables.</p> <p>This will work on both static and instance methods.</p> <pre><code>&lt;?php\n\nuse lucatume\\WPBrowser\\Traits\\UopzFunctions;\nuse lucatume\\WPBrowser\\TestCase\\WPTestCase;\n\nclass ListComponent {\n    public function render(){\n        static $hash;\n\n        if(!$hash){\n            $hash = md5(microtime());\n        }\n\n        return '&lt;ul screen=' . $hash . '&gt;&lt;li&gt;Item One&lt;/li&gt;&lt;li&gt;Item Two&lt;/li&gt;&lt;/ul&gt;';\n    }\n}\n\nclass MyTest extends WPTestCase\n{\n    use UopzFunctions;\n\n    public function test_can_set_class_method_static_variables()\n    {\n        $newValues = array_merge(\n            $this-&gt;getMethodStaticVariables(ListComponent::class, 'render'),\n            ['hash' =&gt; 'some-hash']\n        );\n        $this-&gt;setClassMethodStaticVariables( ListComponent::class, 'render', [\n          'hash' =&gt; 'some-hash'\n        ]);\n\n        $component = new ListComponent();\n\n        $this-&gt;assertEquals(\n            '&lt;ul data-screen=\"some-hash\"&gt;&lt;li&gt;Item One&lt;/li&gt;&lt;li&gt;Item Two&lt;/li&gt;&lt;/ul&gt;', \n            $component-&gt;render()\n        );\n    }\n}\n</code></pre> <p>You do not need to reset the static variable of a class method that was set with <code>setMethodStaticVariables</code> explicitly using <code>resetMethodStaticVariables</code> explicitly: the trait will take care of cleaning up all the modifications made to the functions, methods and class attributes after each test.</p>"},{"location":"traits/UopzFunctions/#resetmethodstaticvariables","title":"resetMethodStaticVariables","text":"<p><code>resetMethodStaticVariables(string $class, string $method): void</code></p> <p>Resets the static variables of the class <code>$class</code> method <code>$method</code> to their original values.</p>"},{"location":"traits/UopzFunctions/#setfunctionstaticvariable","title":"setFunctionStaticVariable","text":"<p><code>setFunctionStaticVariables(string $function, string $variable, mixed $value): Closure</code></p> <p>Set the static variable <code>$variable</code> of the function <code>$function</code> to the value <code>$value</code>. The Closure returned by this method can be used to unset the static variable.</p> <pre><code>&lt;?php\n\nuse lucatume\\WPBrowser\\Traits\\UopzFunctions;\nuse lucatume\\WPBrowser\\TestCase\\WPTestCase;\n\nfunction renderScreen(): string{\n    static $rendered;\n\n    if($rendered){\n        return;\n    }\n\n    $html = '&lt;p&gt;Some HTML&lt;/p&gt;';\n\n    $rendered = true;\n\n    return $html;\n}\n\nclass MyTest extends WPTestCase\n{\n    use UopzFunctions;\n\n    public function test_can_set_function_static_variables()\n    {\n        $this-&gt;setFunctionStaticVariables('renderScreen', ['rendered' =&gt; false]);\n\n        $this-&gt;assertEquals('&lt;p&gt;Some HTML&lt;/p&gt;', renderScreen());\n    }\n}\n</code></pre> <p>You do not need to reset the value of a function static variable set using the <code>resetFunctionStaticVariables</code> method explicitly: the trait will take care of cleaning up all the modifications made to the functions, methods and class attributes after each test.</p>"},{"location":"traits/UopzFunctions/#getfunctionstaticvariables","title":"getFunctionStaticVariables","text":"<p><code>getFunctionStaticVariables(string $function, ): array</code></p> <p>Get the value of the static variable <code>$variable</code> of the function <code>$function</code>.</p> <pre><code>&lt;?php\n\nuse lucatume\\WPBrowser\\Traits\\UopzFunctions;\nuse lucatume\\WPBrowser\\TestCase\\WPTestCase;\n\nfunction renderScreen(): string {\n    static $screenHash;\n\n    if(!$screenHash){\n        $screenHash = md5(microtime());\n    }\n\n    return '&lt;p data-screen=\"' . $screenHash . '\"&gt;Some HTML&lt;/p&gt;';\n}\n\nclass MyTest extends WPTestCase\n{\n    use UopzFunctions;\n\n    public function test_can_set_function_static_variables()\n    {\n        $screenHash = $this-&gt;getFunctionStaticVariables('renderScreen')['screenHash'];\n\n        $this-&gt;assertEquals('&lt;p data-screen=\"' . $screenHash . '\"&gt;Some HTML&lt;/p&gt;', renderScreen());\n    }\n}\n</code></pre>"},{"location":"traits/UopzFunctions/#resetfunctionstaticvariables","title":"resetFunctionStaticVariables","text":"<p><code>resetFunctionStaticVariables(string $function): void</code></p> <p>Resets the static variables of the function <code>$function</code> set with the <code>setFunctionStaticVariables</code> method.</p>"},{"location":"traits/UopzFunctions/#addfunction","title":"addFunction","text":"<p><code>addFunction(string $function, Closure $closure): void</code></p> <p>Add a global or namespaced function to the current scope.</p> <pre><code>&lt;?php\n\nuse lucatume\\WPBrowser\\Traits\\UopzFunctions;\nuse lucatume\\WPBrowser\\TestCase\\WPTestCase;\n\nclass MyTest extends WPTestCase\n{\n    use UopzFunctions;\n\n    public function test_can_add_function()\n    {\n        $this-&gt;addFunction('myGlobalFunction', fn() =&gt; 23);\n        $this-&gt;addFunction('Acme\\Project\\namespacedFunction', fn() =&gt; 89);\n\n        $this-&gt;assertEquals(23, myGlobalFunction());\n        $this-&gt;assertEquals(89, Acme\\Project\\namespacedFunction());\n    }\n}\n</code></pre>"},{"location":"traits/UopzFunctions/#removefunction","title":"removeFunction","text":"<p><code>removeFunction(string $function): void</code></p> <p>Removes the global or namespaced function <code>$function</code> from the current scope. This will work for functions defined using the <code>addFunction</code> method or defined elsewhere.</p> <pre><code>&lt;?php\n\nuse lucatume\\WPBrowser\\Traits\\UopzFunctions;\nuse lucatume\\WPBrowser\\TestCase\\WPTestCase;\n\nclass MyTest extends WPTestCase\n{\n    use UopzFunctions;\n\n    public function test_can_add_function()\n    {\n        $this-&gt;addFunction('myGlobalFunction', fn() =&gt; 23);\n        $this-&gt;addFunction('Acme\\Project\\namespacedFunction', fn() =&gt; 89);\n\n        $this-&gt;removeFunction('some_plugin_function');\n        $this-&gt;removeFunction('Acme\\Project\\namespacedFunction');\n\n        // Added with addFunction.\n        $this-&gt;assertFalse(function_exists('myGlobalFunction');\n        $this-&gt;assertFalse(function_exists('Acme\\Project\\namespacedFunction');\n\n        $this-&gt;assertFalse(function_exists('some_plugin_function');\n        $this-&gt;assertFalse(function_exists('Another\\Plugin\\some_function');\n    }\n}\n</code></pre> <p>You do not need to remove a function added with <code>addFunction</code> using <code>removeFunction</code> explicitly: the trait will take care of cleaning up all the modifications made to the functions, methods and class attributes after each test.</p>"},{"location":"traits/UopzFunctions/#preventexit","title":"preventExit","text":"<p><code>preventExit(): void</code></p> <p>Prevents <code>exit</code> or <code>die</code> calls executed after the method from terminating the PHP process calling <code>exit</code> or <code>die</code>.</p> <pre><code>&lt;?php\n\nuse lucatume\\WPBrowser\\Traits\\UopzFunctions;\nuse lucatume\\WPBrowser\\TestCase\\WPTestCase;\n\nfunction printAndDie(): void{\n    print 'Some HTML';\n    die();\n}\n\nclass MyTest extends WPTestCase\n{\n    use UopzFunctions;\n\n    public function test_can_prevent_exit()\n    {\n        $this-&gt;preventExit();\n\n        ob_start();\n        printAndDie();\n        $buffer = ob_get_clean();\n\n        $this-&gt;assertEquals('Some HTML', $buffer);\n    }\n}\n</code></pre>"},{"location":"traits/UopzFunctions/#restoreexit","title":"restoreExit","text":"<p><code>allowExit(): void</code></p> <p>Restores the original behavior of the <code>exit</code> and <code>die</code> functions.</p> <p>You do not need to restore the exit behavior for a exit that was prevented using <code>preventExit</code> using <code>allowExit</code> explicitly: the trait will take care of cleaning up all the modifications made to the functions, methods and class attributes after each test.</p>"},{"location":"v3/","title":"Welcome","text":"<p>This is the documentation for version 3 of the project. The current version is version 4 and the documentation can be found here.</p> <p>The wp-browser project provides a Codeception based solution to test WordPress plugins, themes and whole sites at all levels of testing.  </p> <p>The purpose of this documentation is to help you set up, run and iterate over your project and test code using the powerful APIs provided by Codeception while trying to alleviate the pains of setting it up for WordPress projects.  </p> <p>Throughout the documentation you will find references to test terminology: I've tried to condense those into small, digestable chunks to provide a rough idea without and a limited context; where required I tried to provide links to dive deeper into the subjects.  </p> <p>Happy testing!</p>"},{"location":"v3/codeception-4-support/","title":"Using wp-browser with Codeception 4.0","text":"<p>This is the documentation for version 3 of the project. The current version is version 4 and the documentation can be found here.</p>"},{"location":"v3/codeception-4-support/#using-wp-browser-with-codeception-40","title":"Using wp-browser with Codeception 4.0","text":"<p>Codeception version <code>4.0</code> introduced a number of new features to the framework and it's the version of wp-browser that will be maintained from now on.  </p> <p>I've made an effort to keep <code>wp-browser</code> compatible with PHP 5.6 and Codeception versions from <code>2.5</code> up.  </p> <p>One the biggest changes of Codeception version <code>4.0</code> is that modules have been broken out into separate packages. To use <code>wp-browser</code> with Codeception <code>4.0</code> all you need to do is to add this to your project <code>composer.json</code> file:</p> <pre><code>{\n  \"require-dev\": {\n    \"lucatume/wp-browser\": \"^2.4\",\n    \"codeception/module-asserts\": \"^1.0\",\n    \"codeception/module-phpbrowser\": \"^1.0\",\n    \"codeception/module-webdriver\": \"^1.0\",\n    \"codeception/module-db\": \"^1.0\",\n    \"codeception/module-filesystem\": \"^1.0\",\n    \"codeception/module-cli\": \"^1.0\",\n    \"codeception/util-universalframework\": \"^1.0\"\n  }\n}\n</code></pre> <p>You might not need all the modules listed here, depending on the wp-browser modules you use in your test suites. This is a scheme of what Codeception modules you will need for which wp-browser module to help you choose only the required modules:</p> <ul> <li>\"codeception/module-asserts\" -  Required for Codeception 4.0 compatibility.</li> <li>\"codeception/module-phpbrowser\" -  Required by the <code>WPBrowser</code> module.</li> <li>\"codeception/module-webdriver\" - Required by the <code>WPWebDriver</code> module.</li> <li>\"codeception/module-db\" - Required by the <code>WPDb</code> module.</li> <li>\"codeception/module-filesystem\" - Required by the <code>WPFilesystem</code> module.</li> <li>\"codeception/module-cli\" - Required by the <code>WPCLI</code> module.</li> <li>\"codeception/util-universalframework\" - Required by the <code>WordPress</code> framework module.</li> </ul>"},{"location":"v3/codeception-phpunit-and-wpbrowser/","title":"Codeception, PHPUnit and wp-browser","text":"<p>This is the documentation for version 3 of the project. The current version is version 4 and the documentation can be found here.</p>"},{"location":"v3/codeception-phpunit-and-wpbrowser/#the-wp-browser-stack","title":"The wp-browser stack","text":"<p>The wp-browser project is built leveraging the power of a number of open-source projects.  </p> <p>While I'm not listing all of them here it's worth mentioning those that will come up, again and again, in the documentation.</p>"},{"location":"v3/codeception-phpunit-and-wpbrowser/#wordpress","title":"WordPress","text":"<p>WordPress is open source software you can use to create a beautiful website, blog, or app.  </p> <p>The line is taken directly from WordPress.org site. </p> <p>In the context of this documentation WordPress is the PHP and JavaScript framework websites and web applications can be built on, the one anyone can download from here.</p>"},{"location":"v3/codeception-phpunit-and-wpbrowser/#codeception","title":"Codeception","text":"<p>Codeception (home) is a modern, powerful PHP testing framework written in PHP.  </p> <p>It comes with a number of modules and extensions that are comparable to WordPress plugins and themes.  </p> <p>Modules and extensions are combined in suites to be able to run a specific type of test. Each suite will handle a specific type of test for a specific set of code.</p> <p>wp-browser is none other than a collection of modules and extensions for Codeception made specifically to test WordPress applications.</p>"},{"location":"v3/codeception-phpunit-and-wpbrowser/#phpunit","title":"PHPUnit","text":"<p>PHPUnit is the most widely known PHP testing framework. As the name implies it was born to make unit testing of PHP code easier but its scope and power has grown well below that.  </p> <p>Codeception is based, and uses, PhpUnit to wrap some of its functionalities into an easy-to-use API. The two are so compatible one with the other that Codeception can run PHPUnit tests with little to no changes.</p> <p>This documentation will not cover this subject and will only deal with Codeception-native test methods but you can find more information here.</p>"},{"location":"v3/commands/","title":"Commands","text":"<p>This is the documentation for version 3 of the project. The current version is version 4 and the documentation can be found here.</p>"},{"location":"v3/commands/#custom-commands-provided-by-wp-browser","title":"Custom commands provided by wp-browser","text":"<p>The project comes with its own set of custom Codeception commands.  </p> <p>The commands provide functionalities to quickly scaffold different types of tests. Any other <code>codecept</code> command remains intact and available. </p>"},{"location":"v3/commands/#adding-the-commands-to-an-existing-project","title":"Adding the commands to an existing project","text":"<p>The commands are added to the main Codeception configuration file, <code>codeception.yml</code>, when scaffolding a project via the <code>codecept init wp-browser</code> command.  </p> <p>They can be added to any existing project adding, or editing, the <code>commands</code> section of the configuration file:</p> <pre><code>extensions:\n    commands:\n        - \"Codeception\\\\Command\\\\GenerateWPUnit\"\n        - \"Codeception\\\\Command\\\\GenerateWPRestApi\"\n        - \"Codeception\\\\Command\\\\GenerateWPRestController\"\n        - \"Codeception\\\\Command\\\\GenerateWPRestPostTypeController\"\n        - \"Codeception\\\\Command\\\\GenerateWPAjax\"\n        - \"Codeception\\\\Command\\\\GenerateWPCanonical\"\n        - \"Codeception\\\\Command\\\\GenerateWPXMLRPC\"\n</code></pre>"},{"location":"v3/commands/#generation-commands","title":"Generation commands","text":"<p>The library provides commands to quickly scaffold integration test cases for specific types of WordPress components, see levels of testing for more information.  </p> <p>The tests are almost identical to the ones you could write in a PHPUnit based Core suite with the exception of extending the <code>Codeception\\TestCase\\WPTestCase</code> test case.</p>"},{"location":"v3/commands/#generatewpunit","title":"generate:wpunit","text":"<p>Generates a test case extending the <code>\\Codeception\\TestCase\\WPTestCase</code> class using the</p> <pre><code>  codecept generate:wpunit suite SomeClass\n</code></pre> <p>The command will generate a skeleton test case like</p> <pre><code>&lt;?php\n\nclass SomeClassTest extends \\Codeception\\TestCase\\WPTestCase\n{\n    public function setUp()\n    {\n      parent::setUp();\n    }\n\n    public function tearDown()\n    {\n      parent::tearDown();\n    }\n\n    // tests\n    public function testMe()\n    {\n    }\n\n}\n</code></pre>"},{"location":"v3/commands/#generatewprest","title":"generate:wprest","text":"<p>Generates a test case extending the <code>\\Codeception\\TestCase\\WPRestApiTestCase</code> class using the</p> <pre><code>  codecept generate:wprest suite SomeClass\n</code></pre> <p>The command will generate a skeleton test case like</p> <pre><code>&lt;?php\n\nclass SomeClassTest extends \\Codeception\\TestCase\\WPRestApiTestCase\n{\n    public function setUp()\n    {\n      parent::setUp();\n    }\n\n    public function tearDown()\n    {\n      parent::tearDown();\n    }\n\n    // tests\n    public function testMe()\n    {\n    }\n\n}\n</code></pre>"},{"location":"v3/commands/#generatewprestcontroller","title":"generate:wprestcontroller","text":"<p>Generates a test case extending the <code>\\Codeception\\TestCase\\WPRestControllerTestCase</code> class using the</p> <pre><code>  codecept generate:wprest suite SomeClass\n</code></pre> <p>The command will generate a skeleton test case like</p> <pre><code>&lt;?php\n\nclass SomeClassTest extends \\Codeception\\TestCase\\WPRestControllerTestCase\n{\n    public function setUp()\n    {\n      parent::setUp();\n    }\n\n    public function tearDown()\n    {\n      parent::tearDown();\n    }\n\n    // tests\n    public function testMe()\n    {\n    }\n\n}\n</code></pre>"},{"location":"v3/commands/#generatewprestposttypecontroller","title":"generate:wprestposttypecontroller","text":"<p>Generates a test case extending the <code>\\Codeception\\TestCase\\WPRestPostTypeControllerTestCase</code> class using the</p> <pre><code>  codecept generate:wprest suite SomeClass\n</code></pre> <p>The command will generate a skeleton test case like</p> <pre><code>&lt;?php\n\nclass SomeClassTest extends \\Codeception\\TestCase\\WPRestPostTypeControllerTestCase\n{\n    public function setUp()\n    {\n      parent::setUp();\n    }\n\n    public function tearDown()\n    {\n      parent::tearDown();\n    }\n\n    // tests\n    public function testMe()\n    {\n    }\n\n}\n</code></pre>"},{"location":"v3/commands/#generatewpajax","title":"generate:wpajax","text":"<p>Generates a test case extending the <code>\\Codeception\\TestCase\\WPAjaxTestCase</code> class using the</p> <pre><code>  codecept generate:wpajax suite SomeClass\n</code></pre> <p>The command will generate a skeleton test case like</p> <pre><code>&lt;?php\n\nclass SomeClassTest extends \\Codeception\\TestCase\\WPAjaxTestCase\n{\n    public function setUp()\n    {\n      parent::setUp();\n    }\n\n    public function tearDown()\n    {\n      parent::tearDown();\n    }\n\n    // tests\n    public function testMe()\n    {\n    }\n\n}\n</code></pre>"},{"location":"v3/commands/#generatewpxmlrpc","title":"generate:wpxmlrpc","text":"<p>Generates a test case extending the <code>\\Codeception\\TestCase\\WPXMLRPCTestCase</code> class using the</p> <pre><code>  codecept generate:wpxmlrpc suite SomeClass\n</code></pre> <p>The command will generate a skeleton test case like</p> <pre><code>&lt;?php\n\nclass SomeClassTest extends \\Codeception\\TestCase\\WPXMLRPCTestCase\n{\n    public function setUp()\n    {\n      parent::setUp();\n    }\n\n    public function tearDown()\n    {\n      parent::tearDown();\n    }\n\n    // tests\n    public function testMe()\n    {\n    }\n\n}\n</code></pre>"},{"location":"v3/commands/#generatewpcanonical","title":"generate:wpcanonical","text":"<p>Generates a test case extending the <code>\\Codeception\\TestCase\\WPCanonicalTestCase</code> class using the</p> <pre><code>  codecept generate:wpcanonical suite SomeClass\n</code></pre> <p>The command will generate a skeleton test case like</p> <pre><code>&lt;?php\n\nclass SomeClassTest extends \\Codeception\\TestCase\\WPCanonicalTestCase\n{\n    public function setUp()\n    {\n      parent::setUp();\n    }\n\n    public function tearDown()\n    {\n      parent::tearDown();\n    }\n\n    // tests\n    public function testMe()\n    {\n    }\n\n}\n</code></pre>"},{"location":"v3/configuration/","title":"Configuration","text":"<p>This is the documentation for version 3 of the project. The current version is version 4 and the documentation can be found here.</p>"},{"location":"v3/configuration/#initializing-wp-browser","title":"Initializing wp-browser","text":"<p>While wp-browser can be configured manually creating each file the fastest way to bootstrap its configuration is by using its initialization template.  </p> <p>Throughout the steps below I will use the WordPress setup I've prepared before From the root folder of the project, <code>/Users/luca/Sites/wordpress/wp-content/plugins/acme-plugin</code> in the example, run the command:</p> <pre><code>vendor/bin/codecept init wpbrowser\n</code></pre> <p>Composer installed Codeception binary (<code>codecept</code>) in the <code>vendor</code> folder of my project.  </p> <p>With the command above I'm telling Codeception to initialize a wp-browser project in the current folder. When I click enter I'm presented with a list of questions, each answer will be used to configure the wp-browser project for me; one by one.  </p> <p>In the screenshot the answers I've provided to each question, with reference to the setup above:</p> <p></p> <p></p> <p>wp-browser will try to provide a brief explanation of what each question is but below is the long version.</p>"},{"location":"v3/configuration/#long-question-explanation","title":"Long question explanation","text":"<p>I've tried to condense as much clarity as possible in the questions the <code>codecept init wpbrowser</code> command will ask but, for sake of brevity and space, there's no way I could provide inline a deeper explanation of each.  </p> <p>Below is a longer explanation of each question:</p> <ul> <li>How would you like the acceptance suite to be called? </li> <li>How would you like the functional suite to be called? </li> <li>How would you like the WordPress unit and integration suite to be called? </li> <li>How would you like to call the env configuration file? </li> <li>Where is WordPress installed? </li> <li>What is the path, relative to WordPress root URL, of the admin area of the test site?</li> <li>What is the name of the test database used by the test site? </li> <li>What is the host of the test database used by the test site? </li> <li>What is the user of the test database WPLoader should use? </li> <li>What is the password of the test database WPLoader should use? </li> <li>What is the table prefix of the test database WPLoader should use? </li> <li>What is the URL the test site? </li> <li>What is the email of the test site WordPress administrator? </li> <li>What is the title of the test site? </li> <li>What is the login of the administrator user of the test site? </li> <li>What is the password of the administrator user of the test site? </li> <li>Are you testing a plugin, a theme or a combination of both? </li> <li>What is the folder/plugin.php name of the plugin? </li> <li>Are you developing a child theme? </li> <li>Are you using a child theme? </li> <li>What is the slug of the parent theme? </li> <li>What is the slug of the theme? </li> <li>What is the slug of the theme you are using? </li> <li>Does your project needs additional plugins to be activated to work? </li> </ul>"},{"location":"v3/configuration/#how-would-you-like-the-acceptance-suite-to-be-called","title":"How would you like the acceptance suite to be called?","text":"<p>With reference to the testing levels definition this question provides you with the possibility to change the name of the acceptance-like test suite.  </p> <p>Common, alternative, names are <code>ui</code>, <code>rest</code> and <code>user</code>.  </p>"},{"location":"v3/configuration/#how-would-you-like-the-functional-suite-to-be-called","title":"How would you like the functional suite to be called?","text":"<p>With reference to the testing levels definition this question provides you with the possibility to change the name of the functional-like test suite.  </p> <p>A common alternative name is <code>service</code>.  </p>"},{"location":"v3/configuration/#how-would-you-like-the-wordpress-unit-and-integration-suite-to-be-called","title":"How would you like the WordPress unit and integration suite to be called?","text":"<p>With reference to the testing levels definition this question provides you with the possibility to change the name of the suite dedicated to integration and \"WordPress unit\" tests.  </p> <p>A common alternative name is <code>integration</code>.  </p>"},{"location":"v3/configuration/#how-would-you-like-to-call-the-env-configuration-file","title":"How would you like to call the env configuration file?","text":"<p>Instead of configuring each module in each suite with the same parameters over and over Codeception supports dynamic configuration via environment files.  </p> <p>wp-browser will scaffold such a configuration for you and will use, by default, a file called <code>.env</code> to store the configuration parameters.  </p> <p>The file name might not suit all setups especially and this question allows changing that file name; common, alternative, file names are <code>.env.tests</code>, <code>.env.codeception</code> and similar.  </p>"},{"location":"v3/configuration/#where-is-wordpress-installed","title":"Where is WordPress installed?","text":"<p>During tests the test code will need to access WordPress code, precisely wp-browser requires being pointed to the folder that contains the <code>wp-load.php</code> file.  </p> <p>The answer can be an absolute path, like <code>/Users/luca/Sites/wordrpress</code>, or a path relative to the folder where Codeception is installed like <code>vendor/wordpress</code>. </p> <p>This path should be accessible by the machine that is running the tests; if you're running the tests from your machine (e.g. your laptop) that's just the path to the folder where WordPress is installed, <code>/Users/luca/Sites/wordpress</code> in the example configuration above.  </p> <p>If you are, instead, running the tests from within a virtualized machine (e.g. Vagrant or Docker) then the path should be the one used by the virtualized machine.  </p> <p>To make an example:</p> <ul> <li>on my machine WordPress is installed at <code>/Users/luca/Sites/wordpress</code></li> <li>I've created a Docker container using the official WordPress image and bound the above folder into the container</li> <li>internally the container will put WordPress in the <code>/var/www/html</code> folder</li> </ul> <p>If I run the tests from my host machine then WordPress root directory will be <code>/Users/luca/Sites/wordpress</code>, if I run the tests from within the Docker container then WordPress root folder will be <code>/var/www/html</code>. </p> <p>Another example is Local by Flywheel:</p> <ul> <li>in the host machine the path to the WordPress root folder will be <code>/Users/luca/Local\\ Sites/wordpress/app/public</code></li> <li>from within the Docker container managed by Local the path will be <code>/app/public</code></li> </ul> <p>If you need a solution that will work in both instances use a relative path: wp-browser will accept paths like <code>./../../../wordpress</code> and will attempt to resolve them.</p>"},{"location":"v3/configuration/#what-is-the-path-relative-to-wordpress-root-url-of-the-admin-area-of-the-test-site","title":"What is the path, relative to WordPress root URL, of the admin area of the test site?","text":"<p>This is usually <code>/wp-admin</code> but you might have the web-server, or a plugin, redirect or hide requests for the administration area to another path.  </p> <p>Some examples are <code>/admin</code>, <code>/login</code> and the like.  </p> <p>Mind that this is not the path to the login page but the path to the administrationo area; this will be used by wp-browser to find to the administration area in acceptance and functional tests.</p>"},{"location":"v3/configuration/#what-is-the-name-of-the-test-database-used-by-the-test-site","title":"What is the name of the test database used by the test site?","text":"<p>In my example setup it's <code>wordpress</code>.  </p> <p>This is the name of the database that is storing the information used by the site I can reach at <code>http://localhost:8080</code>.  </p> <p>I want to underline the word \"test\". Any site and any database you use and expose to wp-browser should be intended for tests; this means that it does not contain any data you care about as it will be lost.</p>"},{"location":"v3/configuration/#what-is-the-host-of-the-test-database-used-by-the-test-site","title":"What is the host of the test database used by the test site?","text":"<p>In my example setup it's <code>127.0.0.1:3306</code>.  </p> <p>Here the same principle valid for Where is WordPress installed? applies: the database host is relative to the machine that is running the tests.  </p> <p>In my example I'm hosting the database locally, on my laptop, and my machine can reach it at the localhost address (<code>127.0.0.1</code>) on MySQL default port (<code>3306</code>).  </p> <p>If I am using the database of a Local by Flywheel site from my host machine then it might be something like <code>192.168.92.100:4050</code> (from the site \"Database\" tab); the same principle applies if I am using a Vagrant-based or Docker-based solution.  </p> <p>If I am running the tests from within a virtualized machine (a Docker container, a Vagrant box et cetera) then it would probably be <code>localhost</code> or <code>1270.0.0.1</code>.  </p> <p>This detail will be used in the context of acceptance and functional tests by the WPDb module.</p>"},{"location":"v3/configuration/#what-is-the-user-of-the-test-database-used-by-the-test-site","title":"What is the user of the test database used by the test site?","text":"<p>In my example setup it's <code>root</code> as I'm using MySQL server root user to access the database during tests.  </p> <p>Depending on your setup it might be different; since wp-browser will need to not only read but write too to the database make sure to use a user that has full access to the database specified in the answer to the What is the host of the test database used by the test site? question.</p> <p>This detail will be used in the context of acceptance and functional tests by the WPDb module.</p>"},{"location":"v3/configuration/#what-is-the-password-of-the-test-database-used-by-the-test-site","title":"What is the password of the test database used by the test site?","text":"<p>In my example setup it's empty as I've not set any password for the root account.</p> <p>In your case it might be different and it should be the password associated with the user specified in the answer to the What is the user of the test database used by the test site? question.</p> <p>This detail will be used in the context of acceptance and functional tests by the WPDb module.</p>"},{"location":"v3/configuration/#what-is-the-table-prefix-of-the-test-database-used-by-the-test-site","title":"What is the table prefix of the test database used by the test site?","text":"<p>In my example setup it's <code>wp_</code>; that value is taken from the WordPress installation configuration file.  </p> <p>To have any influence on the site wp-browser will need to modify the same database tables WordPress is using; as I did you can take this value from the <code>wp-config.php</code> file directly: it's the value of the <code>$table_prefix</code> variable.  </p> <p>This detail will be used in the context of acceptance and functional tests by the WPDb module.</p>"},{"location":"v3/configuration/#what-is-the-name-of-the-test-database-wploader-should-use","title":"What is the name of the test database WPLoader should use?","text":"<p>In my example setup it's <code>tests</code>.  </p> <p>During integration, or WordPress \"unit\" tests, wp-loader will need to load WordPress code.  </p> <p>Since WordPress code is not meant to be \"modular\" it does not support auto-loading or loading just parts of it; it's either almost all or nothing.  </p> <p>One of the first things WordPress does, when loading, is trying to connect to a database: if that database is not available then WordPress will not load.  </p> <p>In the answer to the question Where is WordPress installed? I've told wp-browser where to find WordPress code, in this answer I'm telling wp-browser what database it should use to bootstrap WordPress.  </p> <p>This detail will be used by the WPLoader module to bootstrap WordPress. It's highly recommended to use a different database from the one used for functional and acceptance tests.</p>"},{"location":"v3/configuration/#what-is-the-host-of-the-test-database-wploader-should-use","title":"What is the host of the test database WPLoader should use?","text":"<p>In my example setup it's <code>127.0.0.1:3306</code>.  </p> <p>As in the answer to the question What is the name of the test database WPLoader should use? we're providing connection details about the database that should be used to bootstrap WordPress during integration and WordPress \"unit\" tests.  </p> <p>Again the database host is in relation to the machine running the tests, all the considerations done for What is the host of the test database used by the test site? apply.</p> <p>This detail will be used by the WPLoader module to bootstrap WordPress.</p>"},{"location":"v3/configuration/#what-is-the-user-of-the-test-database-wploader-should-use","title":"What is the user of the test database WPLoader should use?","text":"<p>In my example it's <code>root</code>.  </p> <p>Similar to the question What is the user of the test database used by the test site? but in relation to the database specified in the question What is the name of the test database WPLoader should use?.  </p> <p>This detail will be used by the WPLoader module to bootstrap WordPress.</p>"},{"location":"v3/configuration/#what-is-the-password-of-the-test-database-wploader-should-use","title":"What is the password of the test database WPLoader should use?","text":"<p>In my example setup it's empty as I've not set any password for the root account.  </p> <p>Similar to the question What is the password of the test database used by the test site? but in relation to the database specified in the question What is the name of the test database WPLoader should use?.  </p> <p>This detail will be used by the WPLoader module to bootstrap WordPress.</p>"},{"location":"v3/configuration/#what-is-the-table-prefix-of-the-test-database-wploader-should-use","title":"What is the table prefix of the test database WPLoader should use?","text":"<p>In my example setup it's <code>wp_</code>.  </p> <p>Similar to the question What is the table prefix of the test database used by the test site? but in relation to the database specified in the question What is the name of the test database WPLoader should use?.  </p> <p>This detail will be used by the WPLoader module to bootstrap WordPress.</p>"},{"location":"v3/configuration/#what-is-the-url-the-test-site","title":"What is the URL the test site?","text":"<p>In my example setup it's <code>http://localhost:8080</code>.  </p> <p>This is the full URL you would have to enter in the browser, on the machine that is running the tests, to reach the test WordPress site homepage.  </p>"},{"location":"v3/configuration/#what-is-the-email-of-the-test-site-wordpress-administrator","title":"What is the email of the test site WordPress administrator?","text":"<p>In my example setup it's <code>admin@wp.localhost</code>.  </p> <p>This detail will be used by the WPLoader module to bootstrap WordPress and, while required, it's usually not relevant unless you're testing email communications.  </p>"},{"location":"v3/configuration/#what-is-the-title-of-the-test-site","title":"What is the title of the test site?","text":"<p>In my example setup it's <code>Acme Plugin Test Site</code>.  </p> <p>This detail will be used by the WPLoader module to bootstrap WordPress and, while required, it's usually not relevant unless you're testing around the site title.  </p>"},{"location":"v3/configuration/#what-is-the-login-of-the-administrator-user-of-the-test-site","title":"What is the login of the administrator user of the test site?","text":"<p>In my example setup it's <code>admin</code>.  </p> <p>This detail will be used by the WPBrowser or WPWebDriver modules to fill in the login details for the administrator user.  </p> <p>It should be the same as the one that allows you to access the site administration area in the WordPress test site, <code>http://localhost:8080/wp-admin</code> in my example.</p>"},{"location":"v3/configuration/#what-is-the-password-of-the-administrator-user-of-the-test-site","title":"What is the password of the administrator user of the test site?","text":"<p>In my example setup it's <code>password</code>.  </p> <p>This detail will be used by the WPBrowser or WPWebDriver modules to fill in the login details for the administrator user.  </p> <p>It should be the same as the one that allows you to access the site administration area in the WordPress test site, <code>http://localhost:8080/wp-admin</code> in my example.</p>"},{"location":"v3/configuration/#are-you-testing-a-plugin-a-theme-or-a-combination-of-both","title":"Are you testing a plugin, a theme or a combination of both?","text":"<p>Depending on the answer the WPLoader module will load, during integration or WordPress \"unit\" tests, your WordPress plugin or theme.  </p> <p>If you replied with <code>both</code> (for \"a combination of both\") then you'll be able to choose the plugins and theme to load in integration and WordPress \"unit\" tests in the following questions.  </p>"},{"location":"v3/configuration/#what-is-the-folderpluginphp-name-of-the-plugin","title":"What is the folder/plugin.php name of the plugin?","text":"<p>This question will be asked only if you replied <code>plugin</code> to the question Are you testing a plugin, a theme or a combination of both?. In my example setup it's <code>acme-plugin/plugin.php</code>.  </p> <p>This is the <code>&lt;folder&gt;/&lt;main-plugin-file&gt;.php</code> path, relative to the WordPress installation plugins folder, to the plugin you are testing.  </p> <p>The main plugin file is the one that contains the plugin header.</p> <p>This detail will be used by the WPLoader module to bootstrap WordPress and load your plugin or theme in integration and WordPress \"unit\" tests.  </p>"},{"location":"v3/configuration/#are-you-developing-a-child-theme","title":"Are you developing a child theme?","text":"<p>This question will be asked only if you replied <code>theme</code> to the question Are you testing a plugin, a theme or a combination of both?. Enter <code>yes</code> if you are developing a child theme.  </p> <p>This detail will be used by the WPLoader module to bootstrap WordPress and load a parent theme along with your theme in integration and WordPress \"unit\" tests.  </p> <p>Please note that wp-browser will not download and install the parent theme in the WordPress installation for you.</p>"},{"location":"v3/configuration/#are-you-using-a-child-theme","title":"Are you using a child theme?","text":"<p>This question will be asked only if you replied <code>both</code> to the question Are you testing a plugin, a theme or a combination of both?. Enter <code>yes</code> if you are using a child theme.  </p> <p>This detail will be used by the WPLoader module to bootstrap WordPress and load a parent theme along with your theme in integration and WordPress \"unit\" tests.  </p> <p>Please note that wp-browser will not download and install the parent theme in the WordPress installation for you.</p>"},{"location":"v3/configuration/#what-is-the-slug-of-the-parent-theme","title":"What is the slug of the parent theme?","text":"<p>This question will be asked only if you replied <code>yes</code> to the question Are you developing a child theme?.  </p> <p>Reply with the slug of the parent theme, that's usually the name of the folder the parent theme lives in, e.g. <code>twentyseventeen</code>.  </p> <p>This detail will be used by the WPLoader module to bootstrap WordPress and load a parent theme along with your theme in integration and WordPress \"unit\" tests.  </p> <p>Please note that wp-browser will not download and install the parent theme in the WordPress installation for you.</p>"},{"location":"v3/configuration/#what-is-the-slug-of-the-theme","title":"What is the slug of the theme?","text":"<p>This question will be asked only if you replied <code>theme</code> to the question Are you testing a plugin, a theme or a combination of both?. Reply with the slug of the theme, that's usually the name of the folder the theme lives in, e.g. <code>twentyseventeen</code>.  </p> <p>This detail will be used by the WPLoader module to bootstrap WordPress and load your theme in integration and WordPress \"unit\" tests.  </p>"},{"location":"v3/configuration/#what-is-the-slug-of-the-theme-you-are-using","title":"What is the slug of the theme you are using?","text":"<p>This question will be asked only if you replied <code>both</code> to the question Are you testing a plugin, a theme or a combination of both?. Reply with the slug of the theme you are using, that's usually the name of the folder the theme lives in, e.g. <code>twentyseventeen</code>.  </p> <p>This detail will be used by the WPLoader module to bootstrap WordPress and load the theme integration and WordPress \"unit\" tests.  </p>"},{"location":"v3/configuration/#does-your-project-needs-additional-plugins-to-be-activated-to-work","title":"Does your project needs additional plugins to be activated to work?","text":"<p>Whether you're testing a plugin, a theme or a combination of both you might need some additional plugins to run your tests.  </p> <p>As an example if I'm testing a WooCommerce extension I need the WooCommerce plugin to test it; this is the place where I can define it.  </p> <p>The required plugins follow the same format as the one used in the question What is the folder/plugin.php name of the plugin?: <code>&lt;plugin-folder&gt;/&lt;plugin-main-file&gt;.php</code>; in the case of WooCommerce it would be <code>woocommerce/woocommerce.php</code>.  </p> <p>This detail will be used by the WPLoader module to bootstrap WordPress and load the required plugins in integration and WordPress \"unit\" tests.  </p> <p>Please note that wp-browser will not download and install the required plugins in the WordPress installation for you.</p>"},{"location":"v3/configuration/#if-you-entered-a-wrong-value","title":"If you entered a wrong value","text":"<p>No worries, just correct the value in the environment file or in the suites configuration files.  </p> <p>The environment file will have the name you specified in the answer the question How would you like to call the env configuration file?.  </p> <p>The suites configuration files can be found in <code>tests/&lt;suite&gt;.suite.yml</code>; e.g. the <code>wpunit</code> suite configuration file will be <code>tests/wpunit.suite.yml</code> file.</p>"},{"location":"v3/configuration/#final-steps","title":"Final steps","text":"<p>To complete the setup I have removed any demo content from the site and activated my plugin in the plugins administration page.</p> <p>In the <code>tests/acceptance.suite.yml</code> file and in the <code>tests/functional.suite.yml</code> file, the configuration file for the <code>acceptance</code> and <code>functional</code> suites respectively, the <code>WPDb</code> module configuration contains a <code>dump</code> configuration parameter:</p> <pre><code>class_name: AcceptanceTester\nmodules:\n    enabled:\n        - WPDb\n    config:\n        WPDb:\n            dump: 'tests/_data/dump.sql'\n</code></pre> <p>The <code>dump</code> parameter is inherited by the <code>WPDb</code> module from the Codeception <code>Db</code> module and defines the SQL dump file that should be loaded before, and between, tests to reset the testing environment to a base known state.  </p> <p>As for any other database-related operation wp-browser will not create the dump for me. I use MySQL binary to export the database state (a dump) with the command:</p> <pre><code>mysqldump -u root -h 127.0.0.1 -P 3306 wordpress &gt; /Users/luca/Sites/wordpress/wp-content/plugins/acme-plugin/tests/_data/dump.sql\n</code></pre> <p>I could use any other combination of tools to produce the dump; using <code>mysql</code> binary is not a requirement. </p> <p>Graphic interfaces like SequelPro, Adminer and the like would be perfectly fine.</p>"},{"location":"v3/configuration/#pre-flight-check","title":"Pre-flight check","text":"<p>There is one last check I need to make before jumping into the creation of tests: making sure all the paths and credentials I've configured wp-browser with are correct.  </p> <p>The bootstrap process generated four suites for me: <code>acceptance</code>, <code>functional</code>, <code>integration</code> and <code>unit</code>. If you have modified the default suite names during the setup your suites names might differ though.  </p> <p>To test the setup I will run each suite and make sure it can run correctly empty of any test. To run a suite of tests I will use the <code>codecept run</code> command:</p> <pre><code>codecept run acceptance\ncodecept run functional\ncodecept run integration\ncodecept run unit\n</code></pre> <p>How comes I'm not using the command <code>codecept run</code> (without specifying the suite names)? See the FAQ entry.</p> <p></p> <p>If you cannot run all the suites without issues then check your configuration settings again, read the errors and see If you entered a wrong value</p>"},{"location":"v3/events-api/","title":"Events API","text":"<p>This is the documentation for version 3 of the project. The current version is version 4 and the documentation can be found here.</p>"},{"location":"v3/events-api/#events-api","title":"Events API","text":"<p>Codeception comes with a set of events modules and extensions can subscribe to.  </p> <p>Codeception Events API is, but, only available to Modules and Extensions, and while that might be good for most cases, it might not cover a number of edge cases.  </p> <p>Similarly to WordPress <code>add_action</code> function, <code>wp-browser</code> provides the <code>tad\\WPBrowser\\addListener</code> function:</p> <pre><code>function addListener($eventName, callable $listener, $priority = 0);\n</code></pre> <p>The priority works the reverse way as it does in WordPress: highest number will be processed first!</p> <p>Again similarly to WordPress <code>do_action</code> function, the <code>tad\\WPBrowser\\dispatch</code> function:</p> <pre><code>function dispatch($eventName, $origin = null, array $context = []);\n</code></pre> <p>This is the kind of API that is better shown with an example, though.</p>"},{"location":"v3/events-api/#example","title":"Example","text":"<p>In this example I'm writing acceptance tests and would like to avoid the performance hit that the <code>cleanup</code> configuration parameter of the <code>Db</code>, or <code>WPDb</code>, module implies. The <code>cleanup</code> parameter will trigger the drop of all tables in the test database and the re-import of the SQL dump file, or files, between each test. This will ensure a clean starting fixture between tests, but for larger setup fixtures this might be a long operation that wastes precious seconds when, say, the only change is the addition of 3 posts, as in this example.</p> <p>The Events API allows implementing a tailored clean-up procedure that can avoid costly clean ups between tests.  </p> <p>In the suite bootstrap file, e.g. <code>tests/acceptance/_bootstrap.php</code>, I add a listener on the <code>my-plugin-test/setup-posts</code> event. The event will contain information about what post IDs I've set up in the tests and will provide an instance of the tester object to handle database manipulation. With that information, the costly <code>cleanup</code> procedure can be avoided.</p> <pre><code>&lt;?php\n\n$registerPostsCleanup = static function (tad\\WPBrowser\\Events\\WpbrowserEvent $event) {\n    $ids = $event-&gt;get('ids', []);\n    /** @var \\EventsTester $db */\n    $db = $event-&gt;get('db');\n\n    // When tests are done, then remove all the posts we've created at the start of the test, if any.\n    tad\\WPBrowser\\addListener(\n        Codeception\\Events::TEST_AFTER,\n        static function () use ($ids, $db) {\n            foreach ($ids as $id) {\n                $db-&gt;dontHavePostInDatabase([ 'ID' =&gt; $id ], true);\n                // Ensure the clean up did happen correctly.\n                $db-&gt;dontSeePostInDatabase([ 'ID' =&gt; $id ]);\n                $db-&gt;dontSeePostMetaInDatabase([ 'post_id' =&gt; $id ]);\n            }\n        }\n    );\n};\n\n// Listen for this event to register the posts to remove, along with their custom fields, after the test.\ntad\\WPBrowser\\addListener('test-event-1/setup-posts', $registerPostsCleanup);\n</code></pre> <p>In this simple test I'm adding 3 posts [using the <code>factory</code> provided by the <code>WPLoader</code> module in <code>loadOnly</code> mode][2] and want to make sure those, and the relative meta, are removed at the end of the tests. The <code>WPDb</code> module, extending the <code>Db</code> module from Codeception, will remove the inserted rows, but will not take care of modified rows, or rows not inserted by the <code>WPDb</code> module.</p> <p>Mirroring the requirement of the clean up function I've defined above, I'm passing the post IDs of the posts I've created and the current tester to provide the clean up function with database handling capabilities.</p> <pre><code>&lt;?php\n/** @var Codeception\\Scenario $scenario */\n$I = new AcceptanceTester($scenario);\n$I-&gt;wantTo('add posts and clean them up using the Events API');\n\n/*\n * Use WordPress methods, thanks to the `WPLoader` module, to use WordPress, or our own, API to insert posts.\n * This will prevent, but, `WPDb` from removing the inserted rows and clean up, so we remove the posts and meta\n * with an event and our custom clean-up function.\n */\n$ids = $I-&gt;factory()-&gt;post-&gt;create_many(3, [ 'post_type' =&gt; 'some_post_type' ]);\n\ntad\\WPBrowser\\dispatch('test-event-1/setup-posts', __FILE__, [\n    'ids' =&gt; $ids,\n    'db'  =&gt; $I\n]);\n</code></pre>"},{"location":"v3/extensions/","title":"Extensions","text":"<p>This is the documentation for version 3 of the project. The current version is version 4 and the documentation can be found here.</p>"},{"location":"v3/extensions/#extensions","title":"Extensions","text":"<p>The Codeception testing framework can be extended in a number of ways.  </p> <p>The one this project leverages the most are modules but [extensions are another way].  </p> <p>Modules extend the functionality of Codeception in the context of the tests, while extensions extend its interaction capacities; this is by no means a strict rule but that's usually the case.  </p> <p>The package contains two additional extensions to facilitate testers' life.</p>"},{"location":"v3/extensions/#symlinker","title":"Symlinker","text":"<p>The <code>tad\\WPBrowser\\Extension\\Symlinker</code> extension provides an automation to have the Codeception root directory symbolically linked in a WordPress local installation.  </p> <p>Since version <code>3.9</code> WordPress supports this feature (with some precautions) and the extension takes charge of:</p> <ul> <li>symbolically linking a plugin or theme folder in the specified destination before any suite boots up</li> <li>unlinking that symbolic link after all of the suites did run</li> </ul> <p>It's the equivalent of doing something like this from the command line (on a Mac):</p> <pre><code>ln -s /my/central/plugin/folder/my-plugin /my/local/wordpress/installation/wp-content/plugins/my-plugin\n/my/central/plugin/folder/my-plugin/vendor/bin/codecept run\nrm -rf /my/local/wordpress/installation/wp-content/plugins/my-plugin\n</code></pre> <p>The extension needs small configuration in the <code>codeception.yml</code> file:</p> <pre><code>extensions:\n    enabled:\n        - tad\\WPBrowser\\Extension\\Symlinker\n    config:\n        tad\\WPBrowser\\Extension\\Symlinker:\n            mode: plugin\n            destination: /my/local/wordpress/installation/wp-content/plugins\n            rootFolder: /some/plugin/folder\n</code></pre> <p>The arguments are:</p> <ul> <li><code>mode</code> - can be <code>plugin</code> or <code>theme</code> and indicates whether the current Codeception root folder being symlinked is a plugin or a theme one</li> <li><code>destination</code> - the absolute path to the WordPress local installation plugins or themes folder; to take the never ending variety of possible setups into account the extension will make no checks on the nature of the destination: could be any folder.</li> <li><code>rootFolder</code> - optional absolute path to the WordPress plugin or theme to be symlinked root folder; will default to the Codeception root folder</li> </ul>"},{"location":"v3/extensions/#copier","title":"Copier","text":"<p>The <code>tad\\WPBrowser\\Extension\\Copier</code> extension provides an automation to have specific files and folders copied to specified destination files and folders before the suites run.</p> <p>While WordPress handles symbolic linking pretty well there are some cases, like themes and drop-ins, where there is a need for \"real\" files to be put in place.</p> <p>One of such cases is, currently, one where Docker is used to to host and serve the code under test: symbolically linked files cannot be bound inside a container and Docker containers will fail to start in this case.</p> <p>The extension follows the standard Codeception extension activation and has one configuration parameter only:</p> <pre><code>extensions:\n    enabled:\n        - tad\\WPBrowser\\Extension\\Copier\n    config:\n        tad\\WPBrowser\\Extension\\Copier:\n            files:\n                tests/_data/required-drop-in.php: /var/www/wordpress/wp-content/drop-in.php\n                tests/_data/themes/dummy: /var/www/wordpress/wp-content/themes/dummy\n                /Users/Me/Repos/required-plugin: /var/www/wordpress/wp-content/plugins/required-plugin.php\n                /Users/Me/Repos/mu-plugin.php: ../../../../wp-content/mu-plugins/mu-plugin.php\n</code></pre> <p>The extension will handle absolute and relative paths for sources and destinations and will resolve relative paths from the project root folder.</p> <p>When copying directories the extension will only create the destination folder and not the folder tree required; in the example configuration above the last entry specifies that a <code>mu-plugin.php</code> file should be copied to the <code>mu-plugins</code> folder: that <code>mu-plugins</code> folder must be there already.</p>"},{"location":"v3/extensions/#environments-support","title":"Environments support","text":"<p>Being able to symlink a plugin or theme folder into a WordPress installation for testing purposes could make sense when trying to test, as an example, a plugin in a single site and in multi site environment.  </p> <p>Codeception supports environments and the extension does as well specifying a destination for each.</p> <p>As an example the <code>acceptance.suite.yml</code> file might be configured to support <code>single</code> and <code>multisite</code> environments:</p> <pre><code>env:\n    single:\n        modules:\n            config:\n                WPBrowser:\n                    url: 'http://wp.dev'\n                WPDb:\n                    dsn: 'mysql:host=127.0.0.1;dbname=wp'\n    multisite:\n        modules:\n            config:\n                WPBrowser:\n                    url: 'http://mu.dev'\n                WPDb:\n                    dsn: 'mysql:host=127.0.0.1;dbname=mu'\n</code></pre> <p>In the <code>codeception.yml</code> file specifying a <code>destination</code> for each supported environment will tell the extension to symbolically link the plugin or theme file to different locations according to the current environment:</p> <pre><code>extensions:\n    enabled:\n        - tad\\WPBrowser\\Extension\\Symlinker\n    config:\n        tad\\WPBrowser\\Extension\\Symlinker:\n            mode: plugin\n            destination:\n                single: /var/www/wp/wp-content/plugins\n                multisite: /var/www/mu/wp-content/plugins\n</code></pre> <p>If no destination is specified for the current environment the extension will fallback to the first specified one.  </p> <p>A <code>default</code> destination can be specified to override this behaviour.</p> <pre><code>extensions:\n    enabled:\n        - tad\\WPBrowser\\Extension\\Symlinker\n    config:\n        tad\\WPBrowser\\Extension\\Symlinker:\n            mode: plugin\n            destination:\n                default: /var/www/default/wp-content/plugins\n                single: /var/www/wp/wp-content/plugins\n                multisite: /var/www/mu/wp-content/plugins\n</code></pre> <p>When running a suite specifying more than one environment like</p> <pre><code>codecept run acceptance --env foo,baz,multisite\n</code></pre> <p>Then the extension will use the first matched one, in the case above the <code>multisite</code> destination will be used.  </p> <p>The <code>rootFolder</code> parameter too can be set to be environment-aware and it will follow the same logic as the destination:</p> <pre><code>extensions:\n    enabled:\n        - tad\\WPBrowser\\Extension\\Symlinker\n    config:\n        tad\\WPBrowser\\Extension\\Symlinker:\n            mode: plugin\n            rootFolder:\n                dev: /\n                dist: /dist\n                default: /\n            destination:\n                default: /var/www/dev/wp-content/plugins\n                dev: /var/www/dev/wp-content/plugins\n                dist: /var/www/dist/wp-content/plugins\n</code></pre> <p>When running a suite specifying more than one environment like</p> <pre><code>codecept run acceptance --env dist\n</code></pre> <p>Then the extension will symlink the files from <code>/dist</code> into the <code>/var/www/dist/wp-content/plugins</code> folder.</p>"},{"location":"v3/extensions/#events","title":"Events","text":"<p>Due to some internal changes in Codeception <code>4.0</code>, the internal API (really a collection of low-level hacks on my part) that allowed <code>wp-browser</code> to dispatch, and listen for, events in the modules has been removed.</p> <p>If you want to leverage [the event system wp-browser provides] with Codeception default events (e.g. <code>suite.init</code> or <code>test.before</code>), then you will need to use this extension.</p> <p>You will not need this extension if you're not using Codeception version <code>4.0</code>.</p> <p>You will need to enable it in your Codeception main configuration file (e.g. <code>codeception.dist.yml</code>).</p> <pre><code>extensions:\n    enabled:\n        - tad\\WPBrowser\\Extension\\Events\n    config:\n      tad\\WPBrowser\\Extension\\Events:\n        suites: ['acceptance']\n</code></pre> <p>The extension only configuration is the <code>suites</code> parameter that allows specifying the suites the extension should apply to. If the <code>suites</code> parameter is not specified, then the extension will apply to all suites.  </p>"},{"location":"v3/faq/","title":"Frequently asked questions","text":"<p>This is the documentation for version 3 of the project. The current version is version 4 and the documentation can be found here.</p>"},{"location":"v3/faq/#some-common-questions","title":"Some common questions","text":"<p>There are questions I keep receiving via email, GitHub or in person at conferences.</p> <p>I tried to address some of them here.</p>"},{"location":"v3/faq/#is-codeceptionwp-browser-php-52-compatible","title":"Is Codeception/wp-browser PHP 5.2 compatible?","text":"<p>No, Codeception, and wp-browser by extension, will require PHP 5.6 minimum.</p> <p>This does not mean your code cannot be PHP 5.2 compatible: you can test your code using all the possibilities of newer PHP versions and still keep it PHP 5.2 compatible.</p> <p>Just because you can doesn't mean you should though: this documentation will assume a minimum PHP version, for the example and test code, of PHP 5.6.</p>"},{"location":"v3/faq/#can-i-run-unit-tests-with-wp-browsercodeception","title":"Can I run unit tests with wp-browser/Codeception?","text":"<p>Yes, with some distinctions.</p> <p>In the WordPress ecosystem there's a tendency to call any kind of test a \"unit test\". Under that definition will fall tests that are not \"unit\" tests at all.</p> <p>Without drowning into a long and painful battle for definitions this guide will use the following definitions for different levels of testing.</p> <p>The next section will detail the conventions this documentation uses to define different levels of testing in more detail.</p>"},{"location":"v3/faq/#isnt-wordpress-untestable","title":"Isn't WordPress untestable?","text":"<p>No; it's sometimes difficult to test and not as straightforward as other PHP frameworks but it's definitely not untestable.</p> <p>You are writing code that runs on WordPress, not the Core code for WordPress so the question should really be: will you write testable code?</p> <p>It's up to you to decide at what level you want to make your code testable and how much you want to test it.</p>"},{"location":"v3/faq/#do-i-need-to-use-a-specific-local-development-environment-to-use-wp-browser","title":"Do I need to use a specific local development environment to use wp-browser?","text":"<p>No. I've started using wp-browser on a vanilla PHP built-in server to, then, move to MAMP (or XAMP) and, from there, to other solutions.</p> <p>I've configured and used wp-browser on Docker, Vagrant, VVV, Valet and various CI solutions.</p> <p>To this day I keep using different setups on different machines and personally prefer Docker for its portability.</p>"},{"location":"v3/faq/#can-i-only-test-plugins-with-wp-browser","title":"Can I only test plugins with wp-browser?","text":"<p>No, you can test any kind of WordPress application.</p> <p>With \"application\" I mean any PHP software built on top of WordPress: plugins, themes, whole sites.</p>"},{"location":"v3/faq/#if-im-testing-a-site-do-i-have-to-use-the-default-wordpress-file-structure","title":"If I'm testing a site do I have to use the default WordPress file structure?","text":"<p>No, you can use any file structure you want.</p> <p>Some wp-browser modules will need a little help to find your code but, so far, I've never been unable to set it up.</p>"},{"location":"v3/faq/#can-i-use-wp-browser-even-if-my-wordpress-application-doesnt-use-composer","title":"Can I use wp-browser even if my WordPress application doesn't use Composer?","text":"<p>Yes, although wp-browser, as a development tool, cannot be installed without Composer.</p>"},{"location":"v3/faq/#should-i-use-wp-browser-to-test-my-production-servers","title":"Should I use wp-browser to test my production servers?","text":"<p>No. Unless you know very well what you're doing that's a dangerous idea that might leave you with a broken site and an empty database.</p> <p>As almost any testing tool, wp-browser should be used locally on local installations of WordPress that do not contain any valuable information.</p>"},{"location":"v3/faq/#how-can-i-avoid-the-wpdb-module-from-replacing-the-contents-of-my-database","title":"How can I avoid the WPDb module from replacing the contents of my database?","text":"<p>You should always backup any database that contains any information you care about before running any test.</p> <p>You can read the answer to this question in the WPDb module documentation.</p>"},{"location":"v3/faq/#can-i-run-all-my-tests-with-one-command","title":"Can I run all my tests with one command?","text":"<p>Theoretically: yes, in practice: no.</p> <p>When you use <code>codecept run</code> Codeception will run all the tests from all the suites.</p> <p>This, done in the context of other frameworks, will generally not create any problem but, in the context of WordPress it will.</p> <p>While handling a single HTTP request WordPress will set, and use, a number of constants and globals and, likewise, will do plugins and themes that follow WordPress standards.</p> <p>This means that the global context (variable scope) will be left \"dirty\" and contain \"left-over\" constants and globals from the previous tests.</p> <p>An example is one where a test for the handling of Ajax requests sets the <code>DOING_AJAX</code> constant: this will be now set for any test after the one that set it thus breaking, or worse altering, all the following ones.</p> <p>So, in short, run each suite separately.</p>"},{"location":"v3/faq/#can-i-have-more-than-one-suite-of-one-kind","title":"Can I have more than one suite of one kind?","text":"<p>Yes, you should.</p> <p>As an example you might have a <code>frontend</code> suite running acceptance tests on the site frontend and a <code>backend</code> suite running acceptance tests on the site backend.</p> <p>Think of suites as a tool to organize your tests: there's a good measure between too organized and not organized at all.</p>"},{"location":"v3/faq/#ive-used-phpunit-before-for-my-unit-tests-can-i-reuse-that-knowledge-and-code-with-wp-browser","title":"I've used PHPUnit before for my unit tests, can I reuse that knowledge and code with wp-browser?","text":"<p>Yes.</p> <p>Codeception uses PHPUnit as one of its main components and can run PHPUnit tests with little or no modification.</p> <p>As such you can just move your existing PHPUnit tests in a dedicated suite and be ready to run in minutes.</p>"},{"location":"v3/faq/#ive-already-set-up-my-tests-to-run-using-the-core-phpunit-based-test-suite-can-i-keep-using-my-tests","title":"I've already set up my tests to run using the Core PHPUnit-based test suite, can I keep using my tests?","text":"<p>Yes.</p> <p>Codeception uses PHPUnit as one of its main components and can run PHPUnit tests with little or no modification.</p> <p>One of the goals of wp-browser was to make it easier to test WordPress application at an integration level (or \"WordPress unit\" level).</p> <p>As such migrating those tests could be a matter of minutes requiring no modification to the tests if not for moving some files and creating a dedicated suite.</p>"},{"location":"v3/faq/#why-is-the-project-called-wp-browser","title":"Why is the project called wp-browser?","text":"<p>When I started working with Codeception to run my acceptance tests I kept creating steps that I would reuse over and over in my projects.</p> <p>I packed them in a module extending the <code>PHPBrowser</code> module.</p> <p>Being a natural talent in naming things I've called the module <code>WPBrowser</code> and published it. As I started relying on Codeception more and more I kept adding modules but the name remained.</p>"},{"location":"v3/installation/","title":"Installation","text":"<p>This is the documentation for version 3 of the project. The current version is version 4 and the documentation can be found here.</p>"},{"location":"v3/installation/#installation","title":"Installation","text":""},{"location":"v3/installation/#where-should-i-install-wp-browser","title":"Where should I install wp-browser?","text":"<p>As a rule-of-thumb wp-browser should be installed in the root folder of your  project.  </p> <p>If your project is a plugin then it should be installed in the root folder of your plugin; if your project is a theme it should be installed in the root folder of your theme.  </p> <p>If your project is a site I'd, personally install it in the site root folder. </p> <p>The purpose of installing wp-browser in the root folder of a project is to keep the code and its tests under version control together.  </p> <p>Exceptions apply but, for most projects, that's what I would do.</p>"},{"location":"v3/installation/#initializing-the-composer-project","title":"Initializing the Composer project","text":"<p>Since Composer is a requirement of wp-browser and the only way to install it you should, first thing, initialize the Composer project.  </p> <p>If you've already initialized the Composer project you can skip this section.</p> <p>Once you've decided where to install wp-browser navigate to that folder using the terminal and type:</p> <pre><code>composer init\n</code></pre> <p>Composer will take you through a number of questions to setup some meta information about your project.  </p> <p>Do not install any dependency yet when asked (unless you know what you're doing) and, as a suggestion, set <code>wordpress-plugin</code> as \"Package Type\".  </p> <p>Also, since WordPress is licensed under the GPL-2.0+ you might want to set the \"License\" of your project to <code>GPL-2.0-or-later</code>.</p>"},{"location":"v3/installation/#installing-wp-browser-as-a-development-dependency","title":"Installing wp-browser as a development dependency","text":"<p>Once you've initialized the Composer project it's time to <code>require</code> wp-browser ; you can read more about the usage of the <code>require</code> command on the Composer documentation.  </p> <p>wp-browser is a testing tool and, as such, should be installed as a project development dependency, not as a normal (production) one.  </p> <p>From the terminal type:</p> <pre><code>composer require --dev lucatume/wp-browser\n</code></pre> <p>This will install the latest stable version of wp-browser and, along with it, Codeception and PHPUnit in the <code>vendor</code> folder of your project.  </p> <p>Once that's done it's time to move to the setup and configuration of wp-browser.</p>"},{"location":"v3/levels-of-testing/","title":"Levels of testing","text":"<p>This is the documentation for version 3 of the project. The current version is version 4 and the documentation can be found here.</p>"},{"location":"v3/levels-of-testing/#what-is-a-unit-test-an-acceptance-test","title":"What is a unit test? An acceptance test?","text":"<p>This page has no pretense to be THE source of truth about what is called how in the context of tests; the purpose of this page is to lay out the terminology that I'll use in the documentation to define the levels and component of testing. Wikipedia, forums and other documents online will offer alternate, and equally valid, definitions.</p>"},{"location":"v3/levels-of-testing/#the-signup-page-example","title":"The signup page example","text":"<p>Let's assume I'm testing a WordPress plugin that adds mailing list management and subscription functionalities to a site.  </p> <p>The plugin provides a number of functions and, among them, it will add a sign-up page to receive users applications.  </p>"},{"location":"v3/levels-of-testing/#acceptance-tests","title":"Acceptance tests","text":"<p>In brief: make assertions as a user would.  </p> <p>The user might be tech-savvy as much as I want her to be but still make assertions only on what feedback the site provides. </p> <p>The code below tests a user can subscribe to the mailing list:</p> <pre><code>&lt;?php\n// UserSuccessfulSignupTest.php\n\n// Add a page that contains the shortcode that will render the signup form.\n$I-&gt;havePageInDatabase( [\n    'post_name' =&gt; 'signup',\n    'post_content'=&gt; 'Sign-up for our awesome thing! [signup]',\n] );\n\n// Go to the page.\n$I-&gt;amOnPage( '/signup' );\n\n// Submit the form as a user would submit it. \n$I-&gt;submitForm( '#signup-form', [\n  'name' =&gt; 'Luca',\n  'email' =&gt; 'luca@theAverageDev.com',\n] );\n\n// Make sure I see a confirmation message. \n$I-&gt;waitForElement( '#signup-confirmation' );\n</code></pre>"},{"location":"v3/levels-of-testing/#functional-tests","title":"Functional tests","text":"<p>In brief: make assertions as a developer would.  </p> <p>The test code below asserts front-end submissions are correctly processed from the developer perspective:</p> <pre><code>&lt;?php\n// file tests/functional/SignupSubmissionCest.php\n\nclass SignupSubmissionCest {\n\n    public function _before( FunctionalTester $I ) {\n        // Add a page that contains the shortcode that will render the signup form.\n        $I-&gt;havePageInDatabase( [\n            'post_name' =&gt; 'signup',\n            'post_content'=&gt; 'Sign-up for our awesome thing! [signup]',\n        ] );\n\n        $I-&gt;amOnPage( '/signup' );\n    }\n\n    public function test_good_signup( FunctionalTester $I ) {\n        $I-&gt;sendAjaxPostRequest( '/wp-json/acme/v1/signup', [\n          '_wpnonce' =&gt; $I-&gt;grabAttributeFrom( '#signup-nonce', 'value' ),\n          'name' =&gt; 'Luca',\n          'email' =&gt; 'luca@theAverageDev.com',\n        ] );\n\n        $I-&gt;seeResponseCodeIsSuccessful();\n        $I-&gt;seeUserInDatabase( [ 'user_login' =&gt; 'luca', 'user_email' =&gt; 'luca@theaveragedev.com' ] );\n    }\n\n    public function test_bad_email_signup( FunctionalTester $I ) {\n        $I-&gt;sendAjaxPostRequest( '/wp-json/acme/v1/signup', [\n          '_wpnonce' =&gt; $I-&gt;grabAttributeFrom( '#signup-nonce', 'value' ),\n          'name' =&gt; 'Luca',\n          'email' =&gt; 'not-really-an-email',\n        ] );\n\n        $I-&gt;seeResponseCodeIs( 400 );\n        $I-&gt;dontSeeUserInDatabase( [ 'user_login' =&gt; 'luca', 'user_email' =&gt; 'not-really-an-email' ] );\n    }\n}\n</code></pre> <p>The code looks, initially, like an acceptance test, but differs in its action and assertion phase: in place of filling a form and clicking \"Submit\" it sends a <code>POST</code> request to a REST API endpoint and checks the effect of the submission in the database.  </p> <p>All of these actions fall squarely into what a developer would do, not into what a user could/should be able to do.  </p> <p>Furthermore, the format of the test is not the same as the one used in the acceptance test.  </p> <p>The acceptance test is written in the most eloquent testing format supported by Codeception, the Cept format, this test uses a more PHPUnit-like format, the Cest format.  </p> <p>While the first is easier to skim for  non-developers the second harnesses the power of a re-using pieces of code, the page creation and navigation in the example, to optimize the test code.</p>"},{"location":"v3/levels-of-testing/#integration-tests","title":"Integration tests","text":"<p>In brief: test code modules in the context of a WordPress website.</p> <p>In this type of test the WordPress, and additional plugins code, is loaded in the same variable scope as the tests; this is why in the example below I'm using classes (<code>WP_REST_Request</code>, <code>WP_REST_Response</code>) and methods (<code>register_rest_route</code>) defined by WordPress, not the plugin code.  </p> <p>The REST API request sent by the application form will be handled by a class, <code>Acme\\Signup\\SubmissionHandler</code>, that's been attached to the <code>/wp-json/acme/v1/signup</code> path:</p> <pre><code>&lt;?php\n// file src/rest.php\n\nadd_action( 'rest_api_init', function () {\n    register_rest_route( 'acme/v1', '/signup', array(\n        'methods' =&gt; 'POST',\n        'callback' =&gt; function( WP_Rest_Request $request ) {\n            $email_validator = new Acme\\Signup\\EmailValidator();\n            $handler = new Acme\\Signup\\SubmissionHandler( $email_validator );\n\n            return $handler-&gt;handle( $request );\n        },\n    ) );\n} );\n</code></pre> <p>I want to test the chain of classes and methods that's handling such a request in the context of a WordPress installation.  </p> <p>Integration is usually about testing \"modules\" of code: groups of classes and functions working together to provide a service or complete a task.  </p> <p>In the context of integration testing the class dependencies and/or the context are not mocked.</p> <pre><code>&lt;?php\n// file tests/integration/SubmissionHandlingTest.php\n\nclass SubmissionHandlingTest extends \\Codeception\\TestCase\\WPTestCase {\n    public function test_good_request() {\n        $request = new WP_Rest_Request();\n        $request-&gt;set_body_params( [ 'name' =&gt; 'luca', 'email' =&gt; 'luca@theaveragedev.com' ] );\n        $handler = new  Acme\\Signup\\SubmissionHandler();\n\n        $response = $handler-&gt;handle( $request );\n\n        $this-&gt;assertIntsanceOf( WP_REST_Response::class, $response );\n        $this-&gt;assertEquals( 200, $response-&gt;get_status() );\n        $this-&gt;assertInstanceOf( Acme\\Signup\\Submission_Good::class, $handler-&gt;last_submission() );\n        $this-&gt;assertEquals( 'luca', $handler-&gt;last_submission()-&gt;name() );\n        $this-&gt;assertEquals( 'luca@theaveragedev.com', $handler-&gt;last_submission()-&gt;email() );\n    }\n\n    public function test_bad_email_request() {\n        $request = new WP_Rest_Request();\n        $request-&gt;set_body_params( [ 'name' =&gt; 'luca', 'email' =&gt; 'not-a-valid-email' ] );\n        $handler = new  Acme\\Signup\\SubmissionHandler();\n\n        $response = $handler-&gt;handle( $request );\n\n        $this-&gt;assertIntsanceOf( WP_REST_Response::class, $response );\n        $this-&gt;assertEquals( 400, $response-&gt;get_status() );\n        $this-&gt;assertInstanceOf( Acme\\Signup\\Submission_Bad::class, $handler-&gt;last_submission() );\n        $this-&gt;assertEquals( 'luca', $handler-&gt;last_submission()-&gt;name() );\n        $this-&gt;assertEquals( 'not-a-valid-email', $handler-&gt;last_submission()-&gt;email() );\n    }\n}\n</code></pre> <p>The test format used is the familiar PhpUnit one; the only difference is the base test class that's being extended (<code>\\Codeception\\TestCase\\WPTestCase</code>) is one provided by wp-browser.  </p> <p>In the context of WordPress \"integration\" might also mean testing that filters used by the code have the expected effect.  </p>"},{"location":"v3/levels-of-testing/#unit-tests","title":"Unit tests","text":"<p>In brief: test single classes or functions in isolation.</p> <p>The email address is validated by the <code>Acme\\Signup\\EmailValidator</code> class.  </p> <p>In the test code below I want to make sure the validation works as intended.</p> <pre><code>&lt;?php\n// file tests/unit/EmailValidatorTest.php\n\nclass EmailValidatorTest extends Codeception\\Test\\Test {\n    public function test_good_email_validation() {\n        $validator = new Acme\\Signup\\EmailValidator();\n\n        $this-&gt;assertTrue( $validator-&gt;validate( 'luca@theaveragedev.com' ) ); \n    }\n\n    public function test_bad_email_validation(){\n        $validator = new Acme\\Signup\\EmailValidator();\n\n        $this-&gt;assertTrue( $validator-&gt;validate( 'not-an-email' ) );\n    }\n\n    public function test_tricky_email_validation() {\n        $validator = new Acme\\Signup\\EmailValidator();\n\n        $this-&gt;assertTrue( $validator-&gt;validate( 'luca+signup@theaveragedev.com' ) ); \n    }\n\n    public function test_validation_with_service(){\n        // Stub the validation service.\n        $validation_service = $this-&gt;prophesize( Acme\\Signup\\ValidationService::class );\n        $validation_service-&gt;validate( 'luca@theaveragedev.com' )-&gt;willReturn( true );\n        $validation_service-&gt;validate( 'lucas@theaveragedev.com' )-&gt;willReturn( false );\n        // Build the validator and set it to use the mock validation service.\n        $validator = new Acme\\Signup\\EmailValidator();\n        $validator-&gt;use_service( $validation_service-&gt;reveal() );\n\n        $this-&gt;assertTrue( $validator-&gt;validate( 'luca@theaveragedev.com' ) );\n        $this-&gt;assertFalse( $validator-&gt;validate( 'lucas@theaveragedev.com' ) );\n    }\n}\n</code></pre> <p>Unit tests is where stubbing/mocking/spying of dependencies is used to gain total control over the input and context the class is using.  </p> <p>In the last test method I'm doing exactly that testing the email validator with an external validation service.</p> <p>In the example I'm using the Prophecy mock engine that comes with PHPUnit along with its own mocking/stubbing/spying solutions.  </p> <p>There are other mocking engines (e.g Mockery) that could be used.</p>"},{"location":"v3/levels-of-testing/#wordpress-unit-tests","title":"WordPress \"unit\" tests","text":"<p>In brief: test single classes or functions that require WordPress code in as much isolation as possible.  </p> <p>This is what most people referring to \"unit tests\" in the context of WordPress is talking about.  </p> <p>The purpose of this kind of tests is to test one class of a WordPress application, or one function, that requires a WordPress-defined function or class with a unit testing approach.  </p> <p>In the example below I'm testing the <code>Acme\\Signup\\SubmissionHandler</code> class on a \"unit\" level making sure it will mark a request as bad if the email is not a valid one. </p> <pre><code>&lt;?php\n// file tests/unit/SubmissionHandlerTest.php\nclass SubmissionHandlerTest extends Codeception\\Test\\Test {\n    protected  $request;\n    protected $validator;\n\n    public function setUp() {\n        // Mock the request.\n        $this-&gt;request = $this-&gt;prophesize( WP_REST_Request::class );\n        // Spy on the validator.\n        $this-&gt;validator = $this-&gt;prophesize( Acme\\Signup\\EmailValidator::class );\n    }\n\n    public function test_email_is_validated_by_default() {\n        $this-&gt;request-&gt;get_param( 'name' )-&gt;willReturn( 'luca' );\n        $this-&gt;request-&gt;get_param( 'email' )-&gt;willReturn( 'luca@theaveragedev.com' );\n\n        $handler = new Acme\\Signup\\SubmissionHandler( $this-&gt;validator-&gt;reveal() );\n        $handler-&gt;set_validator( $this-&gt;validator );\n        $response = $handler-&gt;handle( $this-&gt;request-&gt;reveal() );\n\n        $this-&gt;assertInstanceOf( WP_REST_Response::class, $response );\n        // Verify on the validator spy.\n        $this-&gt;validator-&gt;validate( 'luca@theaveragedev.com' )-&gt;shouldHaveBeenCalled();\n    }\n\n    public function test_will_not_validate_email_if_missing() {\n        $this-&gt;request-&gt;get_param( 'name' )-&gt;willReturn( 'luca' );\n        $this-&gt;request-&gt;get_param( 'email' )-&gt;willReturn( '' );\n\n        $handler = new Acme\\Signup\\SubmissionHandler( $this-&gt;validator-&gt;reveal() );\n        $handler-&gt;set_validator( $this-&gt;validator );\n        $response = $handler-&gt;handle( $this-&gt;request-&gt;reveal() );\n\n        $this-&gt;assertInstanceOf( WP_REST_Response::class, $response );\n        // Verify on the validator spy.\n        $this-&gt;validator-&gt;validate( Argument::any() )-&gt;shouldNotHaveBeenCalled();\n    }\n}\n</code></pre> <p>The class uses the <code>WP_REST_Request</code> and <code>WP_Rest_Response</code> classes as input and output and will probably, internally, use more functions defined by WordPress.  </p> <p>One solution to avoid loading WordPress, could be to rewrite test versions of each and all the WordPress functions and classes needed by all the classes I want to unit test; this would require updating each time the classes requirements change.  </p> <p>Furthermore internationalization (e.g. <code>__()</code>) and filtering (e.g <code>apply_filters</code>) functions would not need to be mocked if not in specific cases and would pretty much be copy and paste versions of the WordPres ones.  </p> <p>Loading single pieces of WordPress is a dangerous and brittle endeavour and it's not supported by the  framework.</p> <p>To avoid all this WordPress \"unit tests\" pay the price of having to bootstrap WordPress, thus requiring a database connection.</p> <p>This kind of test setup and level is the one you can see in the PHPUnit Core suite of WordPress itself.</p>"},{"location":"v3/requirements/","title":"Requirements","text":"<p>This is the documentation for version 3 of the project. The current version is version 4 and the documentation can be found here.</p>"},{"location":"v3/requirements/#requirements","title":"Requirements","text":"<p>wp-browser has some requirements your development environment will need to fulfill for it to work correctly.  </p>"},{"location":"v3/requirements/#php","title":"PHP","text":"<p>The minimum supported version of PHP supported by wp-browser is 5.6.  </p> <p>This requirement does not reflect on the minimum PHP version your plugin might require; see the FAQs for more information.</p>"},{"location":"v3/requirements/#composer","title":"Composer","text":"<p>There is no <code>phar</code> version of wp-browser and it can only be installed using Composer.  </p> <p>See Composer installation guide for more information.</p>"},{"location":"v3/requirements/#wordpress-mysql-apachenginx","title":"WordPress, MySQL, Apache/Nginx","text":"<p>wp-browser will not download, install and configure WordPress for you.  </p> <p>It will also not download, install and setup MySQL, Apache, Nginx or any other technology required by a fully functional WordPress installation for you.  </p> <p>You need to set up a local WordPress installation on your own; you can use your preferred solution to do it.</p> <p>In the documentation I will show automated ways to do this but, for most projects, that's not the best solution.</p>"},{"location":"v3/setting-up-minimum-wordpress-installation/","title":"Setting up a minimum WordPress installation","text":"<p>This is the documentation for version 3 of the project. The current version is version 4 and the documentation can be found here.</p>"},{"location":"v3/setting-up-minimum-wordpress-installation/#setting-up-a-minimum-wordpress-installation","title":"Setting up a minimum WordPress installation","text":"<p>As mentioned in Installation section wp-browser will not download, configure and install WordPress for you.  </p> <p>On a high level, once WordPress is installed and configured, whatever local development environment solution you've used, there are some information you'll need to gather before moving into wp-browser configuration.  </p> <p>While there will be a section dedicated to different environments and setups I will outline below the example setup I will use, in the next section, to configure wp-browser:</p> <ul> <li>WordPress is installed, on my machine, at <code>/Users/luca/Sites/wordpress</code>.</li> <li>I'm running MySQL server locally; I can connect to the MySQL server with the command <code>mysql -u root -h 127.0.0.1 -P 3306</code>; there is no password.</li> <li>I've created two databases, <code>wordpress</code> and <code>tests</code>, with the command:     <pre><code>mysql -u root -h 127.0.0.1 -P 3306 -e \"create database if not exists wordpress; create database if not exists tests\"\n</code></pre></li> <li>I've configured the <code>/Users/luca/Sites/wordpress/wp-config.php</code> file like below (redacted for brevity):     <pre><code>&lt;?php\ndefine( 'DB_NAME', 'wordpress' );\ndefine( 'DB_USER', 'root' );\ndefine( 'DB_PASSWORD', '' );\ndefine( 'DB_HOST', '127.0.0.1' );\ndefine( 'DB_CHARSET', 'utf8' );\ndefine( 'DB_COLLATE', '' );\n\n$table_prefix = 'wp_';\n\nif ( ! defined( 'ABSPATH' ) )\n    define( 'ABSPATH', dirname( __FILE__ ) . '/' );\n\nrequire_once ABSPATH . 'wp-settings.php';\n</code></pre></li> <li>To serve the site I'm using PHP built-in server with the command:     <pre><code>(cd /Users/luca/Sites/wordpress; php -S localhost:8080)\n</code></pre></li> <li>I can access the WordPress homepage at <code>http://localhost:8080</code> and the administration area at <code>http://localhost:8080/wp-admin</code>.</li> <li>I've installed WordPress via its UI (<code>http://localhost:8080/wp-admin</code>), the administrator username is <code>admin</code>, the administrator password is <code>password</code>.</li> <li>I'm testing a plugin and that plugin is in the folder, relative to the WordPress root folder, <code>wp-content/plugins/acme-plugin</code>.</li> </ul> <p>With all the steps above done I can now move into the actual wp-browser configuration phase.</p>"},{"location":"v3/advanced/run-in-separate-process/","title":"Running tests in separate processes","text":"<p>This is the documentation for version 3 of the project. The current version is version 4 and the documentation can be found here.</p>"},{"location":"v3/advanced/run-in-separate-process/#running-tests-in-separate-processes","title":"Running tests in separate processes","text":"<p>PHPUnit offers the possibility to run tests in a separate PHP process; Codeception does not officially support the option as of version 4.0.</p> <p>The wp-browser project tries to fill that gap by supporting the <code>@runInSeparateProcess</code> annotation. This support comes with some caveats, though:</p> <ol> <li>The support is only for test cases extending the <code>Codeception\\TestCase\\WPTestCase</code> class (the base test case for integration or \"WordPress unit\" tests)</li> <li>The support wp-browser provides only supports the <code>@preserveGlobalState</code> annotation with the <code>disabled</code> value; this means there is no support for preserving global state between tests.</li> </ol> <p>Read more about what this means in PHPUnit documentation.</p>"},{"location":"v3/advanced/run-in-separate-process/#why-run-tests-in-a-separate-php-process","title":"Why run tests in a separate PHP process?","text":"<p>One main reason: isolation.</p> <p>What does \"isolation\" means?</p> <p>Before answering that question, it's essential to understand, via an example, why a lack of isolation might be an issue.</p> <p>I want to test the <code>get_api</code> function. The function will return the correct singleton instance of an API handling class: an instance of <code>Api</code> when the function is called in non-admin context, and an instance of <code>AdminApi</code> when the function is called in admin context. The <code>get_api</code> function is acting as a service locator.</p> <pre><code>&lt;?php\nfunction get_api(){\n    static $api;\n\n    if(null !== $api){\n        return $api;\n    }\n\n    if( is_admin() ) {\n        $api = new Admin_Api();\n    } else {\n        $api = new Api();\n    }\n\n    return $api;\n}\n</code></pre> <p>There are two challenges to testing this function:</p> <ol> <li>The <code>is_admin</code> function, defined by WordPress, looks up a <code>WP_ADMIN</code> constant to know if the context of the current request is an administration UI one or not.</li> <li>The <code>get_api</code> function will check for the context and resolve and build the correct instance only once, the first time it's called in the context of a request. </li> </ol> <p>There are some possible solutions to this problem:</p> <p>a. Refactor the <code>get_api</code> function into a method of an <code>Api_Factory</code> object taking the context as a dependency, thus allowing injection of the \"context\" (which implies the creation of a Context adapter that will proxy its <code>is_admin</code> method to the <code>is_admin</code> function). You can find the code for such refactoring in the OOP refactoring of get_api section. b. Refactor the <code>get_api</code> function to accept the current <code>is_admin</code> value as an input argument, <code>get_api( $is_admin )</code>, this refactoring moves part of the complexity of getting hold of the correct instance of the API handler on the client code. Adding more build condition and checks, e.g., if the current request is a REST request or not or some tests on the user authorizations, then, requires adding more input arguments to the <code>get_api</code> function: the knowledge of the implementation of the <code>get_api</code> method will \"leak\" to the client code having to replicate complexity throughout the system.</p> <p>I want to layout possible solutions to the problem to show there is always a design alternative to make code testable that might or might not fit the current time or scope constraint.  </p> <p>In this example, I've inherited the <code>get_api</code> function from the existing code, and it cannot be changed, yet I want to test it dealing with the two problems outlined above.</p>"},{"location":"v3/advanced/run-in-separate-process/#running-tests-in-separate-php-processes","title":"Running tests in separate PHP processes","text":"<p>To test the <code>get_api</code> function shown above I've created a new <code>wpunit</code> type of test:</p> <pre><code>vendor/bin/codecept g:wpunit integration \"api\"\n</code></pre> <p>The command scaffolds a <code>test/integration/apiTest.php</code> file that I've modified to ensure full coverage of the <code>get_api</code> function:</p> <pre><code>&lt;?php\n\nclass apiTest extends \\Codeception\\TestCase\\WPTestCase\n{\n    public function test_get_api_exists()\n    {\n        $this-&gt;assertTrue(function_exists('get_api'));\n    }\n\n    public function test_get_api_will_cache()\n    {\n        $this-&gt;assertSame(get_api(), get_api());\n    }\n\n    /**\n     * @runInSeparateProcess\n     * @preserveGlobalState disabled\n     */\n    public function test_get_api_will_return_api_if_not_admin()\n    {\n        // Let's make sure we're NOT in admin context.\n        define('WP_ADMIN', false);\n\n        $api = get_api();\n\n        $this-&gt;assertInstanceOf(Api::class, $api);\n    }\n\n    /**\n     * @runInSeparateProcess\n     * @preserveGlobalState disabled\n     */\n    public function test_get_api_will_cache_api_if_not_admin()\n    {\n        // Let's make sure we're NOT in admin context.\n        define('WP_ADMIN', false);\n\n        $api = get_api();\n\n        $this-&gt;assertSame(get_api(), $api);\n    }\n\n    /**\n     * @runInSeparateProcess\n     * @preserveGlobalState disabled\n     */\n    public function test_get_api_will_return_api_if_is_admin()\n    {\n        // Let's make sure we're NOT in admin context.\n        define('WP_ADMIN', true);\n\n        $api = get_api();\n\n        $this-&gt;assertInstanceOf(AdminApi::class, $api);\n    }\n\n    /**\n     * @runInSeparateProcess\n     * @preserveGlobalState disabled\n     */\n    public function test_get_api_will_cache_api_if_is_admin()\n    {\n        // Let's make sure we're NOT in admin context.\n        define('WP_ADMIN', true);\n\n        $api = get_api();\n\n        $this-&gt;assertSame(get_api(), $api);\n    }\n}\n</code></pre> <p>Some pieces of this code are worth pointing out:</p> <ol> <li>There are two test methods, <code>test_get_api_exists</code> and <code>test_get_api_will_cache</code> that are not running in a separate process. Running tests in a separate process provide isolation at the cost of speed, only tests that require isolation should run in a separate PHP process.  </li> <li>I instruct the Codeception and PHPUnit test runner to run a test method in a different process by adding two annotations that are both required ** precisely as shown**:     <pre><code>/**\n * @runInSeparateProcess\n * @preserveGlobalState disabled\n */\n</code></pre></li> <li>The isolation part of this testing approach shines through when I <code>define</code>, in the last four tests, the <code>WP_ADMIN</code> constant multiple times. If I try to do that in test code running in the same PHP process, then the second <code>define</code> call would cause a fatal error.</li> <li>The isolation has also taken care of the second issue where the <code>get_api</code> function caches the <code>$api</code> instance after its first resolution in a <code>static</code> variable: since each test happens in a self-contained, dedicated PHP process, the <code>static $api</code> variable will be <code>null</code> at the start of each test.</li> </ol>"},{"location":"v3/advanced/run-in-separate-process/#can-i-run-some-tests-in-the-same-process-and-some-in-a-separate-process","title":"Can I run some tests in the same process and some in a separate process?","text":"<p>Yes. In the example test code in the previous section, the <code>test_get_api_exists</code> and <code>test_get_api_will_cache</code> test methods are not running in separate processes.  </p> <p>In your test cases extending the <code>Codeception\\TestCase\\WPTestCase</code>, you can mix test methods running in the primary PHP process and those running in a separate PHP process without issues.</p>"},{"location":"v3/advanced/run-in-separate-process/#oop-refactoring-of-get_api","title":"OOP refactoring of get_api","text":"<p>In the Why run tests in a separate PHP process? section I've outlined a possible refactoring of the <code>get_api</code> function to make it testable without requiring the use of separate PHP processes.</p> <p>I'm providing this refactoring code below for the sake of completeness, the judgment of which approach is \"better\" is up to the reader.</p> <pre><code>&lt;?php\n\nclass Context_Adapter{\n\n    public function is_admin(){\n        return \\is_admin();\n    }\n\n}\n\nclass Api_Factory{\n\n    private $api;\n    private $context;\n\n    public function __construct(Context_Adapter $context){\n        $this-&gt;context = $context;\n    }\n\n    public function getApi(){\n        if(null !== $this-&gt;api){\n            return $this-&gt;api;    \n        }\n\n        if($this-&gt;context-&gt;is_admin()){\n            $api = new Admin_Api;\n        } else {\n            $api = new Api;\n        }\n\n        return $api;\n    }\n}\n</code></pre> <p>Now the <code>Api_Factory</code> class can be injected by injecting a mocked <code>Context_Adapter</code> class, modifying the return value of the <code>Context_Adapter::is_admin</code> method.  </p> <p>Due to the supposed requirement of the API instance being a singleton, this solution will also require some container or service-locator to ensure at most only one instance of the <code>Api_Factory</code> exists at any given time in the context of a request.</p>"},{"location":"v3/migration/from-version-2-to-version-3/","title":"Version 2 to version 3","text":"<p>This is the documentation for version 3 of the project. The current version is version 4 and the documentation can be found here.</p>"},{"location":"v3/migration/from-version-2-to-version-3/#migrating-projects-from-version-2-of-wp-browser-to-version-3","title":"Migrating projects from version 2 of wp-browser to version 3","text":"<p>Version 3 of wp-browser removed, to allow for broader compatibility with PHP and Composer versions, some of its  dependencies and modified some of its methods. Here is a list of changes and the suggested courses of action:</p> <ul> <li>Removed <code>symfony/process</code> to launch and manage external processes; re-add it your project development  requirements using <code>composer require --dev symfony/process</code>.</li> <li>Removed the <code>wp-cli/wp-cli-bundle</code> dependency; if you were relying on non-core  packages, then re-add it to your project development requirements using <code>composer require --dev wp-cli/wp-cli-bundle</code>.  </li> <li>Removed the <code>WithWpCli::executeBackgroundWpCliCommand</code> trait method, and, as a consequence, the  <code>WPCLI::executeBackgroundWpCliCommand</code> module method; you could have used the latter, if this was the case, then  require the <code>symfony/process</code> as explained above and launch processes in background using its API; find out more.</li> <li>Refactored the <code>WPCLI</code> module to build and escape string command lines differently; the handling of command-line arguments for the <code>WPCLI</code> module has been modified to make it a bit more consistent and robust; as a consequence, you might experience some breakages in string commands that used to work correctly before; should this be the case then either modify your code to provide the command in array format (taking care of the correct escaping in your code), or make sure to  pass a correctly structured command string to the <code>WPCLI</code> module.</li> </ul>"},{"location":"v3/modules/WPBrowser/","title":"WPBrowser","text":"<p>This is the documentation for version 3 of the project. The current version is version 4 and the documentation can be found here.</p>"},{"location":"v3/modules/WPBrowser/#wpbrowser-module","title":"WPBrowser module","text":"<p>This module should be used in acceptance and functional tests, see levels of testing for more information.  </p> <p>This module extends the PHPBrowser module adding WordPress-specific configuration parameters and methods.  </p> <p>The module simulates a user interaction with the site without Javascript support; if you need to test your project with Javascript support use the WPWebDriver module.  </p>"},{"location":"v3/modules/WPBrowser/#module-requirements-for-codeception-40","title":"Module requirements for Codeception 4.0+","text":"<p>This module requires the <code>codeception/module-phpbrowser</code> Composer package to work when wp-browser is used with Codeception 4.0.  </p> <p>To install the package run: </p> <pre><code>composer require --dev codeception/module-phpbrowser:^1.0\n</code></pre>"},{"location":"v3/modules/WPBrowser/#configuration","title":"Configuration","text":"<p>Since this module extends the <code>PHPBrowser</code> module provided by Codeception, please refer to the PHPBrowser configuration section for more information about the base configuration parameters.  </p> <ul> <li><code>url</code> required - Start URL of your WordPress project, e.g. <code>http://wp.test</code>.</li> <li><code>headers</code> - Default headers are set before each test; this might be useful to simulate a specific user agent during the tests or to identify the request source. Note that the headers defined in the config should be prefaced with <code>HTTP_</code> in your <code>wp-config.php</code> file. This can be used to select which database to use.</li> <li><code>handler</code> (default: <code>curl</code>) - The Guzzle handler to use. By default <code>curl</code> is used, also possible to pass <code>stream</code>, or any valid class name as Handler.</li> <li><code>middleware</code> - The Guzzle middlewares to add. An array of valid callables is required; see here for more information.</li> <li><code>curl</code> - curl options; only applied if using the <code>curl</code> handler; more options are available.</li> <li><code>adminUsername</code> required - This is the login name, not the \"nice\" name, of the administrator user of the WordPress test site. This will be used to fill the username field in WordPress login page.  </li> <li><code>adminPassword</code> required - This is the the password of the administrator use of the WordPress test site. This will be used to fill the password in WordPress login page.  </li> <li><code>adminPath</code> required - The path, relative to the WordPress test site home URL, to the administration area, usually <code>/wp-admin</code>.</li> </ul>"},{"location":"v3/modules/WPBrowser/#example-configuration","title":"Example configuration","text":"<pre><code>  modules:\n      enabled:\n          - WPBrowser\n      config:\n          WPBrowser:\n              url: 'http://wordpress.localhost'\n              adminUsername: 'admin'\n              adminPassword: 'password'\n              adminPath: '/wp-admin'\n              headers:\n                X_TEST_REQUEST: 1\n                X_WPBROWSER_REQUEST: 1\n</code></pre> <p>Read here how to use the headers information to automatically change the database during acceptance and functional tests.</p>"},{"location":"v3/modules/WPBrowser/#public-api","title":"Public API","text":"<ul> <li><code>activatePlugin($pluginSlug)</code> : <code>void</code>   In the plugin administration screen activates a plugin clicking the \"Activate\" link.</li> </ul> <p>The method will not handle authentication to the admin area.</p> <ul> <li><code>activateTheme($slug)</code> : <code>void</code>   Activates a theme.</li> </ul> <p>The method will not handle authentication and navigation to the themes administration page.</p> <ul> <li><code>amEditingPostWithId($id)</code> : <code>void</code>   Go to the admin page to edit the post with the specified ID.</li> </ul> <p>The method will not handle authentication the admin area.</p> <ul> <li><code>amEditingUserWithId($id)</code> : <code>void</code>   Go to the admin page to edit the user with the specified ID.</li> </ul> <p>The method will not handle authentication the admin area.</p> <ul> <li> <p><code>amHttpAuthenticated($username, $password)</code> : <code>void</code></p> </li> <li> <p><code>amOnAdminAjaxPage([$queryVars])</code> : <code>void</code>   Go to the <code>admin-ajax.php</code> page to start a synchronous, and blocking, <code>GET</code> AJAX request.</p> </li> </ul> <p>The method will not handle authentication, nonces or authorization.</p> <ul> <li><code>amOnAdminPage($page)</code> : <code>void</code>   Go to a page in the admininstration area of the site.</li> </ul> <p>This method will not handle authentication to the administration area.</p> <ul> <li> <p><code>amOnCronPage([$queryVars])</code> : <code>void</code>   Go to the cron page to start a synchronous, and blocking, <code>GET</code> request to the cron script.</p> </li> <li> <p><code>amOnPage($page)</code> : <code>void</code></p> </li> <li> <p><code>amOnPagesPage()</code> : <code>void</code>   Go the \"Pages\" administration screen.</p> </li> </ul> <p>The method will not handle authentication.</p> <ul> <li><code>amOnPluginsPage()</code> : <code>void</code>   Go to the plugins administration screen.</li> </ul> <p>The method will not handle authentication.</p> <ul> <li> <p><code>amOnSubdomain($subdomain)</code> : <code>void</code></p> </li> <li> <p><code>amOnThemesPage()</code> : <code>void</code>   Moves to the themes administration page.</p> </li> <li> <p><code>amOnUrl($url)</code> : <code>void</code></p> </li> <li> <p><code>attachFile($field, $filename)</code> : <code>void</code></p> </li> <li> <p><code>checkOption($option)</code> : <code>void</code></p> </li> <li> <p><code>click($link, [$context])</code> : <code>void</code></p> </li> <li> <p><code>deactivatePlugin($pluginSlug)</code> : <code>void</code>   In the plugin administration screen deactivate a plugin clicking the \"Deactivate\" link.</p> </li> </ul> <p>The method will not handle authentication and navigation to the plugins administration page.</p> <ul> <li><code>deleteHeader($name)</code> : <code>void</code>   Deletes the header with the passed name.  Subsequent requests   will not have the deleted header in its request.</li> </ul> <p>Example:   <pre><code>&lt;?php\n$I-&gt;haveHttpHeader('X-Requested-With', 'Codeception');\n$I-&gt;amOnPage('test-headers.php');\n// ...\n$I-&gt;deleteHeader('X-Requested-With');\n$I-&gt;amOnPage('some-other-page.php');\n</code></pre></p> <ul> <li> <p><code>dontSee($text, [$selector])</code> : <code>void</code></p> </li> <li> <p><code>dontSeeCheckboxIsChecked($checkbox)</code> : <code>void</code></p> </li> <li> <p><code>dontSeeCookie($cookie, [array $params])</code> : <code>void</code></p> </li> <li> <p><code>dontSeeCurrentUrlEquals($uri)</code> : <code>void</code></p> </li> <li> <p><code>dontSeeCurrentUrlMatches($uri)</code> : <code>void</code></p> </li> <li> <p><code>dontSeeElement($selector, [$attributes])</code> : <code>void</code></p> </li> <li> <p><code>dontSeeInCurrentUrl($uri)</code> : <code>void</code></p> </li> <li> <p><code>dontSeeInField($field, $value)</code> : <code>void</code></p> </li> <li> <p><code>dontSeeInFormFields($formSelector, array $params)</code> : <code>void</code></p> </li> <li> <p><code>dontSeeInSource($raw)</code> : <code>void</code></p> </li> <li> <p><code>dontSeeInTitle($title)</code> : <code>void</code></p> </li> <li> <p><code>dontSeeLink($text, [$url])</code> : <code>void</code></p> </li> <li> <p><code>dontSeeOptionIsSelected($selector, $optionText)</code> : <code>void</code></p> </li> <li> <p><code>dontSeePluginInstalled($pluginSlug)</code> : <code>void</code>   Assert a plugin is not installed in the plugins administration screen.</p> </li> </ul> <p>The method will not handle authentication and navigation to the plugin administration screen.</p> <ul> <li><code>dontSeeResponseCodeIs($code)</code> : <code>void</code>   Checks that response code is equal to value provided.</li> </ul> <pre><code>&lt;?php\n$I-&gt;dontSeeResponseCodeIs(200);\n\n// recommended \\Codeception\\Util\\HttpCode\n$I-&gt;dontSeeResponseCodeIs(\\Codeception\\Util\\HttpCode::OK);\n</code></pre> <ul> <li><code>executeInGuzzle(Closure $function)</code> : <code>void</code>   Low-level API method.   If Codeception commands are not enough, use Guzzle HTTP Client methods directly</li> </ul> <p>Example:</p> <pre><code>&lt;?php\n$I-&gt;executeInGuzzle(function (\\GuzzleHttp\\Client $client) {\n     $client-&gt;get('/get', ['query' =&gt; ['foo' =&gt; 'bar']]);\n});\n?&gt;\n</code></pre> <p>It is not recommended to use this command on a regular basis.   If Codeception lacks important Guzzle Client methods, implement them and submit patches.</p> <ul> <li> <p><code>fillField($field, $value)</code> : <code>void</code></p> </li> <li> <p><code>followRedirect()</code> : <code>void</code>   Follow pending redirect if there is one.</p> </li> </ul> <pre><code>&lt;?php\n$I-&gt;followRedirect();\n</code></pre> <ul> <li><code>grabActiveTheme()</code> : <code>void</code>   Returns the slug of the currently active themes.</li> </ul> <p>The method will not handle authentication and navigation to the themes administration page.</p> <ul> <li> <p><code>grabAttributeFrom($cssOrXpath, $attribute)</code> : <code>void</code></p> </li> <li> <p><code>grabAvailableThemes([$classes])</code> : <code>void</code>   Returns the list of available themes.</p> </li> </ul> <p>The method will not handle authentication and navigation to the themes administration page.</p> <ul> <li> <p><code>grabCookie($cookie, [array $params])</code> : <code>void</code></p> </li> <li> <p><code>grabCookiesWithPattern($cookiePattern)</code> : <code>void</code>   Returns all the cookies whose name matches a regex pattern.</p> </li> <li> <p><code>grabFromCurrentUrl([$uri])</code> : <code>void</code></p> </li> <li> <p><code>grabMultiple($cssOrXpath, [$attribute])</code> : <code>void</code></p> </li> <li> <p><code>grabPageSource()</code> : <code>void</code>   Grabs current page source code.</p> </li> <li> <p><code>grabTextFrom($cssOrXPathOrRegex)</code> : <code>void</code></p> </li> <li> <p><code>grabValueFrom($field)</code> : <code>void</code></p> </li> <li> <p><code>grabWordPressTestCookie([$name])</code> : <code>void</code>   Returns WordPress default test cookie object if present.</p> </li> <li> <p><code>haveHttpHeader($name, $value)</code> : <code>void</code>   Sets the HTTP header to the passed value - which is used on   subsequent HTTP requests through PhpBrowser.</p> </li> </ul> <p>Example:   <pre><code>&lt;?php\n$I-&gt;haveHttpHeader('X-Requested-With', 'Codeception');\n$I-&gt;amOnPage('test-headers.php');\n</code></pre></p> <p>To use special chars in Header Key use HTML Character Entities:   Example:   Header with underscore - 'Client_Id'   should be represented as - 'Client_Id' or 'Client_Id'</p> <pre><code>&lt;?php\n$I-&gt;haveHttpHeader('Client&amp;#95;Id', 'Codeception');\n</code></pre> <ul> <li><code>haveServerParameter($name, $value)</code> : <code>void</code>   Sets SERVER parameter valid for all next requests.</li> </ul> <pre><code>$I-&gt;haveServerParameter('name', 'value');\n</code></pre> <ul> <li> <p><code>logOut([$redirectTo])</code> : <code>void</code>   Navigate to the default WordPress logout page and click the logout link.</p> </li> <li> <p><code>loginAs($username, $password)</code> : <code>void</code>   Login as the specified user.</p> </li> </ul> <p>The method will not follow redirection, after the login, to any page.</p> <ul> <li><code>loginAsAdmin()</code> : <code>void</code>   Login as the administrator user using the credentials specified in the module configuration.</li> </ul> <p>The method will not follow redirection, after the login, to any page.</p> <ul> <li> <p><code>makeHtmlSnapshot([$name])</code> : <code>void</code></p> </li> <li> <p><code>moveBack([$numberOfSteps])</code> : <code>void</code>   Moves back in history.</p> </li> <li> <p><code>resetCookie($cookie, [array $params])</code> : <code>void</code></p> </li> <li> <p><code>see($text, [$selector])</code> : <code>void</code></p> </li> <li> <p><code>seeCheckboxIsChecked($checkbox)</code> : <code>void</code></p> </li> <li> <p><code>seeCookie($cookie, [array $params])</code> : <code>void</code></p> </li> <li> <p><code>seeCurrentUrlEquals($uri)</code> : <code>void</code></p> </li> <li> <p><code>seeCurrentUrlMatches($uri)</code> : <code>void</code></p> </li> <li> <p><code>seeElement($selector, [$attributes])</code> : <code>void</code></p> </li> <li> <p><code>seeErrorMessage([$classes])</code> : <code>void</code>   In an administration screen look for an error admin notice.</p> </li> </ul> <p>The check is class-based to decouple from internationalization.   The method will not handle authentication and navigation the administration area.</p> <ul> <li> <p><code>seeInCurrentUrl($uri)</code> : <code>void</code></p> </li> <li> <p><code>seeInField($field, $value)</code> : <code>void</code></p> </li> <li> <p><code>seeInFormFields($formSelector, array $params)</code> : <code>void</code></p> </li> <li> <p><code>seeInSource($raw)</code> : <code>void</code></p> </li> <li> <p><code>seeInTitle($title)</code> : <code>void</code></p> </li> <li> <p><code>seeLink($text, [$url])</code> : <code>void</code></p> </li> <li> <p><code>seeMessage([$classes])</code> : <code>void</code>   In an administration screen look for an admin notice.</p> </li> </ul> <p>The check is class-based to decouple from internationalization.   The method will not handle authentication and navigation the administration area.</p> <ul> <li> <p><code>seeNumberOfElements($selector, $expected)</code> : <code>void</code></p> </li> <li> <p><code>seeOptionIsSelected($selector, $optionText)</code> : <code>void</code></p> </li> <li> <p><code>seePageNotFound()</code> : <code>void</code>   Asserts that current page has 404 response status code.</p> </li> <li> <p><code>seePluginActivated($pluginSlug)</code> : <code>void</code>   Assert a plugin is activated in the plugin administration screen.</p> </li> </ul> <p>The method will not handle authentication and navigation to the plugin administration screen.</p> <ul> <li><code>seePluginDeactivated($pluginSlug)</code> : <code>void</code>   Assert a plugin is not activated in the plugins administration screen.</li> </ul> <p>The method will not handle authentication and navigation to the plugin administration screen.</p> <ul> <li><code>seePluginInstalled($pluginSlug)</code> : <code>void</code>   Assert a plugin is installed, no matter its activation status, in the plugin administration screen.</li> </ul> <p>The method will not handle authentication and navigation to the plugin administration screen.</p> <ul> <li><code>seeResponseCodeIs($code)</code> : <code>void</code>   Checks that response code is equal to value provided.</li> </ul> <pre><code>&lt;?php\n$I-&gt;seeResponseCodeIs(200);\n\n// recommended \\Codeception\\Util\\HttpCode\n$I-&gt;seeResponseCodeIs(\\Codeception\\Util\\HttpCode::OK);\n</code></pre> <ul> <li> <p><code>seeResponseCodeIsBetween($from, $to)</code> : <code>void</code>   Checks that response code is between a certain range. Between actually means [from &lt;= CODE &lt;= to]</p> </li> <li> <p><code>seeResponseCodeIsClientError()</code> : <code>void</code>   Checks that the response code is 4xx</p> </li> <li> <p><code>seeResponseCodeIsRedirection()</code> : <code>void</code>   Checks that the response code 3xx</p> </li> <li> <p><code>seeResponseCodeIsServerError()</code> : <code>void</code>   Checks that the response code is 5xx</p> </li> <li> <p><code>seeResponseCodeIsSuccessful()</code> : <code>void</code>   Checks that the response code 2xx</p> </li> <li> <p><code>seeThemeActivated($slug)</code> : <code>void</code>   Verifies that a theme is active.</p> </li> </ul> <p>The method will not handle authentication and navigation to the themes administration page.</p> <ul> <li><code>seeWpDiePage()</code> : <code>void</code>   Checks that the current page is one generated by the <code>wp_die</code> function.</li> </ul> <p>The method will try to identify the page based on the default WordPress die page HTML attributes.</p> <ul> <li> <p><code>selectOption($select, $option)</code> : <code>void</code></p> </li> <li> <p><code>sendAjaxGetRequest($uri, [$params])</code> : <code>void</code>   Sends an ajax GET request with the passed parameters.   See <code>sendAjaxPostRequest()</code></p> </li> <li> <p><code>sendAjaxPostRequest($uri, [$params])</code> : <code>void</code>   Sends an ajax POST request with the passed parameters.   The appropriate HTTP header is added automatically:   <code>X-Requested-With: XMLHttpRequest</code>   Example:   <pre><code>&lt;?php\n$I-&gt;sendAjaxPostRequest('/add-task', ['task' =&gt; 'lorem ipsum']);\n</code></pre>   Some frameworks (e.g. Symfony) create field names in the form of an \"array\":   <code>&lt;input type=\"text\" name=\"form[task]\"&gt;</code>   In this case you need to pass the fields like this:   <pre><code>&lt;?php\n$I-&gt;sendAjaxPostRequest('/add-task', ['form' =&gt; [\n    'task' =&gt; 'lorem ipsum',\n    'category' =&gt; 'miscellaneous',\n]]);\n</code></pre></p> </li> <li> <p><code>sendAjaxRequest($method, $uri, [$params])</code> : <code>void</code>   Sends an ajax request, using the passed HTTP method.   See <code>sendAjaxPostRequest()</code>   Example:   <pre><code>&lt;?php\n$I-&gt;sendAjaxRequest('PUT', '/posts/7', ['title' =&gt; 'new title']);\n</code></pre></p> </li> <li> <p><code>setCookie($name, $val, [array $params])</code> : <code>void</code></p> </li> <li> <p><code>setHeader($name, $value)</code> : <code>void</code>   Alias to <code>haveHttpHeader</code></p> </li> <li> <p><code>setMaxRedirects($maxRedirects)</code> : <code>void</code>   Sets the maximum number of redirects that the Client can follow.</p> </li> </ul> <pre><code>&lt;?php\n$I-&gt;setMaxRedirects(2);\n</code></pre> <ul> <li><code>setServerParameters(array $params)</code> : <code>void</code>   Sets SERVER parameters valid for all next requests.   this will remove old ones.</li> </ul> <pre><code>$I-&gt;setServerParameters([]);\n</code></pre> <ul> <li><code>startFollowingRedirects()</code> : <code>void</code>   Enables automatic redirects to be followed by the client.</li> </ul> <pre><code>&lt;?php\n$I-&gt;startFollowingRedirects();\n</code></pre> <ul> <li><code>stopFollowingRedirects()</code> : <code>void</code>   Prevents automatic redirects to be followed by the client.</li> </ul> <pre><code>&lt;?php\n$I-&gt;stopFollowingRedirects();\n</code></pre> <ul> <li> <p><code>submitForm($selector, array $params, [$button])</code> : <code>void</code></p> </li> <li> <p><code>switchToIframe($name)</code> : <code>void</code>   Switch to iframe or frame on the page.</p> </li> </ul> <p>Example:   <pre><code>&lt;iframe name=\"another_frame\" src=\"http://example.com\"&gt;\n</code></pre></p> <pre><code>&lt;?php\n# switch to iframe\n$I-&gt;switchToIframe(\"another_frame\");\n</code></pre> <ul> <li><code>uncheckOption($option)</code> : <code>void</code></li> </ul> <p>This class extends \\Codeception\\Module\\PhpBrowser</p> <p>This class implements \\Codeception\\Lib\\Interfaces\\MultiSession, \\Codeception\\Lib\\Interfaces\\Remote, \\Codeception\\Lib\\Interfaces\\Web, \\Codeception\\Lib\\Interfaces\\PageSourceSaver, \\Codeception\\Lib\\Interfaces\\ElementLocator, \\Codeception\\Lib\\Interfaces\\ConflictsWithModule</p>"},{"location":"v3/modules/WPCLI/","title":"WPCLI","text":"<p>This is the documentation for version 3 of the project. The current version is version 4 and the documentation can be found here.</p>"},{"location":"v3/modules/WPCLI/#wpcli-module","title":"WPCLI module","text":"<p>This module should be used in acceptance and functional tests to setup, or verify, tests pre and post conditions using WP-CLI commands. This module allows invoking WP-CLI commands, refer to the official site for more information.</p> <p>The module will use its own version of WP-CLI, not the one installed in the machine running the tests!</p> <p>By default, wp-browser will only include the <code>wp-cli/wp-cli</code> package; this package contains the basic files to run WP-CLI and does not contain all the commands that come with a typical wp-cli installation. If, in your tests, you require all the commands that usually come installed with WP-CLI, then you should require the <code>wp-cli/wp-cli-bundle</code> package as a development dependency of your project, see below.</p>"},{"location":"v3/modules/WPCLI/#fixing-not-a-registered-command-issue","title":"Fixing \"not a registered command\" issue","text":"<p>To keep the conflicts at a manageable level, the wp-browser project does not include all the commands WP-CLI usually comes bundled with. Running, in the context of an automated test, a WP-CLI command that would work on your machine, e.g. <code>wp plugin list --status=active</code>, will not work on a default installation of wp-browser and you will get the following error message:</p> <pre><code>[ModuleException] WPCLI: wp-cli terminated with status [1] and output [Error: 'plugin' is not a registered wp command. See 'wp help' for available commands.]\n</code></pre> <p>To resolve the message just add the package you require as a development dependency or add the whole WP-CLI bundle:</p> <pre><code>composer require --dev wp-cli/wp-cli-bundle\n</code></pre> <p>The package will make all the default WP-CLI commands available to the WP-CLI version used in tests.</p>"},{"location":"v3/modules/WPCLI/#module-requirements-for-codeception-40","title":"Module requirements for Codeception 4.0+","text":"<p>This module requires the <code>codeception/module-cli</code> Composer package to work when wp-browser is used with Codeception 4.0.  </p> <p>To install the package run: </p> <pre><code>composer require --dev codeception/module-cli:^1.0\n</code></pre>"},{"location":"v3/modules/WPCLI/#detecting-requests-coming-from-this-module","title":"Detecting requests coming from this module","text":"<p>When it runs this module will set the <code>WPBROWSER_HOST_REQUEST</code> environment variable. You can detect and use that information to, as an example, use the correct database in your test site <code>wp-config.php</code> file: <pre><code>&lt;?php\nif ( \n    // Custom header.\n    isset( $_SERVER['HTTP_X_TESTING'] )\n    // Custom user agent.\n    || ( isset( $_SERVER['HTTP_USER_AGENT'] ) &amp;&amp; $_SERVER['HTTP_USER_AGENT'] === 'wp-browser' )\n    // The env var set by the WPClIr or WordPress modules.\n    || getenv( 'WPBROWSER_HOST_REQUEST' )\n) {\n    // Use the test database if the request comes from a test.\n    define( 'DB_NAME', 'wordpress_test' );\n} else {\n    // Else use the default one.\n    define( 'DB_NAME', 'wordpress' );\n}\n</code></pre></p>"},{"location":"v3/modules/WPCLI/#configuration","title":"Configuration","text":"<ul> <li><code>path</code> required - the absolute, or relative, path to the WordPress root folder. This will be mapped to the <code>--path</code> argument of the wp-cli binary.  </li> <li><code>throw</code> - defaults to <code>true</code> to throw an exception when a wp-cli command does not return an exit status of <code>0</code>; if set to <code>false</code> then the exit status of the commands will be returned as is.</li> <li><code>timeout</code> - defaults to <code>60</code> (seconds) to set each process execution timeout to a certain value; set to <code>null</code>, <code>false</code> or <code>0</code> to disable timeout completely.</li> </ul> <p>Additionally the module configuration will forward any configuration parameter to <code>wp-cli</code> as a flag or option. In the example configuration below the <code>allow-root</code> flag and the <code>some-option</code> option will be passed to <code>wp-cli</code> directly and prepended to the command as global options.</p> <p>Note: these extract configuration flags and options will be prepended to all commands executed by wp-cli!</p>"},{"location":"v3/modules/WPCLI/#environment-configuration","title":"Environment configuration","text":"<p>The wp-cli binary supports a set of environment variables to modify its behavior.   </p> <p>These environment variables can be set on the commands ran by the <code>WPCLI</code> module using the optional <code>env</code> array in the module configuration. The example configuration below shows all of them with some example values. Most of the times you won't need any of these, but they are there for more fine-grained control over the module operations.  </p> <p>The module is not validating the environment variables in any way! Those values will be evaluated by wp-cli at runtime and might generate errors if not correctly configured.</p>"},{"location":"v3/modules/WPCLI/#example-configuration","title":"Example configuration","text":"<pre><code>modules:\n    enabled:\n        - WPCLI\n    config:\n        WPCLI:\n            path: /Users/Luca/Sites/wp\n            throw: true\n            timeout: 60\n            # This will be prepended to the command, `wp --allow-root &lt;command&gt;`.\n            allow-root: true\n            # This will be prepended to the command, `wp --some-option=some-value &lt;command&gt;`.\n            some-option: some-value\n            env:\n                # Any one of these, if provided, will be set as environment variable for the the cli command process. \n                # See https://make.wordpress.org/cli/handbook/config/#environment-variables for information.\n                # Equivalent to `WP_CLI_STRICT_ARGS_MODE=1 wp &lt;command&gt;'.\n                strict-args: true\n                # Equivalent to `WP_CLI_CACHE_DIR=/tmp/wp-cli-cache wp &lt;command&gt;'.\n                cache-dir: '/tmp/wp-cli-cache'\n                # Equivalent to `WP_CLI_CONFIG_PATH=/app/public wp &lt;command&gt;'.\n                config-path: '/app/public'\n                # Equivalent to `WP_CLI_CUSTOM_SHELL=/bin/zsh wp &lt;command&gt;'.\n                custom-shell: '/bin/zsh'\n                # Equivalent to `WP_CLI_DISABLE_AUTO_CHECK_UPDATE=1 wp &lt;command&gt;'.\n                disable-auto-update: true\n                # Equivalent to `WP_CLI_PACKAGES_DIR=/wp-cli/packages wp &lt;command&gt;'.\n                packages-dir: '/wp-cli/packages'\n                # Equivalent to `WP_CLI_PHP=/usr/local/bin/php/7.2/php wp &lt;command&gt;'.\n                php: '/usr/local/bin/php/7.2/php'\n                # Equivalent to `WP_CLI_PHP_ARGS='foo=bar some=23' wp &lt;command&gt;'.\n                php-args: 'foo=bar some=23'\n</code></pre>"},{"location":"v3/modules/WPCLI/#public-api","title":"Public API","text":"<ul> <li> buildFullCommand </li> <li> cli </li> <li> cliToArray </li> <li> cliToString </li> <li> dontSeeInShellOutput </li> <li> seeInShellOutput </li> <li> seeResultCodeIs </li> <li> seeResultCodeIsNot </li> <li> seeShellOutputMatches </li> </ul> buildFullCommand <p>Builds the full command to run including the PHP binary and the wp-cli boot file path.</p> <pre><code>// This method is defined in the WithWpCli trait.\n  // Set the wp-cli path, `$this` is a test case.\n  $this-&gt;setUpWpCli( '/var/www/html' );\n  // Builds the full wp-cli command, including the `path` variable.\n  $fullCommand =  $this-&gt;buildFullCommand(['core', 'version']);\n  // The full command can then be used to run it with another process handler.\n  $wpCliProcess = new Process($fullCommand);\n  $wpCliProcess-&gt;run();\n</code></pre> Parameters <ul> <li><code>\\Codeception\\Module\\array/string $command - The command to run. cli <p>Executes a wp-cli command targeting the test WordPress installation. minus <code>wp</code>. For back-compatibility purposes you can still pass the commandline as a string, but the array format is the preferred and supported method.</p> <pre><code>// Activate a plugin via wp-cli in the test WordPress site.\n  $I-&gt;cli(['plugin', 'activate', 'my-plugin']);\n  // Change a user password.\n  $I-&gt;cli(['user', 'update', 'luca', '--user_pass=newpassword']);\n</code></pre> Parameters <ul> <li><code>string/string/\\Codeception\\Module\\array $userCommand - The string of command and parameters as it would be passed to wp-cli cliToArray <p>Returns the output of a wp-cli command as an array optionally allowing a callback to process the output. minus <code>wp</code>. For back-compatibility purposes you can still pass the commandline as a string, but the array format is the preferred and supported method.</p> <pre><code>// Return a list of inactive themes, like ['twentyfourteen', 'twentyfifteen'].\n  $inactiveThemes = $I-&gt;cliToArray(['theme', 'list', '--status=inactive', '--field=name']);\n  // Get the list of installed plugins and only keep the ones starting with \"foo\".\n  $fooPlugins = $I-&gt;cliToArray(['plugin', 'list', '--field=name'], function($output){\n  return array_filter(explode(PHP_EOL, $output), function($name){\n  return strpos(trim($name), 'foo') === 0;\n  });\n  });\n</code></pre> Parameters <ul> <li><code>string/string/\\Codeception\\Module\\array $userCommand - The string of command and parameters as it would be passed to wp-cli <li><code>\\callable</code> $splitCallback - An optional callback function to split the results array.</li> cliToString <p>Returns the output of a wp-cli command as a string. minus <code>wp</code>. For back-compatibility purposes you can still pass the commandline as a string, but the array format is the preferred and supported method.</p> <pre><code>// Return the current site administrator email, using string command format.\n  $adminEmail = $I-&gt;cliToString('option get admin_email');\n  // Get the list of active plugins in JSON format, two ways.\n  $activePlugins = $I-&gt;cliToString(['plugin', 'list','--status=active', '--format=json']);\n  $activePlugins = $I-&gt;cliToString(['option', 'get', 'active_plugins' ,'--format=json']);\n</code></pre> Parameters <ul> <li><code>string/\\Codeception\\Module\\array $userCommand - The string of command and parameters as it would be passed to wp-cli dontSeeInShellOutput <p>Checks that output from last command doesn't contain text.</p> <pre><code>// Return the current site administrator email, using string command format.\n  $I-&gt;cli('plugin list --status=active');\n  $I-&gt;dontSeeInShellOutput('my-inactive/plugin.php');\n</code></pre> Parameters <ul> <li><code>string</code> $text - The text to assert is not in the output.</li></ul> seeInShellOutput <p>Checks that output from last command contains text.</p> <pre><code>// Return the current site administrator email, using string command format.\n  $I-&gt;cli('option get admin_email');\n</code></pre> Parameters <ul> <li><code>string</code> $text - The text to assert is in the output.</li></ul> seeResultCodeIs <p>Checks the result code from the last command.</p> <pre><code>// Return the current site administrator email, using string command format.\n  $I-&gt;cli('option get admin_email');\n  $I-&gt;seeResultCodeIs(0);\n</code></pre> Parameters <ul> <li><code>int</code> $code - The desired result code.</li></ul> seeResultCodeIsNot <p>Checks the result code from the last command.</p> <pre><code>// Return the current site administrator email, using string command format.\n  $I-&gt;cli('invalid command');\n  $I-&gt;seeResultCodeIsNot(0);\n</code></pre> Parameters <ul> <li><code>int</code> $code - The result code the command should not have exited with.</li></ul> seeShellOutputMatches <p>Checks that output from the last command matches a given regular expression.</p> <pre><code>// Return the current site administrator email, using string command format.\n  $I-&gt;cli('option get admin_email');\n</code></pre> Parameters <ul> <li><code>string</code> $regex - The regex pattern, including delimiters, to assert the output matches against.</li></ul> <p>This class extends \\Codeception\\Module</p>"},{"location":"v3/modules/WPDb/","title":"WPDb","text":"<p>This is the documentation for version 3 of the project. The current version is version 4 and the documentation can be found here.</p>"},{"location":"v3/modules/WPDb/#wpdb-module","title":"WPDb module","text":"<p>This module should be used in acceptance and functional tests, see levels of testing for more information. This module extends the Db module adding WordPress-specific configuration parameters and methods. The module provides methods to read, write and update the WordPress database directly, without relying on WordPress methods, using WordPress functions or triggering WordPress filters.  </p>"},{"location":"v3/modules/WPDb/#module-requirements-for-codeception-40","title":"Module requirements for Codeception 4.0+","text":"<p>This module requires the <code>codeception/module-db</code> Composer package to work when wp-browser is used with Codeception 4.0.  </p> <p>To install the package run: </p> <pre><code>composer require --dev codeception/module-db:^1.0\n</code></pre>"},{"location":"v3/modules/WPDb/#backup-your-content","title":"Backup your content","text":"<p>This module, like the Codeception Db one it extends, by default will load a database dump in the database it's using. This means that the database contents will be replaced by the dump contents on each run of a suite using the module. You can set the <code>populate</code> and <code>cleanup</code> parameters to <code>false</code> to prevent this default behavior but it's usually not what you need in an automated test. Make a backup of any database you're using in tests that contains any information you care about before you run any test!</p>"},{"location":"v3/modules/WPDb/#change-the-database-used-depending-on-whether-youre-running-tests-or-not","title":"Change the database used depending on whether you're running tests or not","text":"<p>The chore of having to plug different databases, or backup them, depending on whether you're manually testing the site or automatically testing can be mitigated switching them automatically depending on the browser user agent or request headers. This module was born to be used in acceptance and functional tests (see levels of testing for more information) and will often be coupled with modules like the WPBrowser one or the WPWebDriver one. Depending on which of the two modules is being used in the suite there are different ways to automate the \"database switching\".</p>"},{"location":"v3/modules/WPDb/#automatically-changing-database-based-on-the-browser-user-agent","title":"Automatically changing database based on the browser user agent","text":"<p>If you would like to automate the \"switching above\" below you will find an example setup. Update the test site <code>wp-config.php</code> file from this: <pre><code>define( 'DB_NAME', 'wordpress' );\n</code></pre>  to this: <pre><code>&lt;?php\nif ( \n    // Custom header.\n    isset( $_SERVER['HTTP_X_TESTING'] )\n    // Custom user agent.\n    || ( isset( $_SERVER['HTTP_USER_AGENT'] ) &amp;&amp; $_SERVER['HTTP_USER_AGENT'] === 'wp-browser' )\n    // The env var set by the WPClIr or WordPress modules.\n    || getenv( 'WPBROWSER_HOST_REQUEST' )\n) {\n    // Use the test database if the request comes from a test.\n    define( 'DB_NAME', 'wordpress_test' );\n} else {\n    // Else use the default one.\n    define( 'DB_NAME', 'wordpress' );\n}\n</code></pre></p> <p>If you're using the WPWebDriver module set the user agent in the browser, in this example I'm setting the user agent in Chromedriver: <pre><code>class_name: AcceptanceTester\nmodules:\n    enabled:\n        - \\Helper\\Acceptance\n        - WPDb\n        - WPWebDriver\n    config:\n        WPDb:\n            dsn: 'mysql:host=%WP_DB_HOST%;dbname=%WP_DB_NAME%'\n            user: %WP_DB_USER%\n            password: %WP_DB_PASSWORD%\n            dump: tests/_data/dump.sql\n            populate: true\n            cleanup: false\n            url: '%WP_URL%'\n            tablePrefix: %WP_TABLE_PREFIX%\n            urlReplacement: true\n        WPWebDriver:\n            url: '%WP_URL%'\n            adminUsername: '%WP_ADMIN_USERNAME%'\n            adminPassword: '%WP_ADMIN_PASSWORD%'\n            adminPath: '%WP_ADMIN_PATH%'\n            browser: chrome\n            host: localhost\n            port: 4444\n            window_size: false\n            wait: 5\n            capabilities:\n              \"goog:chromeOptions\":\n                args:\n                  - \"--headless\"\n                  - \"--disable-gpu\"\n                  - \"--disable-dev-shm-usage\"\n                  - \"--proxy-server='direct://'\"\n                  - \"--proxy-bypass-list=*\"\n                  - \"--no-sandbox\"\n</code></pre></p> <p>If you're using the WPBrowser module send a specific header in the context of test requests:  <pre><code>class_name: AcceptanceTester\nmodules:\n    enabled:\n        - \\Helper\\Acceptance\n        - WPDb\n        - WPBrowser\n    config:\n        WPDb:\n              dsn: 'mysql:host=%DB_HOST%;dbname=%WP_DB_NAME%'\n              user: %WP_DB_USER%\n              password: %WP_DB_PASSWORD%\n              dump: 'tests/_data/dump.sql'\n              populate: true\n              cleanup: true\n              reconnect: false\n              url: '%WP_URL%'\n              tablePrefix: 'wp_'\n        WPBrowser:\n              url: '%WP_URL%'\n              adminUsername: 'admin'\n              adminPassword: 'admin'\n              adminPath: '/wp-admin'\n              headers: \n                X-Testing: 'wp-browser'\n</code></pre></p>"},{"location":"v3/modules/WPDb/#configuration","title":"Configuration","text":"<ul> <li><code>dsn</code> required - the database POD DSN connection details; read more on PHP PDO documentation. If the database is accessible (as is the case on the latest version of [Local by Flywheel][http://localwp.com]) via unix socket, then the string to insert here should look like this <code>mysql:unix_socket=/path/to/the/mysql.sock;dbname=wordpress</code>.</li> <li><code>user</code> required - the database user.</li> <li><code>password</code> required - the database password.</li> <li><code>url</code> required - the full URL, including the HTTP scheme, of the website whose database is being accessed. WordPress uses hard-codece URLs in the database, that URL will be set by this module when applying the SQL dump file during population or cleanup.</li> <li><code>dump</code> required - defaults to <code>null</code>; sets the path, relative to the project root folder, or absolute to the SQL dump file that will be used to set the tests initial database fixture. If set to <code>null</code> then the <code>populate</code>, <code>cleanup</code> and <code>populator</code> parameters will be ignored.</li> <li><code>populate</code> - defaults to <code>true</code> to empty the target database and import the SQL dump(s) specified in the <code>dump</code> argument before the test suite is started.</li> <li><code>cleanup</code> - defaults to <code>true</code> empty the target database and import the SQL dump(s) specified in the <code>dump</code> argument before each test. </li> <li><code>urlReplacement</code> - defaults to <code>true</code> to replace, while using the built-in, PHP-based, dump import solution the hard-coded WordPress URL in the database with the specified one.</li> <li><code>originalUrl</code> - specifies the original URL hard-coded into the version controlled SQL dump files. This can help prevent some URL replacement issues when the <code>urlReplacement</code> configuration parameter is set to <code>true</code>.</li> <li><code>populator</code> - defaults to <code>null</code>, if set to an executable shell command then that command will be used to populate the database in place of the built-in PHP solution; URL replacement will not apply in this case. Read more about this on Codeception documentation.</li> <li><code>reconnect</code> - defaults to <code>true</code> to force the module to reconnect to the database before each test in place of only connecting at the start of the tests.</li> <li><code>waitlock</code> - defaults to <code>10</code>; wait lock (in seconds) that the database session should use for DDL statements.</li> <li><code>tablePrefix</code> - defaults to <code>wp_</code>; sets the prefix of the tables that the module will manipulate.</li> <li><code>letAdminEmailVerification</code> - defaults to an empty value to remove the Administrator Email Verification screen introduced in WordPress 5.3. Set to <code>true</code> to not remove the screen and show it when an administrator user first logs in.</li> <li><code>letCron</code> - defaults to an empty value to avoid <code>wp-cron</code> from being spawned during tests. Setting this to <code>true</code> will let <code>wp-cron</code> requests to fire during tests.</li> </ul>"},{"location":"v3/modules/WPDb/#example-configuration","title":"Example configuration","text":"<pre><code>modules:\n  enabled:\n      - WPDb\n  config:\n      WPDb:\n          dsn: 'mysql:host=localhost;dbname=wordpress'\n          user: 'root'\n          password: 'password'\n          dump: 'tests/_data/dump.sql'\n          populate: true\n          cleanup: true\n          waitlock: 10\n          url: 'http://wordpress.localhost'\n          urlReplacement: true\n          tablePrefix: 'wp_'\n</code></pre>"},{"location":"v3/modules/WPDb/#using-the-module-with-the-wploader-one","title":"Using the module with the WPLoader one","text":"<p>This module is often used in conjunction with the WPLoader one to use WordPress-defined functions, classes and methods in acceptance or functional tests. The WPLoader module should be set to only load WordPress and this module should be listed, in the <code>modules.enabled</code> section of the suite configuration file before the <code>WPLoader</code> one:</p> <p><pre><code>modules:\n  enabled:\n      - WPDb # this before...\n      - WPLoader # ...this one.\n  config:\n      WPDb:\n        # ...\n      WPLoader:\n        loadOnly: true\n        # ... \n</code></pre> This will avoid issues where the <code>WPLoader</code> module could <code>exit</code>, terminating the test run, due to an inconsistent database state.</p>"},{"location":"v3/modules/WPDb/#public-api","title":"Public API","text":"<ul> <li> countRowsInDatabase </li> <li> dontHaveAttachmentFilesInDatabase </li> <li> dontHaveAttachmentInDatabase </li> <li> dontHaveBlogInDatabase </li> <li> dontHaveCommentInDatabase </li> <li> dontHaveCommentMetaInDatabase </li> <li> dontHaveInDatabase </li> <li> dontHaveLinkInDatabase </li> <li> dontHaveOptionInDatabase </li> <li> dontHavePostInDatabase </li> <li> dontHavePostMetaInDatabase </li> <li> dontHavePostThumbnailInDatabase </li> <li> dontHaveSiteOptionInDatabase </li> <li> dontHaveSiteTransientInDatabase </li> <li> dontHaveTableInDatabase </li> <li> dontHaveTermInDatabase </li> <li> dontHaveTermMetaInDatabase </li> <li> dontHaveTermRelationshipInDatabase </li> <li> dontHaveTermTaxonomyInDatabase </li> <li> dontHaveTransientInDatabase </li> <li> dontHaveUserInDatabase </li> <li> dontHaveUserInDatabaseWithEmail </li> <li> dontHaveUserMetaInDatabase </li> <li> dontSeeAttachmentInDatabase </li> <li> dontSeeBlogInDatabase </li> <li> dontSeeCommentInDatabase </li> <li> dontSeeCommentMetaInDatabase </li> <li> dontSeeLinkInDatabase </li> <li> dontSeeOptionInDatabase </li> <li> dontSeePageInDatabase </li> <li> dontSeePostInDatabase </li> <li> dontSeePostMetaInDatabase </li> <li> dontSeePostWithTermInDatabase </li> <li> dontSeeSiteOptionInDatabase </li> <li> dontSeeTableInDatabase </li> <li> dontSeeTermInDatabase </li> <li> dontSeeTermMetaInDatabase </li> <li> dontSeeTermTaxonomyInDatabase </li> <li> dontSeeUserInDatabase </li> <li> dontSeeUserMetaInDatabase </li> <li> getSiteDomain </li> <li> getUsersTableName </li> <li> grabAllFromDatabase </li> <li> grabAttachmentAttachedFile </li> <li> grabAttachmentMetadata </li> <li> grabBlogDomain </li> <li> grabBlogPath </li> <li> grabBlogTableName </li> <li> grabBlogTableNames </li> <li> grabBlogTablePrefix </li> <li> grabBlogVersionsTableName </li> <li> grabBlogsTableName </li> <li> grabCommentmetaTableName </li> <li> grabCommentsTableName </li> <li> grabLatestEntryByFromDatabase </li> <li> grabLinksTableName </li> <li> grabOptionFromDatabase </li> <li> grabPostMetaFromDatabase </li> <li> grabPostmetaTableName </li> <li> grabPostsTableName </li> <li> grabPrefixedTableNameFor </li> <li> grabRegistrationLogTableName </li> <li> grabSignupsTableName </li> <li> grabSiteMetaTableName </li> <li> grabSiteOptionFromDatabase </li> <li> grabSiteTableName </li> <li> grabSiteTransientFromDatabase </li> <li> grabSiteUrl </li> <li> grabTablePrefix </li> <li> grabTermIdFromDatabase </li> <li> grabTermMetaTableName </li> <li> grabTermRelationshipsTableName </li> <li> grabTermTaxonomyIdFromDatabase </li> <li> grabTermTaxonomyTableName </li> <li> grabTermsTableName </li> <li> grabUserIdFromDatabase </li> <li> grabUserMetaFromDatabase </li> <li> grabUsermetaTableName </li> <li> grabUsersTableName </li> <li> haveAttachmentInDatabase </li> <li> haveBlogInDatabase </li> <li> haveCommentInDatabase </li> <li> haveCommentMetaInDatabase </li> <li> haveLinkInDatabase </li> <li> haveManyBlogsInDatabase </li> <li> haveManyCommentsInDatabase </li> <li> haveManyLinksInDatabase </li> <li> haveManyPostsInDatabase </li> <li> haveManyTermsInDatabase </li> <li> haveManyUsersInDatabase </li> <li> haveMenuInDatabase </li> <li> haveMenuItemInDatabase </li> <li> haveOptionInDatabase </li> <li> havePageInDatabase </li> <li> havePostInDatabase </li> <li> havePostThumbnailInDatabase </li> <li> havePostmetaInDatabase </li> <li> haveSiteOptionInDatabase </li> <li> haveSiteTransientInDatabase </li> <li> haveTermInDatabase </li> <li> haveTermMetaInDatabase </li> <li> haveTermRelationshipInDatabase </li> <li> haveTransientInDatabase </li> <li> haveUserCapabilitiesInDatabase </li> <li> haveUserInDatabase </li> <li> haveUserLevelsInDatabase </li> <li> haveUserMetaInDatabase </li> <li> importSql </li> <li> importSqlDumpFile </li> <li> seeAttachmentInDatabase </li> <li> seeBlogInDatabase </li> <li> seeCommentInDatabase </li> <li> seeCommentMetaInDatabase </li> <li> seeLinkInDatabase </li> <li> seeOptionInDatabase </li> <li> seePageInDatabase </li> <li> seePostInDatabase </li> <li> seePostMetaInDatabase </li> <li> seePostWithTermInDatabase </li> <li> seeSiteOptionInDatabase </li> <li> seeSiteSiteTransientInDatabase </li> <li> seeTableInDatabase </li> <li> seeTermInDatabase </li> <li> seeTermMetaInDatabase </li> <li> seeTermRelationshipInDatabase </li> <li> seeTermTaxonomyInDatabase </li> <li> seeUserInDatabase </li> <li> seeUserMetaInDatabase </li> <li> useBlog </li> <li> useMainBlog </li> <li> useTheme </li> </ul> countRowsInDatabase <p>Returns the number of table rows matching a criteria.</p> <pre><code>$I-&gt;haveManyPostsInDatabase(3, ['post_status' =&gt; 'draft' ]);\n  $I-&gt;haveManyPostsInDatabase(3, ['post_status' =&gt; 'private' ]);\n  // Make sure there are now the expected number of draft posts.\n  $postsTable = $I-&gt;grabPostsTableName();\n  $draftsCount = $I-&gt;countRowsInDatabase($postsTable, ['post_status' =&gt; 'draft']);\n</code></pre> Parameters <ul> <li><code>string</code> $table - The table to count the rows in.</li> <li><code>array/\\Codeception\\Module\\array/array $criteria - Search criteria, if empty all table rows will be counted. dontHaveAttachmentFilesInDatabase <p>Removes all the files attached with an attachment post, it will not remove the database entries. Requires the <code>WPFilesystem</code> module to be loaded in the suite.</p> <pre><code>$posts = $I-&gt;grabPostsTableName();\n  $attachmentIds = $I-&gt;grabColumnFromDatabase($posts, 'ID', ['post_type' =&gt; 'attachment']);\n  // This will only remove the files, not the database entries.\n  $I-&gt;dontHaveAttachmentFilesInDatabase($attachmentIds);\n</code></pre> Parameters <ul> <li><code>\\Codeception\\Module\\array/int $attachmentIds - An attachment post ID or an array of attachment post IDs. dontHaveAttachmentInDatabase <p>Removes an attachment from the posts table. table. the suite.</p> <pre><code>$postmeta = $I-&gt;grabpostmetatablename();\n  $thumbnailId = $I-&gt;grabFromDatabase($postmeta, 'meta_value', [\n  'post_id' =&gt; $id,\n  'meta_key'=&gt;'thumbnail_id'\n  ]);\n  // Remove only the database entry (including postmeta) but not the files.\n  $I-&gt;dontHaveAttachmentInDatabase($thumbnailId);\n  // Remove the database entry (including postmeta) and the files.\n  $I-&gt;dontHaveAttachmentInDatabase($thumbnailId, true, true);\n</code></pre> Parameters <ul> <li><code>\\Codeception\\Module\\array/array $criteria - An array of search criteria to find the attachment post in the posts <li><code>bool</code> $purgeMeta - If set to <code>true</code> then the meta for the attachment will be purged too.</li> <li><code>bool</code> $removeFiles - Remove all files too, requires the <code>WPFilesystem</code> module to be loaded in</li> dontHaveBlogInDatabase <p>Removes one ore more blogs from the database.</p> <pre><code>// Remove the blog, all its tables and files.\n  $I-&gt;dontHaveBlogInDatabase(['path' =&gt; 'test/one']);\n  // Remove the blog entry, not the tables though.\n  $I-&gt;dontHaveBlogInDatabase(['blog_id' =&gt; $blogId]);\n  // Remove multiple blogs.\n  $I-&gt;dontHaveBlogInDatabase(['domain' =&gt; 'test']);\n</code></pre> Parameters <ul> <li><code>\\Codeception\\Module\\array/array $criteria - An array of search criteria to find the blog rows in the blogs table. <li><code>bool</code> $removeTables - Remove the blog tables.</li> <li><code>bool</code> $removeUploads - Remove the blog uploads; requires the <code>WPFilesystem</code> module.</li> dontHaveCommentInDatabase <p>Removes an entry from the comments table.</p> <pre><code>$I-&gt;dontHaveCommentInDatabase(['comment_post_ID' =&gt; 23, 'comment_url' =&gt; 'http://example.copm']);\n</code></pre> Parameters <ul> <li><code>\\Codeception\\Module\\array/array $criteria - An array of search criteria. <li><code>bool</code> $purgeMeta - If set to <code>true</code> then the meta for the comment will be purged too.</li> dontHaveCommentMetaInDatabase <p>Removes a post comment meta from the database</p> <pre><code>// Remove all meta for the comment with an ID of 23.\n  $I-&gt;dontHaveCommentMetaInDatabase(['comment_id' =&gt; 23]);\n  // Remove the `count` comment meta for the comment with an ID of 23.\n  $I-&gt;dontHaveCommentMetaInDatabase(['comment_id' =&gt; 23, 'meta_key' =&gt; 'count']);\n</code></pre> Parameters <ul> <li><code>\\Codeception\\Module\\array/array $criteria - An array of search criteria. dontHaveInDatabase <p>Deletes a database entry. criteria.</p> <pre><code>$I-&gt;dontHaveInDatabase('custom_table', ['book_ID' =&gt; 23, 'book_genre' =&gt; 'fiction']);\n</code></pre> Parameters <ul> <li><code>string</code> $table - The table name.</li> <li><code>\\Codeception\\Module\\array/array $criteria - An associative array of the column names and values to use as deletion dontHaveLinkInDatabase <p>Removes a link from the database.</p> <pre><code>$I-&gt;dontHaveLinkInDatabase(['link_url' =&gt; 'http://example.com']);\n</code></pre> Parameters <ul> <li><code>\\Codeception\\Module\\array/array $criteria - An array of search criteria. dontHaveOptionInDatabase <p>Removes an entry from the options table.</p> <pre><code>// Remove the `foo` option.\n  $I-&gt;dontHaveOptionInDatabase('foo');\n  // Remove the 'bar' option only if it has the `baz` value.\n  $I-&gt;dontHaveOptionInDatabase('bar', 'baz');\n</code></pre> Parameters <ul> <li><code>string</code> $key - The option name.</li> <li><code>mixed/null</code> $value - If set the option will only be removed if its value matches the passed one.</li></ul> dontHavePostInDatabase <p>Removes an entry from the posts table.</p> <pre><code>$posts = $I-&gt;haveManyPostsInDatabase(3, ['post_title' =&gt; 'Test {{n}}']);\n  $I-&gt;dontHavePostInDatabase(['post_title' =&gt; 'Test 2']);\n</code></pre> Parameters <ul> <li><code>\\Codeception\\Module\\array/array $criteria - An array of search criteria. <li><code>bool</code> $purgeMeta - If set to <code>true</code> then the meta for the post will be purged too.</li> dontHavePostMetaInDatabase <p>Removes an entry from the postmeta table.</p> <pre><code>$postId = $I-&gt;havePostInDatabase(['meta_input' =&gt; ['rating' =&gt; 23]]);\n  $I-&gt;dontHavePostMetaInDatabase(['post_id' =&gt; $postId, 'meta_key' =&gt; 'rating']);\n</code></pre> Parameters <ul> <li><code>\\Codeception\\Module\\array/array $criteria - An array of search criteria. dontHavePostThumbnailInDatabase <p>Remove the thumbnail (featured image) from a post, if any. Please note: the method will NOT remove the attachment post, post meta and file.</p> <pre><code>$attachmentId = $I-&gt;haveAttachmentInDatabase(codecept_data_dir('some-image.png'));\n  $postId = $I-&gt;havePostInDatabase();\n  // Attach the thumbnail to the post.\n  $I-&gt;havePostThumbnailInDatabase($postId, $attachmentId);\n  // Remove the thumbnail from the post.\n  $I-&gt;dontHavePostThumbnailInDatabase($postId);\n</code></pre> Parameters <ul> <li><code>int</code> $postId - The post ID to remove the thumbnail (featured image) from.</li></ul> dontHaveSiteOptionInDatabase <p>Removes a site option from the database.</p> <pre><code>// Remove the `foo_count` option.\n  $I-&gt;dontHaveSiteOptionInDatabase('foo_count');\n  // Remove the `foo_count` option only if its value is `23`.\n  $I-&gt;dontHaveSiteOptionInDatabase('foo_count', 23);\n</code></pre> Parameters <ul> <li><code>string</code> $key - The option name.</li> <li><code>mixed/null</code> $value - If set the option will only be removed it its value matches the specified one.</li></ul> dontHaveSiteTransientInDatabase <p>Removes a site transient from the database.</p> <pre><code>$I-&gt;dontHaveSiteTransientInDatabase(['my_plugin_site_buffer']);\n</code></pre> Parameters <ul> <li><code>string</code> $key - The name of the transient to delete.</li></ul> dontHaveTableInDatabase <p>Removes a table from the database. The case where a table does not exist is handled without raising an error.</p> <pre><code>$ordersTable = $I-&gt;grabPrefixedTableNameFor('orders');\n  $I-&gt;dontHaveTableInDatabase($ordersTable);\n</code></pre> Parameters <ul> <li><code>string</code> $fullTableName - The full table name, including the table prefix.</li></ul> dontHaveTermInDatabase <p>Removes a term from the database.</p> <pre><code>$I-&gt;dontHaveTermInDatabase(['name' =&gt; 'romance']);\n  $I-&gt;dontHaveTermInDatabase(['slug' =&gt; 'genre--romance']);\n</code></pre> Parameters <ul> <li><code>\\Codeception\\Module\\array/array $criteria - An array of search criteria. <li><code>bool</code> $purgeMeta - Whether the terms meta should be purged along side with the meta or not.</li> dontHaveTermMetaInDatabase <p>Removes a term meta from the database.</p> <pre><code>// Remove the \"karma\" key.\n  $I-&gt;dontHaveTermMetaInDatabase(['term_id' =&gt; $termId, 'meta_key' =&gt; 'karma']);\n  // Remove all meta for the term.\n  $I-&gt;dontHaveTermMetaInDatabase(['term_id' =&gt; $termId]);\n</code></pre> Parameters <ul> <li><code>\\Codeception\\Module\\array/array $criteria - An array of search criteria. dontHaveTermRelationshipInDatabase <p>Removes an entry from the term_relationships table.</p> <pre><code>// Remove the relation between a post and a category.\n  $I-&gt;dontHaveTermRelationshipInDatabase(['object_id' =&gt; $postId, 'term_taxonomy_id' =&gt; $ttaxId]);\n  // Remove all terms for a post.\n  $I-&gt;dontHaveTermMetaInDatabase(['object_id' =&gt; $postId]);\n</code></pre> Parameters <ul> <li><code>\\Codeception\\Module\\array/array $criteria - An array of search criteria. dontHaveTermTaxonomyInDatabase <p>Removes an entry from the <code>term_taxonomy</code> table.</p> <pre><code>// Remove a specific term from the genre taxonomy.\n  $I-&gt;dontHaveTermTaxonomyInDatabase(['term_id' =&gt; $postId, 'taxonomy' =&gt; 'genre']);\n  // Remove all terms for a taxonomy.\n  $I-&gt;dontHaveTermTaxonomyInDatabase(['taxonomy' =&gt; 'genre']);\n</code></pre> Parameters <ul> <li><code>\\Codeception\\Module\\array/array $criteria - An array of search criteria. dontHaveTransientInDatabase <p>Removes a transient from the database.</p> <pre><code>// Removes the `tweets` transient from the database, if set.\n  $I-&gt;dontHaveTransientInDatabase('tweets');\n</code></pre> Parameters <ul> <li><code>string</code> $transient - The name of the transient to delete.</li></ul> dontHaveUserInDatabase <p>Removes a user from the database.</p> <pre><code>$bob = $I-&gt;haveUserInDatabase('bob');\n  $alice = $I-&gt;haveUserInDatabase('alice');\n  // Remove Bob's user and meta.\n  $I-&gt;dontHaveUserInDatabase('bob');\n  // Remove Alice's user but not meta.\n  $I-&gt;dontHaveUserInDatabase($alice);\n</code></pre> Parameters <ul> <li><code>int/string</code> $userIdOrLogin - The user ID or login name.</li> <li><code>bool</code> $purgeMeta - Whether the user meta should be purged alongside the user or not.</li></ul> dontHaveUserInDatabaseWithEmail <p>Removes a user(s) from the database using the user email address.</p> <pre><code>$luca = $I-&gt;haveUserInDatabase('luca', 'editor', ['user_email' =&gt; 'luca@example.org']);\n</code></pre> Parameters <ul> <li><code>string</code> $userEmail - The email of the user to remove.</li> <li><code>bool</code> $purgeMeta - Whether the user meta should be purged alongside the user or not.</li></ul> dontHaveUserMetaInDatabase <p>Removes an entry from the usermeta table.</p> <pre><code>// Remove the `karma` user meta for a user.\n  $I-&gt;dontHaveUserMetaInDatabase(['user_id' =&gt; 23, 'meta_key' =&gt; 'karma']);\n  // Remove all the user meta for a user.\n  $I-&gt;dontHaveUserMetaInDatabase(['user_id' =&gt; 23]);\n</code></pre> Parameters <ul> <li><code>\\Codeception\\Module\\array/array $criteria - An array of search criteria. dontSeeAttachmentInDatabase <p>Checks that an attachment is not in the database.</p> <pre><code>$url = 'https://example.org/images/foo.png';\n  $I-&gt;dontSeeAttachmentInDatabase(['guid' =&gt; $url]);\n</code></pre> Parameters <ul> <li><code>\\Codeception\\Module\\array/array $criteria - An array of search criteria. dontSeeBlogInDatabase <p>Checks that a row is not present in the <code>blogs</code> table.</p> <pre><code>$I-&gt;haveManyBlogsInDatabase(2, ['path' =&gt; 'test-{{n}}'], false)\n  $I-&gt;dontSeeBlogInDatabase(['path' =&gt; '/test-3/'])\n</code></pre> Parameters <ul> <li><code>\\Codeception\\Module\\array/array $criteria - An array of search criteria. dontSeeCommentInDatabase <p>Checks that a comment is not in the database. Will look up the \"comments\" table.</p> <pre><code>// Checks for one comment.\n  $I-&gt;dontSeeCommentInDatabase(['comment_ID' =&gt; 23]);\n  // Checks for comments from a user.\n  $I-&gt;dontSeeCommentInDatabase(['user_id' =&gt; 89]);\n</code></pre> Parameters <ul> <li><code>\\Codeception\\Module\\array/array $criteria - The search criteria. dontSeeCommentMetaInDatabase <p>Checks that a comment meta value is not in the database. Will look up the \"commentmeta\" table.</p> <pre><code>// Delete a comment `karma` meta.\n  $I-&gt;dontSeeCommentMetaInDatabase(['comment_id' =&gt; 23, 'meta_key' =&gt; 'karma']);\n  // Delete all meta for a comment.\n  $I-&gt;dontSeeCommentMetaInDatabase(['comment_id' =&gt; 23]);\n</code></pre> Parameters <ul> <li><code>\\Codeception\\Module\\array/array $criteria - An array of search criteria. dontSeeLinkInDatabase <p>Checks that a link is not in the <code>links</code> database table.</p> <pre><code>$I-&gt;dontSeeLinkInDatabase(['link_url' =&gt; 'http://example.com']);\n  $I-&gt;dontSeeLinkInDatabase(['link_url' =&gt; 'http://example.com', 'link_name' =&gt; 'example']);\n</code></pre> Parameters <ul> <li><code>\\Codeception\\Module\\array/array $criteria - An array of search criteria. dontSeeOptionInDatabase <p>Checks that an option is not in the database for the current blog. If the value is an object or an array then the serialized option will be checked.</p> <pre><code>$I-&gt;dontHaveOptionInDatabase('posts_per_page');\n  $I-&gt;dontSeeOptionInDatabase('posts_per_page');\n  $I-&gt;dontSeeOptionInDatabase('posts_per_page', 23);\n  $I-&gt;dontSeeOptionInDatabase(['option_name' =&gt; 'posts_per_page']);\n  $I-&gt;dontSeeOptionInDatabase(['option_name' =&gt; 'posts_per_page', 'option_value' =&gt; 23]);\n</code></pre> Parameters <ul> <li><code>\\Codeception\\Module\\array/string $criteriaOrName - An array of search criteria or the option name. <li><code>mixed/null</code> $value - The optional value to try and match, only used if the option name is provided.</li> dontSeePageInDatabase <p>Checks that a page is not in the database.</p> <pre><code>// Assert a page with an ID does not exist.\n  $I-&gt;dontSeePageInDatabase(['ID' =&gt; 23]);\n  // Assert a page with a slug and ID.\n  $I-&gt;dontSeePageInDatabase(['post_name' =&gt; 'test', 'ID' =&gt; 23]);\n</code></pre> Parameters <ul> <li><code>\\Codeception\\Module\\array/array $criteria - An array of search criteria. dontSeePostInDatabase <p>Checks that a post is not in the database.</p> <pre><code>// Asserts a post with title 'Test' is not in the database.\n  $I-&gt;dontSeePostInDatabase(['post_title' =&gt; 'Test']);\n  // Asserts a post with title 'Test' and content 'Test content' is not in the database.\n  $I-&gt;dontSeePostInDatabase(['post_title' =&gt; 'Test', 'post_content' =&gt; 'Test content']);\n</code></pre> Parameters <ul> <li><code>\\Codeception\\Module\\array/array $criteria - An array of search criteria. dontSeePostMetaInDatabase <p>Checks that a post meta value does not exist. If the meta value is an object or an array then the check will be made on its serialized version.</p> <pre><code>$postId = $I-&gt;havePostInDatabase(['meta_input' =&gt; ['foo' =&gt; 'bar']]);\n  $I-&gt;dontSeePostMetaInDatabase(['post_id' =&gt; $postId, 'meta_key' =&gt; 'woot']);\n</code></pre> Parameters <ul> <li><code>\\Codeception\\Module\\array/array $criteria - An array of search criteria. dontSeePostWithTermInDatabase <p>Checks that a post to term relation does not exist in the database. The method will check the \"term_relationships\" table.</p> <pre><code>$fiction = $I-&gt;haveTermInDatabase('fiction', 'genre');\n  $nonFiction = $I-&gt;haveTermInDatabase('non-fiction', 'genre');\n  $postId = $I-&gt;havePostInDatabase(['tax_input' =&gt; ['genre' =&gt; ['fiction']]]);\n  $I-&gt;dontSeePostWithTermInDatabase($postId, $nonFiction['term_taxonomy_id], );\n  passed this parameter will be interpreted as a `term_id`, else as a\n  the\n  term order.\n  to build a `taxonomy_term_id` from the `term_id`.\n</code></pre> Parameters <ul> <li><code>int</code> $post_id - The post ID.</li> <li><code>int</code> $term_taxonomy_id - The term <code>term_id</code> or <code>term_taxonomy_id</code>; if the <code>$taxonomy</code> argument is</li> <li><code>int/null</code> $term_order - The order the term applies to the post, defaults to <code>null</code> to not use</li> <li><code>string/null</code> $taxonomy - The taxonomy the <code>term_id</code> is for; if passed this parameter will be used</li></ul> dontSeeSiteOptionInDatabase <p>Checks that a site option is not in the database.</p> <pre><code>// Check that the option is not set in the database.\n  $I-&gt;dontSeeSiteOptionInDatabase('foo_count');\n  // Check that the option is not set with a specific value.\n  $I-&gt;dontSeeSiteOptionInDatabase('foo_count', 23);\n  $I-&gt;dontSeeSiteOptionInDatabase(['option_name =&gt; 'foo_count', 'option_value' =&gt; 23]);\n</code></pre> Parameters <ul> <li><code>\\Codeception\\Module\\array/string $criteriaOrName - An array of search criteria or the option name. <li><code>mixed/null</code> $value - The optional value to try and match, only used if the option name is provided.</li> dontSeeTableInDatabase <p>Checks that a table is not in the database.</p> <pre><code>$options = $I-&gt;grabPrefixedTableNameFor('options');\n  $I-&gt;dontHaveTableInDatabase($options)\n  $I-&gt;dontSeeTableInDatabase($options);\n</code></pre> Parameters <ul> <li><code>string</code> $table - The full table name, including the table prefix.</li></ul> dontSeeTermInDatabase <p>Makes sure a term is not in the database. Looks up both the <code>terms</code> table and the <code>term_taxonomy</code> tables. and the <code>term_taxonomy</code> tables.</p> <pre><code>// Asserts a 'fiction' term is not in the database.\n  $I-&gt;dontSeeTermInDatabase(['name' =&gt; 'fiction']);\n  // Asserts a 'fiction' term with slug 'genre--fiction' is not in the database.\n  $I-&gt;dontSeeTermInDatabase(['name' =&gt; 'fiction', 'slug' =&gt; 'genre--fiction']);\n</code></pre> Parameters <ul> <li><code>\\Codeception\\Module\\array/array $criteria - An array of criteria to search for the term, can be columns from the <code>terms</code> dontSeeTermMetaInDatabase <p>Checks that a term meta is not in the database.</p> <pre><code>list($termId, $termTaxonomyId) = $I-&gt;haveTermInDatabase('fiction', 'genre');\n  $I-&gt;haveTermMetaInDatabase($termId, 'rating', 4);\n  $I-&gt;dontSeeTermMetaInDatabase(['term_id' =&gt; $termId,'meta_key' =&gt; 'average_review']);\n</code></pre> Parameters <ul> <li><code>\\Codeception\\Module\\array/array $criteria - An array of search criteria. dontSeeTermTaxonomyInDatabase <p>Checks that a term taxonomy is not in the database.</p> <pre><code>list($termId, $termTaxonomyId) = $I-&gt;haveTermInDatabase('fiction', 'genre');\n  $I-&gt;dontSeeTermTaxonomyInDatabase(['term_id' =&gt; $termId, 'taxonomy' =&gt; 'country']);\n</code></pre> Parameters <ul> <li><code>\\Codeception\\Module\\array/array $criteria - An array of search criteria. dontSeeUserInDatabase <p>Checks that a user is not in the database.</p> <pre><code>// Asserts a user does not exist in the database.\n  $I-&gt;dontSeeUserInDatabase(['user_login' =&gt; 'luca']);\n  // Asserts a user with email and login is not in the database.\n  $I-&gt;dontSeeUserInDatabase(['user_login' =&gt; 'luca', 'user_email' =&gt; 'luca@theaveragedev.com']);\n</code></pre> Parameters <ul> <li><code>\\Codeception\\Module\\array/array $criteria - An array of search criteria. dontSeeUserMetaInDatabase <p>Check that a user meta value is not in the database.</p> <pre><code>// Asserts a user does not have a 'karma' meta assigned.\n  $I-&gt;dontSeeUserMetaInDatabase(['user_id' =&gt; 23, 'meta_key' =&gt; 'karma']);\n  // Asserts no user has any 'karma' meta assigned.\n  $I-&gt;dontSeeUserMetaInDatabase(['meta_key' =&gt; 'karma']);\n</code></pre> Parameters <ul> <li><code>\\Codeception\\Module\\array/array $criteria - An array of search criteria. getSiteDomain <p>Returns the site domain inferred from the <code>url</code> set in the config.</p> <pre><code>$domain = $I-&gt;getSiteDomain();\n  // We should be redirected to the HTTPS version when visiting the HTTP version.\n  $I-&gt;amOnPage('http://' . $domain);\n  $I-&gt;seeCurrentUrlEquals('https://' . $domain);\n</code></pre> getUsersTableName <p>Returns the prefixed users table name.</p> <pre><code>// Given a `wp_` table prefix returns `wp_users`.\n  $usersTable = $I-&gt;getUsersTableName();\n  // Given a `wp_` table prefix returns `wp_users`.\n  $I-&gt;useBlog(23);\n  $usersTable = $I-&gt;getUsersTableName();\n</code></pre> grabAllFromDatabase <p>Returns all entries matching a criteria from the database.</p> <pre><code>$books = $I-&gt;grabPrefixedTableNameFor('books');\n  $I-&gt;grabAllFromDatabase($books, 'title', ['genre' =&gt; 'fiction']);\n</code></pre> Parameters <ul> <li><code>string</code> $table - The table to grab the values from.</li> <li><code>string</code> $column - The column to fetch.</li> <li><code>\\Codeception\\Module\\array $criteria - The search criteria. grabAttachmentAttachedFile <p>Returns the path, as stored in the database, of an attachment <code>_wp_attached_file</code> meta. The attached file is, usually, an attachment origal file.</p> <pre><code>$file = $I-&gt;grabAttachmentAttachedFile($attachmentId);\n  $fileInfo = new SplFileInfo($file);\n  $I-&gt;assertEquals('jpg', $fileInfo-&gt;getExtension());\n</code></pre> Parameters <ul> <li><code>int</code> $attachmentPostId - The attachment post ID.</li></ul> grabAttachmentMetadata <p>Returns the metadata array for an attachment post. This is the value of the <code>_wp_attachment_metadata</code> meta.</p> <pre><code>$metadata = $I-&gt;grabAttachmentMetadata($attachmentId);\n  $I-&gt;assertEquals(['thumbnail', 'medium', 'medium_large'], array_keys($metadata['sizes']);\n</code></pre> Parameters <ul> <li><code>int</code> $attachmentPostId - The attachment post ID.</li></ul> grabBlogDomain <p>Returns a blog domain given its ID.</p> <pre><code>$blogIds = $I-&gt;haveManyBlogsInDatabase(3);\n  $domains = array_map(function($blogId){\n  return $I-&gt;grabBlogDomain($blogId);\n  }, $blogIds);\n</code></pre> Parameters <ul> <li><code>int</code> $blogId - The blog ID.</li></ul> grabBlogPath <p>Grabs a blog domain from the blogs table.</p> <pre><code>$blogId = $I-&gt;haveBlogInDatabase('test');\n  $path = $I-&gt;grabBlogDomain($blogId);\n  $I-&gt;amOnSubdomain($path);\n  $I-&gt;amOnPage('/');\n</code></pre> Parameters <ul> <li><code>int</code> $blogId - The blog ID.</li></ul> grabBlogTableName <p>Returns the full name of a table for a blog from a multisite installation database.</p> <pre><code>$blogOptionTable = $I-&gt;grabBlogTableName($blogId, 'option');\n</code></pre> Parameters <ul> <li><code>int</code> $blogId - The blog ID.</li> <li><code>string</code> $table - The table name, without table prefix.</li></ul> grabBlogTableNames <p>Returns a list of tables for a blog ID.</p> <pre><code>$blogId = $I-&gt;haveBlogInDatabase('test');\n  $tables = $I-&gt;grabBlogTableNames($blogId);\n  $options = array_filter($tables, function($tableName){\n  return str_pos($tableName, 'options') !== false;\n  });\n</code></pre> Parameters <ul> <li><code>int</code> $blogId - The ID of the blog to fetch the tables for.</li></ul> grabBlogTablePrefix <p>Returns the table prefix for a blog.</p> <pre><code>$blogId = $I-&gt;haveBlogInDatabase('test');\n  $blogTablePrefix = $I-&gt;getBlogTablePrefix($blogId);\n  $blogOrders = $I-&gt;blogTablePrefix . 'orders';\n</code></pre> Parameters <ul> <li><code>int</code> $blogId - The blog ID.</li></ul> grabBlogVersionsTableName <p>Gets the prefixed <code>blog_versions</code> table name.</p> <pre><code>// Assuming a `wp_` table prefix it will return `wp_blog_versions`.\n  $blogVersionsTable = $I-&gt;grabBlogVersionsTableName();\n  $I-&gt;useBlog(23);\n  // Assuming a `wp_` table prefix it will return `wp_blog_versions`.\n  $blogVersionsTable = $I-&gt;grabBlogVersionsTableName();\n</code></pre> grabBlogsTableName <p>Gets the prefixed <code>blogs</code> table name.</p> <pre><code>// Assuming a `wp_` table prefix it will return `wp_blogs`.\n  $blogVersionsTable = $I-&gt;grabBlogsTableName();\n  $I-&gt;useBlog(23);\n  // Assuming a `wp_` table prefix it will return `wp_blogs`.\n  $blogVersionsTable = $I-&gt;grabBlogsTableName();\n</code></pre> grabCommentmetaTableName <p>Returns the prefixed comment meta table name.</p> <pre><code>// Get all the values of 'karma' for all comments.\n  $commentMeta = $I-&gt;grabCommentmetaTableName();\n  $I-&gt;grabAllFromDatabase($commentMeta, 'meta_value', ['meta_key' =&gt; 'karma']);\n</code></pre> grabCommentsTableName <p>Gets the comments table name.</p> <pre><code>// Will be `wp_comments`.\n  $comments = $I-&gt;grabCommentsTableName();\n  // Will be `wp_23_comments`.\n  $I-&gt;useBlog(23);\n  $comments = $I-&gt;grabCommentsTableName();\n</code></pre> grabLatestEntryByFromDatabase <p>Returns the id value of the last table entry.</p> <pre><code>$I-&gt;haveManyPostsInDatabase();\n  $postsTable = $I-&gt;grabPostsTableName();\n  $last = $I-&gt;grabLatestEntryByFromDatabase($postsTable, 'ID');\n  items.\n</code></pre> Parameters <ul> <li><code>string</code> $tableName - The table to fetch the last insertion for.</li> <li><code>string</code> $idColumn - The column that is used, in the table, to uniquely identify</li></ul> grabLinksTableName <p>Returns the prefixed links table name.</p> <pre><code>// Given a `wp_` table prefix returns `wp_links`.\n  $linksTable = $I-&gt;grabLinksTableName();\n  // Given a `wp_` table prefix returns `wp_23_links`.\n  $I-&gt;useBlog(23);\n  $linksTable = $I-&gt;grabLinksTableName();\n</code></pre> grabOptionFromDatabase <p>Gets an option value from the database.</p> <pre><code>$count = $I-&gt;grabOptionFromDatabase('foo_count');\n</code></pre> Parameters <ul> <li><code>string</code> $option_name - The name of the option to grab from the database.</li></ul> grabPostMetaFromDatabase <p>Gets the value of one or more post meta values from the database.</p> <pre><code>$thumbnail_id = $I-&gt;grabPostMetaFromDatabase($postId, '_thumbnail_id', true);\n</code></pre> Parameters <ul> <li><code>int</code> $postId - The post ID.</li> <li><code>string</code> $metaKey - The key of the meta to retrieve.</li> <li><code>bool</code> $single - Whether to return a single meta value or an array of all available meta values.</li></ul> grabPostmetaTableName <p>Returns the prefixed post meta table name.</p> <pre><code>// Returns 'wp_postmeta'.\n  $I-&gt;grabPostmetaTableName();\n  // Returns 'wp_23_postmeta'.\n  $I-&gt;useBlog(23);\n  $I-&gt;grabPostmetaTableName();\n</code></pre> grabPostsTableName <p>Gets the posts prefixed table name.</p> <pre><code>// Given a `wp_` table prefix returns `wp_posts`.\n  $postsTable = $I-&gt;grabPostsTableName();\n  // Given a `wp_` table prefix returns `wp_23_posts`.\n  $I-&gt;useBlog(23);\n  $postsTable = $I-&gt;grabPostsTableName();\n</code></pre> grabPrefixedTableNameFor <p>Returns a prefixed table name for the current blog. If the table is not one to be prefixed (e.g. <code>users</code>) then the proper table name will be returned.</p> <pre><code>// Will return wp_users.\n  $usersTable = $I-&gt;grabPrefixedTableNameFor('users');\n  // Will return wp_options.\n  $optionsTable = $I-&gt;grabPrefixedTableNameFor('options');\n  // Use a different blog and get its options table.\n  $I-&gt;useBlog(2);\n  $blogOptionsTable = $I-&gt;grabPrefixedTableNameFor('options');\n</code></pre> Parameters <ul> <li><code>string</code> $tableName - The table name, e.g. <code>options</code>.</li></ul> grabRegistrationLogTableName <p>Gets the prefixed <code>registration_log</code> table name.</p> <pre><code>// Assuming a `wp_` table prefix it will return `wp_registration_log`.\n  $blogVersionsTable = $I-&gt;grabRegistrationLogTableName();\n  $I-&gt;useBlog(23);\n  // Assuming a `wp_` table prefix it will return `wp_registration_log`.\n  $blogVersionsTable = $I-&gt;grabRegistrationLogTableName();\n</code></pre> grabSignupsTableName <p>Gets the prefixed <code>signups</code> table name.</p> <pre><code>// Assuming a `wp_` table prefix it will return `wp_signups`.\n  $blogVersionsTable = $I-&gt;grabSignupsTableName();\n  $I-&gt;useBlog(23);\n  // Assuming a `wp_` table prefix it will return `wp_signups`.\n  $blogVersionsTable = $I-&gt;grabSignupsTableName();\n</code></pre> grabSiteMetaTableName <p>Gets the prefixed <code>sitemeta</code> table name.</p> <pre><code>// Assuming a `wp_` table prefix it will return `wp_sitemeta`.\n  $blogVersionsTable = $I-&gt;grabSiteMetaTableName();\n  $I-&gt;useBlog(23);\n  // Assuming a `wp_` table prefix it will return `wp_sitemeta`.\n  $blogVersionsTable = $I-&gt;grabSiteMetaTableName();\n</code></pre> grabSiteOptionFromDatabase <p>Gets a site option from the database.</p> <pre><code>$fooCountOptionId = $I-&gt;haveSiteOptionInDatabase('foo_count','23');\n</code></pre> Parameters <ul> <li><code>string</code> $key - The name of the option to read from the database.</li></ul> grabSiteTableName <p>Gets the prefixed <code>site</code> table name.</p> <pre><code>// Assuming a `wp_` table prefix it will return `wp_site`.\n  $blogVersionsTable = $I-&gt;grabSiteTableName();\n  $I-&gt;useBlog(23);\n  // Assuming a `wp_` table prefix it will return `wp_site`.\n  $blogVersionsTable = $I-&gt;grabSiteTableName();\n</code></pre> grabSiteTransientFromDatabase <p>Gets a site transient from the database.</p> <pre><code>$I-&gt;grabSiteTransientFromDatabase('total_comments');\n  $I-&gt;grabSiteTransientFromDatabase('api_data');\n</code></pre> Parameters <ul> <li><code>string</code> $key - The site transient to fetch the value for, w/o the <code>_site_transient_</code> prefix.</li></ul> grabSiteUrl <p>Returns the current site URL as specified in the module configuration.</p> <pre><code>$shopPath = $I-&gt;grabSiteUrl('/shop');\n</code></pre> Parameters <ul> <li><code>string</code> $path - A path that should be appended to the site URL.</li></ul> grabTablePrefix <p>Returns the table prefix, namespaced for secondary blogs if selected.</p> <pre><code>// Assuming a table prefix of `wp_` it will return `wp_`;\n  $tablePrefix = $I-&gt;grabTablePrefix();\n  $I-&gt;useBlog(23);\n  // Assuming a table prefix of `wp_` it will return `wp_23_`;\n  $tablePrefix = $I-&gt;grabTablePrefix();\n</code></pre> grabTermIdFromDatabase <p>Gets a term ID from the database. Looks up the prefixed <code>terms</code> table, e.g. <code>wp_terms</code>.</p> <pre><code>// Return the 'fiction' term 'term_id'.\n  $termId = $I-&gt;grabTermIdFromDatabase(['name' =&gt; 'fiction']);\n  // Get a term ID by more stringent criteria.\n  $termId = $I-&gt;grabTermIdFromDatabase(['name' =&gt; 'fiction', 'slug' =&gt; 'genre--fiction']);\n  // Return the 'term_id' of the first term for a group.\n  $termId = $I-&gt;grabTermIdFromDatabase(['term_group' =&gt; 23]);\n</code></pre> Parameters <ul> <li><code>\\Codeception\\Module\\array/array $criteria - An array of search criteria. grabTermMetaTableName <p>Gets the terms meta table prefixed name.</p> <pre><code>// Returns 'wp_termmeta'.\n  $I-&gt;grabTermMetaTableName();\n  // Returns 'wp_23_termmeta'.\n  $I-&gt;useBlog(23);\n  $I-&gt;grabTermMetaTableName();\n</code></pre> grabTermRelationshipsTableName <p>Gets the prefixed term relationships table name, e.g. <code>wp_term_relationships</code>.</p> <pre><code>$I-&gt;grabTermRelationshipsTableName();\n</code></pre> grabTermTaxonomyIdFromDatabase <p>Gets a <code>term_taxonomy_id</code> from the database. Looks up the prefixed <code>terms_relationships</code> table, e.g. <code>wp_term_relationships</code>.</p> <pre><code>// Get the `term_taxonomy_id` for a term and a taxonomy.\n  $I-&gt;grabTermTaxonomyIdFromDatabase(['term_id' =&gt; $fictionId, 'taxonomy' =&gt; 'genre']);\n  // Get the `term_taxonomy_id` for the first term with a count of 23.\n  $I-&gt;grabTermTaxonomyIdFromDatabase(['count' =&gt; 23]);\n</code></pre> Parameters <ul> <li><code>\\Codeception\\Module\\array/array $criteria - An array of search criteria. grabTermTaxonomyTableName <p>Gets the prefixed term and taxonomy table name, e.g. <code>wp_term_taxonomy</code>.</p> <pre><code>// Returns 'wp_term_taxonomy'.\n  $I-&gt;grabTermTaxonomyTableName();\n  // Returns 'wp_23_term_taxonomy'.\n  $I-&gt;useBlog(23);\n  $I-&gt;grabTermTaxonomyTableName();\n</code></pre> grabTermsTableName <p>Gets the prefixed terms table name, e.g. <code>wp_terms</code>.</p> <pre><code>// Returns 'wp_terms'.\n  $I-&gt;grabTermsTableName();\n  // Returns 'wp_23_terms'.\n  $I-&gt;useBlog(23);\n  $I-&gt;grabTermsTableName();\n</code></pre> grabUserIdFromDatabase <p>Gets the a user ID from the database using the user login.</p> <pre><code>$userId = $I-&gt;grabUserIdFromDatabase('luca');\n</code></pre> Parameters <ul> <li><code>string</code> $userLogin - The user login name.</li></ul> grabUserMetaFromDatabase <p>Gets a user meta from the database.</p> <pre><code>// Returns a user 'karma' value.\n  $I-&gt;grabUserMetaFromDatabase($userId, 'karma');\n  // Returns an array, the unserialized version of the value stored in the database.\n  $I-&gt;grabUserMetaFromDatabase($userId, 'api_data');\n</code></pre> Parameters <ul> <li><code>int</code> $userId - The ID of th user to get the meta for.</li> <li><code>string</code> $meta_key - The meta key to fetch the value for.</li></ul> grabUsermetaTableName <p>Returns the prefixed users meta table name.</p> <pre><code>// Given a `wp_` table prefix returns `wp_usermeta`.\n  $usermetaTable = $I-&gt;grabUsermetaTableName();\n  // Given a `wp_` table prefix returns `wp_usermeta`.\n  $I-&gt;useBlog(23);\n  $usermetaTable = $I-&gt;grabUsermetaTableName();\n</code></pre> grabUsersTableName <p>Returns the prefixed users table name.</p> <pre><code>// Given a `wp_` table prefix returns `wp_users`.\n  $usersTable = $I-&gt;grabUsersTableName();\n  // Given a `wp_` table prefix returns `wp_users`.\n  $I-&gt;useBlog(23);\n  $usersTable = $I-&gt;grabUsersTableName();\n</code></pre> haveAttachmentInDatabase <p>Creates the database entries representing an attachment and moves the attachment file to the right location. timestamp that should be used to build the \"year/time\" uploads sub-folder structure. override the image sizes created by default.</p> <pre><code>$file = codecept_data_dir('images/test.png');\n  $attachmentId = $I-&gt;haveAttachmentInDatabase($file);\n  $image = codecept_data_dir('images/test-2.png');\n  $lastWeekAttachment = $I-&gt;haveAttachmentInDatabase($image, '-1 week');\n  Requires the WPFilesystem module.\n</code></pre> Parameters <ul> <li><code>string</code> $file - The absolute path to the attachment file.</li> <li><code>string/string/int</code> $date - Either a string supported by the <code>strtotime</code> function or a UNIX</li> <li><code>array/\\Codeception\\Module\\array/array $overrides - An associative array of values overriding the default ones. <li><code>\\Codeception\\Module\\array&gt; $imageSizes - An associative array in the format [  =&gt; [,]] to haveBlogInDatabase <p>Inserts a blog in the <code>blogs</code> table.</p> <pre><code>// Create the `test` subdomain blog.\n  $blogId = $I-&gt;haveBlogInDatabase('test', ['administrator' =&gt; $userId]);\n  // Create the `/test` subfolder blog.\n  $blogId = $I-&gt;haveBlogInDatabase('test', ['administrator' =&gt; $userId], false);\n  or subfolder (`true`)\n</code></pre> Parameters <ul> <li><code>string</code> $domainOrPath - The subdomain or the path to the be used for the blog.</li> <li><code>array/\\Codeception\\Module\\array/array $overrides - An array of values to override the defaults. <li><code>bool</code> $subdomain - Whether the new blog should be created as a subdomain (<code>true</code>)</li> haveCommentInDatabase <p>Inserts a comment in the database.</p> <pre><code>$I-&gt;haveCommentInDatabase($postId, ['comment_content' =&gt; 'Test Comment', 'comment_karma' =&gt; 23]);\n</code></pre> Parameters <ul> <li><code>int</code> $comment_post_ID - The id of the post the comment refers to.</li> <li><code>array/\\Codeception\\Module\\array/array $data - The comment data overriding default and random generated values. haveCommentMetaInDatabase <p>Inserts a comment meta field in the database. Array and object meta values will be serialized.</p> <pre><code>$I-&gt;haveCommentMetaInDatabase($commentId, 'api_ID', 23);\n  // The value will be serialized.\n  $apiData = ['ID' =&gt; 23, 'user' =&gt; 89, 'origin' =&gt; 'twitter'];\n  $I-&gt;haveCommentMetaInDatabase($commentId, 'api_data', $apiData);\n</code></pre> Parameters <ul> <li><code>int</code> $comment_id - The ID of the comment to insert the meta for.</li> <li><code>string</code> $meta_key - The key of the comment meta to insert.</li> <li><code>mixed</code> $meta_value - The value of the meta to insert, if serializable it will be serialized.</li></ul> haveLinkInDatabase <p>Inserts a link in the database.</p> <pre><code>$linkId = $I-&gt;haveLinkInDatabase(['link_url' =&gt; 'http://example.org']);\n</code></pre> Parameters <ul> <li><code>array/\\Codeception\\Module\\array/array $overrides - The data to insert. haveManyBlogsInDatabase <p>Inserts many blogs in the database. by the count.</p> <pre><code>$blogIds = $I-&gt;haveManyBlogsInDatabase(3, ['domain' =&gt;'test-{{n}}']);\n  foreach($blogIds as $blogId){\n  $I-&gt;useBlog($blogId);\n  $I-&gt;haveManuPostsInDatabase(3);\n  }\n</code></pre> Parameters <ul> <li><code>int</code> $count - The number of blogs to create.</li> <li><code>array/\\Codeception\\Module\\array/array $overrides - An array of values to override the default ones; <code>{{n}}</code> will be replaced <li><code>bool</code> $subdomain - Whether the new blogs should be created as a subdomain or subfolder.</li> haveManyCommentsInDatabase <p>Inserts many comments in the database.</p> <pre><code>// Insert 3 random comments for a post.\n  $I-&gt;haveManyCommentsInDatabase(3, $postId);\n  // Insert 3 random comments for a post.\n  $I-&gt;haveManyCommentsInDatabase(3, $postId, ['comment_content' =&gt; 'Comment {{n}}']);\n</code></pre> Parameters <ul> <li><code>int</code> $count - The number of comments to insert.</li> <li><code>int</code> $comment_post_ID - The comment parent post ID.</li> <li><code>array/\\Codeception\\Module\\array/array $overrides - An associative array to override the defaults. haveManyLinksInDatabase <p>Inserts many links in the database <code>links</code> table.</p> <pre><code>// Insert 3 randomly generated links in the database.\n  $linkIds = $I-&gt;haveManyLinksInDatabase(3);\n  // Inserts links in the database replacing the `n` placeholder.\n  $linkIds = $I-&gt;haveManyLinksInDatabase(3, ['link_url' =&gt; 'http://example.org/test-{{n}}']);\n</code></pre> Parameters <ul> <li><code>int</code> $count - The number of links to insert.</li> <li><code>array/\\Codeception\\Module\\array/array $overrides - Overrides for the default arguments. haveManyPostsInDatabase <p>Inserts many posts in the database returning their IDs. An array of values to override the defaults. The <code>{{n}}</code> placeholder can be used to have the post count inserted in its place; e.g. <code>Post Title - {{n}}</code> will be set to <code>Post Title - 0</code> for the first post, <code>Post Title - 1</code> for the second one and so on. The same applies to meta values as well.</p> <pre><code>// Insert 3 random posts.\n  $I-&gt;haveManyPostsInDatabase(3);\n  // Insert 3 posts with generated titles.\n  $I-&gt;haveManyPostsInDatabase(3, ['post_title' =&gt; 'Test post {{n}}']);\n</code></pre> Parameters <ul> <li><code>int</code> $count - The number of posts to insert.</li> <li><code>array/\\Codeception\\Module\\array/array $overrides haveManyTermsInDatabase <p>Inserts many terms in the database.</p> <pre><code>$terms = $I-&gt;haveManyTermsInDatabase(3, 'genre-{{n}}', 'genre');\n  $termIds = array_column($terms, 0);\n  $termTaxonomyIds = array_column($terms, 1);\n</code></pre> Parameters <ul> <li><code>int</code> $count - The number of terms to insert.</li> <li><code>string</code> $name - The term name template, can include the <code>{{n}}</code> placeholder.</li> <li><code>string</code> $taxonomy - The taxonomy to insert the terms for.</li> <li><code>array/\\Codeception\\Module\\array/array $overrides - An associative array of default overrides. haveManyUsersInDatabase <p>Inserts many users in the database.</p> <pre><code>$subscribers = $I-&gt;haveManyUsersInDatabase(5, 'user-{{n}}');\n  $editors = $I-&gt;haveManyUsersInDatabase(\n  5,\n  'user-{{n}}',\n  'editor',\n  ['user_email' =&gt; 'user-{{n}}@example.org']\n  );\n</code></pre> Parameters <ul> <li><code>int</code> $count - The number of users to insert.</li> <li><code>string</code> $user_login - The user login name.</li> <li><code>string</code> $role - The user role.</li> <li><code>array/\\Codeception\\Module\\array/array $overrides - An array of values to override the default ones. haveMenuInDatabase <p>Creates and adds a menu to a theme location in the database.</p> <pre><code>list($termId, $termTaxId) = $I-&gt;haveMenuInDatabase('test', 'sidebar');\n</code></pre> Parameters <ul> <li><code>string</code> $slug - The menu slug.</li> <li><code>string</code> $location - The theme menu location the menu will be assigned to.</li> <li><code>array/\\Codeception\\Module\\array/array $overrides - An array of values to override the defaults. haveMenuItemInDatabase <p>Adds a menu element to a menu for the current theme. post meta.</p> <pre><code>$I-&gt;haveMenuInDatabase('test', 'sidebar');\n  $I-&gt;haveMenuItemInDatabase('test', 'Test one', 0);\n  $I-&gt;haveMenuItemInDatabase('test', 'Test two', 1);\n</code></pre> Parameters <ul> <li><code>string</code> $menuSlug - The menu slug the item should be added to.</li> <li><code>string</code> $title - The menu item title.</li> <li><code>int/null</code> $menuOrder - An optional menu order, <code>1</code> based.</li> <li><code>array/\\Codeception\\Module\\array/array $meta - An associative array that will be prefixed with <code>_menu_item_</code> for the item haveOptionInDatabase <p>Inserts an option in the database.</p> <pre><code>$I-&gt;haveOptionInDatabase('posts_per_page', 23);\n  $I-&gt;haveOptionInDatabase('my_plugin_options', ['key_one' =&gt; 'value_one', 'key_two' =&gt; 89]);\n  If the option value is an object or an array then the value will be serialized.\n</code></pre> Parameters <ul> <li><code>string</code> $option_name - The option name.</li> <li><code>mixed</code> $option_value - The option value; if an array or object it will be serialized.</li> <li><code>string</code> $autoload - Weather the option should be autoloaded by WordPress or not.</li></ul> havePageInDatabase <p>Inserts a page in the database.</p> <pre><code>// Creates a test page in the database with random values.\n  $randomPageId = $I-&gt;havePageInDatabase();\n  // Creates a test page in the database defining its title.\n  $testPageId = $I-&gt;havePageInDatabase(['post_title' =&gt; 'Test page']);\n</code></pre> Parameters <ul> <li><code>array/\\Codeception\\Module\\array/array $overrides - An array of values to override the default ones. havePostInDatabase <p>Inserts a post in the database. values.</p> <pre><code>// Insert a post with random values in the database.\n  $randomPostId = $I-&gt;havePostInDatabase();\n  // Insert a post with specific values in the database.\n  $I-&gt;havePostInDatabase([\n  'post_type' =&gt; 'book',\n  'post_title' =&gt; 'Alice in Wonderland',\n  'meta_input' =&gt; [\n  'readers_count' =&gt; 23\n  ],\n  'tax_input' =&gt; [\n  ['genre' =&gt; 'fiction']\n  ]\n  ]);\n</code></pre> Parameters <ul> <li><code>array/\\Codeception\\Module\\array/array $data - An associative array of post data to override default and random generated havePostThumbnailInDatabase <p>Assigns the specified attachment ID as thumbnail (featured image) to a post.</p> <pre><code>$attachmentId = $I-&gt;haveAttachmentInDatabase(codecept_data_dir('some-image.png'));\n  $postId = $I-&gt;havePostInDatabase();\n  $I-&gt;havePostThumbnailInDatabase($postId, $attachmentId);\n</code></pre> Parameters <ul> <li><code>int</code> $postId - The post ID to assign the thumbnail (featured image) to.</li> <li><code>int</code> $thumbnailId - The post ID of the attachment.</li></ul> havePostmetaInDatabase <p>Adds one or more meta key and value couples in the database for a post.</p> <pre><code>// Set the post-meta for a post.\n  $I-&gt;havePostmetaInDatabase($postId, 'karma', 23);\n  // Set an array post-meta for a post, it will be serialized in the db.\n  $I-&gt;havePostmetaInDatabase($postId, 'data', ['one', 'two']);\n  // Use a loop to insert one meta per row.\n  foreach( ['one', 'two'] as $value){\n  $I-&gt;havePostmetaInDatabase($postId, 'data', $value);\n  }\n</code></pre> Parameters <ul> <li><code>int</code> $postId - The post ID.</li> <li><code>string</code> $meta_key - The meta key.</li> <li><code>mixed</code> $meta_value - The value to insert in the database, objects and arrays will be serialized.</li></ul> haveSiteOptionInDatabase <p>Inserts a site option in the database. If the value is an array or an object then the value will be serialized.</p> <pre><code>$fooCountOptionId = $I-&gt;haveSiteOptionInDatabase('foo_count','23');\n</code></pre> Parameters <ul> <li><code>string</code> $key - The name of the option to insert.</li> <li><code>mixed</code> $value - The value to insert for the option.</li></ul> haveSiteTransientInDatabase <p>Inserts a site transient in the database. If the value is an array or an object then the value will be serialized.</p> <pre><code>$I-&gt;haveSiteTransientInDatabase('total_comments_count', 23);\n  // This value will be serialized.\n  $I-&gt;haveSiteTransientInDatabase('api_data', ['user' =&gt; 'luca', 'token' =&gt; '11ae3ijns-j83']);\n</code></pre> Parameters <ul> <li><code>string</code> $key - The key of the site transient to insert, w/o the <code>_site_transient_</code> prefix.</li> <li><code>mixed</code> $value - The value to insert; if serializable the value will be serialized.</li></ul> haveTermInDatabase <p>Inserts a term in the database.</p> <pre><code>// Insert a random 'genre' term in the database.\n  $I-&gt;haveTermInDatabase('non-fiction', 'genre');\n  // Insert a term in the database with term meta.\n  $I-&gt;haveTermInDatabase('fiction', 'genre', [\n  'slug' =&gt; 'genre--fiction',\n  'meta' =&gt; [\n  'readers_count' =&gt; 23\n  ]\n  ]);\n</code></pre> Parameters <ul> <li><code>string</code> $name - The term name, e.g. \"Fuzzy\".</li> <li><code>string</code> $taxonomy - The term taxonomy</li> <li><code>array/\\Codeception\\Module\\array/array $overrides - An array of values to override the default ones. haveTermMetaInDatabase <p>Inserts a term meta row in the database. Objects and array meta values will be serialized.</p> <pre><code>$I-&gt;haveTermMetaInDatabase($fictionId, 'readers_count', 23);\n  // Insert some meta that will be serialized.\n  $I-&gt;haveTermMetaInDatabase($fictionId, 'flags', [3, 4, 89]);\n  // Use a loop to insert one meta per row.\n  foreach([3, 4, 89] as $value) {\n  $I-&gt;haveTermMetaInDatabase($fictionId, 'flag', $value);\n  }\n</code></pre> Parameters <ul> <li><code>int</code> $term_id - The ID of the term to insert the meta for.</li> <li><code>string</code> $meta_key - The key of the meta to insert.</li> <li><code>mixed</code> $meta_value - The value of the meta to insert, if serializable it will be serialized.</li></ul> haveTermRelationshipInDatabase <p>Creates a term relationship in the database. No check about the consistency of the insertion is made. E.g. a post could be assigned a term from a taxonomy that's not registered for that post type.</p> <pre><code>// Assign the `fiction` term to a book.\n  $I-&gt;haveTermRelationshipInDatabase($bookId, $fictionId);\n</code></pre> Parameters <ul> <li><code>int</code> $object_id - A post ID, a user ID or anything that can be assigned a taxonomy term.</li> <li><code>int</code> $term_taxonomy_id - The <code>term_taxonomy_id</code> of the term and taxonomy to create a relation with.</li> <li><code>int</code> $term_order - Defaults to <code>0</code>.</li></ul> haveTransientInDatabase <p>Inserts a transient in the database. If the value is an array or an object then the value will be serialized. Since the transients are set in the context of tests it's not possible to set an expiration directly.</p> <pre><code>// Store an array in the `tweets` transient.\n  $I-&gt;haveTransientInDatabase('tweets', $tweets);\n</code></pre> Parameters <ul> <li><code>string</code> $transient - The transient name.</li> <li><code>mixed</code> $value - The transient value.</li></ul> haveUserCapabilitiesInDatabase <p>Sets a user capabilities in the database.</p> <pre><code>// Assign one user a role in a blog.\n  $blogId = $I-&gt;haveBlogInDatabase('test');\n  $editor = $I-&gt;haveUserInDatabase('luca', 'editor');\n  $capsIds = $I-&gt;haveUserCapabilitiesInDatabase($editor, [$blogId =&gt; 'editor']);\n  // Assign a user two roles in blog 1.\n  $capsIds = $I-&gt;haveUserCapabilitiesInDatabase($userId, ['editor', 'subscriber']);\n  // Assign one user different roles in different blogs.\n  $capsIds = $I-&gt;haveUserCapabilitiesInDatabase($userId, [$blogId1 =&gt; 'editor', $blogId2 =&gt; 'author']);\n  // Assign a user a role and an additional capability in blog 1.\n  $I-&gt;haveUserCapabilitiesInDatabase($userId, ['editor' =&gt; true, 'edit_themes' =&gt; true]);\n  // Assign a user a mix of roles and capabilities in different blogs.\n  $capsIds = $I-&gt;haveUserCapabilitiesInDatabase(\n  $userId,\n  [\n  $blogId1 =&gt; ['editor' =&gt; true, 'edit_themes' =&gt; true],\n  $blogId2 =&gt; ['administrator' =&gt; true, 'edit_themes' =&gt; false]\n  ]\n  );\n  associative array of blog IDs/roles for a multisite\n  installation (e.g. `[1 =&gt; 'administrator`, 2 =&gt;\n  'subscriber']`).\n</code></pre> Parameters <ul> <li><code>int</code> $userId - The ID of the user to set the capabilities of.</li> <li><code>string/\\Codeception\\Module\\array/\\Codeception\\Module\\array $role - Either a role string (e.g. <code>administrator</code>),an haveUserInDatabase <p>Inserts a user and its meta in the database. defaults to <code>subscriber</code>. If more than one role is specified, then the first role in the list will be the user primary role and the <code>wp_user_level</code> will be set to that role. in the <code>users</code> and <code>usermeta</code> table.</p> <pre><code>// Create an editor user in blog 1 w/ specific email.\n  $userId = $I-&gt;haveUserInDatabase('luca', 'editor', ['user_email' =&gt; 'luca@example.org']);\n  // Create a subscriber user in blog 1.\n  $subscriberId = $I-&gt;haveUserInDatabase('subscriber');\n  // Create a user editor in blog 1, author in blog 2, administrator in blog 3.\n  $userWithMeta = $I-&gt;haveUserInDatabase('luca',\n  [\n  1 =&gt; 'editor',\n  2 =&gt; 'author',\n  3 =&gt; 'administrator'\n  ], [\n  'user_email' =&gt; 'luca@example.org'\n  'meta' =&gt; ['a meta_key' =&gt; 'a_meta_value']\n  ]\n  );\n  // Create editor in blog 1 w/ `edit_themes` cap, author in blog 2, admin in blog 3 w/o `manage_options` cap.\n  $userWithMeta = $I-&gt;haveUserInDatabase('luca',\n  [\n  1 =&gt; ['editor', 'edit_themes'],\n  2 =&gt; 'author',\n  3 =&gt; ['administrator' =&gt; true, 'manage_options' =&gt; false]\n  ]\n  );\n  // Create a user w/o role.\n  $userId = $I-&gt;haveUserInDatabase('luca', '');\n</code></pre> Parameters <ul> <li><code>string</code> $user_login - The user login name.</li> <li><code>string/string/\\Codeception\\Module\\array $role - The user role slug(s), e.g. <code>administrator</code> or <code>['author', 'editor']</code>; <li><code>array/\\Codeception\\Module\\array/array $overrides - An associative array of column names and values overriding defaults haveUserLevelsInDatabase <p>Sets the user access level meta in the database for a user. IDs/roles for a multisite installation (e.g. <code>[1 =&gt; 'administrator</code>, 2 =&gt; 'subscriber']`).</p> <pre><code>$userId = $I-&gt;haveUserInDatabase('luca', 'editor');\n  $moreThanAnEditorLessThanAnAdmin = 8;\n  $I-&gt;haveUserLevelsInDatabase($userId, $moreThanAnEditorLessThanAnAdmin);\n</code></pre> Parameters <ul> <li><code>int</code> $userId - The ID of the user to set the level for.</li> <li><code>\\Codeception\\Module\\array/string $role - Either a role string (e.g. <code>administrator</code>) or an array of blog haveUserMetaInDatabase <p>Sets a user meta in the database.</p> <pre><code>$userId = $I-&gt;haveUserInDatabase('luca', 'editor');\n  $I-&gt;haveUserMetaInDatabase($userId, 'karma', 23);\n  values will trigger the insertion of multiple rows.\n</code></pre> Parameters <ul> <li><code>int</code> $userId - The user ID.</li> <li><code>string</code> $meta_key - The meta key to set the value for.</li> <li><code>mixed</code> $meta_value - Either a single value or an array of values; objects will be serialized while array of</li></ul> importSql <p>Loads a set SQL code lines in the current database.</p> <pre><code>// Import a SQL string.\n  $I-&gt;importSql([$sqlString]);\n  // Import a set of SQL strings.\n  $I-&gt;importSql($sqlStrings);\n  // Import a prepared set of SQL strings.\n  $preparedSqlStrings = array_map(function($line){\n  return str_replace('{{date}}', date('Y-m-d H:i:s'), $line);\n  }, $sqlTemplate);\n  $I-&gt;importSql($preparedSqlStrings);\n</code></pre> Parameters <ul> <li><code>\\Codeception\\Module\\array/array $sql - The SQL strings to load. importSqlDumpFile <p>Import the SQL dump file if populate is enabled.</p> <pre><code>// Import a dump file passing the absolute path.\n  $I-&gt;importSqlDumpFile(codecept_data_dir('dumps/start.sql'));\n  Specifying a dump file that file will be imported.\n</code></pre> Parameters <ul> <li><code>string/null</code> $dumpFile - The dump file that should be imported in place of the default one.</li></ul> seeAttachmentInDatabase <p>Checks for an attachment in the database.</p> <pre><code>$url = 'https://example.org/images/foo.png';\n  $I-&gt;seeAttachmentInDatabase(['guid' =&gt; $url]);\n</code></pre> Parameters <ul> <li><code>\\Codeception\\Module\\array/array $criteria - An array of search criteria. seeBlogInDatabase <p>Checks for a blog in the <code>blogs</code> table.</p> <pre><code>// Search for a blog by `blog_id`.\n  $I-&gt;seeBlogInDatabase(['blog_id' =&gt; 23]);\n  // Search for all blogs on a path.\n  $I-&gt;seeBlogInDatabase(['path' =&gt; '/sub-path/']);\n</code></pre> Parameters <ul> <li><code>\\Codeception\\Module\\array/array $criteria - An array of search criteria. seeCommentInDatabase <p>Checks for a comment in the database. Will look up the \"comments\" table.</p> <pre><code>$I-&gt;seeCommentInDatabase(['comment_ID' =&gt; 23]);\n</code></pre> Parameters <ul> <li><code>\\Codeception\\Module\\array/array $criteria - An array of search criteria. seeCommentMetaInDatabase <p>Checks that a comment meta value is in the database. Will look up the \"commentmeta\" table.</p> <pre><code>// Assert a specified meta for a comment exists.\n  $I-&gt;seeCommentMetaInDatabase(['comment_ID' =&gt; $commentId, 'meta_key' =&gt; 'karma', 'meta_value' =&gt; 23]);\n  // Assert the comment has at least one meta set.\n  $I-&gt;seeCommentMetaInDatabase(['comment_ID' =&gt; $commentId]);\n</code></pre> Parameters <ul> <li><code>\\Codeception\\Module\\array/array $criteria - An array of search criteria. seeLinkInDatabase <p>Checks for a link in the <code>links</code> table of the database.</p> <pre><code>// Asserts a link exists by name.\n  $I-&gt;seeLinkInDatabase(['link_name' =&gt; 'my-link']);\n  // Asserts at least one link exists for the user.\n  $I-&gt;seeLinkInDatabase(['link_owner' =&gt; $userId]);\n</code></pre> Parameters <ul> <li><code>\\Codeception\\Module\\array/array $criteria - An array of search criteria. seeOptionInDatabase <p>Checks if an option is in the database for the current blog, either by criteria or by name and value. If checking for an array or an object then the serialized version will be checked for.</p> <pre><code>// Checks an option is in the database.\n  $I-&gt;seeOptionInDatabase('tables_version');\n  // Checks an option is in the database and has a specific value.\n  $I-&gt;seeOptionInDatabase('tables_version', '1.0');\n  $I-&gt;seeOptionInDatabase(['option_name' =&gt; 'tables_version', 'option_value' =&gt; 1.0']);\n</code></pre> Parameters <ul> <li><code>\\Codeception\\Module\\array/string $criteriaOrName - An array of search criteria or the option name. <li><code>mixed/null</code> $value - The optional value to try and match, only used if the option name is provided.</li> seePageInDatabase <p>Checks for a page in the database.</p> <pre><code>// Asserts a page with an exists in the database.\n  $I-&gt;seePageInDatabase(['ID' =&gt; 23]);\n  // Asserts a page with a slug and ID exists in the database.\n  $I-&gt;seePageInDatabase(['post_title' =&gt; 'Test Page', 'ID' =&gt; 23]);\n</code></pre> Parameters <ul> <li><code>\\Codeception\\Module\\array/array $criteria - An array of search criteria. seePostInDatabase <p>Checks for a post in the database.</p> <pre><code>// Assert a post exists in the database.\n  $I-&gt;seePostInDatabase(['ID' =&gt; 23]);\n  // Assert a post with a slug and ID exists in the database.\n  $I-&gt;seePostInDatabase(['post_content' =&gt; 'test content', 'ID' =&gt; 23]);\n</code></pre> Parameters <ul> <li><code>\\Codeception\\Module\\array/array $criteria - An array of search criteria. seePostMetaInDatabase <p>Checks for a post meta value in the database for the current blog. If the <code>meta_value</code> is an object or an array then the check will be made for serialized values.</p> <pre><code>$postId = $I-&gt;havePostInDatabase(['meta_input' =&gt; ['foo' =&gt; 'bar']];\n  $I-&gt;seePostMetaInDatabase(['post_id' =&gt; '$postId', 'meta_key' =&gt; 'foo']);\n</code></pre> Parameters <ul> <li><code>\\Codeception\\Module\\array/array $criteria - An array of search criteria. seePostWithTermInDatabase <p>Checks that a post to term relation exists in the database. The method will check the \"term_relationships\" table.</p> <pre><code>$fiction = $I-&gt;haveTermInDatabase('fiction', 'genre');\n  $postId = $I-&gt;havePostInDatabase(['tax_input' =&gt; ['genre' =&gt; ['fiction']]]);\n  $I-&gt;seePostWithTermInDatabase($postId, $fiction['term_taxonomy_id']);\n  passed this parameter will be interpreted as a `term_id`, else as a\n  the\n  term order.\n  to build a `taxonomy_term_id` from the `term_id`.\n</code></pre> Parameters <ul> <li><code>int</code> $post_id - The post ID.</li> <li><code>int</code> $term_taxonomy_id - The term <code>term_id</code> or <code>term_taxonomy_id</code>; if the <code>$taxonomy</code> argument is</li> <li><code>int/null</code> $term_order - The order the term applies to the post, defaults to <code>null</code> to not use</li> <li><code>string/null</code> $taxonomy - The taxonomy the <code>term_id</code> is for; if passed this parameter will be used</li></ul> seeSiteOptionInDatabase <p>Checks that a site option is in the database.</p> <pre><code>// Check that the option is set in the database.\n  $I-&gt;seeSiteOptionInDatabase('foo_count');\n  // Check that the option is set and has a specific value.\n  $I-&gt;seeSiteOptionInDatabase('foo_count', 23);\n</code></pre> Parameters <ul> <li><code>\\Codeception\\Module\\array/string $criteriaOrName - An array of search criteria or the option name. <li><code>mixed/null</code> $value - The optional value to try and match, only used if the option name is provided.</li> seeSiteSiteTransientInDatabase <p>Checks that a site option is in the database.</p> <pre><code>// Check a transient exists.\n  $I-&gt;seeSiteSiteTransientInDatabase('total_counts');\n  // Check a transient exists and has a specific value.\n  $I-&gt;seeSiteSiteTransientInDatabase('total_counts', 23);\n</code></pre> Parameters <ul> <li><code>string</code> $key - The name of the transient to check for, w/o the <code>_site_transient_</code> prefix.</li> <li><code>mixed/null</code> $value - If provided then the assertion will include the value.</li></ul> seeTableInDatabase <p>Checks that a table is in the database.</p> <pre><code>$options = $I-&gt;grabPrefixedTableNameFor('options');\n  $I-&gt;seeTableInDatabase($options);\n</code></pre> Parameters <ul> <li><code>string</code> $table - The full table name, including the table prefix.</li></ul> seeTermInDatabase <p>Checks for a term in the database. Looks up the <code>terms</code> and <code>term_taxonomy</code> prefixed tables. and the <code>term_taxonomy</code> tables.</p> <pre><code>$I-&gt;seeTermInDatabase(['slug' =&gt; 'genre--fiction']);\n  $I-&gt;seeTermInDatabase(['name' =&gt; 'Fiction', 'slug' =&gt; 'genre--fiction']);\n</code></pre> Parameters <ul> <li><code>\\Codeception\\Module\\array/array $criteria - An array of criteria to search for the term, can be columns from the <code>terms</code> seeTermMetaInDatabase <p>Checks for a term meta in the database.</p> <pre><code>list($termId, $termTaxonomyId) = $I-&gt;haveTermInDatabase('fiction', 'genre');\n  $I-&gt;haveTermMetaInDatabase($termId, 'rating', 4);\n  $I-&gt;seeTermMetaInDatabase(['term_id' =&gt; $termId,'meta_key' =&gt; 'rating', 'meta_value' =&gt; 4]);\n</code></pre> Parameters <ul> <li><code>\\Codeception\\Module\\array/array $criteria - An array of search criteria. seeTermRelationshipInDatabase <p>Checks for a term relationship in the database.</p> <pre><code>$postId = $I-&gt;havePostInDatabase(['tax_input' =&gt; ['category' =&gt; 'one']]);\n  $I-&gt;seeTermRelationshipInDatabase(['object_id' =&gt; $postId, 'term_taxonomy_id' =&gt; $oneTermTaxId]);\n</code></pre> Parameters <ul> <li><code>\\Codeception\\Module\\array/array $criteria - An array of search criteria. seeTermTaxonomyInDatabase <p>Checks for a taxonomy taxonomy in the database.</p> <pre><code>list($termId, $termTaxonomyId) = $I-&gt;haveTermInDatabase('fiction', 'genre');\n  $I-&gt;seeTermTaxonomyInDatabase(['term_id' =&gt; $termId, 'taxonomy' =&gt; 'genre']);\n</code></pre> Parameters <ul> <li><code>\\Codeception\\Module\\array/array $criteria - An array of search criteria. seeUserInDatabase <p>Checks that a user is in the database. The method will check the \"users\" table.</p> <pre><code>$I-&gt;seeUserInDatabase([\n  \"user_email\" =&gt; \"test@example.org\",\n  \"user_login\" =&gt; \"login name\"\n  ])\n</code></pre> Parameters <ul> <li><code>\\Codeception\\Module\\array/array $criteria - An array of search criteria. seeUserMetaInDatabase <p>Checks for a user meta value in the database.</p> <pre><code>$I-&gt;seeUserMetaInDatabase(['user_id' =&gt; 23, 'meta_key' =&gt; 'karma']);\n</code></pre> Parameters <ul> <li><code>\\Codeception\\Module\\array/array $criteria - An array of search criteria. useBlog <p>Sets the blog to be used. This has nothing to do with WordPress <code>switch_to_blog</code> function, this code will affect the table prefixes used.</p> <pre><code>// Switch to the blog with ID 23.\n  $I-&gt;useBlog(23);\n  // Switch back to the main blog.\n  $I-&gt;useMainBlog();\n</code></pre> Parameters <ul> <li><code>int</code> $blogId - The ID of the blog to use.</li></ul> useMainBlog <p>Sets the current blog to the main one (<code>blog_id</code> 1).</p> <pre><code>// Switch to the blog with ID 23.\n  $I-&gt;useBlog(23);\n  // Switch back to the main blog.\n  $I-&gt;useMainBlog();\n</code></pre> useTheme <p>Sets the current theme options.</p> <pre><code>$I-&gt;useTheme('twentyseventeen');\n  $I-&gt;useTheme('child-of-twentyseventeen', 'twentyseventeen');\n  $I-&gt;useTheme('acme', 'acme', 'Acme Theme');\n</code></pre> Parameters <ul> <li><code>string</code> $stylesheet - The theme stylesheet slug, e.g. <code>twentysixteen</code>.</li> <li><code>string</code> $template - The theme template slug, e.g. <code>twentysixteen</code>, defaults to <code>$stylesheet</code>.</li> <li><code>string</code> $themeName - The theme name, e.g. <code>Acme</code>, defaults to the \"title\" version of</li></ul> <p>This class extends \\Codeception\\Module\\Db</p> <p>This class implements \\Codeception\\Lib\\Interfaces\\Db</p>"},{"location":"v3/modules/WPFilesystem/","title":"WPFilesystem","text":"<p>This is the documentation for version 3 of the project. The current version is version 4 and the documentation can be found here.</p>"},{"location":"v3/modules/WPFilesystem/#wpfilesystem-module","title":"WPFilesystem module","text":"<p>This module should be used in acceptance and functional tests, see levels of testing for more information. This module extends the Filesystem module adding WordPress-specific configuration parameters and methods. The module provides methods to read, write and update the WordPress filesystem directly, without relying on WordPress methods, using WordPress functions or triggering WordPress filters. This module also provides methods to scaffold plugins and themes on the fly in the context of tests and auto-remove them after each test.</p>"},{"location":"v3/modules/WPFilesystem/#module-requirements-for-codeception-40","title":"Module requirements for Codeception 4.0+","text":"<p>This module requires the <code>codeception/module-filesystem</code> Composer package to work when wp-browser is used with Codeception 4.0.  </p> <p>To install the package run: </p> <pre><code>composer require --dev codeception/module-filesystem:^1.0\n</code></pre>"},{"location":"v3/modules/WPFilesystem/#configuration","title":"Configuration","text":"<ul> <li><code>wpRootFolder</code> required The absolute, or relative to the project root folder, path to the root WordPress installation folder. The WordPress installation root folder is the one that contains the <code>wp-load.php</code> file.</li> <li><code>themes</code> - defaults to <code>/wp-content/themes</code>; the path, relative to the the WordPress installation root folder, to the themes folder.</li> <li><code>plugins</code> - defaults to <code>/wp-content/plugins</code>; the path, relative to the WordPress installation root folder, to the plugins folder.</li> <li><code>mu-plugins</code> - defaults to <code>wp-content/mu-plugins</code>; the path, relative to the WordPress installation root folder, to the must-use plugins folder.</li> <li><code>uploads</code> - defaults to <code>/wp-content/uploads</code>; the path, relative to the WordPress installation root folder, to the uploads folder.</li> </ul>"},{"location":"v3/modules/WPFilesystem/#example-configuration","title":"Example configuration","text":"<pre><code>modules:\n    enabled:\n        - WPFilesystem\n    config:\n        WPFilesystem:\n            wpRootFolder: \"/var/www/wordpress\"\n</code></pre>"},{"location":"v3/modules/WPFilesystem/#public-api","title":"Public API","text":"<ul> <li> amInMuPluginPath </li> <li> amInPluginPath </li> <li> amInThemePath </li> <li> amInUploadsPath </li> <li> cleanMuPluginDir </li> <li> cleanPluginDir </li> <li> cleanThemeDir </li> <li> cleanUploadsDir </li> <li> copyDirToMuPlugin </li> <li> copyDirToPlugin </li> <li> copyDirToTheme </li> <li> copyDirToUploads </li> <li> deleteMuPluginFile </li> <li> deletePluginFile </li> <li> deleteThemeFile </li> <li> deleteUploadedDir </li> <li> deleteUploadedFile </li> <li> dontSeeInMuPluginFile </li> <li> dontSeeInPluginFile </li> <li> dontSeeInThemeFile </li> <li> dontSeeInUploadedFile </li> <li> dontSeeMuPluginFileFound </li> <li> dontSeePluginFileFound </li> <li> dontSeeThemeFileFound </li> <li> dontSeeUploadedFileFound </li> <li> getBlogUploadsPath </li> <li> getUploadsPath </li> <li> getWpRootFolder </li> <li> haveMuPlugin </li> <li> havePlugin </li> <li> haveTheme </li> <li> makeUploadsDir </li> <li> openUploadedFile </li> <li> seeInMuPluginFile </li> <li> seeInPluginFile </li> <li> seeInThemeFile </li> <li> seeInUploadedFile </li> <li> seeMuPluginFileFound </li> <li> seePluginFileFound </li> <li> seeThemeFileFound </li> <li> seeUploadedFileFound </li> <li> writeToMuPluginFile </li> <li> writeToPluginFile </li> <li> writeToThemeFile </li> <li> writeToUploadedFile </li> </ul> amInMuPluginPath <p>Sets the current working folder to a folder in a mu-plugin.</p> <pre><code>$I-&gt;amInMuPluginPath('mu-plugin');\n</code></pre> Parameters <ul> <li><code>string</code> $path - The path to the folder, relative to the mu-plugins root folder.</li></ul> amInPluginPath <p>Sets the current working folder to a folder in a plugin.</p> <pre><code>$I-&gt;amInPluginPath('my-plugin');\n</code></pre> Parameters <ul> <li><code>string</code> $path - The folder path, relative to the root uploads folder, to change to.</li></ul> amInThemePath <p>Sets the current working folder to a folder in a theme.</p> <pre><code>$I-&gt;amInThemePath('my-theme');\n</code></pre> Parameters <ul> <li><code>string</code> $path - The path to the theme folder, relative to themes root folder.</li></ul> amInUploadsPath <p>Enters, changing directory, to the uploads folder in the local filesystem.</p> <pre><code>$I-&gt;amInUploadsPath('/logs');\n  $I-&gt;seeFileFound('shop.log');\n</code></pre> Parameters <ul> <li><code>string</code> $path - The path, relative to the site uploads folder.</li></ul> cleanMuPluginDir <p>Cleans, emptying it, a folder in a mu-plugin folder.</p> <pre><code>$I-&gt;cleanMuPluginDir('mu-plugin1/foo');\n</code></pre> Parameters <ul> <li><code>string</code> $dir - The path to the directory, relative to the mu-plugins root folder.</li></ul> cleanPluginDir <p>Cleans, emptying it, a folder in a plugin folder.</p> <pre><code>$I-&gt;cleanPluginDir('my-plugin/foo');\n</code></pre> Parameters <ul> <li><code>string</code> $dir - The path to the folder, relative to the plugins root folder.</li></ul> cleanThemeDir <p>Clears, emptying it, a folder in a theme folder.</p> <pre><code>$I-&gt;cleanThemeDir('my-theme/foo');\n</code></pre> Parameters <ul> <li><code>string</code> $dir - The path to the folder, relative to the themese root folder.</li></ul> cleanUploadsDir <p>Clears a folder in the uploads folder. The date argument can be a string compatible with <code>strtotime</code> or a Unix timestamp that will be used to build the <code>Y/m</code> uploads subfolder path.</p> <pre><code>$I-&gt;cleanUploadsDir('some/folder');\n  $I-&gt;cleanUploadsDir('some/folder', 'today');\n</code></pre> Parameters <ul> <li><code>string</code> $dir - The path to the directory to delete, relative to the uploads folder.</li> <li><code>string/int/[\\DateTime](http://php.net/manual/en/class.datetime.php)</code> $date - The date of the uploads to delete, will default to <code>now</code>.</li></ul> copyDirToMuPlugin <p>Copies a folder to a folder in a mu-plugin.</p> <pre><code>$I-&gt;copyDirToMuPlugin(codecept_data_dir('foo'), 'mu-plugin/foo');\n</code></pre> Parameters <ul> <li><code>string</code> $src - The path to the source file to copy.</li> <li><code>string</code> $pluginDst - The path to the destination folder, relative to the mu-plugins root folder.</li></ul> copyDirToPlugin <p>Copies a folder to a folder in a plugin.</p> <pre><code>// Copy the 'foo' folder to the 'foo' folder in the plugin.\n  $I-&gt;copyDirToPlugin(codecept_data_dir('foo'), 'my-plugin/foo');\n</code></pre> Parameters <ul> <li><code>string</code> $src - The path to the source directory to copy.</li> <li><code>string</code> $pluginDst - The destination path, relative to the plugins root folder.</li></ul> copyDirToTheme <p>Copies a folder in a theme folder.</p> <pre><code>$I-&gt;copyDirToTheme(codecept_data_dir('foo'), 'my-theme');\n</code></pre> Parameters <ul> <li><code>string</code> $src - The path to the source file.</li> <li><code>string</code> $themeDst - The path to the destination folder, relative to the themes root folder.</li></ul> copyDirToUploads <p>Copies a folder to the uploads folder. The date argument can be a string compatible with <code>strtotime</code> or a Unix timestamp that will be used to build the <code>Y/m</code> uploads subfolder path.</p> <pre><code>$I-&gt;copyDirToUploads(codecept_data_dir('foo'), 'uploadsFoo');\n  $I-&gt;copyDirToUploads(codecept_data_dir('foo'), 'uploadsFoo', 'today');\n</code></pre> Parameters <ul> <li><code>string</code> $src - The path to the source file, relative to the current uploads folder.</li> <li><code>string</code> $dst - The path to the destination file, relative to the current uploads folder.</li> <li><code>string/int/[\\DateTime](http://php.net/manual/en/class.datetime.php)</code> $date - The date of the uploads to delete, will default to <code>now</code>.</li></ul> deleteMuPluginFile <p>Deletes a file in a mu-plugin folder.</p> <pre><code>$I-&gt;deleteMuPluginFile('mu-plugin1/some-file.txt');\n</code></pre> Parameters <ul> <li><code>string</code> $file - The path to the file, relative to the mu-plugins root folder.</li></ul> deletePluginFile <p>Deletes a file in a plugin folder.</p> <pre><code>$I-&gt;deletePluginFile('my-plugin/some-file.txt');\n</code></pre> Parameters <ul> <li><code>string</code> $file - The folder path, relative to the plugins root folder.</li></ul> deleteThemeFile <p>Deletes a file in a theme folder.</p> <pre><code>$I-&gt;deleteThemeFile('my-theme/some-file.txt');\n</code></pre> Parameters <ul> <li><code>string</code> $file - The path to the file to delete, relative to the themes root folder.</li></ul> deleteUploadedDir <p>Deletes a dir in the uploads folder. The date argument can be a string compatible with <code>strtotime</code> or a Unix timestamp that will be used to build the <code>Y/m</code> uploads subfolder path.</p> <pre><code>$I-&gt;deleteUploadedDir('folder');\n  $I-&gt;deleteUploadedDir('folder', 'today');\n</code></pre> Parameters <ul> <li><code>string</code> $dir - The path to the directory to delete, relative to the uploads folder.</li> <li><code>string/int/[\\DateTime](http://php.net/manual/en/class.datetime.php)</code> $date - The date of the uploads to delete, will default to <code>now</code>.</li></ul> deleteUploadedFile <p>Deletes a file in the uploads folder. The date argument can be a string compatible with <code>strtotime</code> or a Unix timestamp that will be used to build the <code>Y/m</code> uploads subfolder path.</p> <pre><code>$I-&gt;deleteUploadedFile('some-file.txt');\n  $I-&gt;deleteUploadedFile('some-file.txt', 'today');\n</code></pre> Parameters <ul> <li><code>string</code> $file - The file path, relative to the uploads folder or the current folder.</li> <li><code>string/int</code> $date - A string compatible with <code>strtotime</code> or a Unix timestamp.</li></ul> dontSeeInMuPluginFile <p>Checks that a file in a mu-plugin folder does not contain a string.</p> <pre><code>$I-&gt;dontSeeInMuPluginFile('mu-plugin1/some-file.txt', 'foo');\n</code></pre> Parameters <ul> <li><code>string</code> $file - The path to the file, relative to the mu-plugins root folder.</li> <li><code>string</code> $contents - The contents to check the file for.</li></ul> dontSeeInPluginFile <p>Checks that a file in a plugin folder does not contain a string.</p> <pre><code>$I-&gt;dontSeeInPluginFile('my-plugin/some-file.txt', 'foo');\n</code></pre> Parameters <ul> <li><code>string</code> $file - The path to the file, relative to the plugins root folder.</li> <li><code>string</code> $contents - The contents to check the file for.</li></ul> dontSeeInThemeFile <p>Checks that a file in a theme folder does not contain a string.</p> <pre><code>$I-&gt;dontSeeInThemeFile('my-theme/some-file.txt', 'foo');\n</code></pre> Parameters <ul> <li><code>string</code> $file - The path to the file, relative to the themes root folder.</li> <li><code>string</code> $contents - The contents to check the file for.</li></ul> dontSeeInUploadedFile <p>Checks that a file in the uploads folder does contain a string. The date argument can be a string compatible with <code>strtotime</code> or a Unix timestamp that will be used to build the <code>Y/m</code> uploads subfolder path.</p> <pre><code>$I-&gt;dontSeeInUploadedFile('some-file.txt', 'foo');\n  $I-&gt;dontSeeInUploadedFile('some-file.txt','foo', 'today');\n</code></pre> Parameters <ul> <li><code>string</code> $file - The file path, relative to the uploads folder or the current folder.</li> <li><code>string</code> $contents - The not expected file contents or part of them.</li> <li><code>string/int</code> $date - A string compatible with <code>strtotime</code> or a Unix timestamp.</li></ul> dontSeeMuPluginFileFound <p>Checks that a file is not found in a mu-plugin folder.</p> <pre><code>$I-&gt;dontSeeMuPluginFileFound('mu-plugin1/some-file.txt');\n</code></pre> Parameters <ul> <li><code>string</code> $file - The path to the file, relative to the mu-plugins folder.</li></ul> dontSeePluginFileFound <p>Checks that a file is not found in a plugin folder.</p> <pre><code>$I-&gt;dontSeePluginFileFound('my-plugin/some-file.txt');\n</code></pre> Parameters <ul> <li><code>string</code> $file - The path to the file, relative to the plugins root folder.</li></ul> dontSeeThemeFileFound <p>Checks that a file is not found in a theme folder.</p> <pre><code>$I-&gt;dontSeeThemeFileFound('my-theme/some-file.txt');\n</code></pre> Parameters <ul> <li><code>string</code> $file - The path to the file, relative to the themes root folder.</li></ul> dontSeeUploadedFileFound <p>Checks thata a file does not exist in the uploads folder. The date argument can be a string compatible with <code>strtotime</code> or a Unix timestamp that will be used to build the <code>Y/m</code> uploads subfolder path.</p> <pre><code>$I-&gt;dontSeeUploadedFileFound('some-file.txt');\n  $I-&gt;dontSeeUploadedFileFound('some-file.txt','today');\n</code></pre> Parameters <ul> <li><code>string</code> $file - The file path, relative to the uploads folder or the current folder.</li> <li><code>string/int</code> $date - A string compatible with <code>strtotime</code> or a Unix timestamp.</li></ul> getBlogUploadsPath <p>Returns the absolute path to a blog uploads folder or file.</p> <pre><code>$blogId = $I-&gt;haveBlogInDatabase('test');\n  $testTodayUploads = $I-&gt;getBlogUploadsPath($blogId);\n  $testLastMonthLogs = $I-&gt;getBlogUploadsPath($blogId, '/logs', '-1 month');\n  file or folder.\n  sub-folders in the year/month format; a UNIX timestamp or\n  a string supported by the `strtotime` function; defaults\n  to `now`.\n</code></pre> Parameters <ul> <li><code>int</code> $blogId - The blog ID to get the path for.</li> <li><code>string</code> $file - The path, relatitve to the blog uploads folder, to the</li> <li><code>null/string/[\\DateTime](http://php.net/manual/en/class.datetime.php)/[\\DateTime](http://php.net/manual/en/class.datetime.php)Immutable</code> $date - The date that should be used to build the uploads</li></ul> getUploadsPath <p>Returns the path to the specified uploads file of folder. Not providing a value for <code>$file</code> and <code>$date</code> will return the uploads folder path.</p> <pre><code>$todaysPath = $I-&gt;getUploadsPath();\n  $lastWeek = $I-&gt;getUploadsPath('', '-1 week');\n</code></pre> Parameters <ul> <li><code>string</code> $file - The file path, relative to the uploads folder.</li> <li><code>mixed</code> $date - A string compatible with <code>strtotime</code>, a Unix timestamp or a Date object.</li></ul> getWpRootFolder <p>Returns the absolute path to WordPress root folder without trailing slash.</p> <pre><code>$rootFolder = $I-&gt;getWpRootFolder();\n  $I-&gt;assertFileExists($rootFolder . 'wp-load.php');\n</code></pre> haveMuPlugin <p>Creates a mu-plugin file, including plugin header, in the mu-plugins folder. The code can not contain the opening '&lt;?php' tag.</p> <pre><code>$code = 'echo \"Hello world!\"';\n  $I-&gt;haveMuPlugin('foo-mu-plugin.php', $code);\n  // Load the code from a file.\n  $code = file_get_contents(codecept_data_dir('code/mu-plugin.php'));\n  $I-&gt;haveMuPlugin('foo-mu-plugin.php', $code);\n</code></pre> Parameters <ul> <li><code>string</code> $filename - The path to the file to create, relative to the plugins root folder.</li> <li><code>string</code> $code - The content of the plugin file with or without the opening PHP tag.</li></ul> havePlugin <p>Creates a plugin file, including plugin header, in the plugins folder. The plugin is just created and not activated; the code can not contain the opening '&lt;?php' tag.</p> <pre><code>$code = 'echo \"Hello world!\"';\n  $I-&gt;havePlugin('foo/plugin.php', $code);\n  // Load the code from a file.\n  $code = file_get_contents(codecept_data_dir('code/plugin.php'));\n  $I-&gt;havePlugin('foo/plugin.php', $code);\n</code></pre> Parameters <ul> <li><code>string</code> $path - The path to the file to create, relative to the plugins folder.</li> <li><code>string</code> $code - The content of the plugin file with or without the opening PHP tag.</li></ul> haveTheme <p>Creates a theme file structure, including theme style file and index, in the themes folder. The theme is just created and not activated; the code can not contain the opening '&lt;?php' tag.</p> <pre><code>$code = 'sayHi();';\n  $functionsCode  = 'function sayHi(){echo \"Hello world\";};';\n  $I-&gt;haveTheme('foo', $indexCode, $functionsCode);\n  // Load the code from a file.\n  $indexCode = file_get_contents(codecept_data_dir('code/index.php'));\n  $functionsCode = file_get_contents(codecept_data_dir('code/functions.php'));\n  $I-&gt;haveTheme('foo', $indexCode, $functionsCode);\n</code></pre> Parameters <ul> <li><code>string</code> $folder - The path to the theme to create, relative to the themes root folder.</li> <li><code>string</code> $indexFileCode - The content of the theme index.php file with or without the opening PHP tag.</li> <li><code>string</code> $functionsFileCode - The content of the theme functions.php file with or without the opening PHP tag.</li></ul> makeUploadsDir <p>Creates an empty folder in the WordPress installation uploads folder.</p> <pre><code>$logsDir = $I-&gt;makeUploadsDir('logs/acme');\n  to create.\n</code></pre> Parameters <ul> <li><code>string</code> $path - The path, relative to the WordPress installation uploads folder, of the folder</li></ul> openUploadedFile <p>Opens a file in the the uploads folder. The date argument can be a string compatible with <code>strtotime</code> or a Unix timestamp that will be used to build the <code>Y/m</code> uploads subfolder path.</p> <pre><code>$I-&gt;openUploadedFile('some-file.txt');\n  $I-&gt;openUploadedFile('some-file.txt', 'time');\n</code></pre> Parameters <ul> <li><code>string</code> $filename - The path to the file, relative to the current uploads folder.</li> <li><code>string/int/[\\DateTime](http://php.net/manual/en/class.datetime.php)</code> $date - The date of the uploads to delete, will default to <code>now</code>.</li></ul> seeInMuPluginFile <p>Checks that a file in a mu-plugin folder contains a string.</p> <pre><code>$I-&gt;seeInMuPluginFile('mu-plugin1/some-file.txt', 'foo');\n</code></pre> Parameters <ul> <li><code>string</code> $file - The path the file, relative to the mu-plugins root folder.</li> <li><code>string</code> $contents - The contents to check the file for.</li></ul> seeInPluginFile <p>Checks that a file in a plugin folder contains a string.</p> <pre><code>$I-&gt;seeInPluginFile('my-plugin/some-file.txt', 'foo');\n</code></pre> Parameters <ul> <li><code>string</code> $file - The path to the file, relative to the plugins root folder.</li> <li><code>string</code> $contents - The contents to check the file for.</li></ul> seeInThemeFile <p>Checks that a file in a theme folder contains a string.</p> <pre><code>&lt;?php\n  $I-&gt;seeInThemeFile('my-theme/some-file.txt', 'foo');\n  ?&gt;\n</code></pre> Parameters <ul> <li><code>string</code> $file - The path to the file, relative to the themes root folder.</li> <li><code>string</code> $contents - The contents to check the file for.</li></ul> seeInUploadedFile <p>Checks that a file in the uploads folder contains a string. The date argument can be a string compatible with <code>strtotime</code> or a Unix timestamp that will be used to build the <code>Y/m</code> uploads subfolder path.</p> <pre><code>$I-&gt;seeInUploadedFile('some-file.txt', 'foo');\n  $I-&gt;seeInUploadedFile('some-file.txt','foo', 'today');\n</code></pre> Parameters <ul> <li><code>string</code> $file - The file path, relative to the uploads folder or the current folder.</li> <li><code>string</code> $contents - The expected file contents or part of them.</li> <li><code>string/int</code> $date - A string compatible with <code>strtotime</code> or a Unix timestamp.</li></ul> seeMuPluginFileFound <p>Checks that a file is found in a mu-plugin folder.</p> <pre><code>$I-&gt;seeMuPluginFileFound('mu-plugin1/some-file.txt');\n</code></pre> Parameters <ul> <li><code>string</code> $file - The path to the file, relative to the mu-plugins folder.</li></ul> seePluginFileFound <p>Checks that a file is found in a plugin folder.</p> <pre><code>$I-&gt;seePluginFileFound('my-plugin/some-file.txt');\n</code></pre> Parameters <ul> <li><code>string</code> $file - The path to the file, relative to thep plugins root folder.</li></ul> seeThemeFileFound <p>Checks that a file is found in a theme folder.</p> <pre><code>$I-&gt;seeThemeFileFound('my-theme/some-file.txt');\n</code></pre> Parameters <ul> <li><code>string</code> $file - The path to the file, relative to the themes root folder.</li></ul> seeUploadedFileFound <p>Checks if file exists in the uploads folder. The date argument can be a string compatible with <code>strtotime</code> or a Unix timestamp that will be used to build the <code>Y/m</code> uploads subfolder path.</p> <pre><code>$I-&gt;seeUploadedFileFound('some-file.txt');\n  $I-&gt;seeUploadedFileFound('some-file.txt','today');\n  ?&gt;\n</code></pre> Parameters <ul> <li><code>string</code> $filename - The file path, relative to the uploads folder or the current folder.</li> <li><code>string/int</code> $date - A string compatible with <code>strtotime</code> or a Unix timestamp.</li></ul> writeToMuPluginFile <p>Writes a file in a mu-plugin folder.</p> <pre><code>$I-&gt;writeToMuPluginFile('mu-plugin1/some-file.txt', 'foo');\n</code></pre> Parameters <ul> <li><code>string</code> $file - The path to the destination file, relative to the mu-plugins root folder.</li> <li><code>string</code> $data - The data to write to the file.</li></ul> writeToPluginFile <p>Writes a file in a plugin folder.</p> <pre><code>$I-&gt;writeToPluginFile('my-plugin/some-file.txt', 'foo');\n</code></pre> Parameters <ul> <li><code>string</code> $file - The path to the file, relative to the plugins root folder.</li> <li><code>string</code> $data - The data to write in the file.</li></ul> writeToThemeFile <p>Writes a string to a file in a theme folder.</p> <pre><code>$I-&gt;writeToThemeFile('my-theme/some-file.txt', 'foo');\n</code></pre> Parameters <ul> <li><code>string</code> $file - The path to the file, relative to the themese root folder.</li> <li><code>string</code> $data - The data to write to the file.</li></ul> writeToUploadedFile <p>Writes a string to a file in the the uploads folder. The date argument can be a string compatible with <code>strtotime</code> or a Unix timestamp that will be used to build the <code>Y/m</code> uploads subfolder path.</p> <pre><code>$I-&gt;writeToUploadedFile('some-file.txt', 'foo bar');\n  $I-&gt;writeToUploadedFile('some-file.txt', 'foo bar', 'today');\n</code></pre> Parameters <ul> <li><code>string</code> $filename - The path to the destination file, relative to the current uploads folder.</li> <li><code>string</code> $data - The data to write to the file.</li> <li><code>string/int/[\\DateTime](http://php.net/manual/en/class.datetime.php)</code> $date - The date of the uploads to delete, will default to <code>now</code>.</li></ul> <p>This class extends \\Codeception\\Module\\Filesystem</p>"},{"location":"v3/modules/WPLoader/","title":"WPLoader","text":"<p>This is the documentation for version 3 of the project. The current version is version 4 and the documentation can be found here.</p>"},{"location":"v3/modules/WPLoader/#wploader-module","title":"WPLoader module","text":"<p>This module should be used in integration tests, see levels of testing for more information, to bootstrap WordPress code in the context of the tests. Setting the <code>loadOnly</code> parameter to <code>true</code> the module can be additionally used in acceptance and functional tests to access WordPress code in the tests context. This module is a wrapper around the functionalities provided by the WordPress PHPUnit Core test suite, as such it provides the same method and facilities. The parameters provided to the module duplicate the ones used in the WordPress configuration file: the <code>WPLoader</code> module will not bootstrap WordPress using the <code>wp-config.php</code> file, it will define and use its own WordPress configuration built from the module parameters.</p>"},{"location":"v3/modules/WPLoader/#everything-happens-in-a-transaction","title":"Everything happens in a transaction","text":"<p>When used to bootstrap and install WordPress (<code>loadOnly: false</code>) exactly as the the WordPress PHPUnit Core test suite it is based on, this module will operate any change to the database in a transaction. This means that, in the context of integration tests, the result of any write or delete operation done during the tests will be rolled back at the end of each test method; this is done for a number of reasons like performance and tests independence. Inspection of the database during tests, e.g. stopping execution using XDebug, will not show any change in the database. Keep this in mind while trying to debug integration tests using the <code>WPLoader</code> module. When configured to only load WordPress (<code>loadOnly: true</code>) then any database operation will be committed and written to the database.</p>"},{"location":"v3/modules/WPLoader/#configuration","title":"Configuration","text":"<ul> <li><code>wpRootFolder</code> required The absolute, or relative to the project root folder, path to the root WordPress installation folder. The WordPress installation root folder is the one that contains the <code>wp-load.php</code> file.</li> <li><code>dbName</code> required - The name of the database used by the WordPress installation, same as the <code>DB_NAME</code> constant.</li> <li><code>dbHost</code> required - The host of the database used by the WordPress installation, same as the <code>DB_HOST</code> constant. If the database is accessible (as is the case on the latest version of [Local by Flywheel][http://localwp.com]) via unix socket, then the string to insert here should look like this <code>localhost:/path/to/the/mysql.sock</code>.</li> <li><code>dbUser</code> required - The user of the database used by the WordPress installation, same as the <code>DB_USER</code> constant.</li> <li><code>dbPassword</code> required - The password of the database used by the WordPress installation, same as <code>DB_PASSWORD</code> constant.</li> <li><code>loadOnly</code> - defaults to <code>false</code>; whether to only load WordPress, without bootstrapping a fresh installation for tests or not. Read more in the \"Using WPLoader in acceptance and functional tests\" section. If this parameter is set to <code>true</code> the following parameters will not apply.</li> <li><code>isolatedInstall</code> - defaults to <code>true</code>, whether to install and bootstrap the WordPress installation in a secondary PHP thread for thread safety or not. Maintained for back-compatibility purposes with wp-browser first versions: to get a replica of the bootstrap process used by WordPress Core PHPUnit tests leave this to <code>true</code>.</li> <li><code>installationTableHandling</code> - defaults to <code>empty</code>; it controls how tables created by WordPress and plugins will be handled during the installation of WordPress during tests. By default tables will be emptied of any content, but some plugins might require tables to be dropped before WordPress is installed and after plugins are activated (this used to be the default behavior). Supported values are <code>drop</code> to drop the tables, <code>empty</code> to just empty the tables and <code>let</code> to do nothing about the tables. If you get errors from database queries while the <code>WPLoader</code> module installs the tests, then try changing this parameter value. </li> <li><code>wpDebug</code> - defaults to <code>true</code>, the value the <code>WP_DEBUG</code> constant will be set to.</li> <li><code>multisite</code> - defaults to <code>false</code>, the value the <code>MULTISITE</code> constant will be set to.</li> <li><code>skipPluggables</code> - defaults to <code>false</code>, if set to <code>true</code> will skip the definition of pluggable functions.</li> <li><code>dbCharset</code> - defaults to <code>utf8</code>, the value the <code>DB_CHARSET</code> constant will be set to.</li> <li><code>dbCollate</code> - defaults to an empty string, the value the <code>DB_COLLATE</code> constant will be set to.</li> <li><code>tablePrefix</code> - defaults to <code>wptests_</code>, the value the <code>$table_prefix</code> variable will be set to.</li> <li><code>domain</code> - defaults to <code>example.org</code>, the domain of the WordPress site to scaffold for the tests.</li> <li><code>adminEmail</code> - defaults to <code>admin@example.org</code>, the email of the WordPress site to scaffold for the tests.</li> <li><code>title</code> - defaults to <code>Test Blog</code>, the title of the WordPress site to scaffolded for the tests.</li> <li><code>phpBinary</code> - defaults to <code>php</code>, the PHP binary the host machine will have to use to bootstrap and load the test WordPress installation.</li> <li><code>language</code> - defaults to an empty string, the language of the WordPress installation to scaffold.</li> <li><code>configFile</code> - defaults to an empty string, an additional configuration file to include before loading WordPress. Any instruction in this fill will run before any WordPress file is included.</li> <li><code>contentFolder</code> - defaults to an empty string; the path, relative to the <code>wpRootFolder</code> or absolute, to the content folder if different from the default one or the one defined by the <code>WP_CONTENT_DIR</code> constant; if the <code>WP_CONTENT_DIR</code> constant is defined in a config file (see the <code>configFile</code> parameter) this will be ignored.</li> <li><code>pluginsFolder</code> - defaults to an empty string; the path, relative to the <code>wpRootFolder</code> or absolute, to the plugins folder from the <code>wpRootFolder</code> if different from the default one or the one defined by the <code>WP_PLUGIN_DIR</code> constant; if the <code>WP_PLUGIN_DIR</code> constant is defined in a config file (see the <code>configFile</code> parameter) this will be ignored.</li> <li><code>plugins</code> - defaults to an empty array; a list of plugins that should be loaded before any test case runs and after mu-plugins have been loaded; these should be defined in the <code>folder/plugin-file.php</code> format.</li> <li><code>activateplugins</code> - defaults to an empty array, a list of plugins that will be activated before any test case runs and after wordpress is fully loaded and set up; these should be defined in the <code>folder/plugin-file.php</code> format; when the <code>multisite</code> option is set to <code>true</code> the plugins will be network activated during the installation.</li> <li><code>activatePluginsSilently</code> - defaults to an empty array, a list of plugins that will be silently activated, thus not firing the plugins' activation actions, before any test case runs and after wordpress is fully loaded and set up; these should be defined in the <code>folder/plugin-file.php</code> format; when the <code>multisite</code> option is set to <code>true</code> the plugins will be network activated during the installation.</li> <li><code>bootstrapActions</code> - defaults to an empty string, a list of actions, static functions or functions that should be called after before any test case runs, after plugins have been loaded and activated; static functions should be defined in the YAML array format:     <pre><code>bootstrapActions:\n    - action_one\n    - action_two\n    - [MyClass, myStaticMethod]\n    - my_function\n</code></pre></li> <li> <p><code>theme</code> - defaults to an empty string, the theme that should be activated for the tests; if a string is passed then both <code>template</code> and <code>stylesheet</code> options will be set to the passed value; if an array is passed then the <code>template</code> and <code>stylesheet</code> will be set in that order:</p> <pre><code>theme: my-theme\n</code></pre> <p>The theme will be set to <code>my-theme</code>.</p> <pre><code>theme: [ parent, child ]\n</code></pre> <p>The <code>template</code> will be set to <code>parent</code>, the <code>stylesheet</code> will be set to <code>child</code>.</p> </li> </ul> <p>A word of caution: right now the only way to write tests able to take advantage of the suite is to use the <code>WP_UnitTestCase</code> test case class; while the module will load fine and will raise no problems <code>WP_UnitTestCase</code> will take care of handling the database as intended and using another test case class will almost certainly result in an error if the test case defines more than one test method.</p>"},{"location":"v3/modules/WPLoader/#example-configuration","title":"Example configuration","text":"<pre><code>  modules:\n      enabled:\n          - WPLoader\n      config:\n          WPLoader:\n              multisite: false\n              wpRootFolder: \"/Users/luca/www/wordpress\"\n              dbName: \"wordpress_tests\"\n              dbHost: \"localhost\"\n              dbUser: \"root\"\n              dbPassword: \"password\"\n              isolatedInstall: true\n              installationTableHandling: drop\n              tablePrefix: \"wptests_\"\n              domain: \"wordrpess.localhost\"\n              adminEmail: \"admin@wordpress.localhost\"\n              title: \"Test Blog\"\n              theme: my-theme\n              plugins: ['hello.php', 'my-plugin/my-plugin.php']\n              activatePlugins: ['hello.php', 'my-plugin/my-plugin.php']\n</code></pre>"},{"location":"v3/modules/WPLoader/#usage-in-integration-or-wordpress-unit-tests","title":"Usage in integration or \"WordPress unit\" tests","text":"<p>The most common use of this module is to run integration, or \"WordPress unit\" tests (see levels of testing for more information).  </p> <p>As a first step generate a <code>WPTestCase</code> using Codeception command-line utility (see the commands provided by wp-browser):</p> <pre><code>codecept generate:wpunit my_suite \"Acme\\User\"\n</code></pre> <p>Codeception will generate the <code>tests/my_suite/Acme/UserTest.php</code> class. The class extends the <code>Codeception\\TestCase\\WPTestCase</code> class provided by wp-browser; this looks like a normal PHPUnit test case but has some perks due to it's mixed breed nature. Understanding them might help you work with it:</p> <ul> <li>WordPress is installed and configured for the tests before the test case is loaded; WordPress defined functions and classes (and those of the plugins and themes loaded with it) will be available in the <code>setUpBeforeClass</code> method. </li> <li>WordPress is not loaded when PHPUnit will call the data provider methods; this means the <code>post_provider</code> method will generate a function not found exception when the test case runs as the WordPress defined methods are not loaded yet:     <pre><code>public function post_provider(){\n        // `wp_insert_post` is loaded with WordPress and WordPress has not been loaded yet!\n        return [\n                [wp_insert_post(['post_title' =&gt; 'Test', 'post_status' =&gt; 'publish'])]\n        ];\n}\n\npublic function test_posts($post_id){\n        $this-&gt;assertInstanceOf(WP_Post::class, get_post($post_id));\n}\n</code></pre></li> <li>WordPress is reset to an initial known state before each test runs; the database transaction is rolled back to wipe any data and tables you might have manipulated in the tests, the global space is cleaned. See Everything happens in a transaction.  </li> <li>This is a Codeception Unit test, as such it does provide access to the <code>$this-&gt;tester</code> property to access the methods defined in other modules loaded in the suite and to Codeception test doubles</li> <li>This is a PhpUnit test case too; there are way too many testing functions to cover to report them here but, to highlight a few: mocking with Prophecy and the wealth of PHPUnit assertion methods.</li> <li>This is kind of a WordPress Core suite test case; as such it provides access to its functions and to the often-overlooked <code>static::factory()</code> method; in this instance too there are too many methods to list them all but it's worth noting how easy it is to set up test fixtures with the factory:     <pre><code>public function test_post_creation(){\n        $random_post_id = static::factory()-&gt;post-&gt;create();\n\n        $this-&gt;assertInstanceOf(WP_Post::class, get_post($random_post_id));\n}\n</code></pre></li> <li>The <code>factory</code> property can be accessed on the <code>tester</code> property too and will work the same way as if called using <code>static::factory()</code>:     <pre><code>public function test_post_creation(){\n        $random_post_id = $this-&gt;tester-&gt;factory()-&gt;post-&gt;create();\n\n        $this-&gt;assertInstanceOf(WP_Post::class, get_post($random_post_id));\n}\n</code></pre></li> </ul>"},{"location":"v3/modules/WPLoader/#wploader-to-only-bootstrap-wordpress","title":"WPLoader to only bootstrap WordPress","text":"<p>If the need is to just bootstrap the WordPress installation in the context of the tests variable scope then the <code>WPLoader</code> module <code>loadOnly</code> parameter should be set to <code>true</code>; this could be the case for functional tests in need to access WordPress provided methods, functions and values. An example configuration for the module in this mode is this one:</p> <pre><code>  modules:\n      enabled:\n          - WPDb # BEFORE the WPLoader one!\n          - WPLoader # AFTER the WPDb one!\n      config:\n          WPDb:\n              dsn: 'mysql:host=localhost;dbname=wordpress'\n              user: 'root'\n              password: 'password'\n              dump: 'tests/_data/dump.sql'\n              populate: true\n              cleanup: true\n              waitlock: 10\n              url: 'http://wordpress.localhost'\n              urlReplacement: true\n              tablePrefix: 'wp_'\n          WPLoader:\n              loadOnly: true \n              wpRootFolder: \"/Users/User/www/wordpress\"\n              dbName: \"wpress-tests\"\n              dbHost: \"localhost\"\n              dbUser: \"root\"\n              dbPassword: \"root\"\n              domain: \"wordpress.localhost\"\n</code></pre> <p>With reference to the table above the module will not take care of the test WordPress installation state before and after the tests, the installed and activated plugins, and theme. The module can be used in conjunction with a <code>WPDb</code> module to provide the tests with a WordPress installation suiting the tests at hand; when doing so please take care to list, in the suite configuration file <code>modules</code> section (see example above) the <code>WPDb</code> module before the <code>WPLoader</code> one. Codeception will initialize the modules in the same order they are listed in the modules section of the suite configuration file and the WPLoader module needs the database to be populated by the <code>WPDb</code> module before it runs! As an example this is a correct suite configuration: <pre><code>modules:\n  enabled:\n      - WPDb # this before...\n      - WPLoader # ...this one.\n  config:\n      WPDb:\n        # ...\n      WPLoader:\n        loadOnly: true\n        # ... \n</code></pre></p>"},{"location":"v3/modules/WPLoader/#public-api","title":"Public API","text":"<ul> <li> debugWpActionFinal </li> <li> debugWpActionInitial </li> <li> debugWpFilterFinal </li> <li> debugWpFilterInitial </li> <li> factory </li> <li> getContentFolder </li> <li> getPluginsFolder </li> <li> startWpFiltersDebug </li> <li> stopWpFiltersDebug </li> </ul> debugWpActionFinal <p>Debugs a single WordPress action final call using Codeception debug functions. The output will show following the selected output verbosity (<code>--debug</code> and <code>-vvv</code> CLI options).</p> <pre><code>// Start debugging all WordPress actions final value.\n  add_action('all', [$this,'debugWpActionFinal']);\n  // Run some code firing actions and debug them.\n  // Stop debugging all WordPress actions final value.\n  remove_action('all', [$this,'debugWpActionFinal']);\n</code></pre> Parameters <ul> <li><code>mixed</code> $args</li></ul> debugWpActionInitial <p>Debugs a single WordPress action initial call using Codeception debug functions. The output will show following the selected output verbosity (<code>--debug</code> and <code>-vvv</code> CLI options).</p> <pre><code>// Start debugging all WordPress actions initial value.\n  add_action('all', [$this,'debugWpActionInitial']);\n  // Run some code firing actions and debug them.\n  // Stop debugging all WordPress actions initial value.\n  remove_action('all', [$this,'debugWpActionInitial']);\n</code></pre> Parameters <ul> <li><code>mixed</code> $args</li></ul> debugWpFilterFinal <p>Debugs a single WordPress filter final call using Codeception debug functions. The output will show following the selected output verbosity (<code>--debug</code> and <code>-vvv</code> CLI options).</p> <pre><code>// Start debugging all WordPress filters final value.\n  add_filter('all', [$this,'debugWpFilterFinal']);\n  // Run some code firing filters and debug them.\n  // Stop debugging all WordPress filters final value.\n  remove_filter('all', [$this,'debugWpFilterFinal']);\n</code></pre> Parameters <ul> <li><code>mixed</code> $args</li></ul> debugWpFilterInitial <p>Debugs a single WordPress filter initial call using Codeception debug functions. The output will show following the selected output verbosity (<code>--debug</code> and <code>-vvv</code> CLI options).</p> <pre><code>// Start debugging all WordPress filters initial value.\n  add_filter('all', [$this,'debugWpFilterInitial']);\n  // Run some code firing filters and debug them.\n  // Stop debugging all WordPress filters initial value.\n  remove_filter('all', [$this,'debugWpFilterInitial']);\n</code></pre> Parameters <ul> <li><code>mixed</code> $args</li></ul> factory <p>Accessor method to get the object storing the factories for things. This methods gives access to the same factories provided by the Core test suite.</p> <pre><code>$postId = $I-&gt;factory()-&gt;post-&gt;create();\n  $userId = $I-&gt;factory()-&gt;user-&gt;create(['role' =&gt; 'administrator']);\n</code></pre> getContentFolder <p>Returns the absolute path to the WordPress content directory.</p> <pre><code>$content = $this-&gt;getContentFolder();\n  $themes = $this-&gt;getContentFolder('themes');\n  $twentytwenty = $this-&gt;getContentFolder('themes/twentytwenty');\n</code></pre> Parameters <ul> <li><code>string</code> $path - An optional path to append to the content directory absolute path.</li></ul> getPluginsFolder <p>Returns the absolute path to the plugins directory. The value will first look at the <code>WP_PLUGIN_DIR</code> constant, then the <code>pluginsFolder</code> configuration parameter and will, finally, look in the default path from the WordPress root directory.</p> <pre><code>$plugins = $this-&gt;getPluginsFolder();\n  $hello = $this-&gt;getPluginsFolder('hello.php');\n</code></pre> Parameters <ul> <li><code>string</code> $path - A relative path to append to te plugins directory absolute path.</li></ul> startWpFiltersDebug <p>Starts the debug of all WordPress filters and actions. The method hook on <code>all</code> filters and actions to debug their value.</p> <pre><code>// Start debugging all WordPress filters and action final and initial values.\n  $this-&gt;startWpFiltersDebug();\n  // Run some code firing filters and debug them.\n  // Stop debugging all WordPress filters and action final and initial values.\n  $this-&gt;stopWpFiltersDebug();\n  the array of arguments as input.\n</code></pre> Parameters <ul> <li><code>\\callable</code> $format - A callback function to format the arguments debug output; the callback will receive</li></ul> stopWpFiltersDebug <p>Stops the debug of all WordPress filters and actions.</p> <pre><code>// Start debugging all WordPress filters and action final and initial values.\n  $this-&gt;startWpFiltersDebug();\n  // Run some code firing filters and debug them.\n  // Stop debugging all WordPress filters and action final and initial values.\n  $this-&gt;stopWpFiltersDebug();\n</code></pre> <p>This class extends \\Codeception\\Module</p>"},{"location":"v3/modules/WPQueries/","title":"WPQueries","text":"<p>This is the documentation for version 3 of the project. The current version is version 4 and the documentation can be found here.</p>"},{"location":"v3/modules/WPQueries/#wpqueries-module","title":"WPQueries module","text":"<p>This module should be used in integration tests, see levels of testing for more information, to make assertions on the database queries made by the global <code>$wpdb</code> object. This module requires the WPLoader module to work. The module will set, if not set already, the <code>SAVEQUERIES</code> constant to <code>true</code> and will throw an exception if the constant is already set to a falsy value.  </p>"},{"location":"v3/modules/WPQueries/#configuration","title":"Configuration","text":"<p>This module does not require any configuration, but requires the WPLoader module to work correctly. </p>"},{"location":"v3/modules/WPQueries/#usage","title":"Usage","text":"<p>This module must be used in a test case extending the <code>\\Codeception\\TestCase\\WPTestCase</code> class.  </p> <p>The module public API is accessible calling via the <code>\\Codeception\\TestCase\\WPTestCase::queries()</code> method:</p> <pre><code>&lt;?php\n\nuse Codeception\\Module\\WPQueries;\n\nclass WPQueriesUsageTest extends \\Codeception\\TestCase\\WPTestCase\n{\n    public function test_queries_made_by_factory_are_not_tracked()\n    {\n        $currentQueriesCount = $this-&gt;queries()-&gt;countQueries();\n\n        $this-&gt;assertNotEmpty($currentQueriesCount);\n\n        static::factory()-&gt;post-&gt;create_many(3);\n\n        $this-&gt;assertNotEmpty($currentQueriesCount);\n        $this-&gt;assertEquals($currentQueriesCount, $this-&gt;queries()-&gt;countQueries());\n    }\n\n    public function test_count_queries()\n    {\n        $currentQueriesCount = $this-&gt;queries()-&gt;countQueries();\n\n        $this-&gt;assertNotEmpty($currentQueriesCount);\n\n        foreach (range(1, 3) as $i) {\n            wp_insert_post(['post_title' =&gt; 'Post ' . $i, 'post_content' =&gt; str_repeat('test', $i)]);\n        }\n\n        $this-&gt;assertNotEmpty($currentQueriesCount);\n        $this-&gt;assertGreaterThan($currentQueriesCount, $this-&gt;queries()-&gt;countQueries());\n    }\n}\n</code></pre>"},{"location":"v3/modules/WPQueries/#public-api","title":"Public API","text":"<ul> <li> assertCountQueries </li> <li> assertNotQueries </li> <li> assertNotQueriesByAction </li> <li> assertNotQueriesByFilter </li> <li> assertNotQueriesByFunction </li> <li> assertNotQueriesByMethod </li> <li> assertNotQueriesByStatement </li> <li> assertNotQueriesByStatementAndAction </li> <li> assertNotQueriesByStatementAndFilter </li> <li> assertNotQueriesByStatementAndFunction </li> <li> assertNotQueriesByStatementAndMethod </li> <li> assertQueries </li> <li> assertQueriesByAction </li> <li> assertQueriesByFilter </li> <li> assertQueriesByFunction </li> <li> assertQueriesByMethod </li> <li> assertQueriesByStatement </li> <li> assertQueriesByStatementAndAction </li> <li> assertQueriesByStatementAndFilter </li> <li> assertQueriesByStatementAndFunction </li> <li> assertQueriesByStatementAndMethod </li> <li> assertQueriesCountByAction </li> <li> assertQueriesCountByFilter </li> <li> assertQueriesCountByFunction </li> <li> assertQueriesCountByMethod </li> <li> assertQueriesCountByStatement </li> <li> assertQueriesCountByStatementAndAction </li> <li> assertQueriesCountByStatementAndFilter </li> <li> assertQueriesCountByStatementAndFunction </li> <li> assertQueriesCountByStatementAndMethod </li> <li> countQueries </li> <li> getQueries </li> </ul> assertCountQueries <p>Asserts that n queries have been made.</p> <pre><code>$posts = $this-&gt;factory()-&gt;post-&gt;create_many(3);\n  $cachedUsers = $this-&gt;factory()-&gt;user-&gt;create_many(2);\n  $nonCachedUsers = $this-&gt;factory()-&gt;user-&gt;create_many(2);\n  foreach($cachedUsers as $userId){\n  wp_cache_set('page-posts-for-user-' . $userId, $posts, 'acme');\n  }\n  // Run the same query as different users\n  foreach(array_merge($cachedUsers, $nonCachedUsers) as $userId){\n  $pagePosts = $plugin-&gt;getPagePostsForUser($userId);\n  }\n  $I-&gt;assertCountQueries(2, 'A query should be made for each user missing cached posts.')\n</code></pre> Parameters <ul> <li><code>int</code> $n - The expected number of queries.</li> <li><code>string</code> $message - An optional message to override the default one.</li></ul> assertNotQueries <p>Asserts that no queries were made. Queries generated by <code>setUp</code>, <code>tearDown</code> and <code>factory</code> methods are excluded by default.</p> <pre><code>$posts = $this-&gt;factory()-&gt;post-&gt;create_many(3);\n  wp_cache_set('page-posts', $posts, 'acme');\n  $pagePosts = $plugin-&gt;getPagePosts();\n  $I-&gt;assertNotQueries('Queries should not be made if the cache is set.')\n</code></pre> Parameters <ul> <li><code>string</code> $message - An optional message to override the default one.</li></ul> assertNotQueriesByAction <p>Asserts that no queries were made as a consequence of the specified action. Queries generated by <code>setUp</code>, <code>tearDown</code> and <code>factory</code> methods are excluded by default.</p> <pre><code>add_action( 'edit_post', function($postId){\n  $count = get_option('acme_title_updates_count');\n  update_option('acme_title_updates_count', ++$count);\n  } );\n  wp_delete_post($bookId);\n  $this-&gt;assertNotQueriesByAction('edit_post');\n</code></pre> Parameters <ul> <li><code>string</code> $action - The action name, e.g. 'init'.</li> <li><code>string</code> $message - An optional message to override the default one.</li></ul> assertNotQueriesByFilter <p>Asserts that no queries were made as a consequence of the specified filter. Queries generated by <code>setUp</code>, <code>tearDown</code> and <code>factory</code> methods are excluded by default.</p> <pre><code>add_filter('the_title', function($title, $postId){\n  $post = get_post($postId);\n  if($post-&gt;post_type !== 'book'){\n  return $title;\n  }\n  $new = get_option('acme_new_prefix');\n  return \"{$new} - \" . $title;\n  });\n  $title = apply_filters('the_title', get_post($notABookId)-&gt;post_title, $notABookId);\n  $this-&gt;assertNotQueriesByFilter('the_title');\n</code></pre> Parameters <ul> <li><code>string</code> $filter - The filter name, e.g. 'posts_where'.</li> <li><code>string</code> $message - An optional message to override the default one.</li></ul> assertNotQueriesByFunction <p>Asserts that no queries were made by the specified function. Queries generated by <code>setUp</code>, <code>tearDown</code> and <code>factory</code> methods are excluded by default.</p> <pre><code>$this-&gt;assertEmpty(Acme\\get_orphaned_posts());\n  Acme\\delete_orphaned_posts();\n  $this-&gt;assertNotQueriesByFunction('Acme\\delete_orphaned_posts');\n</code></pre> Parameters <ul> <li><code>string</code> $function - The fully qualified name of the function to check.</li> <li><code>string</code> $message - An optional message to override the default one.</li></ul> assertNotQueriesByMethod <p>Asserts that no queries have been made by the specified class method. Queries generated by <code>setUp</code>, <code>tearDown</code> and <code>factory</code> methods are excluded by default.</p> <pre><code>$options = new Acme\\Options();\n  $options-&gt;update('adsSource', 'not-a-real-url.org');\n  $I-&gt;assertNotQueriesByMethod('Acme\\Options', 'update');\n</code></pre> Parameters <ul> <li><code>string</code> $class - The fully qualified name of the class to check.</li> <li><code>string</code> $method - The name of the method to check.</li> <li><code>string</code> $message - An optional message to override the default one.</li></ul> assertNotQueriesByStatement <p>Asserts that no queries have been made by the specified class method. Queries generated by <code>setUp</code>, <code>tearDown</code> and <code>factory</code> methods are excluded by default.</p> <pre><code>$bookRepository = new Acme\\BookRepository();\n  $repository-&gt;where('ID', 23)-&gt;set('title', 'Peter Pan', $deferred = true);\n  $this-&gt;assertNotQueriesByStatement('INSERT', 'Deferred write should happen on __destruct');\n  Regular expressions must contain delimiters.\n</code></pre> Parameters <ul> <li><code>string</code> $statement - A simple string the statement should start with or a valid regular expression.</li> <li><code>string</code> $message - An optional message to override the default one.</li></ul> assertNotQueriesByStatementAndAction <p>Asserts that no queries were made as a consequence of the specified action containing the SQL query. Queries generated by <code>setUp</code>, <code>tearDown</code> and <code>factory</code> methods are excluded by default.</p> <pre><code>add_action( 'edit_post', function($postId){\n  $count = get_option('acme_title_updates_count');\n  update_option('acme_title_updates_count', ++$count);\n  } );\n  wp_delete_post($bookId);\n  $this-&gt;assertNotQueriesByStatementAndAction('DELETE', 'delete_post');\n  Regular expressions must contain delimiters.\n</code></pre> Parameters <ul> <li><code>string</code> $statement - A simple string the statement should start with or a valid regular expression.</li> <li><code>string</code> $action - The action name, e.g. 'init'.</li> <li><code>string</code> $message - An optional message to override the default one.</li></ul> assertNotQueriesByStatementAndFilter <p>Asserts that no queries were made as a consequence of the specified filter containing the specified SQL query. Queries generated by <code>setUp</code>, <code>tearDown</code> and <code>factory</code> methods are excluded by default.</p> <pre><code>add_filter('the_title', function($title, $postId){\n  $post = get_post($postId);\n  if($post-&gt;post_type !== 'book'){\n  return $title;\n  }\n  $new = get_option('acme_new_prefix');\n  return \"{$new} - \" . $title;\n  });\n  $title = apply_filters('the_title', get_post($notABookId)-&gt;post_title, $notABookId);\n  $this-&gt;assertNotQueriesByStatementAndFilter('SELECT', 'the_title');\n  Regular expressions must contain delimiters.\n</code></pre> Parameters <ul> <li><code>string</code> $statement - A simple string the statement should start with or a valid regular expression.</li> <li><code>string</code> $filter - The filter name, e.g. 'posts_where'.</li> <li><code>string</code> $message - An optional message to override the default one.</li></ul> assertNotQueriesByStatementAndFunction <p>Asserts that no queries were made by the specified function starting with the specified SQL statement. Queries generated by <code>setUp</code>, <code>tearDown</code> and <code>factory</code> methods are excluded by default.</p> <pre><code>wp_insert_post(['ID' =&gt; $bookId, 'post_title' =&gt; 'The Call of the Wild']);\n  $this-&gt;assertNotQueriesByStatementAndFunction('INSERT', 'wp_insert_post');\n  $this-&gt;assertQueriesByStatementAndFunction('UPDATE', 'wp_insert_post');\n  Regular expressions must contain delimiters.\n</code></pre> Parameters <ul> <li><code>string</code> $statement - A simple string the statement should start with or a valid regular expression.</li> <li><code>string</code> $function - The name of the function to check the assertions for.</li> <li><code>string</code> $message - An optional message to override the default one.</li></ul> assertNotQueriesByStatementAndMethod <p>Asserts that no queries were made by the specified class method starting with the specified SQL statement. Queries generated by <code>setUp</code>, <code>tearDown</code> and <code>factory</code> methods are excluded by default.</p> <pre><code>Acme\\BookRepository::new(['title' =&gt; 'Alice in Wonderland'])-&gt;commit();\n  $this-&gt;assertQueriesByStatementAndMethod('INSERT', Acme\\BookRepository::class, 'commit');\n  Regular expressions must contain delimiters.\n</code></pre> Parameters <ul> <li><code>string</code> $statement - A simple string the statement should start with or a valid regular expression.</li> <li><code>string</code> $class - The fully qualified name of the class to check.</li> <li><code>string</code> $method - The name of the method to check.</li> <li><code>string</code> $message - An optional message to override the default one.</li></ul> assertQueries <p>Asserts that at least one query was made during the test. Queries generated by <code>setUp</code>, <code>tearDown</code> and <code>factory</code> methods are excluded by default.</p> <pre><code>wp_cache_delete('page-posts', 'acme');\n  $pagePosts = $plugin-&gt;getPagePosts();\n  $I-&gt;assertQueries('Queries should be made to set the cache.')\n</code></pre> Parameters <ul> <li><code>string</code> $message - An optional message to override the default one.</li></ul> assertQueriesByAction <p>Asserts that at least one query was made as a consequence of the specified action. Queries generated by <code>setUp</code>, <code>tearDown</code> and <code>factory</code> methods are excluded by default.</p> <pre><code>add_action( 'edit_post', function($postId){\n  $count = get_option('acme_title_updates_count');\n  update_option('acme_title_updates_count', ++$count);\n  } );\n  wp_update_post(['ID' =&gt; $bookId, 'post_title' =&gt; 'New Title']);\n  $this-&gt;assertQueriesByAction('edit_post');\n</code></pre> Parameters <ul> <li><code>string</code> $action - The action name, e.g. 'init'.</li> <li><code>string</code> $message - An optional message to override the default one.</li></ul> assertQueriesByFilter <p>Asserts that at least one query was made as a consequence of the specified filter. Queries generated by <code>setUp</code>, <code>tearDown</code> and <code>factory</code> methods are excluded by default.</p> <pre><code>add_filter('the_title', function($title, $postId){\n  $post = get_post($postId);\n  if($post-&gt;post_type !== 'book'){\n  return $title;\n  }\n  $new = get_option('acme_new_prefix');\n  return \"{$new} - \" . $title;\n  });\n  $title = apply_filters('the_title', get_post($bookId)-&gt;post_title, $bookId);\n  $this-&gt;assertQueriesByFilter('the_title');\n</code></pre> Parameters <ul> <li><code>string</code> $filter - The filter name, e.g. 'posts_where'.</li> <li><code>string</code> $message - An optional message to override the default one.</li></ul> assertQueriesByFunction <p>Asserts that queries were made by the specified function. Queries generated by <code>setUp</code>, <code>tearDown</code> and <code>factory</code> methods are excluded by default.</p> <pre><code>acme_clean_queue();\n  $this-&gt;assertQueriesByFunction('acme_clean_queue');\n</code></pre> Parameters <ul> <li><code>string</code> $function - The fully qualified name of the function to check.</li> <li><code>string</code> $message - An optional message to override the default one.</li></ul> assertQueriesByMethod <p>Asserts that at least one query has been made by the specified class method. Queries generated by <code>setUp</code>, <code>tearDown</code> and <code>factory</code> methods are excluded by default.</p> <pre><code>$options = new Acme\\Options();\n  $options-&gt;update('showAds', false);\n  $I-&gt;assertQueriesByMethod('Acme\\Options', 'update');\n</code></pre> Parameters <ul> <li><code>string</code> $class - The fully qualified name of the class to check.</li> <li><code>string</code> $method - The name of the method to check.</li> <li><code>string</code> $message - An optional message to override the default one.</li></ul> assertQueriesByStatement <p>Asserts that at least a query starting with the specified statement was made. Queries generated by <code>setUp</code>, <code>tearDown</code> and <code>factory</code> methods are excluded by default.</p> <pre><code>wp_cache_flush();\n  cached_get_posts($args);\n  $I-&gt;assertQueriesByStatement('SELECT');\n  Regular expressions must contain delimiters.\n</code></pre> Parameters <ul> <li><code>string</code> $statement - A simple string the statement should start with or a valid regular expression.</li> <li><code>string</code> $message - An optional message to override the default one.</li></ul> assertQueriesByStatementAndAction <p>Asserts that at least one query was made as a consequence of the specified action containing the SQL query. Queries generated by <code>setUp</code>, <code>tearDown</code> and <code>factory</code> methods are excluded by default.</p> <pre><code>add_action( 'edit_post', function($postId){\n  $count = get_option('acme_title_updates_count');\n  update_option('acme_title_updates_count', ++$count);\n  } );\n  wp_update_post(['ID' =&gt; $bookId, 'post_title' =&gt; 'New']);\n  $this-&gt;assertQueriesByStatementAndAction('UPDATE', 'edit_post');\n  Regular expressions must contain delimiters.\n</code></pre> Parameters <ul> <li><code>string</code> $statement - A simple string the statement should start with or a valid regular expression.</li> <li><code>string</code> $action - The action name, e.g. 'init'.</li> <li><code>string</code> $message - An optional message to override the default one.</li></ul> assertQueriesByStatementAndFilter <p>Asserts that at least one query was made as a consequence of the specified filter containing the SQL query. Queries generated by <code>setUp</code>, <code>tearDown</code> and <code>factory</code> methods are excluded by default.</p> <pre><code>add_filter('the_title', function($title, $postId){\n  $post = get_post($postId);\n  if($post-&gt;post_type !== 'book'){\n  return $title;\n  }\n  $new = get_option('acme_new_prefix');\n  return \"{$new} - \" . $title;\n  });\n  $title = apply_filters('the_title', get_post($bookId)-&gt;post_title, $bookId);\n  $this-&gt;assertQueriesByStatementAndFilter('SELECT', 'the_title');\n  Regular expressions must contain delimiters.\n</code></pre> Parameters <ul> <li><code>string</code> $statement - A simple string the statement should start with or a valid regular expression.</li> <li><code>string</code> $filter - The filter name, e.g. 'posts_where'.</li> <li><code>string</code> $message - An optional message to override the default one.</li></ul> assertQueriesByStatementAndFunction <p>Asserts that queries were made by the specified function starting with the specified SQL statement. Queries generated by <code>setUp</code>, <code>tearDown</code> and <code>factory</code> methods are excluded by default.</p> <pre><code>wp_insert_post(['post_type' =&gt; 'book', 'post_title' =&gt; 'Alice in Wonderland']);\n  $this-&gt;assertQueriesByStatementAndFunction('INSERT', 'wp_insert_post');\n  Regular expressions must contain delimiters.\n</code></pre> Parameters <ul> <li><code>string</code> $statement - A simple string the statement should start with or a valid regular expression.</li> <li><code>string</code> $function - The fully qualified function name.</li> <li><code>string</code> $message - An optional message to override the default one.</li></ul> assertQueriesByStatementAndMethod <p>Asserts that queries were made by the specified class method starting with the specified SQL statement. Queries generated by <code>setUp</code>, <code>tearDown</code> and <code>factory</code> methods are excluded by default.</p> <pre><code>Acme\\BookRepository::new(['title' =&gt; 'Alice in Wonderland'])-&gt;commit();\n  $this-&gt;assertQueriesByStatementAndMethod('UPDATE', Acme\\BookRepository::class, 'commit');\n  Regular expressions must contain delimiters.\n</code></pre> Parameters <ul> <li><code>string</code> $statement - A simple string the statement should start with or a valid regular expression.</li> <li><code>string</code> $class - The fully qualified name of the class to check.</li> <li><code>string</code> $method - The name of the method to check.</li> <li><code>string</code> $message - An optional message to override the default one.</li></ul> assertQueriesCountByAction <p>Asserts that n queries were made as a consequence of the specified action. Queries generated by <code>setUp</code>, <code>tearDown</code> and <code>factory</code> methods are excluded by default.</p> <pre><code>add_action( 'edit_post', function($postId){\n  $count = get_option('acme_title_updates_count');\n  update_option('acme_title_updates_count', ++$count);\n  } );\n  wp_update_post(['ID' =&gt; $bookOneId, 'post_title' =&gt; 'One']);\n  wp_update_post(['ID' =&gt; $bookTwoId, 'post_title' =&gt; 'Two']);\n  wp_update_post(['ID' =&gt; $bookThreeId, 'post_title' =&gt; 'Three']);\n  $this-&gt;assertQueriesCountByAction(3, 'edit_post');\n</code></pre> Parameters <ul> <li><code>int</code> $n - The expected number of queries.</li> <li><code>string</code> $action - The action name, e.g. 'init'.</li> <li><code>string</code> $message - An optional message to override the default one.</li></ul> assertQueriesCountByFilter <p>Asserts that n queries were made as a consequence of the specified filter. Queries generated by <code>setUp</code>, <code>tearDown</code> and <code>factory</code> methods are excluded by default.</p> <pre><code>add_filter('the_title', function($title, $postId){\n  $post = get_post($postId);\n  if($post-&gt;post_type !== 'book'){\n  return $title;\n  }\n  $new = get_option('acme_new_prefix');\n  return \"{$new} - \" . $title;\n  });\n  $title = apply_filters('the_title', get_post($bookOneId)-&gt;post_title, $bookOneId);\n  $title = apply_filters('the_title', get_post($notABookId)-&gt;post_title, $notABookId);\n  $title = apply_filters('the_title', get_post($bookTwoId)-&gt;post_title, $bookTwoId);\n  $this-&gt;assertQueriesCountByFilter(2, 'the_title');\n</code></pre> Parameters <ul> <li><code>int</code> $n - The expected number of queries.</li> <li><code>string</code> $filter - The filter name, e.g. 'posts_where'.</li> <li><code>string</code> $message - An optional message to override the default one.</li></ul> assertQueriesCountByFunction <p>Asserts that n queries were made by the specified function. Queries generated by <code>setUp</code>, <code>tearDown</code> and <code>factory</code> methods are excluded by default.</p> <pre><code>$this-&gt;assertCount(3, Acme\\get_orphaned_posts());\n  Acme\\delete_orphaned_posts();\n  $this-&gt;assertQueriesCountByFunction(3, 'Acme\\delete_orphaned_posts');\n</code></pre> Parameters <ul> <li><code>int</code> $n - The expected number of queries.</li> <li><code>string</code> $function - The function to check the queries for.</li> <li><code>string</code> $message - An optional message to override the default one.</li></ul> assertQueriesCountByMethod <p>Asserts that n queries have been made by the specified class method. Queries generated by <code>setUp</code>, <code>tearDown</code> and <code>factory</code> methods are excluded by default.</p> <pre><code>$bookRepository = new Acme\\BookRepository();\n  $repository-&gt;where('ID', 23)-&gt;commit('title', 'Peter Pan');\n  $repository-&gt;where('ID', 89)-&gt;commit('title', 'Moby-dick');\n  $repository-&gt;where('ID', 2389)-&gt;commit('title', 'The call of the wild');\n  $this-&gt;assertQueriesCountByMethod(3, 'Acme\\BookRepository', 'commit');\n</code></pre> Parameters <ul> <li><code>int</code> $n - The expected number of queries.</li> <li><code>string</code> $class - The fully qualified name of the class to check.</li> <li><code>string</code> $method - The name of the method to check.</li> <li><code>string</code> $message - An optional message to override the default one.</li></ul> assertQueriesCountByStatement <p>Asserts that n queries starting with the specified statement were made. Queries generated by <code>setUp</code>, <code>tearDown</code> and <code>factory</code> methods are excluded by default.</p> <pre><code>$bookRepository = new Acme\\BookRepository();\n  $repository-&gt;where('ID', 23)-&gt;set('title', 'Peter Pan', $deferred = true);\n  $repository-&gt;where('ID', 89)-&gt;set('title', 'Moby-dick', $deferred = true);\n  $repository-&gt;where('ID', 2389)-&gt;set('title', 'The call of the wild', $deferred = false);\n  $this-&gt;assertQueriesCountByStatement(1, 'INSERT', 'Deferred write should happen on __destruct');\n  Regular expressions must contain delimiters.\n</code></pre> Parameters <ul> <li><code>int</code> $n - The expected number of queries.</li> <li><code>string</code> $statement - A simple string the statement should start with or a valid regular expression.</li> <li><code>string</code> $message - An optional message to override the default one.</li></ul> assertQueriesCountByStatementAndAction <p>Asserts that n queries were made as a consequence of the specified action containing the specified SQL statement. Queries generated by <code>setUp</code>, <code>tearDown</code> and <code>factory</code> methods are excluded by default.</p> <pre><code>add_action( 'edit_post', function($postId){\n  $count = get_option('acme_title_updates_count');\n  update_option('acme_title_updates_count', ++$count);\n  } );\n  wp_delete_post($bookOneId);\n  wp_delete_post($bookTwoId);\n  wp_update_post(['ID' =&gt; $bookThreeId, 'post_title' =&gt; 'New']);\n  $this-&gt;assertQueriesCountByStatementAndAction(2, 'DELETE', 'delete_post');\n  $this-&gt;assertQueriesCountByStatementAndAction(1, 'INSERT', 'edit_post');\n  Regular expressions must contain delimiters.\n</code></pre> Parameters <ul> <li><code>int</code> $n - The expected number of queries.</li> <li><code>string</code> $statement - A simple string the statement should start with or a valid regular expression.</li> <li><code>string</code> $action - The action name, e.g. 'init'.</li> <li><code>string</code> $message - An optional message to override the default one.</li></ul> assertQueriesCountByStatementAndFilter <p>Asserts that n queries were made as a consequence of the specified filter containing the specified SQL statement. Queries generated by <code>setUp</code>, <code>tearDown</code> and <code>factory</code> methods are excluded by default.</p> <pre><code>add_filter('the_title', function($title, $postId){\n  $post = get_post($postId);\n  if($post-&gt;post_type !== 'book'){\n  return $title;\n  }\n  $new = get_option('acme_new_prefix');\n  return \"{$new} - \" . $title;\n  });\n  // Warm up the cache.\n  $title = apply_filters('the_title', get_post($bookOneId)-&gt;post_title, $bookOneId);\n  // Cache is warmed up now.\n  $title = apply_filters('the_title', get_post($bookTwoId)-&gt;post_title, $bookTwoId);\n  $title = apply_filters('the_title', get_post($bookThreeId)-&gt;post_title, $bookThreeId);\n  $this-&gt;assertQueriesCountByStatementAndFilter(1, 'SELECT', 'the_title');\n  Regular expressions must contain delimiters.\n</code></pre> Parameters <ul> <li><code>int</code> $n - The expected number of queries.</li> <li><code>string</code> $statement - A simple string the statement should start with or a valid regular expression.</li> <li><code>string</code> $filter - The filter name, e.g. 'posts_where'.</li> <li><code>string</code> $message - An optional message to override the default one.</li></ul> assertQueriesCountByStatementAndFunction <p>Asserts that n queries were made by the specified function starting with the specified SQL statement. Queries generated by <code>setUp</code>, <code>tearDown</code> and <code>factory</code> methods are excluded by default.</p> <pre><code>wp_insert_post(['post_type' =&gt; 'book', 'post_title' =&gt; 'The Call of the Wild']);\n  wp_insert_post(['post_type' =&gt; 'book', 'post_title' =&gt; 'Alice in Wonderland']);\n  wp_insert_post(['post_type' =&gt; 'book', 'post_title' =&gt; 'The Chocolate Factory']);\n  $this-&gt;assertQueriesCountByStatementAndFunction(3, 'INSERT', 'wp_insert_post');\n  Regular expressions must contain delimiters.\n</code></pre> Parameters <ul> <li><code>int</code> $n - The expected number of queries.</li> <li><code>string</code> $statement - A simple string the statement should start with or a valid regular expression.</li> <li><code>string</code> $function - The fully-qualified function name.</li> <li><code>string</code> $message - An optional message to override the default one.</li></ul> assertQueriesCountByStatementAndMethod <p>Asserts that n queries were made by the specified class method starting with the specified SQL statement. Queries generated by <code>setUp</code>, <code>tearDown</code> and <code>factory</code> methods are excluded by default.</p> <pre><code>Acme\\BookRepository::new(['title' =&gt; 'Alice in Wonderland'])-&gt;commit();\n  Acme\\BookRepository::new(['title' =&gt; 'Moby-Dick'])-&gt;commit();\n  Acme\\BookRepository::new(['title' =&gt; 'The Call of the Wild'])-&gt;commit();\n  $this-&gt;assertQueriesCountByStatementAndMethod(3, 'INSERT', Acme\\BookRepository::class, 'commit');\n  Regular expressions must contain delimiters.\n</code></pre> Parameters <ul> <li><code>int</code> $n - The expected number of queries.</li> <li><code>string</code> $statement - A simple string the statement should start with or a valid regular expression.</li> <li><code>string</code> $class - The fully qualified name of the class to check.</li> <li><code>string</code> $method - The name of the method to check.</li> <li><code>string</code> $message - An optional message to override the default one.</li></ul> countQueries <p>Returns the current number of queries. Set-up and tear-down queries performed by the test case are filtered out.</p> <pre><code>// In a WPTestCase, using the global $wpdb object.\n  $queriesCount = $this-&gt;queries()-&gt;countQueries();\n  // In a WPTestCase, using a custom $wpdb object.\n  $queriesCount = $this-&gt;queries()-&gt;countQueries($customWdbb);\n</code></pre> Parameters <ul> <li><code>\\wpdb/null</code> $wpdb - A specific instance of the <code>wpdb</code> class or <code>null</code> to use the global one.</li></ul> getQueries <p>Returns the queries currently performed by the global database object or the specified one. Set-up and tear-down queries performed by the test case are filtered out.</p> <pre><code>// In a WPTestCase, using the global $wpdb object.\n  $queries = $this-&gt;queries()-&gt;getQueries();\n  // In a WPTestCase, using a custom $wpdb object.\n  $queries = $this-&gt;queries()-&gt;getQueries($customWdbb);\n</code></pre> Parameters <ul> <li><code>null/\\wpdb</code> $wpdb - A specific instance of the <code>wpdb</code> class or <code>null</code> to use the global one.</li></ul> <p>This class extends \\Codeception\\Module</p>"},{"location":"v3/modules/WPWebDriver/","title":"WPWebDriver","text":"<p>This is the documentation for version 3 of the project. The current version is version 4 and the documentation can be found here.</p>"},{"location":"v3/modules/WPWebDriver/#wpwebdriver-module","title":"WpWebDriver module","text":"<p>This module should be used in acceptance tests, see levels of testing for more information.  </p> <p>This module extends the WebDriver module adding WordPress-specific configuration parameters and methods.  </p> <p>The module simulates a user interaction with the site with Javascript support; if you don't need to test your project with Javascript support use the WPBrowser module.  </p>"},{"location":"v3/modules/WPWebDriver/#module-requirements-for-codeception-40","title":"Module requirements for Codeception 4.0+","text":"<p>This module requires the <code>codeception/module-webdriver</code> Composer package to work when wp-browser is used with Codeception 4.0.  </p> <p>To install the package run: </p> <pre><code>composer require --dev codeception/module-webdriver:^1.0\n</code></pre>"},{"location":"v3/modules/WPWebDriver/#configuration","title":"Configuration","text":"<p>Due to the combination of possible browsers, capabilities and configurations, it's not possible to provide an exhaustive coverage of all the possible configuration parameteters here.  </p> <p>Please refer to WebDriver documentation for more information.</p> <ul> <li><code>url</code> required - Start URL of your WordPress project, e.g. <code>http://wp.test</code>.</li> <li><code>adminUsername</code> required - This is the login name, not the \"nice\" name, of the administrator user of the WordPress test site. This will be used to fill the username field in WordPress login page.  </li> <li><code>adminPassword</code> required - This is the the password of the administrator use of the WordPress test site. This will be used to fill the password in WordPress login page.  </li> <li><code>adminPath</code> required - The path, relative to the WordPress test site home URL, to the administration area, usually <code>/wp-admin</code>.</li> <li><code>browser</code> - The browser to use for the tests, e.g. <code>chrome</code> or <code>firefox</code>.</li> <li><code>capabilities</code> - Depending on the browser set in <code>browser</code> this is a list of browser-specific capabilities.</li> </ul>"},{"location":"v3/modules/WPWebDriver/#example-configuration","title":"Example configuration","text":"<pre><code>modules:\n  enabled:\n    - WPWebDriver\n  config:\n    WPWebDriver:\n      url: 'http://wp.test'\n      adminUsername: 'admin'\n      adminPassword: 'password'\n      adminPath: '/wp-admin'\n      browser: chrome\n      host: localhost\n      port: 4444\n      window_size: false #disabled for Chrome driver\n      capabilities:\n        \"goog:chromeOptions\":\n          args:\n            - \"--headless\"\n            - \"--disable-gpu\"\n            - \"--disable-dev-shm-usage\"\n            - \"--proxy-server='direct://'\"\n            - \"--proxy-bypass-list=*\"\n            - \"--no-sandbox\"\n</code></pre>"},{"location":"v3/modules/WPWebDriver/#public-api","title":"Public API","text":"<ul> <li> <p><code>acceptPopup()</code> : <code>void</code>   Accepts the active JavaScript native popup window, as created by <code>window.alert</code>|<code>window.confirm</code>|<code>window.prompt</code>.   Don't confuse popups with modal windows,   as created by various libraries.</p> </li> <li> <p><code>activatePlugin($pluginSlug)</code> : <code>void</code>   In the plugin administration screen activates one or more plugins clicking the \"Activate\" link.</p> </li> </ul> <p>The method will not handle authentication and navigation to the plugins administration page.</p> <ul> <li><code>activateTheme($slug)</code> : <code>void</code>   Activates a theme.</li> </ul> <p>The method will not handle authentication and navigation to the themes administration page.</p> <ul> <li><code>amEditingPostWithId($id)</code> : <code>void</code>   Go to the admin page to edit the post with the specified ID.</li> </ul> <p>The method will not handle authentication the admin area.</p> <ul> <li><code>amEditingUserWithId($id)</code> : <code>void</code>   Go to the admin page to edit the user with the specified ID.</li> </ul> <p>The method will not handle authentication the admin area.</p> <ul> <li><code>amOnAdminAjaxPage([$queryVars])</code> : <code>void</code>   Go to the <code>admin-ajax.php</code> page to start a synchronous, and blocking, <code>GET</code> AJAX request.</li> </ul> <p>The method will not handle authentication, nonces or authorization.</p> <ul> <li><code>amOnAdminPage($page)</code> : <code>void</code>   Go to a page in the admininstration area of the site.</li> </ul> <p>This method will not handle authentication to the administration area.</p> <ul> <li> <p><code>amOnCronPage([$queryVars])</code> : <code>void</code>   Go to the cron page to start a synchronous, and blocking, <code>GET</code> request to the cron script.</p> </li> <li> <p><code>amOnPage($page)</code> : <code>void</code></p> </li> <li> <p><code>amOnPagesPage()</code> : <code>void</code>   Go the \"Pages\" administration screen.</p> </li> </ul> <p>The method will not handle authentication.</p> <ul> <li><code>amOnPluginsPage()</code> : <code>void</code>   Go to the plugins administration screen.</li> </ul> <p>The method will not handle authentication.</p> <ul> <li> <p><code>amOnSubdomain($subdomain)</code> : <code>void</code></p> </li> <li> <p><code>amOnThemesPage()</code> : <code>void</code>   Moves to the themes administration page.</p> </li> <li> <p><code>amOnUrl($url)</code> : <code>void</code></p> </li> <li> <p><code>appendField($field, $value)</code> : <code>void</code>   Append the given text to the given element.   Can also add a selection to a select box.</p> </li> </ul> <pre><code>&lt;?php\n$I-&gt;appendField('#mySelectbox', 'SelectValue');\n$I-&gt;appendField('#myTextField', 'appended');\n?&gt;\n</code></pre> <ul> <li> <p><code>attachFile($field, $filename)</code> : <code>void</code></p> </li> <li> <p><code>cancelPopup()</code> : <code>void</code>   Dismisses the active JavaScript popup, as created by <code>window.alert</code>, <code>window.confirm</code>, or <code>window.prompt</code>.</p> </li> <li> <p><code>checkOption($option)</code> : <code>void</code></p> </li> <li> <p><code>clearField($field)</code> : <code>void</code>   Clears given field which isn't empty.</p> </li> </ul> <pre><code>&lt;?php\n$I-&gt;clearField('#username');\n</code></pre> <ul> <li> <p><code>click($link, [$context])</code> : <code>void</code></p> </li> <li> <p><code>clickWithLeftButton([$cssOrXPath], [$offsetX], [$offsetY])</code> : <code>void</code>   Performs click with the left mouse button on an element.   If the first parameter <code>null</code> then the offset is relative to the actual mouse position.   If the second and third parameters are given,   then the mouse is moved to an offset of the element's top-left corner.   Otherwise, the mouse is moved to the center of the element.</p> </li> </ul> <pre><code>&lt;?php\n$I-&gt;clickWithLeftButton(['css' =&gt; '.checkout']);\n$I-&gt;clickWithLeftButton(null, 20, 50);\n$I-&gt;clickWithLeftButton(['css' =&gt; '.checkout'], 20, 50);\n?&gt;\n</code></pre> <ul> <li><code>clickWithRightButton([$cssOrXPath], [$offsetX], [$offsetY])</code> : <code>void</code>   Performs contextual click with the right mouse button on an element.   If the first parameter <code>null</code> then the offset is relative to the actual mouse position.   If the second and third parameters are given,   then the mouse is moved to an offset of the element's top-left corner.   Otherwise, the mouse is moved to the center of the element.</li> </ul> <pre><code>&lt;?php\n$I-&gt;clickWithRightButton(['css' =&gt; '.checkout']);\n$I-&gt;clickWithRightButton(null, 20, 50);\n$I-&gt;clickWithRightButton(['css' =&gt; '.checkout'], 20, 50);\n?&gt;\n</code></pre> <ul> <li><code>closeTab()</code> : <code>void</code>   Closes current browser tab and switches to previous active tab.</li> </ul> <pre><code>&lt;?php\n$I-&gt;closeTab();\n</code></pre> <ul> <li><code>deactivatePlugin($pluginSlug)</code> : <code>void</code>   In the plugin administration screen deactivate a plugin clicking the \"Deactivate\" link.</li> </ul> <p>The method will not handle authentication and navigation to the plugins administration page.</p> <ul> <li> <p><code>debugWebDriverLogs([?Codeception\\TestInterface $test])</code> : <code>void</code>   Print out latest Selenium Logs in debug mode</p> </li> <li> <p><code>deleteSessionSnapshot($name)</code> : <code>void</code></p> </li> <li> <p><code>dontSee($text, [$selector])</code> : <code>void</code></p> </li> <li> <p><code>dontSeeCheckboxIsChecked($checkbox)</code> : <code>void</code></p> </li> <li> <p><code>dontSeeCookie($cookie, [array $params])</code> : <code>void</code></p> </li> <li> <p><code>dontSeeCurrentUrlEquals($uri)</code> : <code>void</code></p> </li> <li> <p><code>dontSeeCurrentUrlMatches($uri)</code> : <code>void</code></p> </li> <li> <p><code>dontSeeElement($selector, [$attributes])</code> : <code>void</code></p> </li> <li> <p><code>dontSeeElementInDOM($selector, [$attributes])</code> : <code>void</code>   Opposite of <code>seeElementInDOM</code>.</p> </li> <li> <p><code>dontSeeInCurrentUrl($uri)</code> : <code>void</code></p> </li> <li> <p><code>dontSeeInField($field, $value)</code> : <code>void</code></p> </li> <li> <p><code>dontSeeInFormFields($formSelector, array $params)</code> : <code>void</code></p> </li> <li> <p><code>dontSeeInPageSource($text)</code> : <code>void</code>   Checks that the page source doesn't contain the given string.</p> </li> <li> <p><code>dontSeeInPopup($text)</code> : <code>void</code>   Checks that the active JavaScript popup,   as created by <code>window.alert</code>|<code>window.confirm</code>|<code>window.prompt</code>, does NOT contain the given string.</p> </li> <li> <p><code>dontSeeInSource($raw)</code> : <code>void</code></p> </li> <li> <p><code>dontSeeInTitle($title)</code> : <code>void</code></p> </li> <li> <p><code>dontSeeLink($text, [$url])</code> : <code>void</code></p> </li> <li> <p><code>dontSeeOptionIsSelected($selector, $optionText)</code> : <code>void</code></p> </li> <li> <p><code>dontSeePluginInstalled($pluginSlug)</code> : <code>void</code>   Assert a plugin is not installed in the plugins administration screen.</p> </li> </ul> <p>The method will not handle authentication and navigation to the plugin administration screen.</p> <ul> <li> <p><code>doubleClick($cssOrXPath)</code> : <code>void</code>   Performs a double-click on an element matched by CSS or XPath.</p> </li> <li> <p><code>dragAndDrop($source, $target)</code> : <code>void</code>   Performs a simple mouse drag-and-drop operation.</p> </li> </ul> <pre><code>&lt;?php\n$I-&gt;dragAndDrop('#drag', '#drop');\n?&gt;\n</code></pre> <ul> <li><code>executeAsyncJS($script, [array $arguments])</code> : <code>void</code>   Executes asynchronous JavaScript.   A callback should be executed by JavaScript to exit from a script.   Callback is passed as a last element in <code>arguments</code> array.   Additional arguments can be passed as array in second parameter.</li> </ul> <pre><code>// wait for 1200 milliseconds my running `setTimeout`\n* $I-&gt;executeAsyncJS('setTimeout(arguments[0], 1200)');\n\n$seconds = 1200; // or seconds are passed as argument\n$I-&gt;executeAsyncJS('setTimeout(arguments[1], arguments[0])', [$seconds]);\n</code></pre> <ul> <li><code>executeInSelenium(Closure $function)</code> : <code>void</code>   Low-level API method.   If Codeception commands are not enough, this allows you to use Selenium WebDriver methods directly:</li> </ul> <pre><code>$I-&gt;executeInSelenium(function(\\Facebook\\WebDriver\\Remote\\RemoteWebDriver $webdriver) {\n  $webdriver-&gt;get('http://google.com');\n});\n</code></pre> <p>This runs in the context of the   RemoteWebDriver class.   Try not to use this command on a regular basis.   If Codeception lacks a feature you need, please implement it and submit a patch.</p> <ul> <li><code>executeJS($script, [array $arguments])</code> : <code>void</code>   Executes custom JavaScript.</li> </ul> <p>This example uses jQuery to get a value and assigns that value to a PHP variable:</p> <pre><code>&lt;?php\n$myVar = $I-&gt;executeJS('return $(\"#myField\").val()');\n\n// additional arguments can be passed as array\n// Example shows `Hello World` alert:\n$I-&gt;executeJS(\"window.alert(arguments[0])\", ['Hello world']);\n</code></pre> <ul> <li> <p><code>fillField($field, $value)</code> : <code>void</code></p> </li> <li> <p><code>grabActiveTheme()</code> : <code>void</code>   Returns the slug of the currently active themes.</p> </li> </ul> <p>The method will not handle authentication and navigation to the themes administration page.</p> <ul> <li> <p><code>grabAttributeFrom($cssOrXpath, $attribute)</code> : <code>void</code></p> </li> <li> <p><code>grabAvailableThemes([$classes])</code> : <code>void</code>   Returns the list of available themes.</p> </li> </ul> <p>The method will not handle authentication and navigation to the themes administration page.</p> <ul> <li> <p><code>grabCookie($cookie, [array $params])</code> : <code>void</code></p> </li> <li> <p><code>grabCookiesWithPattern($cookiePattern)</code> : <code>void</code>   Returns all the cookies whose name matches a regex pattern.</p> </li> <li> <p><code>grabFromCurrentUrl([$uri])</code> : <code>void</code></p> </li> <li> <p><code>grabFullUrl()</code> : <code>void</code>   Grabs the current page full URL including the query vars.</p> </li> <li> <p><code>grabMultiple($cssOrXpath, [$attribute])</code> : <code>void</code></p> </li> <li> <p><code>grabPageSource()</code> : <code>void</code>   Grabs current page source code.</p> </li> <li> <p><code>grabTextFrom($cssOrXPathOrRegex)</code> : <code>void</code></p> </li> <li> <p><code>grabValueFrom($field)</code> : <code>void</code></p> </li> <li> <p><code>grabWordPressTestCookie([$name])</code> : <code>void</code>   Returns WordPress default test cookie object if present.</p> </li> <li> <p><code>loadSessionSnapshot($name)</code> : <code>void</code></p> </li> <li> <p><code>logOut([$redirectTo])</code> : <code>void</code>   Navigate to the default WordPress logout page and click the logout link.</p> </li> <li> <p><code>loginAs($username, $password, [$timeout], [$maxAttempts])</code> : <code>void</code>   Login as the specified user.</p> </li> </ul> <p>The method will not follow redirection, after the login, to any page.   Depending on the driven browser the login might be \"too fast\" and the server might have not   replied with valid cookies yet; in that case the method will re-attempt the login to obtain   the cookies.</p> <ul> <li><code>loginAsAdmin([$timeout], [$maxAttempts])</code> : <code>void</code>   Login as the administrator user using the credentials specified in the module configuration.</li> </ul> <p>The method will not follow redirection, after the login, to any page.</p> <ul> <li><code>makeElementScreenshot($selector, [$name])</code> : <code>void</code>   Takes a screenshot of an element of the current window and saves it to <code>tests/_output/debug</code>.</li> </ul> <pre><code>&lt;?php\n$I-&gt;amOnPage('/user/edit');\n$I-&gt;makeElementScreenshot('#dialog', 'edit_page');\n// saved to: tests/_output/debug/edit_page.png\n$I-&gt;makeElementScreenshot('#dialog');\n// saved to: tests/_output/debug/2017-05-26_14-24-11_4b3403665fea6.png\n</code></pre> <ul> <li> <p><code>makeHtmlSnapshot([$name])</code> : <code>void</code></p> </li> <li> <p><code>makeScreenshot([$name])</code> : <code>void</code>   Takes a screenshot of the current window and saves it to <code>tests/_output/debug</code>.</p> </li> </ul> <pre><code>&lt;?php\n$I-&gt;amOnPage('/user/edit');\n$I-&gt;makeScreenshot('edit_page');\n// saved to: tests/_output/debug/edit_page.png\n$I-&gt;makeScreenshot();\n// saved to: tests/_output/debug/2017-05-26_14-24-11_4b3403665fea6.png\n</code></pre> <ul> <li> <p><code>maximizeWindow()</code> : <code>void</code>   Maximizes the current window.</p> </li> <li> <p><code>moveBack()</code> : <code>void</code>   Moves back in history.</p> </li> <li> <p><code>moveForward()</code> : <code>void</code>   Moves forward in history.</p> </li> <li> <p><code>moveMouseOver([$cssOrXPath], [$offsetX], [$offsetY])</code> : <code>void</code>   Move mouse over the first element matched by the given locator.   If the first parameter null then the page is used.   If the second and third parameters are given,   then the mouse is moved to an offset of the element's top-left corner.   Otherwise, the mouse is moved to the center of the element.</p> </li> </ul> <pre><code>&lt;?php\n$I-&gt;moveMouseOver(['css' =&gt; '.checkout']);\n$I-&gt;moveMouseOver(null, 20, 50);\n$I-&gt;moveMouseOver(['css' =&gt; '.checkout'], 20, 50);\n?&gt;\n</code></pre> <ul> <li><code>openNewTab()</code> : <code>void</code>   Opens a new browser tab and switches to it.</li> </ul> <p><pre><code>&lt;?php\n$I-&gt;openNewTab();\n</code></pre>   The tab is opened with JavaScript's <code>window.open()</code>, which means:   * Some adblockers might restrict it.   * The sessionStorage is copied to the new tab (contrary to a tab that was manually opened by the user)</p> <ul> <li><code>performOn($element, $actions, [$timeout])</code> : <code>void</code>   Waits for element and runs a sequence of actions inside its context.   Actions can be defined with array, callback, or <code>Codeception\\Util\\ActionSequence</code> instance.</li> </ul> <p>Actions as array are recommended for simple to combine \"waitForElement\" with assertions;   <code>waitForElement($el)</code> and <code>see('text', $el)</code> can be simplified to:</p> <pre><code>&lt;?php\n$I-&gt;performOn($el, ['see' =&gt; 'text']);\n</code></pre> <p>List of actions can be pragmatically build using <code>Codeception\\Util\\ActionSequence</code>:</p> <pre><code>&lt;?php\n$I-&gt;performOn('.model', ActionSequence::build()\n    -&gt;see('Warning')\n    -&gt;see('Are you sure you want to delete this?')\n    -&gt;click('Yes')\n);\n</code></pre> <p>Actions executed from array or ActionSequence will print debug output for actions, and adds an action name to   exception on failure.</p> <p>Whenever you need to define more actions a callback can be used. A WebDriver module is passed for argument:</p> <pre><code>&lt;?php\n$I-&gt;performOn('.rememberMe', function (WebDriver $I) {\n     $I-&gt;see('Remember me next time');\n     $I-&gt;seeElement('#LoginForm_rememberMe');\n     $I-&gt;dontSee('Login');\n});\n</code></pre> <p>In 3rd argument you can set number a seconds to wait for element to appear</p> <ul> <li><code>pressKey($element, $char)</code> : <code>void</code>   Presses the given key on the given element.   To specify a character and modifier (e.g. Ctrl, Alt, Shift, Meta), pass an array for <code>$char</code> with   the modifier as the first element and the character as the second.   For special keys, use the constants from <code>Facebook\\WebDriver\\WebDriverKeys</code>.</li> </ul> <pre><code>&lt;?php\n// &lt;input id=\"page\" value=\"old\" /&gt;\n$I-&gt;pressKey('#page','a'); // =&gt; olda\n$I-&gt;pressKey('#page',array('ctrl','a'),'new'); //=&gt; new\n$I-&gt;pressKey('#page',array('shift','111'),'1','x'); //=&gt; old!!!1x\n$I-&gt;pressKey('descendant-or-self::*[@id='page']','u'); //=&gt; oldu\n$I-&gt;pressKey('#name', array('ctrl', 'a'), \\Facebook\\WebDriver\\WebDriverKeys::DELETE); //=&gt;''\n?&gt;\n</code></pre> <ul> <li> <p><code>reloadPage()</code> : <code>void</code>   Reloads the current page.</p> </li> <li> <p><code>resetCookie($cookie, [array $params])</code> : <code>void</code></p> </li> <li> <p><code>resizeWindow($width, $height)</code> : <code>void</code>   Resize the current window.</p> </li> </ul> <pre><code>&lt;?php\n$I-&gt;resizeWindow(800, 600);\n</code></pre> <ul> <li> <p><code>saveSessionSnapshot($name)</code> : <code>void</code></p> </li> <li> <p><code>scrollTo($selector, [$offsetX], [$offsetY])</code> : <code>void</code>   Move to the middle of the given element matched by the given locator.   Extra shift, calculated from the top-left corner of the element,   can be set by passing $offsetX and $offsetY parameters.</p> </li> </ul> <pre><code>&lt;?php\n$I-&gt;scrollTo(['css' =&gt; '.checkout'], 20, 50);\n?&gt;\n</code></pre> <ul> <li> <p><code>see($text, [$selector])</code> : <code>void</code></p> </li> <li> <p><code>seeCheckboxIsChecked($checkbox)</code> : <code>void</code></p> </li> <li> <p><code>seeCookie($cookie, [array $params])</code> : <code>void</code></p> </li> <li> <p><code>seeCurrentUrlEquals($uri)</code> : <code>void</code></p> </li> <li> <p><code>seeCurrentUrlMatches($uri)</code> : <code>void</code></p> </li> <li> <p><code>seeElement($selector, [$attributes])</code> : <code>void</code></p> </li> <li> <p><code>seeElementInDOM($selector, [$attributes])</code> : <code>void</code>   Checks that the given element exists on the page, even it is invisible.</p> </li> </ul> <pre><code>&lt;?php\n$I-&gt;seeElementInDOM('//form/input[type=hidden]');\n?&gt;\n</code></pre> <ul> <li><code>seeErrorMessage([$classes])</code> : <code>void</code>   In an administration screen look for an error admin notice.</li> </ul> <p>The check is class-based to decouple from internationalization.   The method will not handle authentication and navigation the administration area.</p> <ul> <li> <p><code>seeInCurrentUrl($uri)</code> : <code>void</code></p> </li> <li> <p><code>seeInField($field, $value)</code> : <code>void</code></p> </li> <li> <p><code>seeInFormFields($formSelector, array $params)</code> : <code>void</code></p> </li> <li> <p><code>seeInPageSource($text)</code> : <code>void</code>   Checks that the page source contains the given string.</p> </li> </ul> <pre><code>&lt;?php\n$I-&gt;seeInPageSource('&lt;link rel=\"apple-touch-icon\"');\n</code></pre> <ul> <li> <p><code>seeInPopup($text)</code> : <code>void</code>   Checks that the active JavaScript popup,   as created by <code>window.alert</code>|<code>window.confirm</code>|<code>window.prompt</code>, contains the given string.</p> </li> <li> <p><code>seeInSource($raw)</code> : <code>void</code></p> </li> <li> <p><code>seeInTitle($title)</code> : <code>void</code></p> </li> <li> <p><code>seeLink($text, [$url])</code> : <code>void</code></p> </li> <li> <p><code>seeMessage([$classes])</code> : <code>void</code>   In an administration screen look for an admin notice.</p> </li> </ul> <p>The check is class-based to decouple from internationalization.   The method will not handle authentication and navigation the administration area.</p> <ul> <li> <p><code>seeNumberOfElements($selector, $expected)</code> : <code>void</code></p> </li> <li> <p><code>seeNumberOfElementsInDOM($selector, $expected)</code> : <code>void</code></p> </li> <li> <p><code>seeNumberOfTabs($number)</code> : <code>void</code>   Checks current number of opened tabs</p> </li> </ul> <pre><code>&lt;?php\n$I-&gt;seeNumberOfTabs(2);\n</code></pre> <ul> <li> <p><code>seeOptionIsSelected($selector, $optionText)</code> : <code>void</code></p> </li> <li> <p><code>seePluginActivated($pluginSlug)</code> : <code>void</code>   Assert a plugin is activated in the plugin administration screen.</p> </li> </ul> <p>The method will not handle authentication and navigation to the plugin administration screen.</p> <ul> <li><code>seePluginDeactivated($pluginSlug)</code> : <code>void</code>   Assert a plugin is not activated in the plugins administration screen.</li> </ul> <p>The method will not handle authentication and navigation to the plugin administration screen.</p> <ul> <li><code>seePluginInstalled($pluginSlug)</code> : <code>void</code>   Assert a plugin is installed, no matter its activation status, in the plugin administration screen.</li> </ul> <p>The method will not handle authentication and navigation to the plugin administration screen.</p> <ul> <li><code>seeThemeActivated($slug)</code> : <code>void</code>   Verifies that a theme is active.</li> </ul> <p>The method will not handle authentication and navigation to the themes administration page.</p> <ul> <li><code>seeWpDiePage()</code> : <code>void</code>   Checks that the current page is one generated by the <code>wp_die</code> function.</li> </ul> <p>The method will try to identify the page based on the default WordPress die page HTML attributes.</p> <ul> <li> <p><code>selectOption($select, $option)</code> : <code>void</code></p> </li> <li> <p><code>setCookie($cookie, $value, [array $params], [$showDebug])</code> : <code>void</code></p> </li> <li> <p><code>submitForm($selector, array $params, [$button])</code> : <code>void</code>   Submits the given form on the page, optionally with the given form   values.  Give the form fields values as an array. Note that hidden fields   can't be accessed.</p> </li> </ul> <p>Skipped fields will be filled by their values from the page.   You don't need to click the 'Submit' button afterwards.   This command itself triggers the request to form's action.</p> <p>You can optionally specify what button's value to include   in the request with the last parameter as an alternative to   explicitly setting its value in the second parameter, as   button values are not otherwise included in the request.</p> <p>Examples:</p> <pre><code>&lt;?php\n$I-&gt;submitForm('#login', [\n    'login' =&gt; 'davert',\n    'password' =&gt; '123456'\n]);\n// or\n$I-&gt;submitForm('#login', [\n    'login' =&gt; 'davert',\n    'password' =&gt; '123456'\n], 'submitButtonName');\n</code></pre> <p>For example, given this sample \"Sign Up\" form:</p> <pre><code>&lt;form action=\"/sign_up\"&gt;\n    Login:\n    &lt;input type=\"text\" name=\"user[login]\" /&gt;&lt;br/&gt;\n    Password:\n    &lt;input type=\"password\" name=\"user[password]\" /&gt;&lt;br/&gt;\n    Do you agree to our terms?\n    &lt;input type=\"checkbox\" name=\"user[agree]\" /&gt;&lt;br/&gt;\n    Select pricing plan:\n    &lt;select name=\"plan\"&gt;\n        &lt;option value=\"1\"&gt;Free&lt;/option&gt;\n        &lt;option value=\"2\" selected=\"selected\"&gt;Paid&lt;/option&gt;\n    &lt;/select&gt;\n    &lt;input type=\"submit\" name=\"submitButton\" value=\"Submit\" /&gt;\n&lt;/form&gt;\n</code></pre> <p>You could write the following to submit it:</p> <p><pre><code>&lt;?php\n$I-&gt;submitForm(\n    '#userForm',\n    [\n        'user[login]' =&gt; 'Davert',\n        'user[password]' =&gt; '123456',\n        'user[agree]' =&gt; true\n    ],\n    'submitButton'\n);\n</code></pre>   Note that \"2\" will be the submitted value for the \"plan\" field, as it is   the selected option.</p> <p>Also note that this differs from PhpBrowser, in that   <code>'user' =&gt; [ 'login' =&gt; 'Davert' ]</code> is not supported at the moment.   Named array keys must be included in the name as above.</p> <p>Pair this with seeInFormFields for quick testing magic.</p> <pre><code>&lt;?php\n$form = [\n     'field1' =&gt; 'value',\n     'field2' =&gt; 'another value',\n     'checkbox1' =&gt; true,\n     // ...\n];\n$I-&gt;submitForm('//form[@id=my-form]', $form, 'submitButton');\n// $I-&gt;amOnPage('/path/to/form-page') may be needed\n$I-&gt;seeInFormFields('//form[@id=my-form]', $form);\n?&gt;\n</code></pre> <p>Parameter values must be set to arrays for multiple input fields   of the same name, or multi-select combo boxes.  For checkboxes,   either the string value can be used, or boolean values which will   be replaced by the checkbox's value in the DOM.</p> <pre><code>&lt;?php\n$I-&gt;submitForm('#my-form', [\n     'field1' =&gt; 'value',\n     'checkbox' =&gt; [\n         'value of first checkbox',\n         'value of second checkbox',\n     ],\n     'otherCheckboxes' =&gt; [\n         true,\n         false,\n         false,\n     ],\n     'multiselect' =&gt; [\n         'first option value',\n         'second option value',\n     ]\n]);\n?&gt;\n</code></pre> <p>Mixing string and boolean values for a checkbox's value is not supported   and may produce unexpected results.</p> <p>Field names ending in \"[]\" must be passed without the trailing square   bracket characters, and must contain an array for its value.  This allows   submitting multiple values with the same name, consider:</p> <pre><code>$I-&gt;submitForm('#my-form', [\n    'field[]' =&gt; 'value',\n    'field[]' =&gt; 'another value', // 'field[]' is already a defined key\n]);\n</code></pre> <p>The solution is to pass an array value:</p> <pre><code>// this way both values are submitted\n$I-&gt;submitForm('#my-form', [\n    'field' =&gt; [\n        'value',\n        'another value',\n    ]\n]);\n</code></pre> <p>The <code>$button</code> parameter can be either a string, an array or an instance   of Facebook\\WebDriver\\WebDriverBy. When it is a string, the   button will be found by its \"name\" attribute. If $button is an   array then it will be treated as a strict selector and a WebDriverBy   will be used verbatim.</p> <p>For example, given the following HTML:</p> <pre><code>&lt;input type=\"submit\" name=\"submitButton\" value=\"Submit\" /&gt;\n</code></pre> <p><code>$button</code> could be any one of the following:   - 'submitButton'   - ['name' =&gt; 'submitButton']   - WebDriverBy::name('submitButton')</p> <ul> <li><code>switchToFrame([$locator])</code> : <code>void</code>   Switch to another frame on the page.</li> </ul> <p>Example:   <pre><code>&lt;frame name=\"another_frame\" id=\"fr1\" src=\"http://example.com\"&gt;\n</code></pre></p> <pre><code>&lt;?php\n# switch to frame by name\n$I-&gt;switchToFrame(\"another_frame\");\n# switch to frame by CSS or XPath\n$I-&gt;switchToFrame(\"#fr1\");\n# switch to parent page\n$I-&gt;switchToFrame();\n</code></pre> <ul> <li><code>switchToIFrame([$locator])</code> : <code>void</code>   Switch to another iframe on the page.</li> </ul> <p>Example:   <pre><code>&lt;iframe name=\"another_frame\" id=\"fr1\" src=\"http://example.com\"&gt;\n</code></pre></p> <pre><code>&lt;?php\n# switch to iframe by name\n$I-&gt;switchToIFrame(\"another_frame\");\n# switch to iframe by CSS or XPath\n$I-&gt;switchToIFrame(\"#fr1\");\n# switch to parent page\n$I-&gt;switchToIFrame();\n</code></pre> <ul> <li><code>switchToNextTab([$offset])</code> : <code>void</code>   Switches to next browser tab.   An offset can be specified.</li> </ul> <pre><code>&lt;?php\n// switch to next tab\n$I-&gt;switchToNextTab();\n// switch to 2nd next tab\n$I-&gt;switchToNextTab(2);\n</code></pre> <ul> <li><code>switchToPreviousTab([$offset])</code> : <code>void</code>   Switches to previous browser tab.   An offset can be specified.</li> </ul> <pre><code>&lt;?php\n// switch to previous tab\n$I-&gt;switchToPreviousTab();\n// switch to 2nd previous tab\n$I-&gt;switchToPreviousTab(2);\n</code></pre> <ul> <li><code>switchToWindow([$name])</code> : <code>void</code>   Switch to another window identified by name.</li> </ul> <p>The window can only be identified by name. If the $name parameter is blank, the parent window will be used.</p> <p>Example:   <pre><code>&lt;input type=\"button\" value=\"Open window\" onclick=\"window.open('http://example.com', 'another_window')\"&gt;\n</code></pre></p> <pre><code>&lt;?php\n$I-&gt;click(\"Open window\");\n# switch to another window\n$I-&gt;switchToWindow(\"another_window\");\n# switch to parent window\n$I-&gt;switchToWindow();\n?&gt;\n</code></pre> <p>If the window has no name, match it by switching to next active tab using <code>switchToNextTab</code> method.</p> <p>Or use native Selenium functions to get access to all opened windows:</p> <pre><code>&lt;?php\n$I-&gt;executeInSelenium(function (\\Facebook\\WebDriver\\Remote\\RemoteWebDriver $webdriver) {\n     $handles=$webdriver-&gt;getWindowHandles();\n     $last_window = end($handles);\n     $webdriver-&gt;switchTo()-&gt;window($last_window);\n});\n?&gt;\n</code></pre> <ul> <li><code>type($text, [$delay])</code> : <code>void</code>   Type in characters on active element.   With a second parameter you can specify delay between key presses.</li> </ul> <pre><code>&lt;?php\n// activate input element\n$I-&gt;click('#input');\n\n// type text in active element\n$I-&gt;type('Hello world');\n\n// type text with a 1sec delay between chars\n$I-&gt;type('Hello World', 1);\n</code></pre> <p>This might be useful when you an input reacts to typing and you need to slow it down to emulate human behavior.   For instance, this is how Credit Card fields can be filled in.</p> <ul> <li> <p><code>typeInPopup($keys)</code> : <code>void</code>   Enters text into a native JavaScript prompt popup, as created by <code>window.prompt</code>.</p> </li> <li> <p><code>uncheckOption($option)</code> : <code>void</code></p> </li> <li> <p><code>unselectOption($select, $option)</code> : <code>void</code>   Unselect an option in the given select box.</p> </li> <li> <p><code>wait($timeout)</code> : <code>void</code>   Wait for $timeout seconds.</p> </li> <li> <p><code>waitForElement($element, [$timeout])</code> : <code>void</code>   Waits up to $timeout seconds for an element to appear on the page.   If the element doesn't appear, a timeout exception is thrown.</p> </li> </ul> <pre><code>&lt;?php\n$I-&gt;waitForElement('#agree_button', 30); // secs\n$I-&gt;click('#agree_button');\n?&gt;\n</code></pre> <ul> <li><code>waitForElementChange($element, Closure $callback, [$timeout])</code> : <code>void</code>   Waits up to $timeout seconds for the given element to change.   Element \"change\" is determined by a callback function which is called repeatedly   until the return value evaluates to true.</li> </ul> <pre><code>&lt;?php\nuse \\Facebook\\WebDriver\\WebDriverElement\n$I-&gt;waitForElementChange('#menu', function(WebDriverElement $el) {\n    return $el-&gt;isDisplayed();\n}, 100);\n?&gt;\n</code></pre> <ul> <li><code>waitForElementClickable($element, [$timeout])</code> : <code>void</code>   Waits up to $timeout seconds for the given element to be clickable.   If element doesn't become clickable, a timeout exception is thrown.</li> </ul> <pre><code>&lt;?php\n$I-&gt;waitForElementClickable('#agree_button', 30); // secs\n$I-&gt;click('#agree_button');\n?&gt;\n</code></pre> <ul> <li><code>waitForElementNotVisible($element, [$timeout])</code> : <code>void</code>   Waits up to $timeout seconds for the given element to become invisible.   If element stays visible, a timeout exception is thrown.</li> </ul> <pre><code>&lt;?php\n$I-&gt;waitForElementNotVisible('#agree_button', 30); // secs\n?&gt;\n</code></pre> <ul> <li><code>waitForElementVisible($element, [$timeout])</code> : <code>void</code>   Waits up to $timeout seconds for the given element to be visible on the page.   If element doesn't appear, a timeout exception is thrown.</li> </ul> <pre><code>&lt;?php\n$I-&gt;waitForElementVisible('#agree_button', 30); // secs\n$I-&gt;click('#agree_button');\n?&gt;\n</code></pre> <ul> <li><code>waitForJS($script, [$timeout])</code> : <code>void</code>   Executes JavaScript and waits up to $timeout seconds for it to return true.</li> </ul> <p>In this example we will wait up to 60 seconds for all jQuery AJAX requests to finish.</p> <pre><code>&lt;?php\n$I-&gt;waitForJS(\"return $.active == 0;\", 60);\n?&gt;\n</code></pre> <ul> <li> <p><code>waitForJqueryAjax([$time])</code> : <code>void</code>   Waits for any jQuery triggered AJAX request to be resolved.</p> </li> <li> <p><code>waitForText($text, [$timeout], [$selector])</code> : <code>void</code>   Waits up to $timeout seconds for the given string to appear on the page.</p> </li> </ul> <p>Can also be passed a selector to search in, be as specific as possible when using selectors.   waitForText() will only watch the first instance of the matching selector / text provided.   If the given text doesn't appear, a timeout exception is thrown.</p> <pre><code>&lt;?php\n$I-&gt;waitForText('foo', 30); // secs\n$I-&gt;waitForText('foo', 30, '.title'); // secs\n?&gt;\n</code></pre> <p>This class extends \\Codeception\\Module\\WebDriver</p> <p>This class implements \\Codeception\\Lib\\Interfaces\\RequiresPackage, \\Codeception\\Lib\\Interfaces\\ConflictsWithModule, \\Codeception\\Lib\\Interfaces\\ElementLocator, \\Codeception\\Lib\\Interfaces\\PageSourceSaver, \\Codeception\\Lib\\Interfaces\\ScreenshotSaver, \\Codeception\\Lib\\Interfaces\\SessionSnapshot, \\Codeception\\Lib\\Interfaces\\MultiSession, \\Codeception\\Lib\\Interfaces\\Remote, \\Codeception\\Lib\\Interfaces\\Web</p>"},{"location":"v3/modules/WordPress/","title":"WordPress","text":"<p>This is the documentation for version 3 of the project. The current version is version 4 and the documentation can be found here.</p>"},{"location":"v3/modules/WordPress/#wordpress-module","title":"WordPress module","text":"<p>This module requires good knowledge and attention to be used effectively; you can replace it with a combination of the WPBrowser module together with the WPLoader module in loadOnly mode. This module should be used in functional tests, see levels of testing for more information. This module provides a middle-ground, in terms of testing and effects, between the fully isolated approach of the WPBrowser module and the fully integrated approach of the WPLoader module with loadOnly set to <code>false</code>. It allows to interact with WordPress on a very high level, using methods like <code>$I-&gt;loginAs()</code> or <code>$I-&gt;amOnPage()</code> as you could do with the <code>WPBrowser</code> module while also loading WordPress in the same variable scope as the tests as the <code>WPLoader</code> module would. Due to WordPress reliance on constants, globals and side-effects this module will make requests to WordPress in an insulated manner and reproduce WordPress environment (globals and super-globals) after each response in the tests variable scope. The module simulates a user interaction with the site without Javascript support, use the WPWebDriver module for any kind of testing that requires Javascript-based interaction with the site.</p>"},{"location":"v3/modules/WordPress/#module-requirements-for-codeception-40","title":"Module requirements for Codeception 4.0+","text":"<p>This module requires the <code>codeception/lib-innerbrowser</code> Composer package to work when wp-browser is used with Codeception 4.0.  </p> <p>To install the package run: </p> <pre><code>composer require --dev codeception/lib-innerbrowser:^1.0\n</code></pre>"},{"location":"v3/modules/WordPress/#detecting-requests-coming-from-this-module","title":"Detecting requests coming from this module","text":"<p>When it runs this module will set the <code>WPBROWSER_HOST_REQUEST</code> environment variable. You can detect and use that information to, as an example, use the correct database in your test site <code>wp-config.php</code> file: <pre><code>&lt;?php\nif ( \n    // Custom header.\n    isset( $_SERVER['HTTP_X_TESTING'] )\n    // Custom user agent.\n    || ( isset( $_SERVER['HTTP_USER_AGENT'] ) &amp;&amp; $_SERVER['HTTP_USER_AGENT'] === 'wp-browser' )\n    // The env var set by the WPClIr or WordPress modules.\n    || getenv( 'WPBROWSER_HOST_REQUEST' )\n) {\n    // Use the test database if the request comes from a test.\n    define( 'DB_NAME', 'wordpress_test' );\n} else {\n    // Else use the default one.\n    define( 'DB_NAME', 'wordpress' );\n}\n</code></pre></p>"},{"location":"v3/modules/WordPress/#configuration","title":"Configuration","text":"<ul> <li><code>wpRootFolder</code> required The absolute, or relative to the project root folder, path to the root WordPress installation folder. The WordPress installation root folder is the one that contains the <code>wp-load.php</code> file.</li> <li><code>adminUsername</code> required - This is the login name, not the \"nice\" name, of the administrator user of the WordPress test site. This will be used to fill the username field in WordPress login page.  </li> <li><code>adminPassword</code> required - This is the the password of the administrator use of the WordPress test site. This will be used to fill the password in WordPress login page.  </li> <li><code>adminPath</code> required - The path, relative to the WordPress test site home URL, to the administration area, usually <code>/wp-admin</code>.</li> </ul>"},{"location":"v3/modules/WordPress/#example-configuration","title":"Example configuration","text":"<pre><code>  modules:\n      enabled:\n          - WordPress\n      config:\n          WordPress:\n              wpRootFolder: \"/var/www/wordpress\"\n              adminUsername: 'admin'\n              adminPassword: 'password'\n              adminPath: '/wp-admin'\n</code></pre>"},{"location":"v3/modules/WordPress/#public-api","title":"Public API","text":"<ul> <li> amEditingPostWithId </li> <li> amOnAdminAjaxPage </li> <li> amOnAdminPage </li> <li> amOnCronPage </li> <li> amOnPage </li> <li> amOnPagesPage </li> <li> amOnPluginsPage </li> <li> dontSeePluginInstalled </li> <li> extractCookie </li> <li> getResponseContent </li> <li> getWpRootFolder </li> <li> grabWordPressTestCookie </li> <li> logOut </li> <li> loginAs </li> <li> loginAsAdmin </li> <li> seeErrorMessage </li> <li> seeMessage </li> <li> seePluginActivated </li> <li> seePluginDeactivated </li> <li> seePluginInstalled </li> <li> seeWpDiePage </li> </ul> amEditingPostWithId <p>Go to the admin page to edit the post with the specified ID. The method will not handle authentication the admin area.</p> <pre><code>$I-&gt;loginAsAdmin();\n  $postId = $I-&gt;havePostInDatabase();\n  $I-&gt;amEditingPostWithId($postId);\n  $I-&gt;fillField('post_title', 'Post title');\n</code></pre> Parameters <ul> <li><code>int</code> $id - The post ID.</li></ul> amOnAdminAjaxPage <p>Go to the <code>admin-ajax.php</code> page to start a synchronous, and blocking, <code>GET</code> AJAX request. The method will not handle authentication, nonces or authorization.</p> <pre><code>$I-&gt;amOnAdminAjaxPage(['action' =&gt; 'my-action', 'data' =&gt; ['id' =&gt; 23], 'nonce' =&gt; $nonce]);\n</code></pre> Parameters <ul> <li><code>string/\\Codeception\\Module\\array $queryVars - A string or array of query variables to append to the AJAX path. amOnAdminPage <p>Go to a page in the admininstration area of the site.</p> <pre><code>$I-&gt;loginAs('user', 'password');\n  // Go to the plugins management screen.\n  $I-&gt;amOnAdminPage('/plugins.php');\n</code></pre> Parameters <ul> <li><code>string</code> $page - The path, relative to the admin area URL, to the page.</li></ul> amOnCronPage <p>Go to the cron page to start a synchronous, and blocking, <code>GET</code> request to the cron script.</p> <pre><code>// Triggers the cron job with an optional query argument.\n  $I-&gt;amOnCronPage('/?some-query-var=some-value');\n</code></pre> Parameters <ul> <li><code>string/\\Codeception\\Module\\array $queryVars - A string or array of query variables to append to the AJAX path. amOnPage <p>Go to a page on the site. The module will try to reach the page, relative to the URL specified in the module configuration, without applying any permalink resolution.</p> <pre><code>// Go the the homepage.\n  $I-&gt;amOnPage('/');\n  // Go to the single page of post with ID 23.\n  $I-&gt;amOnPage('/?p=23');\n  // Go to search page for the string \"foo\".\n  $I-&gt;amOnPage('/?s=foo');\n</code></pre> Parameters <ul> <li><code>string</code> $page - The path to the page, relative to the the root URL.</li></ul> amOnPagesPage <p>Go the \"Pages\" administration screen. The method will not handle authentication.</p> <pre><code>$I-&gt;loginAsAdmin();\n  $I-&gt;amOnPagesPage();\n  $I-&gt;see('Add New');\n</code></pre> amOnPluginsPage <p>Go to the plugins administration screen. The method will not handle authentication.</p> <pre><code>$I-&gt;loginAsAdmin();\n  $I-&gt;amOnPluginsPage();\n  $I-&gt;activatePlugin('hello-dolly');\n</code></pre> dontSeePluginInstalled <p>Assert a plugin is not installed in the plugins administration screen. The method will not handle authentication and navigation to the plugin administration screen.</p> <pre><code>$I-&gt;loginAsAdmin();\n  $I-&gt;amOnPluginsPage();\n  $I-&gt;dontSeePluginInstalled('my-plugin');\n</code></pre> Parameters <ul> <li><code>string</code> $pluginSlug - The plugin slug, like \"hello-dolly\".</li></ul> extractCookie <p>Grab a cookie value from the current session, sets it in the $_COOKIE array and returns its value. This method utility is to get, in the scope of test code, the value of a cookie set during the tests.</p> <pre><code>$id = $I-&gt;haveUserInDatabase('user', 'subscriber', ['user_pass' =&gt; 'pass']);\n  $I-&gt;loginAs('user', 'pass');\n  // The cookie is now set in the `$_COOKIE` super-global.\n  $I-&gt;extractCookie(LOGGED_IN_COOKIE);\n  // Generate a nonce using WordPress methods (see WPLoader in loadOnly mode) with correctly set context.\n  wp_set_current_user($id);\n  $nonce = wp_create_nonce('wp_rest');\n  // Use the generated nonce to make a request to the the REST API.\n  $I-&gt;haveHttpHeader('X-WP-Nonce', $nonce);\n</code></pre> Parameters <ul> <li><code>string</code> $cookie - The cookie name.</li> <li><code>array/\\Codeception\\Module\\array/array $params - Parameters to filter the cookie value. getResponseContent <p>Returns content of the last response. This method exposes an underlying API for custom assertions.</p> <pre><code>// In test class.\n  $this-&gt;assertContains($text, $this-&gt;getResponseContent(), \"foo-bar\");\n</code></pre> getWpRootFolder <p>Returns the absolute path to the WordPress root folder.</p> <pre><code>$root = $I-&gt;getWpRootFolder();\n  $this-&gt;assertFileExists($root . '/someFile.txt');\n</code></pre> grabWordPressTestCookie <p>Returns WordPress default test cookie object if present.</p> <pre><code>// Grab the default WordPress test cookie.\n  $wpTestCookie = $I-&gt;grabWordPressTestCookie();\n  // Grab a customized version of the test cookie.\n  $myTestCookie = $I-&gt;grabWordPressTestCookie('my_test_cookie');\n</code></pre> Parameters <ul> <li><code>string</code> $name - Optional, overrides the default cookie name.</li></ul> logOut <p>Navigate to the default WordPress logout page and click the logout link.</p> <pre><code>// Log out using the `wp-login.php` form and return to the current page.\n  $I-&gt;logOut(true);\n  // Log out using the `wp-login.php` form and remain there.\n  $I-&gt;logOut(false);\n  // Log out using the `wp-login.php` form and move to another page.\n  $I-&gt;logOut('/some-other-page');\n</code></pre> Parameters <ul> <li><code>bool/bool/string</code> $redirectTo - Whether to redirect to another (optionally specified) page after the logout.</li></ul> loginAs <p>Login as the specified user. The method will not follow redirection, after the login, to any page.</p> <pre><code>$I-&gt;loginAs('user', 'password');\n  $I-&gt;amOnAdminPage('/');\n  $I-&gt;seeElement('.admin');\n</code></pre> Parameters <ul> <li><code>string</code> $username - The user login name.</li> <li><code>string</code> $password - The user password in plain text.</li></ul> loginAsAdmin <p>Login as the administrator user using the credentials specified in the module configuration. The method will not follow redirection, after the login, to any page.</p> <pre><code>$I-&gt;loginAsAdmin();\n  $I-&gt;amOnAdminPage('/');\n  $I-&gt;see('Dashboard');\n</code></pre> seeErrorMessage <p>In an administration screen look for an error admin notice. The check is class-based to decouple from internationalization. The method will not handle authentication and navigation the administration area. <code>.notice.notice-error</code> ones.</p> <pre><code>$I-&gt;loginAsAdmin()\n  $I-&gt;amOnAdminPage('/');\n  $I-&gt;seeErrorMessage('.my-plugin');\n</code></pre> Parameters <ul> <li><code>string/string/\\Codeception\\Module\\array $classes - A list of classes the notice should have other than the seeMessage <p>In an administration screen look for an admin notice. The check is class-based to decouple from internationalization. The method will not handle authentication and navigation the administration area.</p> <pre><code>$I-&gt;loginAsAdmin()\n  $I-&gt;amOnAdminPage('/');\n  $I-&gt;seeMessage('.missing-api-token.my-plugin');\n</code></pre> Parameters <ul> <li><code>string/\\Codeception\\Module\\array/string $classes - A list of classes the message should have in addition to the <code>.notice</code> one. seePluginActivated <p>Assert a plugin is activated in the plugin administration screen. The method will not handle authentication and navigation to the plugin administration screen.</p> <pre><code>$I-&gt;loginAsAdmin();\n  $I-&gt;amOnPluginsPage();\n  $I-&gt;seePluginActivated('my-plugin');\n</code></pre> Parameters <ul> <li><code>string</code> $pluginSlug - The plugin slug, like \"hello-dolly\".</li></ul> seePluginDeactivated <p>Assert a plugin is not activated in the plugins administration screen. The method will not handle authentication and navigation to the plugin administration screen.</p> <pre><code>$I-&gt;loginAsAdmin();\n  $I-&gt;amOnPluginsPage();\n  $I-&gt;seePluginDeactivated('my-plugin');\n</code></pre> Parameters <ul> <li><code>string</code> $pluginSlug - The plugin slug, like \"hello-dolly\".</li></ul> seePluginInstalled <p>Assert a plugin is installed, no matter its activation status, in the plugin administration screen. The method will not handle authentication and navigation to the plugin administration screen.</p> <pre><code>$I-&gt;loginAsAdmin();\n  $I-&gt;amOnPluginsPage();\n  $I-&gt;seePluginInstalled('my-plugin');\n</code></pre> Parameters <ul> <li><code>string</code> $pluginSlug - The plugin slug, like \"hello-dolly\".</li></ul> seeWpDiePage <p>Checks that the current page is one generated by the <code>wp_die</code> function. The method will try to identify the page based on the default WordPress die page HTML attributes.</p> <pre><code>$I-&gt;loginAs('user', 'password');\n  $I-&gt;amOnAdminPage('/forbidden');\n  $I-&gt;seeWpDiePage();\n</code></pre> <p>This class extends \\Codeception\\Lib\\Framework</p> <p>This class implements \\Codeception\\Lib\\Interfaces\\Web, \\Codeception\\Lib\\Interfaces\\PageSourceSaver, \\Codeception\\Lib\\Interfaces\\ElementLocator, \\Codeception\\Lib\\Interfaces\\ConflictsWithModule, \\Codeception\\Lib\\Interfaces\\DependsOnModule</p>"},{"location":"v3/tutorials/automatically-change-db-in-tests/","title":"Automatically change database during acceptance and functional tests","text":"<p>This is the documentation for version 3 of the project. The current version is version 4 and the documentation can be found here.</p>"},{"location":"v3/tutorials/automatically-change-db-in-tests/#automatically-change-database-during-acceptance-and-functional-tests","title":"Automatically change database during acceptance and functional tests","text":"<p>You should always back up any site you run tests on if you care about the site content.</p> <p>Now this disclaimer has been made ad nauseam; there's a simple way to use a different database when during tests.</p>"},{"location":"v3/tutorials/automatically-change-db-in-tests/#identifying-requests","title":"Identifying requests","text":"<p>The first component of this solution is identifying the source of the current HTTP request. WordPress makes this identification before deciding which database to use.  </p> <p>To provide the WordPress installation with this information, you can set the <code>headers</code> entry of the <code>WPBrowser</code> or <code>WPWebDriver</code> module in the suite configuration file.</p> <p>As an example here is an <code>acceptance</code> suite configuration file setting two custom headers, <code>X_WPBROWSER_REQUEST</code> and <code>X_TEST_REQUEST</code>, on each request sent by the <code>WPWebDriver</code> module:</p> <pre><code>actor: AcceptanceTester\nmodules:\n    enabled:\n        - WPDb\n        - WPBrowser\n        - \\Helper\\Acceptance\n    config:\n        WPDb:\n            dsn: 'mysql:host=localhost;dbname=tests'\n            user: 'root'\n            password: 'root'\n            dump: 'tests/_data/dump.sql'\n            populate: true\n            cleanup: true\n            waitlock: 10\n            url: 'http://wp.test'\n            urlReplacement: true\n            tablePrefix: 'wp_'\n        WPBrowser:\n            url: 'http://wp.test'\n            adminUsername: 'admin'\n            adminPassword: 'admin'\n            adminPath: '/wp-admin'\n            headers:\n                X_WPBROWSER_REQUEST: 1\n                X_TEST_REQUEST: 1\n</code></pre> <p>The two headers are sent on each HTTP request type, not just on <code>GET</code> type requests.</p>"},{"location":"v3/tutorials/automatically-change-db-in-tests/#using-a-different-database-to-handle-test-requests","title":"Using a different database to handle test requests","text":"<p>Now that each request made by the <code>WPWebDriver</code> module contains those two headers, it's time for WordPress to check those and change the database to use accordingly.</p> <p>The database to use is set by the <code>DB_NAME</code> constant that is, in turn, set in the <code>wp-config.php</code> file. Different setups could involve more complex configurations for the <code>wp-config.php</code> file but, for the sake of simplicity, I assume the default WordPress <code>wp-config.php</code> file structure. In the example below, the default database name is <code>wordpress</code>, while the name of the test database is <code>tests</code>.</p> <pre><code>- define( 'DB_NAME', 'wordpress' );\n+ if( isset( $_SERVER['HTTP_X_TEST_REQUEST'] ) &amp;&amp; $_SERVER['HTTP_X_TEST_REQUEST'] ) {\n+     define( 'DB_NAME', 'tests' );\n+ } else {\n+     define( 'DB_NAME', 'wordpress' );\n+ }\n</code></pre> <p>The diff shows the replacement done in the WordPress installation <code>wp-config.php</code> file.</p> <p>For copy-and-paste pleasure, replace the line starting with:</p> <pre><code>define( 'DB_NAME', 'default_db_name' );\n</code></pre> <p>With this snippet:</p> <pre><code>if( isset( $_SERVER['HTTP_X_TEST_REQUEST'] ) &amp;&amp; $_SERVER['HTTP_X_TEST_REQUEST'] ) {\n      define( 'DB_NAME', 'test_db_name' );\n} else {\n      define( 'DB_NAME', 'default_db_name' );\n}\n</code></pre> <p>Where <code>default_db_name</code> is the name of the database your test WordPress installation normally uses.</p> <p>Happy, and safer, testing.</p>"},{"location":"v3/tutorials/local-flywheel-setup/","title":"Setting up wp-browser on Local by Flywheel to test a plugin","text":"<p>This is the documentation for version 3 of the project. The current version is version 4 and the documentation can be found here.</p>"},{"location":"v3/tutorials/local-flywheel-setup/#setting-up-wp-browser-with-local-by-flywheel-to-test-a-plugin","title":"Setting up wp-browser with Local by Flywheel to test a plugin","text":"<p>Note: the original version of this guide used, on Mac, the version of Local by Flywheel based on VirtualBox and Docker containers. That version has been replaced by a new one that will not use any virtualization layer. The UI is almost the same but, for back-compatibility purposes, I've not removed the references to the previous version; I have, instead, pointed out where the set up values and procedures might differ due to the changes.</p>"},{"location":"v3/tutorials/local-flywheel-setup/#requirements","title":"Requirements","text":"<ul> <li>A Mac or Windows machine</li> <li>A working installation of Local By Flywheel.</li> <li>You should be able to create sites and visit them from your browser without issues.</li> <li>Composer installed and working on your terminal <code>PATH</code>, you should be able to run <code>composer --version</code> at the terminal and see the version correctly.</li> </ul>"},{"location":"v3/tutorials/local-flywheel-setup/#install-local-by-flywheel","title":"Install Local by Flywheel","text":"<p>This walk-through starts after Local by Flywheel has been installed and is correctly running on your machine; you can download Local from the site and follow the installation instructions.  </p> <p>In the context of this guide I'm assuming the sites directory is <code>~/Local Sites</code>, the default \"Sites Path\" in Local preferences.</p> <p>If your document root lies elsewhere, replace the <code>~/Local Sites</code> path with the actual directory in each command.  </p> <p></p>"},{"location":"v3/tutorials/local-flywheel-setup/#creating-the-databases-and-installing-wordpress","title":"Creating the databases and installing WordPress","text":"<p>Using Local UI create a new site:</p> <ul> <li>The site name is <code>myplugin</code>.</li> <li>The site administrator user name is <code>admin</code>.</li> <li>The site administrator password is <code>password</code>.</li> </ul> <p>Once Local provisioned and installed the new site, open the \"Database\" administration tab and, depending on your OS, start a database administration UI or website. In the image below I'm using Adminer:</p> <p></p> <p>Create a database called <code>tests</code>:</p> <p></p> <p>Make sure you can visit the WordPress installation at <code>http://myplugin.local</code> and that you can correctly access the administration area at <code>http://myplugin.local/wp-admin</code>.</p>"},{"location":"v3/tutorials/local-flywheel-setup/#scaffolding-the-project-folder","title":"Scaffolding the project folder","text":"<p>I'm assuming the scope of the development is to test the <code>my-plugin</code> plugin.  </p> <p>The first step is to create the bare minimum code required to make the plugin show up among the available WordPress plugins. Create the main plugin file in the WordPress installation plugins directory, in the <code>~/Local Sites/myplugin/app/public/wp-content/plugins/my-plugin/my-plugin.php</code> file:</p> <pre><code>&lt;?php\n/**\n * Plugin Name: My plugin\n */ \n</code></pre> <p>The plugin should now show up, activate and deactivate correctly, among the plugins listed in the WordPress installation at <code>http://myplugin.local/wp-admin/plugins.php</code>.  </p> <p></p>"},{"location":"v3/tutorials/local-flywheel-setup/#installing-wp-browser","title":"Installing wp-browser","text":"<p>Open a terminal window and navigate to the plugin directory and initialize the Composer project:</p> <pre><code>cd ~/Local Sites/myplugin/app/public/wp-content/plugins/my-plugin\ncomposer init\n</code></pre> <p></p> <p>Composer will ask some questions to initialize the project, for the sake of this small guide the answers are not relevant. Here is the <code>composer.json</code> file generated by the above answers:</p> <pre><code>{\n    \"name\": \"local/my-plugin\",\n    \"type\": \"wordpress-plugin\",\n    \"require\": {}\n}\n</code></pre> <p>Next require <code>lucatume/wp-browser</code> as a development dependency:</p> <pre><code>composer require --dev lucatume/wp-browser\n</code></pre> <p>Composer installs any dependency binary file, an executable file, in the project <code>vendor/bin</code> folder.  To check Codeception is correctly installed run this command:</p> <pre><code>vendor/bin/codecept --version\n</code></pre> <p></p> <p>Since wp-browser requires Codeception, there is no need to require Codeception explicitly as a development dependency.</p>"},{"location":"v3/tutorials/local-flywheel-setup/#setting-up-wp-browser","title":"Setting up wp-browser","text":"<p>For those that might get lost while trying to set up wp-browser for the first time the VVV context provides an excellent base to understand the process.  </p> <p>wp-browser needs to know:</p> <ul> <li>Where the WordPress installation files are located: they will be loaded in integration and \"WordPress unit\" tests.</li> <li>How to connect to the WordPress site \"normal\" database: this is the database that stores the data of the site I would see when visiting the local installation URL at <code>http://myplugin.local</code>.</li> <li>How to connect to the database dedicated to the integration and \"WordPress unit\" tests: this database will be used to install WordPress during integration and \"WordPress unit\" tests.</li> </ul> <p>Any test suite using a database should never run on a database containing data of any value; this means that your first step should be to backup the site database.  </p> <p>You can create a backup of the current site database contents using whatever tool the version of Local you're using provides. In this example I'm using Adminer:</p> <p></p> <p>At any moment you can re-import the site database dump using, again, phpMyAdmin, under the \"Import\" tab:</p> <p></p>"},{"location":"v3/tutorials/local-flywheel-setup/#bootstrapping-and-configuring-wp-browser","title":"Bootstrapping and configuring wp-browser","text":"<p>After the backup is done it's time to bootstrap <code>wp-browser</code> using its interactive mode:</p> <pre><code>cd ~/Local Sites/myplugin/app/public/wp-content/plugins/my-plugin\nvendor/bin/codecept init wpbrowser\n</code></pre> <p>The initialization guide will ask a number of questions.  </p>"},{"location":"v3/tutorials/local-flywheel-setup/#windows-configuration","title":"Windows configuration","text":"<p>In the screenshots below are the answers I used to configure <code>wp-browser</code> on Windows.</p> <p>Note that I've set up the database host using the values provided by Local UI, yours might differ depending on the version of Local you're using:</p> <p></p> <p></p> <p></p> <p>Below a complete list of each answer:</p> <ul> <li>I acknowledge wp-browser should run on development servers... <code>y</code></li> <li>Would you like to set up the suites interactively now? <code>y</code></li> <li>How would you like the acceptance suite to be called? <code>acceptance</code></li> <li>How would you like the functional suite to be called? <code>functional</code></li> <li>How would you like the WordPress unit and integration suite to be called? <code>wpunit</code></li> <li>How would you like to call the env configuration file? <code>.env.testing</code></li> <li>What is the path of the WordPress root directory? <code>~/Local Sites/myplugin/app/public</code></li> <li>What is the path, relative to WordPress root URL, of the admin area of the test site? <code>/wp-admin</code></li> <li>What is the name of the test database used by the test site? <code>tests</code></li> <li>What is the host of the test database used by the test site? <code>localhost:10003</code></li> <li>What is the user of the test database used by the test site? <code>root</code></li> <li>What is the password of the test database used by the test site? <code>root</code></li> <li>What is the table prefix of the test database used by the test site? <code>wp_</code></li> <li>What is the name of the test database WPLoader should use? <code>tests</code></li> <li>What is the host of the test database WPLoader should use? <code>localhost:10003</code></li> <li>What is the user of the test database WPLoader should use? <code>root</code></li> <li>What is the password of the test database WPLoader should use? <code>root</code></li> <li>What is the table prefix of the test database WPLoader should use? <code>wp_</code></li> <li>What is the URL the test site? <code>http://myplugin.local</code></li> <li>What is the email of the test site WordPress administrator? <code>admin@myplugin.local</code></li> <li>What is the title of the test site? <code>My Plugin Test</code></li> <li>What is the login of the administrator user of the test site? <code>admin</code></li> <li>What is the password of the administrator user of the test site? <code>password</code></li> <li>Are you testing a plugin, a theme or a combination of both (both)? <code>plugin</code></li> <li>What is the folder/plugin.php name of the plugin? <code>my-plugin/my-plugin.php</code></li> <li>Does your project needs additional plugins to be activated to work? <code>no</code></li> </ul> <p>Codeception will build the suites for the first time and should be ready to go.</p>"},{"location":"v3/tutorials/local-flywheel-setup/#mac-configuration","title":"Mac configuration","text":"<p>In the screenshots below are the answers I used to configure <code>wp-browser</code> on Mac.</p> <p>Note that I've set up the database host using the values provided by Local UI, yours might differ.</p> <p></p> <p>This screenshot is from the previous version of Local, the one based on VirtualBox and Docker:</p> <p></p> <p></p> <p></p> <p>Below a complete list of each answer:</p> <ul> <li>I acknowledge wp-browser should run on development servers... <code>y</code></li> <li>Would you like to set up the suites interactively now? <code>y</code></li> <li>How would you like the acceptance suite to be called? <code>acceptance</code></li> <li>How would you like the functional suite to be called? <code>functional</code></li> <li>How would you like the WordPress unit and integration suite to be called? <code>wpunit</code></li> <li>How would you like to call the env configuration file? <code>.env.testing</code></li> <li>What is the path of the WordPress root directory? <code>~/Local Sites/myplugin/app/public</code></li> <li>What is the path, relative to WordPress root URL, of the admin area of the test site? <code>/wp-admin</code></li> <li>What is the name of the test database used by the test site? <code>tests</code></li> <li>What is the host of the test database used by the test site? <code>/Users/lucatume/Library/Application Support/Local/run/FjKWfVMGd/mysql/mysqld.sock</code> ( or <code>192.168.95.100:4055</code> on an older version of Local)</li> <li>What is the user of the test database used by the test site? <code>root</code></li> <li>What is the password of the test database used by the test site? <code>root</code></li> <li>What is the table prefix of the test database used by the test site? <code>wp_</code></li> <li>What is the name of the test database WPLoader should use? <code>tests</code></li> <li>What is the host of the test database WPLoader should use? <code>/Users/lucatume/Library/Application Support/Local/run/FjKWfVMGd/mysql/mysqld.sock</code> (or <code>192.168.95.100:4055</code> on an older version of Local)</li> <li>What is the user of the test database WPLoader should use? <code>root</code></li> <li>What is the password of the test database WPLoader should use? <code>root</code></li> <li>What is the table prefix of the test database WPLoader should use? <code>wp_</code></li> <li>What is the URL the test site? <code>http://myplugin.local</code></li> <li>What is the email of the test site WordPress administrator? <code>admin@myplugin.local</code></li> <li>What is the title of the test site? <code>My Plugin Test</code></li> <li>What is the login of the administrator user of the test site? <code>admin</code></li> <li>What is the password of the administrator user of the test site? <code>password</code></li> <li>Are you testing a plugin, a theme or a combination of both (both)? <code>plugin</code></li> <li>What is the folder/plugin.php name of the plugin? <code>my-plugin/my-plugin.php</code></li> <li>Does your project needs additional plugins to be activated to work? <code>no</code></li> </ul> <p>Codeception will build the suites for the first time and should be ready to go.</p>"},{"location":"v3/tutorials/local-flywheel-setup/#setting-up-the-starting-database-fixture","title":"Setting up the starting database fixture","text":"<p>A \"fixture\", in testing terms, is a minimal, starting environment shared by all tests. In BDD it's the <code>Background</code> any scenario will share. In the case of a plugin the minimal, starting environment is the following:</p> <ul> <li>A fresh WordPress installation empty of any content.</li> <li>WordPress using its default theme.</li> <li>The only active plugin is the one you're testing, in this example: <code>my-plugin</code>.</li> </ul> <p>You should set up this fixture \"manually\", using the site administration UI at <code>http://myplugin.local/wp-admin</code>.</p> <p>The following command will empty the site, backup any content you care about first!</p> <p>When you're done setting up the initial database fixture, export it using the \"Export\" tab of your database tool of choice, and move the file to the <code>~/Local Sites/myplugin/app/public/wp-content/plugins/my-plugin/tests/_data/dump.sql</code> directory.</p> <p>There is one last step left to complete the setup.</p>"},{"location":"v3/tutorials/local-flywheel-setup/#using-the-tests-database-in-acceptance-and-functional-tests","title":"Using the tests database in acceptance and functional tests","text":"<p>Acceptance and functional tests will act as users, navigating to the site pages and making requests as a user would.  </p> <p>This means that WordPress will load, and with it its <code>wp-config.php</code> file, to handle the requests made by the tests.  </p> <p>During the setup phase I've specified the database to be used for <code>acceptance</code> and <code>functional</code> tests as <code>tests</code> but, looking at the contents of the <code>~/Local Sites/myplugin/app/public/wp-config.php</code> file, the <code>DB_NAME</code> constant is set to <code>local</code>.  </p> <p>What we'll do now means:</p> <ul> <li>If the request is a normal one, use the <code>local</code> database.</li> <li>If the request comes from a test, use the <code>tests</code> database.</li> </ul> <p>In your IDE/text-editor of choice edit the <code>~/Local Sites/myplugin/app/public/wp-config.php</code> and replace the line defining the <code>DB_NAME</code> constant like this:</p> <pre><code>- define( 'DB_NAME', 'local' );\n+ if( isset( $_SERVER['HTTP_X_WPBROWSER_REQUEST'] ) &amp;&amp; $_SERVER['HTTP_X_WPBROWSER_REQUEST'] ) { \n+    define( 'DB_NAME', 'tests' );\n+ } else {\n+    define( 'DB_NAME', 'local' );\n+ }\n</code></pre> <p>Here's the copy-and-paste friendly version:</p> <pre><code>if( isset( $_SERVER['HTTP_X_TEST_REQUEST'] ) &amp;&amp; $_SERVER['HTTP_X_TEST_REQUEST'] ) {\n        define( 'DB_NAME', 'tests' );\n} else {\n        define( 'DB_NAME', 'local' );\n}\n</code></pre> <p>If you look at the <code>tests/acceptance.suite.yml</code> and <code>tests/functional.suite.yml</code> files, respectively the <code>acceptance</code> and <code>functional</code> suite configuration files, you will see these entries in the <code>WPBrowser</code> module configuration:</p> <pre><code>headers:\n    X_TEST_REQUEST: 1\n    X_WPBROWSER_REQUEST: 1\n</code></pre> <p>This means that, with each HTTP request done during tests, the module will send the two headers. Those headers are read, on the WordPress side, using the <code>$_SERVER['HTTP_X_TEST_REQUEST']</code> and <code>$_SERVER['X_WPBROWSER_REQUEST']</code> variables.</p> <p>Codeception and wp-browser are ready to run and the test-drive development can start.</p>"},{"location":"v3/tutorials/local-flywheel-setup/#sanity-check","title":"Sanity check","text":"<p>Before starting to write tests, take a moment to run each suite separately and make sure all is set up correctly.  </p> <p>If you run into issues, there's a chance you forgot something along the way, please take the time to read this tutorial a second time before opening an issue.</p> <p>You have created 4 suites, each suite has at least one example test to make sure all works. Run each suite and make sure all tests succeed, from within the box run:</p> <pre><code>cd ~/Local Sites/myplugin/app/public/wp-content/plugins/my-plugin \nvendor/bin/codecept run acceptance\nvendor/bin/codecept run functional\nvendor/bin/codecept run wpunit\nvendor/bin/codecept run unit\n</code></pre> <p>You're now run to customize the suites to your liking or start writing tests, run <code>vendor/bin/codecept</code> to see a list of the available commands.</p>"},{"location":"v3/tutorials/mamp-mac-setup/","title":"Setting up wp-browser on MAMP for Mac to test a plugin","text":"<p>This is the documentation for version 3 of the project. The current version is version 4 and the documentation can be found here.</p>"},{"location":"v3/tutorials/mamp-mac-setup/#setting-up-wp-browser-with-mamp-on-mac-to-test-a-plugin","title":"Setting up wp-browser with MAMP on Mac to test a plugin","text":""},{"location":"v3/tutorials/mamp-mac-setup/#requirements","title":"Requirements","text":"<ul> <li>A Mac machine</li> <li>A working installation of MAMP.</li> <li>You should be able to create sites and visit them from your browser without issues.</li> <li>Composer installed and working on your terminal <code>PATH</code>, you should be able to run <code>composer --version</code> at the terminal and see the version correctly.</li> </ul> <p>The version of MAMP used in this tutorial is the free, non PRO, one. MAMP PRO provides more features, but the setup instructions should remain valid.</p>"},{"location":"v3/tutorials/mamp-mac-setup/#install-and-configure-mamp","title":"Install and configure MAMP","text":"<p>This walk-through starts after MAMP has been installed and is correctly running on the host machine; you can download MAMP from the site and follow the installation instructions. In the context of this guide I'm assuming the \"Document Root\" directory is the default one, in the <code>/Applications/MAMP/htdocs</code> directory. If your document root lies elsewhere, replace the <code>/Applications/MAMP/htdocs</code> path with the actual directory in each command.  </p> <p></p> <p></p>"},{"location":"v3/tutorials/mamp-mac-setup/#creating-the-databases-and-installing-wordpress","title":"Creating the databases and installing WordPress","text":"<p>Go to the <code>http://localhost/phpMyAdmin/</code> page and create two new databases:</p> <ul> <li><code>wordpress</code> is the database you will use for WordPress</li> <li><code>tests</code> is the database you will use for the tests</li> </ul> <p></p> <p>Unzip the the WordPress files into the <code>/Applications/MAMP/htdocs</code> and head over to <code>http://localhost</code> to install WordPress.  </p> <p>The database credentials for the installation are:</p> <ul> <li>Database name: <code>wordpress</code></li> <li>Database user: <code>root</code></li> <li>Database password: <code>root</code></li> <li>Database host: <code>localhost</code></li> </ul> <p>Use <code>admin</code> as administrator user name and <code>password</code> as password for the administrator user.</p> <p></p> <p>Make sure you can visit the WordPress installation at <code>http://localhost</code> and that you can correctly access the administration area at <code>http://localhost/wp-admin</code>.</p>"},{"location":"v3/tutorials/mamp-mac-setup/#scaffolding-the-project-folder","title":"Scaffolding the project folder","text":"<p>I'm assuming the scope of the development is to test the <code>my-plugin</code> plugin.  </p> <p>The first step is to create the bare minimum code required to make the plugin show up among the available WordPress plugins. Create the main plugin file in the WordPress installation plugins directory, in the <code>/Applications/MAMP/htdocs/wp-content/plugins/my-plugin/my-plugin.php</code> file:</p> <pre><code>&lt;?php\n/**\n * Plugin Name: My plugin\n */ \n</code></pre> <p>The plugin should now show up, activate and deactivate correctly, among the plugins listed in the WordPress installation at <code>http://localhost/wp-admin/plugins.php</code>.  </p> <p></p>"},{"location":"v3/tutorials/mamp-mac-setup/#installing-wp-browser","title":"Installing wp-browser","text":"<p>Open a terminal window and navigate to the plugin directory and initialize the Composer project:</p> <pre><code>cd /Applications/MAMP/htdocs/wp-content/plugins/my-plugin\ncomposer init\n</code></pre> <p></p> <p>Composer will ask some questions to initialize the project, for the sake of this small guide the answers are not relevant. Here is the <code>composer.json</code> file generated by the above answers:</p> <pre><code>{\n    \"name\": \"mamp/my-plugin\",\n    \"type\": \"wordpress-plugin\",\n    \"require\": {}\n}\n</code></pre> <p>Next require <code>lucatume/wp-browser</code> as a development dependency:</p> <pre><code>composer require --dev lucatume/wp-browser\n</code></pre> <p>Composer installs any dependency binary file, an executable file, in the project <code>vendor/bin</code> folder.  To check Codeception is correctly installed run this command:</p> <pre><code>vendor/bin/codecept --version\n</code></pre> <p></p> <p>Since wp-browser requires Codeception, there is no need to require Codeception explicitly as a development dependency.</p>"},{"location":"v3/tutorials/mamp-mac-setup/#setting-up-wp-browser","title":"Setting up wp-browser","text":"<p>For those that might get lost while trying to set up wp-browser for the first time the VVV context provides an excellent base to understand the process.  </p> <p>wp-browser needs to know:</p> <ul> <li>Where the WordPress installation files are located: they will be loaded in integration and \"WordPress unit\" tests.</li> <li>How to connect to the WordPress site \"normal\" database: this is the database that stores the data of the site I would see when visiting the local installation URL at <code>http://localhost</code>.</li> <li>How to connect to the database dedicated to the integration and \"WordPress unit\" tests: this database will be used to install WordPress during integration and \"WordPress unit\" tests.</li> </ul> <p>Any test suite using a database should never run on a database containing data of any value; this means that your first step should be to backup the site database.  </p> <p>You can create a backup of the current site database contents using phpMyAdmin, at <code>http://localhost/phpMyAdmin/</code>, under the \"Export\" tab:</p> <p></p> <p>At any moment you can re-import the site database dump using, again, phpMyAdmin, under the \"Import\" tab:</p> <p></p>"},{"location":"v3/tutorials/mamp-mac-setup/#bootstrapping-and-configuring-wp-browser","title":"Bootstrapping and configuring wp-browser","text":"<p>After the backup is done it's time to bootstrap <code>wp-browser</code> using its interactive mode:</p> <pre><code>cd /Applications/MAMP/htdocs/wp-content/plugins/my-plugin\nvendor/bin/codecept init wpbrowser\n</code></pre> <p>The initialization guide will ask a number of questions. In the screenshots below are the answers I used to configure <code>wp-browser</code>.</p> <p></p> <p></p> <p>Below a complete list of each answer:</p> <ul> <li>I acknowledge wp-browser should run on development servers... <code>y</code></li> <li>Would you like to set up the suites interactively now? <code>y</code></li> <li>How would you like the acceptance suite to be called? <code>acceptance</code></li> <li>How would you like the functional suite to be called? <code>functional</code></li> <li>How would you like the WordPress unit and integration suite to be called? <code>wpunit</code></li> <li>How would you like to call the env configuration file? <code>.env.testing</code></li> <li>What is the path of the WordPress root directory? <code>/Applications/MAMP/htdocs</code></li> <li>What is the path, relative to WordPress root URL, of the admin area of the test site? <code>/wp-admin</code></li> <li>What is the name of the test database used by the test site? <code>tests</code></li> <li>What is the host of the test database used by the test site? <code>localhost</code></li> <li>What is the user of the test database used by the test site? <code>root</code></li> <li>What is the password of the test database used by the test site? <code>root</code></li> <li>What is the table prefix of the test database used by the test site? <code>wp_</code></li> <li>What is the name of the test database WPLoader should use? <code>tests</code></li> <li>What is the host of the test database WPLoader should use? <code>localhost</code></li> <li>What is the user of the test database WPLoader should use? <code>root</code></li> <li>What is the password of the test database WPLoader should use? <code>root</code></li> <li>What is the table prefix of the test database WPLoader should use? <code>wp_</code></li> <li>What is the URL the test site? <code>http://localhost</code></li> <li>What is the email of the test site WordPress administrator? <code>admin@wp.test</code></li> <li>What is the title of the test site? <code>My Plugin Test</code></li> <li>What is the login of the administrator user of the test site? <code>admin</code></li> <li>What is the password of the administrator user of the test site? <code>password</code></li> <li>Are you testing a plugin, a theme or a combination of both (both)? <code>plugin</code></li> <li>What is the folder/plugin.php name of the plugin? <code>my-plugin/my-plugin.php</code></li> <li>Does your project needs additional plugins to be activated to work? <code>no</code></li> </ul> <p>Codeception will build the suites for the first time and should be ready to go.</p>"},{"location":"v3/tutorials/mamp-mac-setup/#setting-up-the-starting-database-fixture","title":"Setting up the starting database fixture","text":"<p>A \"fixture\", in testing terms, is a minimal, starting environment shared by all tests. In BDD it's the <code>Background</code> any scenario will share. In the case of a plugin the minimal, starting environment is the following:</p> <ul> <li>A fresh WordPress installation empty of any content.</li> <li>WordPress using its default theme.</li> <li>The only active plugin is the one you're testing, in this example: <code>my-plugin</code>.</li> </ul> <p>You should set up this fixture \"manually\", using the site administration UI at <code>http://localhost/wp-admin</code>.</p> <p>The following command will empty the site, backup any content you care about first!</p> <p>When you're done setting up the initial database fixture, export it using the \"Export\" tab of phpMyAdmin, at <code>http://localhost/phpMyAdmin/</code> and move the file to the <code>/Applications/MAMP/htdocs/wp-content/plugins/my-plugin/tests/_data/dump.sql</code> directory.</p> <p>There is one last step left to complete the setup.</p>"},{"location":"v3/tutorials/mamp-mac-setup/#using-the-tests-database-in-acceptance-and-functional-tests","title":"Using the tests database in acceptance and functional tests","text":"<p>Acceptance and functional tests will act as users, navigating to the site pages and making requests as a user would.  </p> <p>This means that WordPress will load, and with it its <code>wp-config.php</code> file, to handle the requests made by the tests.  </p> <p>During the setup phase I've specified the database to be used for <code>acceptance</code> and <code>functional</code> tests as <code>tests</code> but, looking at the contents of the <code>/Applications/MAMP/htdocs/wp-config.php</code> file, the <code>DB_NAME</code> constant is set to <code>wordpress</code>.  </p> <p>What we'll do now means:</p> <ul> <li>If the request is a normal one, use the <code>wordpress</code> database.</li> <li>If the request comes from a test, use the <code>tests</code> database.</li> </ul> <p>In your IDE/text-editor of choice edit the <code>/Applications/MAMP/htdocs/wp-config.php</code> and replace the line defining the <code>DB_NAME</code> constant like this:</p> <pre><code>- define( 'DB_NAME', 'wordpress' );\n+ if( isset( $_SERVER['HTTP_X_WPBROWSER_REQUEST'] ) &amp;&amp; $_SERVER['HTTP_X_WPBROWSER_REQUEST'] ) { \n+    define( 'DB_NAME', 'tests' );\n+ } else {\n+    define( 'DB_NAME', 'wordpress' );\n+ }\n</code></pre> <p>Here's the copy-and-paste friendly version:</p> <pre><code>if( isset( $_SERVER['HTTP_X_TEST_REQUEST'] ) &amp;&amp; $_SERVER['HTTP_X_TEST_REQUEST'] ) {\n        define( 'DB_NAME', 'tests' );\n} else {\n        define( 'DB_NAME', 'wordpress' );\n}\n</code></pre> <p>If you look at the <code>tests/acceptance.suite.yml</code> and <code>tests/functional.suite.yml</code> files, respectively the <code>acceptance</code> and <code>functional</code> suite configuration files, you will see these entries in the <code>WPBrowser</code> module configuration:</p> <pre><code>headers:\n    X_TEST_REQUEST: 1\n    X_WPBROWSER_REQUEST: 1\n</code></pre> <p>This means that, with each HTTP request done during tests, the module will send the two headers. Those headers are read, on the WordPress side, using the <code>$_SERVER['HTTP_X_TEST_REQUEST']</code> and <code>$_SERVER['X_WPBROWSER_REQUEST']</code> variables.</p> <p>Codeception and wp-browser are ready to run and the test-drive development can start.</p>"},{"location":"v3/tutorials/mamp-mac-setup/#sanity-check","title":"Sanity check","text":"<p>Before starting to write tests, take a moment to run each suite separately and make sure all is set up correctly.  </p> <p>If you run into issues, there's a chance you forgot something along the way, please take the time to read this tutorial a second time before opening an issue.</p> <p>You have created 4 suites, each suite has at least one example test to make sure all works. Run each suite and make sure all tests succeed, from within the box run:</p> <pre><code>cd /Applications/MAMP/htdocs/wp-content/plugins/my-plugin \nvendor/bin/codecept run acceptance\nvendor/bin/codecept run functional\nvendor/bin/codecept run wpunit\nvendor/bin/codecept run unit\n</code></pre> <p>You're now run to customize the suites to your liking or start writing tests, run <code>vendor/bin/codecept</code> to see a list of the available commands.</p>"},{"location":"v3/tutorials/vvv-setup/","title":"Setting up wp-browser on VVV to test a plugin","text":"<p>This is the documentation for version 3 of the project. The current version is version 4 and the documentation can be found here.</p>"},{"location":"v3/tutorials/vvv-setup/#setting-up-wp-browser-on-vvv-to-test-a-plugin","title":"Setting up wp-browser on VVV to test a plugin","text":""},{"location":"v3/tutorials/vvv-setup/#requirements","title":"Requirements","text":"<ul> <li>A Windows, Linux or Mac machine (I'll call this the \"host machine\" or just \"host\").</li> <li>A working installation of VVV; you should be able to navigate to VVV root directory, run the <code>vagrant up</code> command, and have VVV up and running.</li> <li>On the VVV installation you should be able to visit the two default sites URLs without issues; the two default sites addresses are:<ul> <li>http://one.wordpress.test</li> <li>http://two.wordpress.test</li> </ul> </li> </ul>"},{"location":"v3/tutorials/vvv-setup/#why-vvv","title":"Why VVV?","text":"<p>The VVV project provides a \"a Vagrant configuration for developing with WordPress\" and is an excellent, no-frills, starting point to develop WordPress projects (themes, plugins and whole sites. Based on Vagrant and Virtual Box, VVV removes the differences between systems by providing a uniform, Ubuntu Linux based, virtual machine that will bahave the same on Windows, Linux and Mac. Configuring it to run WordPress tests is easy: let's get started.  </p>"},{"location":"v3/tutorials/vvv-setup/#check-vvv-works-correctly","title":"Check VVV works correctly","text":"<p>This walk-through starts after VVV has been installed and is running on the host machine; the installation guide is clear and simple to follow and I'm not duplicating it here. In the context of this guide I'm assuming VVV lives in the <code>~/Repos/VVV</code> directory, that we are working on the <code>my-plugin</code> project and that the plugin is being developed in the default (<code>wordpress-one</code>) WordPress installation provided by the box. If your VVV installation lies elsewhere, replace the <code>~/Repos/VVV</code> with the actual directory in each command.  </p> <p>After completing the installation of VVV navigate to VVV root folder and run the <code>vagrant up</code> command:</p> <pre><code>cd ~/Repos/VVV\nvagrant up\n</code></pre> <p></p> <p>After the automatic bootstrap and initialization process completed, VVV makes two WordPress sites available:</p> <ul> <li><code>http://one.wordpress.test/</code> is the first default site address.</li> <li><code>http://two.wordpress.test/</code> is the second default site address.</li> <li><code>http://vvv.test/</code> is VVV dashboard address.</li> </ul> <p>You should be able to reach each one of the URLs above without issues, should this not be the case something during VVV setup did not go according to the plan and you should fix it before moving on.  </p> <p>If the sanity check above is complete it's time to move to the following part specific to Codeception and wp-browser setup.  </p>"},{"location":"v3/tutorials/vvv-setup/#in-and-out-host-and-guest","title":"In and out, host and guest","text":"<p>The Vagrant box provided by VVV goes beyond a simple MySQL, PHP and Ngnix server stack and provides a complete WordPress development environment; tools like Composer, [grunt-cli][4992-0003], and [wp-cli][4992-0006] are ready to use.  </p> <p>This allows the entire development, when it comes to the CLI tools, to happen in the virtual machine and not outside of it.  </p> <p>\"Inside the virtual machine\" means the first CLI instruction to run from the <code>~/Repos/VVV</code> folder (assuming that is the folder where VVV was installed) is this:</p> <pre><code>cd ~/Repos/VVV\nvagrant ssh\n</code></pre> <p></p> <p>This will connect, via SSH, to the virtual machine as the <code>vagrant</code> user. To exit from the SSH session inside the box, just type <code>exit</code> and return.</p> <p>Note: any further instruction I'm showing here, beside the code editing that will happen in a dedicated PHP IDE like [PHPStorm][4992-0004] or [Sublime Text][4992-0005] on the host machine, will happen \"inside the virtual machine\".  </p> <p>When I say \"host machine\" I mean your laptop, desktop or whatever computer you're working on; when I say \"guest machine\" I mean VVV virtual machine; this is usually the case for any virtual-ish setup (Vagrant, Docker and the like).  </p>"},{"location":"v3/tutorials/vvv-setup/#scaffolding-the-project-folder","title":"Scaffolding the project folder","text":"<p>I'm assuming the scope of the development is to test the <code>my-plugin</code> plugin.  </p> <p>The first step is to create the bare minimum code required to make the plugin show up among the available WordPress plugins. Create the main plugin file in the <code>http://one.wordpress.test</code> installation plugins directory, in the <code>~/Repos/VVV/www/wordpress-one/public_html/wp-content/plugins/my-plugin/my-plugin.php</code> file:</p> <pre><code>&lt;?php\n/**\n * Plugin Name: My plugin\n */ \n</code></pre> <p>The plugin should now show up, activate and deactivate correctly, among the plugins listed in the VVV default WordPress installation at <code>http://one.wordpress.test/wp-admin/plugins.php</code>.  </p> <p>By default, VVV administrator user name is <code>admin</code> and password is <code>password</code>.</p> <p></p>"},{"location":"v3/tutorials/vvv-setup/#installing-wp-browser","title":"Installing wp-browser","text":"<p>Since Composer is provided from VVV, installing <code>wp-browser</code> requires entering the virtual machine (if you did not already):</p> <pre><code>cd ~/Repos/VVV\nvagrant ssh\n</code></pre> <p>Once inside navigate to the plugins folder. The path is now relative to VVV filesystem structure so it won't be the same as the one used above that was, instead, in the context of the \"host machine\":</p> <pre><code>cd /srv/www/wordpress-one/public_html/wp-content/plugins/my-plugin \ncomposer init\n</code></pre> <p></p> <p>Composer will ask some questions to initialize the project, for the sake of this small guide the answers are not relevant. Here is the <code>composer.json</code> file generated by the above answers:</p> <pre><code>{\n    \"name\": \"vagrant/my-plugin\",\n    \"type\": \"wordpress-plugin\",\n    \"require\": {}\n}\n</code></pre> <p>Next require <code>lucatume/wp-browser</code> as a development dependency:</p> <pre><code>composer require --dev lucatume/wp-browser\n</code></pre> <p>Composer installs any dependency binary file, an executable file, in the project <code>vendor/bin</code> folder.  To check Codeception is correctly installed run this command:</p> <pre><code>vendor/bin/codecept --version\n</code></pre> <p></p> <p>Since wp-browser requires Codeception, there is no need to require Codeception explicitly as a development dependency.</p>"},{"location":"v3/tutorials/vvv-setup/#setting-up-wp-browser","title":"Setting up wp-browser","text":"<p>For those that might get lost while trying to set up wp-browser for the first time the VVV context provides an excellent base to understand the process.  </p> <p>wp-browser needs to know:</p> <ul> <li>Where the WordPress installation files are located: they will be loaded in integration and \"WordPress unit\" tests.</li> <li>How to connect to the WordPress site \"normal\" database: this is the database that stores the data of the site I would see when visiting the local installation URL (<code>http://one.wordpress.test</code> in the case of the VVV default installation).</li> <li>How to connect to the database dedicated to the integration and \"WordPress unit\" tests: this database will be used to install WordPress during integration and \"WordPress unit\" tests.</li> </ul> <p>Any test suite using a database should never run on a database containing data of any value; this means that if I am using VVV for my day to day WordPress development my first step should be to backup the site database.  </p> <p>You can create a backup of the current site database contents using wp-cli from within the virtual machine:</p> <pre><code>cd /srv/www/wordpress-one/public_html\nwp db export wordpress-one-backup.sql\n</code></pre> <p>At any moment you can re-import the site database dump using this command, the site database will be reset to the state it was when you created the database dump:</p> <pre><code>cd /srv/www/wordpress-one/public_html\nwp db import wordpress-one-backup.sql\n</code></pre> <p></p>"},{"location":"v3/tutorials/vvv-setup/#creating-the-database-dedicated-to-the-tests","title":"Creating the database dedicated to the tests","text":"<p><code>wp-browser</code> will use the databases it works on in a destructive way: between tests the data will be lost.  </p> <p>After the backup you should have done in the previous step, the next step is creating a database dedicated to the test.  </p> <p>At the VVV box command line run:</p> <pre><code>mysql -u root -p -e \"CREATE DATABASE if not exists tests\"\nmysql -u root -p -e \"GRANT ALL PRIVILEGES ON tests.* TO 'wp'@'localhost';\"\n</code></pre> <p>When prompted for the password enter <code>root</code>. The first command creates the <code>tests</code> database, if it does not exist; the second command grants the <code>wp</code> user all privileges on it.</p> <p>In VVV the root database user name is <code>root</code> and the password is <code>root</code>.</p> <p>Check the database was correctly created running this command:</p> <pre><code>mysql -u root -p -e \"SHOW DATABASES\"\n</code></pre> <p>The <code>tests</code> database should be present in the list.</p>"},{"location":"v3/tutorials/vvv-setup/#bootstrapping-and-configuring-wp-browser","title":"Bootstrapping and configuring wp-browser","text":"<p>After the backup is done it's time to bootstrap <code>wp-browser</code> using its interactive mode:</p> <pre><code>cd /srv/www/wordpress-one/public_html/wp-content/plugins/my-plugin\nvendor/bin/codecept init wpbrowser\n</code></pre> <p>The initialization guide will ask a number of questions. In the screenshots below are the answers I used to configure <code>wp-browser</code>.</p> <p> </p> <p>Below a complete list of each answer:</p> <ul> <li>I acknowledge wp-browser should run on development servers... <code>y</code></li> <li>Would you like to set up the suites interactively now? <code>y</code></li> <li>How would you like the acceptance suite to be called? <code>acceptance</code></li> <li>How would you like the functional suite to be called? <code>functional</code></li> <li>How would you like the WordPress unit and integration suite to be called? <code>wpunit</code></li> <li>How would you like to call the env configuration file? <code>.env.testing</code></li> <li>What is the path of the WordPress root directory? <code>/srv/www/wordpress-one/public_html</code></li> <li>What is the path, relative to WordPress root URL, of the admin area of the test site? <code>/wp-admin</code></li> <li>What is the name of the test database used by the test site? <code>tests</code></li> <li>What is the host of the test database used by the test site? <code>localhost</code></li> <li>What is the user of the test database used by the test site? <code>root</code></li> <li>What is the password of the test database used by the test site? <code>root</code></li> <li>What is the table prefix of the test database used by the test site? <code>wp_</code></li> <li>What is the name of the test database WPLoader should use? <code>tests</code></li> <li>What is the host of the test database WPLoader should use? <code>localhost</code></li> <li>What is the user of the test database WPLoader should use? <code>root</code></li> <li>What is the password of the test database WPLoader should use? <code>root</code></li> <li>What is the table prefix of the test database WPLoader should use? <code>wp_</code></li> <li>What is the URL the test site? <code>http://one.wordpress.test</code></li> <li>What is the email of the test site WordPress administrator? <code>admin@one.wordpress.test</code></li> <li>What is the title of the test site? <code>My Plugin Test</code></li> <li>What is the login of the administrator user of the test site? <code>admin</code></li> <li>What is the password of the administrator user of the test site? <code>password</code></li> <li>Are you testing a plugin, a theme or a combination of both (both)? <code>plugin</code></li> <li>What is the folder/plugin.php name of the plugin? <code>my-plugin/my-plugin.php</code></li> <li>Does your project needs additional plugins to be activated to work? <code>no</code></li> </ul> <p>Codeception will build the suites for the first time and should be ready to go.</p>"},{"location":"v3/tutorials/vvv-setup/#setting-up-the-starting-database-fixture","title":"Setting up the starting database fixture","text":"<p>A \"fixture\", in testing terms, is a minimal, starting environment shared by all tests. In BDD it's the <code>Background</code> any scenario will share. In the case of a plugin the minimal, starting environment is the following:</p> <ul> <li>A fresh WordPress installation empty of any content.</li> <li>WordPress using its default theme.</li> <li>The only active plugin is the one you're testing, in this example: <code>my-plugin</code>.</li> </ul> <p>You can set up this fixture \"manually\", using the site administration UI at <code>http://one.wordpress.test/wp-admin</code>, or use wp-cli and save precious time.</p> <p>The following command will empty the site, backup any content you care about first!</p> <p>As it's been the case so far, I'm running the following command from within the VVV box (use <code>vagrant ssh</code> to log in):</p> <pre><code>cd /srv/www/wordpress-one/public_html\nwp site empty --yes --uploads\nwp plugin deactivate --all\nwp plugin activate my-plugin\nwp db export wp-content/plugins/my-plugin/tests/_data/dump.sql\n</code></pre> <p>The initial database fixture has been created, now there's one last step to complete.</p>"},{"location":"v3/tutorials/vvv-setup/#using-the-tests-database-in-acceptance-and-functional-tests","title":"Using the tests database in acceptance and functional tests","text":"<p>Acceptance and functional tests will act as users, navigating to the site pages and making requests as a user would.  </p> <p>This means that WordPress will load, and with it its <code>wp-config.php</code> file, to handle the requests made by the tests.  </p> <p>During the setup phase I've specified the database to be used for <code>acceptance</code> and <code>functional</code> tests as <code>tests</code> but, looking at the contents of the <code>/srv/www/wordpress-one/public_html/wp-config.php</code> file, the <code>DB_NAME</code> constant is set to <code>wordpress-one</code>.  </p> <p>What we'll do now means:</p> <ul> <li>If the request is a normal one, use the <code>wordpress-one</code> database.</li> <li>If the request comes from a test, use the <code>tests</code> database.</li> </ul> <p>In your IDE/text-editor of choice edit the <code>~/Repos/VVV/www/wordpress-one/public_html/wp-config.php</code> and replace the line defining the <code>DB_NAME</code> constant like this:</p> <pre><code>- define( 'DB_NAME', 'wordpress-one' );\n+ if( isset( $_SERVER['HTTP_X_WPBROWSER_REQUEST'] ) &amp;&amp; $_SERVER['HTTP_X_WPBROWSER_REQUEST'] ) { \n+    define( 'DB_NAME', 'tests' );\n+ } else {\n+    define( 'DB_NAME', 'wordpress-one' );\n+ }\n</code></pre> <p>Here's the copy-and-paste friendly version:</p> <pre><code>if( isset( $_SERVER['HTTP_X_TEST_REQUEST'] ) &amp;&amp; $_SERVER['HTTP_X_TEST_REQUEST'] ) {\n        define( 'DB_NAME', 'tests' );\n} else {\n        define( 'DB_NAME', 'wordpress-one' );\n}\n</code></pre> <p>If you look at the <code>tests/acceptance.suite.yml</code> and <code>tests/functional.suite.yml</code> files, respectively the <code>acceptance</code> and <code>functional</code> suite configuration files, you will see these entries in the <code>WPBrowser</code> module configuration:</p> <pre><code>headers:\n    X_TEST_REQUEST: 1\n    X_WPBROWSER_REQUEST: 1\n</code></pre> <p>This means that, with each HTTP request done during tests, the module will send the two headers. Those headers are read, on the WordPress side, using the <code>$_SERVER['HTTP_X_TEST_REQUEST']</code> and <code>$_SERVER['X_WPBROWSER_REQUEST']</code> variables.</p> <p>Codeception and wp-browser are ready to run and the test-drive development can start.</p>"},{"location":"v3/tutorials/vvv-setup/#sanity-check","title":"Sanity check","text":"<p>Before starting to write tests, take a moment to run each suite separately and make sure all is set up correctly.  </p> <p>If you run into issues, there's a chance you forgot something along the way, please take the time to read this tutorial a second time before opening an issue.</p> <p>You have created 4 suites, each suite has at least one example test to make sure all works. Run each suite and make sure all tests succeed, from within the box run:</p> <pre><code>cd /srv/www/wordpress-one/public_html/wp-content/plugins/my-plugin \nvendor/bin/codecept run acceptance\nvendor/bin/codecept run functional\nvendor/bin/codecept run wpunit\nvendor/bin/codecept run unit\n</code></pre> <p>You're now run to customize the suites to your liking or start writing tests, run <code>vendor/bin/codecept</code> to see a list of the available commands.</p>"},{"location":"v3/tutorials/wamp-setup/","title":"Setting up wp-browser on WAMP for Windows to test a plugin","text":"<p>This is the documentation for version 3 of the project. The current version is version 4 and the documentation can be found here.</p>"},{"location":"v3/tutorials/wamp-setup/#setting-up-wp-browser-with-wamp-on-windows-to-test-a-plugin","title":"Setting up wp-browser with WAMP on Windows to test a plugin","text":""},{"location":"v3/tutorials/wamp-setup/#requirements","title":"Requirements","text":"<ul> <li>A Windows machine</li> <li>A working installation of WAMP.</li> <li>You should be able to create sites and visit them from your browser without issues.</li> <li>Composer installed and working on your terminal <code>PATH</code>, you should be able to run <code>composer --version</code> at the terminal and see the version correctly.</li> </ul>"},{"location":"v3/tutorials/wamp-setup/#install-and-configure-wamp","title":"Install and configure WAMP","text":"<p>This walk-through starts after WAMP has been installed and is correctly running on the host machine; you can download WAMP from the site and follow the installation instructions. In the context of this guide I'm installing the test WordPress installation in the <code>C:\\wamp64\\www\\wp</code> directory. If your installation lies elsewhere, replace the <code>C:\\wamp64\\www\\wp</code> path with the actual directory in each command.  </p> <p></p> <p></p>"},{"location":"v3/tutorials/wamp-setup/#creating-the-databases-and-installing-wordpress","title":"Creating the databases and installing WordPress","text":"<p>Go to the <code>http://localhost/phpmyadmin/index.php</code> page and create two new databases:</p> <ul> <li><code>wordpress</code> is the database you will use for WordPress</li> <li><code>tests</code> is the database you will use for the tests</li> </ul> <p></p> <p>The default database user is <code>root</code>, the default password is empty.</p> <p>Unzip the the WordPress files into the <code>C:\\wamp64\\www\\wp</code> and head over to <code>http://localhost/wp</code> to install WordPress. The database credentials for the installation are:</p> <ul> <li>Database name: <code>wordpress</code></li> <li>Database user: <code>root</code></li> <li>Database password is empty</li> <li>Database host: <code>localhost</code></li> </ul> <p>Use <code>admin</code> as administrator user name and <code>password</code> as password for the administrator user.</p> <p></p> <p></p> <p>Make sure you can visit the WordPress installation at <code>http://localhost/wp</code> and that you can correctly access the administration area at <code>http://localhost/wp/wp-admin</code>.</p>"},{"location":"v3/tutorials/wamp-setup/#scaffolding-the-project-folder","title":"Scaffolding the project folder","text":"<p>I'm assuming the scope of the development is to test the <code>my-plugin</code> plugin.  </p> <p>The first step is to create the bare minimum code required to make the plugin show up among the available WordPress plugins. Create the main plugin file in the WordPress installation plugins directory, in the <code>C:\\wamp64\\www\\wp\\wp-content\\plugins\\my-plugin\\my-plugin.php</code> file:</p> <pre><code>&lt;?php\n/**\n * Plugin Name: My plugin\n */ \n</code></pre> <p>The plugin should now show up, activate and deactivate correctly, among the plugins listed in the WordPress installation at <code>http://localhost/wp/wp-admin/plugins.php</code>.  </p> <p></p>"},{"location":"v3/tutorials/wamp-setup/#installing-wp-browser","title":"Installing wp-browser","text":"<p>Open a terminal window and navigate to the plugin directory and initialize the Composer project. I'm using Cmder as terminal emulator on Windows, but you can use the default one.</p> <pre><code>cd C:\\wamp64\\www\\wp\\wp-content\\plugins\\my-plugin\ncomposer init\n</code></pre> <p></p> <p>Composer will ask some questions to initialize the project, for the sake of this small guide the answers are not relevant. Here is the <code>composer.json</code> file generated by the above answers:</p> <pre><code>{\n    \"name\": \"wamp/my-plugin\",\n    \"type\": \"wordpress-plugin\",\n    \"require\": {}\n}\n</code></pre> <p>Next require <code>lucatume/wp-browser</code> as a development dependency:</p> <pre><code>composer require --dev lucatume/wp-browser\n</code></pre> <p>Composer installs any dependency binary file, an executable file, in the project <code>vendor/bin</code> folder.  To check Codeception is correctly installed run this command:</p> <pre><code>vendor\\bin\\codecept.bat --version\n</code></pre> <p></p> <p>Since wp-browser requires Codeception, there is no need to require Codeception explicitly as a development dependency.</p>"},{"location":"v3/tutorials/wamp-setup/#setting-up-wp-browser","title":"Setting up wp-browser","text":"<p>For those that might get lost while trying to set up wp-browser for the first time the VVV context provides an excellent base to understand the process.  </p> <p>wp-browser needs to know:</p> <ul> <li>Where the WordPress installation files are located: they will be loaded in integration and \"WordPress unit\" tests.</li> <li>How to connect to the WordPress site \"normal\" database: this is the database that stores the data of the site I would see when visiting the local installation URL at <code>http://localhost/wp</code>.</li> <li>How to connect to the database dedicated to the integration and \"WordPress unit\" tests: this database will be used to install WordPress during integration and \"WordPress unit\" tests.</li> </ul> <p>Any test suite using a database should never run on a database containing data of any value; this means that your first step should be to backup the site database.  </p> <p>You can create a backup of the current site database contents using phpMyAdmin, at <code>http://localhost/phpmyadmin/</code>, under the \"Export\" tab:</p> <p></p> <p>At any moment you can re-import the site database dump using, again, phpMyAdmin, under the \"Import\" tab:</p> <p></p>"},{"location":"v3/tutorials/wamp-setup/#bootstrapping-and-configuring-wp-browser","title":"Bootstrapping and configuring wp-browser","text":"<p>After the backup is done it's time to bootstrap <code>wp-browser</code> using its interactive mode:</p> <pre><code>cd C:\\wamp64\\www\\wp\\wp-content\\plugins\\my-plugin\nvendor/bin/codecept.bat init wpbrowser\n</code></pre> <p>The initialization guide will ask a number of questions. In the screenshots below are the answers I used to configure <code>wp-browser</code>.</p> <p></p> <p></p> <p>Below a complete list of each answer:</p> <ul> <li>I acknowledge wp-browser should run on development servers... <code>y</code></li> <li>Would you like to set up the suites interactively now? <code>y</code></li> <li>How would you like the acceptance suite to be called? <code>acceptance</code></li> <li>How would you like the functional suite to be called? <code>functional</code></li> <li>How would you like the WordPress unit and integration suite to be called? <code>wpunit</code></li> <li>How would you like to call the env configuration file? <code>.env.testing</code></li> <li>What is the path of the WordPress root directory? <code>C:/wamp64/www/wp</code></li> <li>What is the path, relative to WordPress root URL, of the admin area of the test site? <code>/wp-admin</code></li> <li>What is the name of the test database used by the test site? <code>tests</code></li> <li>What is the host of the test database used by the test site? <code>localhost</code></li> <li>What is the user of the test database used by the test site? <code>root</code></li> <li>What is the password of the test database used by the test site? ``</li> <li>What is the table prefix of the test database used by the test site? <code>wp_</code></li> <li>What is the name of the test database WPLoader should use? <code>tests</code></li> <li>What is the host of the test database WPLoader should use? <code>localhost</code></li> <li>What is the user of the test database WPLoader should use? <code>root</code></li> <li>What is the password of the test database WPLoader should use? ``</li> <li>What is the table prefix of the test database WPLoader should use? <code>wp_</code></li> <li>What is the URL the test site? <code>http://localhost/wp</code></li> <li>What is the email of the test site WordPress administrator? <code>admin@wp.test</code></li> <li>What is the title of the test site? <code>My Plugin Test</code></li> <li>What is the login of the administrator user of the test site? <code>admin</code></li> <li>What is the password of the administrator user of the test site? <code>password</code></li> <li>Are you testing a plugin, a theme or a combination of both (both)? <code>plugin</code></li> <li>What is the folder/plugin.php name of the plugin? <code>my-plugin/my-plugin.php</code></li> <li>Does your project needs additional plugins to be activated to work? <code>no</code></li> </ul> <p>Codeception will build the suites for the first time and should be ready to go.</p>"},{"location":"v3/tutorials/wamp-setup/#setting-up-the-starting-database-fixture","title":"Setting up the starting database fixture","text":"<p>A \"fixture\", in testing terms, is a minimal, starting environment shared by all tests. In BDD it's the <code>Background</code> any scenario will share. In the case of a plugin the minimal, starting environment is the following:</p> <ul> <li>A fresh WordPress installation empty of any content.</li> <li>WordPress using its default theme.</li> <li>The only active plugin is the one you're testing, in this example: <code>my-plugin</code>.</li> </ul> <p>You should set up this fixture \"manually\", using the site administration UI at <code>http://localhost/wp/wp-admin</code>.</p> <p>The following command will empty the site, backup any content you care about first!</p> <p>When you're done setting up the initial database fixture, export it using the \"Export\" tab of phpMyAdmin, at <code>http://localhost/phpmyadmin/</code> and move the file to the <code>C:\\wamp64\\www\\wp\\wp-content\\plugins\\my-plugin\\tests\\_data\\dump.sql</code> directory.</p> <p>There is one last step left to complete the setup.</p>"},{"location":"v3/tutorials/wamp-setup/#using-the-tests-database-in-acceptance-and-functional-tests","title":"Using the tests database in acceptance and functional tests","text":"<p>Acceptance and functional tests will act as users, navigating to the site pages and making requests as a user would.  </p> <p>This means that WordPress will load, and with it its <code>wp-config.php</code> file, to handle the requests made by the tests.  </p> <p>During the setup phase I've specified the database to be used for <code>acceptance</code> and <code>functional</code> tests as <code>tests</code> but, looking at the contents of the <code>C:\\wamp64\\www\\wp\\wp-config.php</code> file, the <code>DB_NAME</code> constant is set to <code>wordpress</code>.  </p> <p>What we'll do now means:</p> <ul> <li>If the request is a normal one, use the <code>wordpress</code> database.</li> <li>If the request comes from a test, use the <code>tests</code> database.</li> </ul> <p>In your IDE/text-editor of choice edit the <code>C:\\wamp64\\www\\wp\\wp-config.php</code> and replace the line defining the <code>DB_NAME</code> constant like this:</p> <pre><code>- define( 'DB_NAME', 'wordpress' );\n+ if( isset( $_SERVER['HTTP_X_WPBROWSER_REQUEST'] ) &amp;&amp; $_SERVER['HTTP_X_WPBROWSER_REQUEST'] ) { \n+    define( 'DB_NAME', 'tests' );\n+ } else {\n+    define( 'DB_NAME', 'wordpress' );\n+ }\n</code></pre> <p>Here's the copy-and-paste friendly version:</p> <pre><code>if( isset( $_SERVER['HTTP_X_TEST_REQUEST'] ) &amp;&amp; $_SERVER['HTTP_X_TEST_REQUEST'] ) {\n        define( 'DB_NAME', 'tests' );\n} else {\n        define( 'DB_NAME', 'wordpress' );\n}\n</code></pre> <p>If you look at the <code>tests/acceptance.suite.yml</code> and <code>tests/functional.suite.yml</code> files, respectively the <code>acceptance</code> and <code>functional</code> suite configuration files, you will see these entries in the <code>WPBrowser</code> module configuration:</p> <pre><code>headers:\n    X_TEST_REQUEST: 1\n    X_WPBROWSER_REQUEST: 1\n</code></pre> <p>This means that, with each HTTP request done during tests, the module will send the two headers. Those headers are read, on the WordPress side, using the <code>$_SERVER['HTTP_X_TEST_REQUEST']</code> and <code>$_SERVER['X_WPBROWSER_REQUEST']</code> variables.</p> <p>Codeception and wp-browser are ready to run and the test-drive development can start.</p>"},{"location":"v3/tutorials/wamp-setup/#sanity-check","title":"Sanity check","text":"<p>Before starting to write tests, take a moment to run each suite separately and make sure all is set up correctly.  </p> <p>If you run into issues, there's a chance you forgot something along the way, please take the time to read this tutorial a second time before opening an issue.</p> <p>You have created 4 suites, each suite has at least one example test to make sure all works. Run each suite and make sure all tests succeed, from within the box run:</p> <pre><code>cd C:\\wamp64\\www\\wp\\wp-content\\plugins\\my-plugin \nvendor/bin/codecept run acceptance\nvendor/bin/codecept run functional\nvendor/bin/codecept run wpunit\nvendor/bin/codecept run unit\n</code></pre> <p>You're now run to customize the suites to your liking or start writing tests, run <code>vendor/bin/codecept.bat</code> to see a list of the available commands.</p>"}]}